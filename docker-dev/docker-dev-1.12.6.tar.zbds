 message):
    "Show a trace message"
    if Trace.quietmode:
      return
    if Trace.prefix and Trace.showlinesmode:
      message = Trace.prefix + message
    Trace.show(message, sys.stdout)

  def error(cls, message):
    "Show an error message"
    message = '* ' + message
    if Trace.prefix and Trace.showlinesmode:
      message = Trace.prefix + message
    Trace.show(message, sys.stderr)

  def fatal(cls, message):
    "Show an error message and terminate"
    Trace.error('FATAL: ' + message)
    exit(-1)

  def show(cls, message, channel):
    "Show a message out of a channel"
    if sys.version_info < (3,0):
      message = message.encode('utf-8')
    channel.write(message + '\n')

  debug = classmethod(debug)
  message = classmethod(message)
  error = classmethod(error)
  fatal = classmethod(fatal)
  show = classmethod(show)




import os.path
import sys


class BibStylesConfig(object):
  "Configuration class from elyxer.config file"

  abbrvnat = {
      
      u'@article':u'$authors. $title. <i>$journal</i>,{ {$volume:}$pages,} $month $year.{ doi: $doi.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'cite':u'$surname($year)', 
      u'default':u'$authors. <i>$title</i>. $publisher, $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      }

  alpha = {
      
      u'@article':u'$authors. $title.{ <i>$journal</i>{, {$volume}{($number)}}{: $pages}{, $year}.}{ <a href="$url">$url</a>.}{ <a href="$filename">$filename</a>.}{ $note.}', 
      u'cite':u'$Sur$YY', 
      u'default':u'$authors. $title.{ <i>$journal</i>,} $year.{ <a href="$url">$url</a>.}{ <a href="$filename">$filename</a>.}{ $note.}', 
      }

  authordate2 = {
      
      u'@article':u'$authors. $year. $title. <i>$journal</i>, <b>$volume</b>($number), $pages.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@book':u'$authors. $year. <i>$title</i>. $publisher.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'cite':u'$surname, $year', 
      u'default':u'$authors. $year. <i>$title</i>. $publisher.{ URL <a href="$url">$url</a>.}{ $note.}', 
      }

  default = {
      
      u'@article':u'$authors: â€œ$titleâ€, <i>$journal</i>,{ pp. $pages,} $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@book':u'{$authors: }<i>$title</i>{ ($editor, ed.)}.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@booklet':u'$authors: <i>$title</i>.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@conference':u'$authors: â€œ$titleâ€, <i>$journal</i>,{ pp. $pages,} $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@inbook':u'$authors: <i>$title</i>.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@incollection':u'$authors: <i>$title</i>{ in <i>$booktitle</i>{ ($editor, ed.)}}.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@inproceedings':u'$authors: â€œ$titleâ€, <i>$booktitle</i>,{ pp. $pages,} $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@manual':u'$authors: <i>$title</i>.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@mastersthesis':u'$authors: <i>$title</i>.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@misc':u'$authors: <i>$title</i>.{{ $publisher,}{ $howpublished,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@phdthesis':u'$authors: <i>$title</i>.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@proceedings':u'$authors: â€œ$titleâ€, <i>$journal</i>,{ pp. $pages,} $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@techreport':u'$authors: <i>$title</i>, $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@unpublished':u'$authors: â€œ$titleâ€, <i>$journal</i>, $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'cite':u'$index', 
      u'default':u'$authors: <i>$title</i>.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      }

  defaulttags = {
      u'YY':u'??', u'authors':u'', u'surname':u'', 
      }

  ieeetr = {
      
      u'@article':u'$authors, â€œ$titleâ€, <i>$journal</i>, vol. $volume, no. $number, pp. $pages, $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@book':u'$authors, <i>$title</i>. $publisher, $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'cite':u'$index', 
      u'default':u'$authors, â€œ$titleâ€. $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      }

  plain = {
      
      u'@article':u'$authors. $title.{ <i>$journal</i>{, {$volume}{($number)}}{:$pages}{, $year}.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@book':u'$authors. <i>$title</i>. $publisher,{ $month} $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@incollection':u'$authors. $title.{ In <i>$booktitle</i> {($editor, ed.)}.} $publisher,{ $month} $year.{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'@inproceedings':u'$authors. $title. { <i>$booktitle</i>{, {$volume}{($number)}}{:$pages}{, $year}.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      u'cite':u'$index', 
      u'default':u'{$authors. }$title.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}', 
      }

  vancouver = {
      
      u'@article':u'$authors. $title. <i>$journal</i>, $year{;{<b>$volume</b>}{($number)}{:$pages}}.{ URL: <a href="$url">$url</a>.}{ $note.}', 
      u'@book':u'$authors. $title. {$publisher, }$year.{ URL: <a href="$url">$url</a>.}{ $note.}', 
      u'cite':u'$index', 
      u'default':u'$authors. $title; {$publisher, }$year.{ $howpublished.}{ URL: <a href="$url">$url</a>.}{ $note.}', 
      }

class BibTeXConfig(object):
  "Configuration class from elyxer.config file"

  replaced = {
      u'--':u'â€”', u'..':u'.', 
      }

class ContainerConfig(object):
  "Configuration class from elyxer.config file"

  endings = {
      u'Align':u'\\end_layout', u'BarredText':u'\\bar', 
      u'BoldText':u'\\series', u'Cell':u'</cell', 
      u'ChangeDeleted':u'\\change_unchanged', 
      u'ChangeInserted':u'\\change_unchanged', u'ColorText':u'\\color', 
      u'EmphaticText':u'\\emph', u'Hfill':u'\\hfill', u'Inset':u'\\end_inset', 
      u'Layout':u'\\end_layout', u'LyXFooter':u'\\end_document', 
      u'LyXHeader':u'\\end_header', u'Row':u'</row', u'ShapedText':u'\\shape', 
      u'SizeText':u'\\size', u'StrikeOut':u'\\strikeout', 
      u'TextFamily':u'\\family', u'VersalitasText':u'\\noun', 
      }

  extracttext = {
      u'allowed':[u'StringContainer',u'Constant',u'FormulaConstant',], 
      u'cloned':[u'',], 
      u'extracted':[u'PlainLayout',u'TaggedText',u'Align',u'Caption',u'TextFamily',u'EmphaticText',u'VersalitasText',u'BarredText',u'SizeText',u'ColorText',u'LangLine',u'Formula',u'Bracket',u'RawText',u'BibTag',u'FormulaNumber',u'AlphaCommand',u'EmptyCommand',u'OneParamFunction',u'SymbolFunction',u'TextFunction',u'FontFunction',u'CombiningFunction',u'DecoratingFunction',u'FormulaSymbol',u'BracketCommand',u'TeXCode',], 
      }

  startendings = {
      u'\\begin_deeper':u'\\end_deeper', u'\\begin_inset':u'\\end_inset', 
      u'\\begin_layout':u'\\end_layout', 
      }

  starts = {
      u'':u'StringContainer', u'#LyX':u'BlackBox', u'</lyxtabular':u'BlackBox', 
      u'<cell':u'Cell', u'<column':u'Column', u'<row':u'Row', 
      u'\\align':u'Align', u'\\bar':u'BarredText', 
      u'\\bar default':u'BlackBox', u'\\bar no':u'BlackBox', 
      u'\\begin_body':u'BlackBox', u'\\begin_deeper':u'DeeperList', 
      u'\\begin_document':u'BlackBox', u'\\begin_header':u'LyXHeader', 
      u'\\begin_inset Argument':u'ShortTitle', 
      u'\\begin_inset Box':u'BoxInset', u'\\begin_inset Branch':u'Branch', 
      u'\\begin_inset Caption':u'Caption', 
      u'\\begin_inset CommandInset bibitem':u'BiblioEntry', 
      u'\\begin_inset CommandInset bibtex':u'BibTeX', 
      u'\\begin_inset CommandInset citation':u'BiblioCitation', 
      u'\\begin_inset CommandInset href':u'URL', 
      u'\\begin_inset CommandInset include':u'IncludeInset', 
      u'\\begin_inset CommandInset index_print':u'PrintIndex', 
      u'\\begin_inset CommandInset label':u'Label', 
      u'\\begin_inset CommandInset line':u'LineInset', 
      u'\\begin_inset CommandInset nomencl_print':u'PrintNomenclature', 
      u'\\begin_inset CommandInset nomenclature':u'NomenclatureEntry', 
      u'\\begin_inset CommandInset ref':u'Reference', 
      u'\\begin_inset CommandInset toc':u'TableOfContents', 
      u'\\begin_inset ERT':u'ERT', u'\\begin_inset Flex':u'FlexInset', 
      u'\\begin_inset Flex Chunkref':u'NewfangledChunkRef', 
      u'\\begin_inset Flex Marginnote':u'SideNote', 
      u'\\begin_inset Flex Sidenote':u'SideNote', 
      u'\\begin_inset Flex URL':u'FlexURL', u'\\begin_inset Float':u'Float', 
      u'\\begin_inset FloatList':u'ListOf', u'\\begin_inset Foot':u'Footnote', 
      u'\\begin_inset Formula':u'Formula', 
      u'\\begin_inset FormulaMacro':u'FormulaMacro', 
      u'\\begin_inset Graphics':u'Image', 
      u'\\begin_inset Index':u'IndexReference', 
      u'\\begin_inset Info':u'InfoInset', 
      u'\\begin_inset LatexCommand bibitem':u'BiblioEntry', 
      u'\\begin_inset LatexCommand bibtex':u'BibTeX', 
      u'\\begin_inset LatexCommand cite':u'BiblioCitation', 
      u'\\begin_inset LatexCommand citealt':u'BiblioCitation', 
      u'\\begin_inset LatexCommand citep':u'BiblioCitation', 
      u'\\begin_inset LatexCommand citet':u'BiblioCitation', 
      u'\\begin_inset LatexCommand htmlurl':u'URL', 
      u'\\begin_inset LatexCommand index':u'IndexReference', 
      u'\\begin_inset LatexCommand label':u'Label', 
      u'\\begin_inset LatexCommand nomenclature':u'NomenclatureEntry', 
      u'\\begin_inset LatexCommand prettyref':u'Reference', 
      u'\\begin_inset LatexCommand printindex':u'PrintIndex', 
      u'\\begin_inset LatexCommand printnomenclature':u'PrintNomenclature', 
      u'\\begin_inset LatexCommand ref':u'Reference', 
      u'\\begin_inset LatexCommand tableofcontents':u'TableOfContents', 
      u'\\begin_inset LatexCommand url':u'URL', 
      u'\\begin_inset LatexCommand vref':u'Reference', 
      u'\\begin_inset Marginal':u'SideNote', 
      u'\\begin_inset Newline':u'NewlineInset', 
      u'\\begin_inset Newpage':u'NewPageInset', u'\\begin_inset Note':u'Note', 
      u'\\begin_inset OptArg':u'ShortTitle', 
      u'\\begin_inset Phantom':u'PhantomText', 
      u'\\begin_inset Quotes':u'QuoteContainer', 
      u'\\begin_inset Tabular':u'Table', u'\\begin_inset Text':u'InsetText', 
      u'\\begin_inset VSpace':u'VerticalSpace', u'\\begin_inset Wrap':u'Wrap', 
      u'\\begin_inset listings':u'Listing', 
      u'\\begin_inset script':u'ScriptInset', u'\\begin_inset space':u'Space', 
      u'\\begin_layout':u'Layout', u'\\begin_layout Abstract':u'Abstract', 
      u'\\begin_layout Author':u'Author', 
      u'\\begin_layout Bibliography':u'Bibliography', 
      u'\\begin_layout Chunk':u'NewfangledChunk', 
      u'\\begin_layout Description':u'Description', 
      u'\\begin_layout Enumerate':u'ListItem', 
      u'\\begin_layout Itemize':u'ListItem', u'\\begin_layout List':u'List', 
      u'\\begin_layout LyX-Code':u'LyXCode', 
      u'\\begin_layout Plain':u'PlainLayout', 
      u'\\begin_layout Standard':u'StandardLayout', 
      u'\\begin_layout Title':u'Title', u'\\begin_preamble':u'LyXPreamble', 
      u'\\change_deleted':u'ChangeDeleted', 
      u'\\change_inserted':u'ChangeInserted', 
      u'\\change_unchanged':u'BlackBox', u'\\color':u'ColorText', 
      u'\\color inherit':u'BlackBox', u'\\color none':u'BlackBox', 
      u'\\emph default':u'BlackBox', u'\\emph off':u'BlackBox', 
      u'\\emph on':u'EmphaticText', u'\\emph toggle':u'EmphaticText', 
      u'\\end_body':u'LyXFooter', u'\\family':u'TextFamily', 
      u'\\family default':u'BlackBox', u'\\family roman':u'BlackBox', 
      u'\\hfill':u'Hfill', u'\\labelwidthstring':u'BlackBox', 
      u'\\lang':u'LangLine', u'\\length':u'InsetLength', 
      u'\\lyxformat':u'LyXFormat', u'\\lyxline':u'LyXLine', 
      u'\\newline':u'Newline', u'\\newpage':u'NewPage', 
      u'\\noindent':u'BlackBox', u'\\noun default':u'BlackBox', 
      u'\\noun off':u'BlackBox', u'\\noun on':u'VersalitasText', 
      u'\\paragraph_spacing':u'BlackBox', u'\\series bold':u'BoldText', 
      u'\\series default':u'BlackBox', u'\\series medium':u'BlackBox', 
      u'\\shape':u'ShapedText', u'\\shape default':u'BlackBox', 
      u'\\shape up':u'BlackBox', u'\\size':u'SizeText', 
      u'\\size normal':u'BlackBox', u'\\start_of_appendix':u'StartAppendix', 
      u'\\strikeout default':u'BlackBox', u'\\strikeout on':u'StrikeOut', 
      }

  string = {
      u'startcommand':u'\\', 
      }

  table = {
      u'headers':[u'<lyxtabular',u'<features',], 
      }

class EscapeConfig(object):
  "Configuration class from elyxer.config file"

  chars = {
      u'\n':u'', u' -- ':u' â€” ', u' --- ':u' â€” ', u'\'':u'â€™', u'`':u'â€˜', 
      }

  commands = {
      u'\\InsetSpace \\space{}':u'Â ', u'\\InsetSpace \\thinspace{}':u'â€‰', 
      u'\\InsetSpace ~':u'Â ', u'\\SpecialChar \\-':u'', 
      u'\\SpecialChar \\@.':u'.', u'\\SpecialChar \\ldots{}':u'â€¦', 
      u'\\SpecialChar \\menuseparator':u'Â â–·Â ', 
      u'\\SpecialChar \\nobreakdash-':u'-', u'\\SpecialChar \\slash{}':u'/', 
      u'\\SpecialChar \\textcompwordmark{}':u'', u'\\backslash':u'\\', 
      }

  entities = {
      u'&':u'&amp;', u'<':u'&lt;', u'>':u'&gt;', 
      }

  html = {
      u'/>':u'>', 
      }

  iso885915 = {
      u'Â ':u'&nbsp;', u'â€ƒ':u'&emsp;', u'âŸ':u'&#8197;', 
      }

  nonunicode = {
      u'âŸ':u'â€…', 
      }

class FormulaConfig(object):
  "Configuration class from elyxer.config file"

  alphacommands = {
      u'\\AA':u'Ã…', u'\\AE':u'Ã†', 
      u'\\AmS':u'<span class="versalitas">AmS</span>', u'\\Angstroem':u'â„«', 
      u'\\DH':u'Ã', u'\\Koppa':u'Ï', u'\\L':u'Å', u'\\Micro':u'Âµ', u'\\O':u'Ã˜', 
      u'\\OE':u'Å’', u'\\Sampi':u'Ï ', u'\\Stigma':u'Ïš', u'\\TH':u'Ã', 
      u'\\aa':u'Ã¥', u'\\ae':u'Ã¦', u'\\alpha':u'Î±', u'\\beta':u'Î²', 
      u'\\delta':u'Î´', u'\\dh':u'Ã°', u'\\digamma':u'Ï', u'\\epsilon':u'Ïµ', 
      u'\\eta':u'Î·', u'\\eth':u'Ã°', u'\\gamma':u'Î³', u'\\i':u'Ä±', 
      u'\\imath':u'Ä±', u'\\iota':u'Î¹', u'\\j':u'È·', u'\\jmath':u'È·', 
      u'\\kappa':u'Îº', u'\\koppa':u'ÏŸ', u'\\l':u'Å‚', u'\\lambda':u'Î»', 
      u'\\mu':u'Î¼', u'\\nu':u'Î½', u'\\o':u'Ã¸', u'\\oe':u'Å“', u'\\omega':u'Ï‰', 
      u'\\phi':u'Ï†', u'\\pi':u'Ï€', u'\\psi':u'Ïˆ', u'\\rho':u'Ï', 
      u'\\sampi':u'Ï¡', u'\\sigma':u'Ïƒ', u'\\ss':u'ÃŸ', u'\\stigma':u'Ï›', 
      u'\\tau':u'Ï„', u'\\tcohm':u'â„¦', u'\\textcrh':u'Ä§', u'\\th':u'Ã¾', 
      u'\\theta':u'Î¸', u'\\upsilon':u'Ï…', u'\\varDelta':u'âˆ†', 
      u'\\varGamma':u'Î“', u'\\varLambda':u'Î›', u'\\varOmega':u'Î©', 
      u'\\varPhi':u'Î¦', u'\\varPi':u'Î ', u'\\varPsi':u'Î¨', u'\\varSigma':u'Î£', 
      u'\\varTheta':u'Î˜', u'\\varUpsilon':u'Î¥', u'\\varXi':u'Î', 
      u'\\varbeta':u'Ï', u'\\varepsilon':u'Îµ', u'\\varkappa':u'Ï°', 
      u'\\varphi':u'Ï†', u'\\varpi':u'Ï–', u'\\varrho':u'Ï±', u'\\varsigma':u'Ï‚', 
      u'\\vartheta':u'Ï‘', u'\\xi':u'Î¾', u'\\zeta':u'Î¶', 
      }

  array = {
      u'begin':u'\\begin', u'cellseparator':u'&', u'end':u'\\end', 
      u'rowseparator':u'\\\\', 
      }

  bigbrackets = {
      u'(':[u'â›',u'âœ',u'â',], u')':[u'â',u'âŸ',u'â ',], u'[':[u'â¡',u'â¢',u'â£',], 
      u']':[u'â¤',u'â¥',u'â¦',], u'{':[u'â§',u'âª',u'â¨',u'â©',], u'|':[u'|',], 
      u'}':[u'â«',u'âª',u'â¬',u'â­',], u'âˆ¥':[u'âˆ¥',], 
      }

  bigsymbols = {
      u'âˆ‘':[u'â²',u'â³',], u'âˆ«':[u'âŒ ',u'âŒ¡',], 
      }

  bracketcommands = {
      u'\\left':u'span class="symbol"', 
      u'\\left.':u'<span class="leftdot"></span>', 
      u'\\middle':u'span class="symbol"', u'\\right':u'span class="symbol"', 
      u'\\right.':u'<span class="rightdot"></span>', 
      }

  combiningfunctions = {
      u'\\"':u'Ìˆ', u'\\\'':u'Ì', u'\\^':u'Ì‚', u'\\`':u'Ì€', u'\\acute':u'Ì', 
      u'\\bar':u'Ì„', u'\\breve':u'Ì†', u'\\c':u'Ì§', u'\\check':u'ÌŒ', 
      u'\\dddot':u'âƒ›', u'\\ddot':u'Ìˆ', u'\\dot':u'Ì‡', u'\\grave':u'Ì€', 
      u'\\hat':u'Ì‚', u'\\mathring':u'ÌŠ', u'\\overleftarrow':u'âƒ–', 
      u'\\overrightarrow':u'âƒ—', u'\\r':u'ÌŠ', u'\\s':u'Ì©', 
      u'\\textcircled':u'âƒ', u'\\textsubring':u'Ì¥', u'\\tilde':u'Ìƒ', 
      u'\\v':u'ÌŒ', u'\\vec':u'âƒ—', u'\\~':u'Ìƒ', 
      }

  commands = {
      u'\\ ':u'Â ', u'\\!':u'', u'\\#':u'#', u'\\$':u'$', u'\\%':u'%', 
      u'\\&':u'&', u'\\,':u' ', u'\\:':u'âŸ', u'\\;':u'â€„', u'\\AC':u'âˆ¿', 
      u'\\APLcomment':u'â', u'\\APLdownarrowbox':u'â—', u'\\APLinput':u'â', 
      u'\\APLinv':u'âŒ¹', u'\\APLleftarrowbox':u'â‡', u'\\APLlog':u'âŸ', 
      u'\\APLrightarrowbox':u'âˆ', u'\\APLuparrowbox':u'â', u'\\Box':u'â–¡', 
      u'\\Bumpeq':u'â‰', u'\\CIRCLE':u'â—', u'\\Cap':u'â‹’', 
      u'\\CapitalDifferentialD':u'â……', u'\\CheckedBox':u'â˜‘', u'\\Circle':u'â—‹', 
      u'\\Coloneqq':u'â©´', u'\\ComplexI':u'â…ˆ', u'\\ComplexJ':u'â…‰', 
      u'\\Corresponds':u'â‰™', u'\\Cup':u'â‹“', u'\\Delta':u'Î”', u'\\Diamond':u'â—‡', 
      u'\\Diamondblack':u'â—†', u'\\Diamonddot':u'âŸ', u'\\DifferentialD':u'â…†', 
      u'\\Downarrow':u'â‡“', u'\\EUR':u'â‚¬', u'\\Euler':u'â„‡', 
      u'\\ExponetialE':u'â…‡', u'\\Finv':u'â„²', u'\\Game':u'â…', u'\\Gamma':u'Î“', 
      u'\\Im':u'â„‘', u'\\Join':u'â¨', u'\\LEFTCIRCLE':u'â—–', u'\\LEFTcircle':u'â—', 
      u'\\LHD':u'â—€', u'\\Lambda':u'Î›', u'\\Lbag':u'âŸ…', u'\\Leftarrow':u'â‡', 
      u'\\Lleftarrow':u'â‡š', u'\\Longleftarrow':u'âŸ¸', 
      u'\\Longleftrightarrow':u'âŸº', u'\\Longrightarrow':u'âŸ¹', u'\\Lparen':u'â¦…', 
      u'\\Lsh':u'â†°', u'\\Mapsfrom':u'â‡|', u'\\Mapsto':u'|â‡’', u'\\Omega':u'Î©', 
      u'\\P':u'Â¶', u'\\Phi':u'Î¦', u'\\Pi':u'Î ', u'\\Pr':u'Pr', u'\\Psi':u'Î¨', 
      u'\\Qoppa':u'Ï˜', u'\\RHD':u'â–¶', u'\\RIGHTCIRCLE':u'â——', 
      u'\\RIGHTcircle':u'â—‘', u'\\Rbag':u'âŸ†', u'\\Re':u'â„œ', u'\\Rparen':u'â¦†', 
      u'\\Rrightarrow':u'â‡›', u'\\Rsh':u'â†±', u'\\S':u'Â§', u'\\Sigma':u'Î£', 
      u'\\Square':u'â˜', u'\\Subset':u'â‹', u'\\Sun':u'â˜‰', u'\\Supset':u'â‹‘', 
      u'\\Theta':u'Î˜', u'\\Uparrow':u'â‡‘', u'\\Updownarrow':u'â‡•', 
      u'\\Upsilon':u'Î¥', u'\\Vdash':u'âŠ©', u'\\Vert':u'âˆ¥', u'\\Vvdash':u'âŠª', 
      u'\\XBox':u'â˜’', u'\\Xi':u'Î', u'\\Yup':u'â…„', u'\\\\':u'<br/>', 
      u'\\_':u'_', u'\\aleph':u'â„µ', u'\\amalg':u'âˆ', u'\\anchor':u'âš“', 
      u'\\angle':u'âˆ ', u'\\aquarius':u'â™’', u'\\arccos':u'arccos', 
      u'\\arcsin':u'arcsin', u'\\arctan':u'arctan', u'\\arg':u'arg', 
      u'\\aries':u'â™ˆ', u'\\arrowbullet':u'â¢', u'\\ast':u'âˆ—', u'\\asymp':u'â‰', 
      u'\\backepsilon':u'âˆ', u'\\backprime':u'â€µ', u'\\backsimeq':u'â‹', 
      u'\\backslash':u'\\', u'\\ballotx':u'âœ—', u'\\barwedge':u'âŠ¼', 
      u'\\because':u'âˆµ', u'\\beth':u'â„¶', u'\\between':u'â‰¬', u'\\bigcap':u'âˆ©', 
      u'\\bigcirc':u'â—‹', u'\\bigcup':u'âˆª', u'\\bigodot':u'âŠ™', 
      u'\\bigoplus':u'âŠ•', u'\\bigotimes':u'âŠ—', u'\\bigsqcup':u'âŠ”', 
      u'\\bigstar':u'â˜…', u'\\bigtriangledown':u'â–½', u'\\bigtriangleup':u'â–³', 
      u'\\biguplus':u'âŠ', u'\\bigvee':u'âˆ¨', u'\\bigwedge':u'âˆ§', 
      u'\\biohazard':u'â˜£', u'\\blacklozenge':u'â§«', u'\\blacksmiley':u'â˜»', 
      u'\\blacksquare':u'â– ', u'\\blacktriangle':u'â–²', 
      u'\\blacktriangledown':u'â–¼', u'\\blacktriangleleft':u'â—‚', 
      u'\\blacktriangleright':u'â–¶', u'\\blacktriangleup':u'â–´', u'\\bot':u'âŠ¥', 
      u'\\bowtie':u'â‹ˆ', u'\\box':u'â–«', u'\\boxast':u'â§†', u'\\boxbar':u'â—«', 
      u'\\boxbox':u'â§ˆ', u'\\boxbslash':u'â§…', u'\\boxcircle':u'â§‡', 
      u'\\boxdot':u'âŠ¡', u'\\boxminus':u'âŠŸ', u'\\boxplus':u'âŠ', 
      u'\\boxslash':u'â§„', u'\\boxtimes':u'âŠ ', u'\\bullet':u'â€¢', 
      u'\\bumpeq':u'â‰', u'\\cancer':u'â™‹', u'\\cap':u'âˆ©', u'\\capricornus':u'â™‘', 
      u'\\cat':u'â€', u'\\cdot':u'â‹…', u'\\cdots':u'â‹¯', u'\\cent':u'Â¢', 
      u'\\centerdot':u'âˆ™', u'\\checkmark':u'âœ“', u'\\chi':u'Ï‡', u'\\circ':u'âˆ˜', 
      u'\\circeq':u'â‰—', u'\\circlearrowleft':u'â†º', u'\\circlearrowright':u'â†»', 
      u'\\circledR':u'Â®', u'\\circledast':u'âŠ›', u'\\circledbslash':u'â¦¸', 
      u'\\circledcirc':u'âŠš', u'\\circleddash':u'âŠ', u'\\circledgtr':u'â§', 
      u'\\circledless':u'â§€', u'\\clubsuit':u'â™£', u'\\colon':u': ', u'\\coloneqq':u'â‰”', 
      u'\\complement':u'âˆ', u'\\cong':u'â‰…', u'\\coprod':u'âˆ', 
      u'\\copyright':u'Â©', u'\\cos':u'cos', u'\\cosh':u'cosh', u'\\cot':u'cot', 
      u'\\coth':u'coth', u'\\csc':u'csc', u'\\cup':u'âˆª', u'\\curlyvee':u'â‹', 
      u'\\curlywedge':u'â‹', u'\\curvearrowleft':u'â†¶', 
      u'\\curvearrowright':u'â†·', u'\\dag':u'â€ ', u'\\dagger':u'â€ ', 
      u'\\daleth':u'â„¸', u'\\dashleftarrow':u'â‡ ', u'\\dashv':u'âŠ£', 
      u'\\ddag':u'â€¡', u'\\ddagger':u'â€¡', u'\\ddots':u'â‹±', u'\\deg':u'deg', 
      u'\\det':u'det', u'\\diagdown':u'â•²', u'\\diagup':u'â•±', 
      u'\\diameter':u'âŒ€', u'\\diamond':u'â—‡', u'\\diamondsuit':u'â™¦', 
      u'\\dim':u'dim', u'\\div':u'Ã·', u'\\divideontimes':u'â‹‡', 
      u'\\dotdiv':u'âˆ¸', u'\\doteq':u'â‰', u'\\doteqdot':u'â‰‘', u'\\dotplus':u'âˆ”', 
      u'\\dots':u'â€¦', u'\\doublebarwedge':u'âŒ†', u'\\downarrow':u'â†“', 
      u'\\downdownarrows':u'â‡Š', u'\\downharpoonleft':u'â‡ƒ', 
      u'\\downharpoonright':u'â‡‚', u'\\dsub':u'â©¤', u'\\earth':u'â™', 
      u'\\eighthnote':u'â™ª', u'\\ell':u'â„“', u'\\emptyset':u'âˆ…', 
      u'\\eqcirc':u'â‰–', u'\\eqcolon':u'â‰•', u'\\eqsim':u'â‰‚', u'\\euro':u'â‚¬', 
      u'\\exists':u'âˆƒ', u'\\exp':u'exp', u'\\fallingdotseq':u'â‰’', 
      u'\\fcmp':u'â¨¾', u'\\female':u'â™€', u'\\flat':u'â™­', u'\\forall':u'âˆ€', 
      u'\\fourth':u'â—', u'\\frown':u'âŒ¢', u'\\frownie':u'â˜¹', u'\\gcd':u'gcd', 
      u'\\gemini':u'â™Š', u'\\geq)':u'â‰¥', u'\\geqq':u'â‰§', u'\\geqslant':u'â‰¥', 
      u'\\gets':u'â†', u'\\gg':u'â‰«', u'\\ggg':u'â‹™', u'\\gimel':u'â„·', 
      u'\\gneqq':u'â‰©', u'\\gnsim':u'â‹§', u'\\gtrdot':u'â‹—', u'\\gtreqless':u'â‹š', 
      u'\\gtreqqless':u'âªŒ', u'\\gtrless':u'â‰·', u'\\gtrsim':u'â‰³', 
      u'\\guillemotleft':u'Â«', u'\\guillemotright':u'Â»', u'\\hbar':u'â„', 
      u'\\heartsuit':u'â™¥', u'\\hfill':u'<span class="hfill"> </span>', 
      u'\\hom':u'hom', u'\\hookleftarrow':u'â†©', u'\\hookrightarrow':u'â†ª', 
      u'\\hslash':u'â„', u'\\idotsint':u'<span class="bigsymbol">âˆ«â‹¯âˆ«</span>', 
      u'\\iiint':u'<span class="bigsymbol">âˆ­</span>', 
      u'\\iint':u'<span class="bigsymbol">âˆ¬</span>', u'\\imath':u'Ä±', 
      u'\\inf':u'inf', u'\\infty':u'âˆ', u'\\intercal':u'âŠº', 
      u'\\interleave':u'â«´', u'\\invamp':u'â…‹', u'\\invneg':u'âŒ', 
      u'\\jmath':u'È·', u'\\jupiter':u'â™ƒ', u'\\ker':u'ker', u'\\land':u'âˆ§', 
      u'\\landupint':u'<span class="bigsymbol">âˆ±</span>', u'\\lang':u'âŸª', 
      u'\\langle':u'âŸ¨', u'\\lblot':u'â¦‰', u'\\lbrace':u'{', u'\\lbrace)':u'{', 
      u'\\lbrack':u'[', u'\\lceil':u'âŒˆ', u'\\ldots':u'â€¦', u'\\leadsto':u'â‡', 
      u'\\leftarrow)':u'â†', u'\\leftarrowtail':u'â†¢', u'\\leftarrowtobar':u'â‡¤', 
      u'\\leftharpoondown':u'â†½', u'\\leftharpoonup':u'â†¼', 
      u'\\leftleftarrows':u'â‡‡', u'\\leftleftharpoons':u'â¥¢', u'\\leftmoon':u'â˜¾', 
      u'\\leftrightarrow':u'â†”', u'\\leftrightarrows':u'â‡†', 
      u'\\leftrightharpoons':u'â‡‹', u'\\leftthreetimes':u'â‹‹', u'\\leo':u'â™Œ', 
      u'\\leq)':u'â‰¤', u'\\leqq':u'â‰¦', u'\\leqslant':u'â‰¤', u'\\lessdot':u'â‹–', 
      u'\\lesseqgtr':u'â‹›', u'\\lesseqqgtr':u'âª‹', u'\\lessgtr':u'â‰¶', 
      u'\\lesssim':u'â‰²', u'\\lfloor':u'âŒŠ', u'\\lg':u'lg', u'\\lgroup':u'âŸ®', 
      u'\\lhd':u'âŠ²', u'\\libra':u'â™', u'\\lightning':u'â†¯', u'\\limg':u'â¦‡', 
      u'\\liminf':u'liminf', u'\\limsup':u'limsup', u'\\ll':u'â‰ª', 
      u'\\llbracket':u'âŸ¦', u'\\llcorner':u'âŒ', u'\\lll':u'â‹˜', u'\\ln':u'ln', 
      u'\\lneqq':u'â‰¨', u'\\lnot':u'Â¬', u'\\lnsim':u'â‹¦', u'\\log':u'log', 
      u'\\longleftarrow':u'âŸµ', u'\\longleftrightarrow':u'âŸ·', 
      u'\\longmapsto':u'âŸ¼', u'\\longrightarrow':u'âŸ¶', u'\\looparrowleft':u'â†«', 
      u'\\looparrowright':u'â†¬', u'\\lor':u'âˆ¨', u'\\lozenge':u'â—Š', 
      u'\\lrcorner':u'âŒŸ', u'\\ltimes':u'â‹‰', u'\\lyxlock':u'', u'\\male':u'â™‚', 
      u'\\maltese':u'âœ ', u'\\mapsfrom':u'â†¤', u'\\mapsto':u'â†¦', 
      u'\\mathcircumflex':u'^', u'\\max':u'max', u'\\measuredangle':u'âˆ¡', 
      u'\\medbullet':u'âš«', u'\\medcirc':u'âšª', u'\\mercury':u'â˜¿', u'\\mho':u'â„§', 
      u'\\mid':u'âˆ£', u'\\min':u'min', u'\\models':u'âŠ¨', u'\\mp':u'âˆ“', 
      u'\\multimap':u'âŠ¸', u'\\nLeftarrow':u'â‡', u'\\nLeftrightarrow':u'â‡', 
      u'\\nRightarrow':u'â‡', u'\\nVDash':u'âŠ¯', u'\\nabla':u'âˆ‡', 
      u'\\napprox':u'â‰‰', u'\\natural':u'â™®', u'\\ncong':u'â‰‡', u'\\nearrow':u'â†—', 
      u'\\neg':u'Â¬', u'\\neg)':u'Â¬', u'\\neptune':u'â™†', u'\\nequiv':u'â‰¢', 
      u'\\newline':u'<br/>', u'\\nexists':u'âˆ„', u'\\ngeqslant':u'â‰±', 
      u'\\ngtr':u'â‰¯', u'\\ngtrless':u'â‰¹', u'\\ni':u'âˆ‹', u'\\ni)':u'âˆ‹', 
      u'\\nleftarrow':u'â†š', u'\\nleftrightarrow':u'â†®', u'\\nleqslant':u'â‰°', 
      u'\\nless':u'â‰®', u'\\nlessgtr':u'â‰¸', u'\\nmid':u'âˆ¤', u'\\nolimits':u'', 
      u'\\nonumber':u'', u'\\not':u'Â¬', u'\\not<':u'â‰®', u'\\not=':u'â‰ ', 
      u'\\not>':u'â‰¯', u'\\notbackslash':u'â€', u'\\notin':u'âˆ‰', u'\\notni':u'âˆŒ', 
      u'\\notslash':u'âŒ¿', u'\\nparallel':u'âˆ¦', u'\\nprec':u'âŠ€', 
      u'\\nrightarrow':u'â†›', u'\\nsim':u'â‰', u'\\nsimeq':u'â‰„', 
      u'\\nsqsubset':u'âŠÌ¸', u'\\nsubseteq':u'âŠˆ', u'\\nsucc':u'âŠ', 
      u'\\nsucccurlyeq':u'â‹¡', u'\\nsupset':u'âŠ…', u'\\nsupseteq':u'âŠ‰', 
      u'\\ntriangleleft':u'â‹ª', u'\\ntrianglelefteq':u'â‹¬', 
      u'\\ntriangleright':u'â‹«', u'\\ntrianglerighteq':u'â‹­', u'\\nvDash':u'âŠ­', 
      u'\\nvdash':u'âŠ¬', u'\\nwarrow':u'â†–', u'\\odot':u'âŠ™', 
      u'\\officialeuro':u'â‚¬', u'\\oiiint':u'<span class="bigsymbol">âˆ°</span>', 
      u'\\oiint':u'<span class="bigsymbol">âˆ¯</span>', 
      u'\\oint':u'<span class="bigsymbol">âˆ®</span>', 
      u'\\ointclockwise':u'<span class="bigsymbol">âˆ²</span>', 
      u'\\ointctrclockwise':u'<span class="bigsymbol">âˆ³</span>', 
      u'\\ominus':u'âŠ–', u'\\oplus':u'âŠ•', u'\\oslash':u'âŠ˜', u'\\otimes':u'âŠ—', 
      u'\\owns':u'âˆ‹', u'\\parallel':u'âˆ¥', u'\\partial':u'âˆ‚', u'\\pencil':u'âœ', 
      u'\\perp':u'âŠ¥', u'\\pisces':u'â™“', u'\\pitchfork':u'â‹”', u'\\pluto':u'â™‡', 
      u'\\pm':u'Â±', u'\\pointer':u'âª', u'\\pointright':u'â˜', u'\\pounds':u'Â£', 
      u'\\prec':u'â‰º', u'\\preccurlyeq':u'â‰¼', u'\\preceq':u'â‰¼', 
      u'\\precsim':u'â‰¾', u'\\prime':u'â€²', u'\\prompto':u'âˆ', u'\\qoppa':u'Ï™', 
      u'\\qquad':u'  ', u'\\quad':u' ', u'\\quarternote':u'â™©', 
      u'\\radiation':u'â˜¢', u'\\rang':u'âŸ«', u'\\rangle':u'âŸ©', u'\\rblot':u'â¦Š', 
      u'\\rbrace':u'}', u'\\rbrace)':u'}', u'\\rbrack':u']', u'\\rceil':u'âŒ‰', 
      u'\\recycle':u'â™»', u'\\rfloor':u'âŒ‹', u'\\rgroup':u'âŸ¯', u'\\rhd':u'âŠ³', 
      u'\\rightangle':u'âˆŸ', u'\\rightarrow)':u'â†’', u'\\rightarrowtail':u'â†£', 
      u'\\rightarrowtobar':u'â‡¥', u'\\rightharpoondown':u'â‡', 
      u'\\rightharpoonup':u'â‡€', u'\\rightharpooondown':u'â‡', 
      u'\\rightharpooonup':u'â‡€', u'\\rightleftarrows':u'â‡„', 
      u'\\rightleftharpoons':u'â‡Œ', u'\\rightmoon':u'â˜½', 
      u'\\rightrightarrows':u'â‡‰', u'\\rightrightharpoons':u'â¥¤', 
      u'\\rightthreetimes':u'â‹Œ', u'\\rimg':u'â¦ˆ', u'\\risingdotseq':u'â‰“', 
      u'\\rrbracket':u'âŸ§', u'\\rsub':u'â©¥', u'\\rtimes':u'â‹Š', 
      u'\\sagittarius':u'â™', u'\\saturn':u'â™„', u'\\scorpio':u'â™', 
      u'\\searrow':u'â†˜', u'\\sec':u'sec', u'\\second':u'â€³', u'\\setminus':u'âˆ–', 
      u'\\sharp':u'â™¯', u'\\simeq':u'â‰ƒ', u'\\sin':u'sin', u'\\sinh':u'sinh', 
      u'\\sixteenthnote':u'â™¬', u'\\skull':u'â˜ ', u'\\slash':u'âˆ•', 
      u'\\smallsetminus':u'âˆ–', u'\\smalltriangledown':u'â–¿', 
      u'\\smalltriangleleft':u'â—ƒ', u'\\smalltriangleright':u'â–¹', 
      u'\\smalltriangleup':u'â–µ', u'\\smile':u'âŒ£', u'\\smiley':u'â˜º', 
      u'\\spadesuit':u'â™ ', u'\\spddot':u'Â¨', u'\\sphat':u'', 
      u'\\sphericalangle':u'âˆ¢', u'\\spot':u'â¦', u'\\sptilde':u'~', 
      u'\\sqcap':u'âŠ“', u'\\sqcup':u'âŠ”', u'\\sqsubset':u'âŠ', 
      u'\\sqsubseteq':u'âŠ‘', u'\\sqsupset':u'âŠ', u'\\sqsupseteq':u'âŠ’', 
      u'\\square':u'â–¡', u'\\sslash':u'â«½', u'\\star':u'â‹†', u'\\steaming':u'â˜•', 
      u'\\subseteqq':u'â«…', u'\\subsetneqq':u'â«‹', u'\\succ':u'â‰»', 
      u'\\succcurlyeq':u'â‰½', u'\\succeq':u'â‰½', u'\\succnsim':u'â‹©', 
      u'\\succsim':u'â‰¿', u'\\sun':u'â˜¼', u'\\sup':u'sup', u'\\supseteqq':u'â«†', 
      u'\\supsetneqq':u'â«Œ', u'\\surd':u'âˆš', u'\\swarrow':u'â†™', 
      u'\\swords':u'âš”', u'\\talloblong':u'â«¾', u'\\tan':u'tan', 
      u'\\tanh':u'tanh', u'\\taurus':u'â™‰', u'\\textasciicircum':u'^', 
      u'\\textasciitilde':u'~', u'\\textbackslash':u'\\', 
      u'\\textcopyright':u'Â©\'', u'\\textdegree':u'Â°', u'\\textellipsis':u'â€¦', 
      u'\\textemdash':u'â€”', u'\\textendash':u'â€”', u'\\texteuro':u'â‚¬', 
      u'\\textgreater':u'>', u'\\textless':u'<', u'\\textordfeminine':u'Âª', 
      u'\\textordmasculine':u'Âº', u'\\textquotedblleft':u'â€œ', 
      u'\\textquotedblright':u'â€', u'\\textquoteright':u'â€™', 
      u'\\textregistered':u'Â®', u'\\textrightarrow':u'â†’', 
      u'\\textsection':u'Â§', u'\\texttrademark':u'â„¢', 
      u'\\texttwosuperior':u'Â²', u'\\textvisiblespace':u' ', 
      u'\\therefore':u'âˆ´', u'\\third':u'â€´', u'\\top':u'âŠ¤', u'\\triangle':u'â–³', 
      u'\\triangleleft':u'âŠ²', u'\\trianglelefteq':u'âŠ´', u'\\triangleq':u'â‰œ', 
      u'\\triangleright':u'â–·', u'\\trianglerighteq':u'âŠµ', 
      u'\\twoheadleftarrow':u'â†', u'\\twoheadrightarrow':u'â† ', 
      u'\\twonotes':u'â™«', u'\\udot':u'âŠ', u'\\ulcorner':u'âŒœ', u'\\unlhd':u'âŠ´', 
      u'\\unrhd':u'âŠµ', u'\\unrhl':u'âŠµ', u'\\uparrow':u'â†‘', 
      u'\\updownarrow':u'â†•', u'\\upharpoonleft':u'â†¿', u'\\upharpoonright':u'â†¾', 
      u'\\uplus':u'âŠ', u'\\upuparrows':u'â‡ˆ', u'\\uranus':u'â™…', 
      u'\\urcorner':u'âŒ', u'\\vDash':u'âŠ¨', u'\\varclubsuit':u'â™§', 
      u'\\vardiamondsuit':u'â™¦', u'\\varheartsuit':u'â™¥', u'\\varnothing':u'âˆ…', 
      u'\\varspadesuit':u'â™¤', u'\\vdash':u'âŠ¢', u'\\vdots':u'â‹®', u'\\vee':u'âˆ¨', 
      u'\\vee)':u'âˆ¨', u'\\veebar':u'âŠ»', u'\\vert':u'âˆ£', u'\\virgo':u'â™', 
      u'\\warning':u'âš ', u'\\wasylozenge':u'âŒ‘', u'\\wedge':u'âˆ§', 
      u'\\wedge)':u'âˆ§', u'\\wp':u'â„˜', u'\\wr':u'â‰€', u'\\yen':u'Â¥', 
      u'\\yinyang':u'â˜¯', u'\\{':u'{', u'\\|':u'âˆ¥', u'\\}':u'}', 
      }

  decoratedcommand = {
      
      }

  decoratingfunctions = {
      u'\\overleftarrow':u'âŸµ', u'\\overrightarrow':u'âŸ¶', u'\\widehat':u'^', 
      }

  endings = {
      u'bracket':u'}', u'complex':u'\\]', u'endafter':u'}', 
      u'endbefore':u'\\end{', u'squarebracket':u']', 
      }

  environments = {
      u'align':[u'r',u'l',], u'eqnarray':[u'r',u'c',u'l',], 
      u'gathered':[u'l',u'l',], 
      }

  fontfunctions = {
      u'\\boldsymbol':u'b', u'\\mathbb':u'span class="blackboard"', 
      u'\\mathbb{A}':u'ğ”¸', u'\\mathbb{B}':u'ğ”¹', u'\\mathbb{C}':u'â„‚', 
      u'\\mathbb{D}':u'ğ”»', u'\\mathbb{E}':u'ğ”¼', u'\\mathbb{F}':u'ğ”½', 
      u'\\mathbb{G}':u'ğ”¾', u'\\mathbb{H}':u'â„', u'\\mathbb{J}':u'ğ•', 
      u'\\mathbb{K}':u'ğ•‚', u'\\mathbb{L}':u'ğ•ƒ', u'\\mathbb{N}':u'â„•', 
      u'\\mathbb{O}':u'ğ•†', u'\\mathbb{P}':u'â„™', u'\\mathbb{Q}':u'â„š', 
      u'\\mathbb{R}':u'â„', u'\\mathbb{S}':u'ğ•Š', u'\\mathbb{T}':u'ğ•‹', 
      u'\\mathbb{W}':u'ğ•', u'\\mathbb{Z}':u'â„¤', u'\\mathbf':u'b', 
      u'\\mathcal':u'span class="scriptfont"', u'\\mathcal{B}':u'â„¬', 
      u'\\mathcal{E}':u'â„°', u'\\mathcal{F}':u'â„±', u'\\mathcal{H}':u'â„‹', 
      u'\\mathcal{I}':u'â„', u'\\mathcal{L}':u'â„’', u'\\mathcal{M}':u'â„³', 
      u'\\mathcal{R}':u'â„›', u'\\mathfrak':u'span class="fraktur"', 
      u'\\mathfrak{C}':u'â„­', u'\\mathfrak{F}':u'ğ”‰', u'\\mathfrak{H}':u'â„Œ', 
      u'\\mathfrak{I}':u'â„‘', u'\\mathfrak{R}':u'â„œ', u'\\mathfrak{Z}':u'â„¨', 
      u'\\mathit':u'i', u'\\mathring{A}':u'Ã…', u'\\mathring{U}':u'Å®', 
      u'\\mathring{a}':u'Ã¥', u'\\mathring{u}':u'Å¯', u'\\mathring{w}':u'áº˜', 
      u'\\mathring{y}':u'áº™', u'\\mathrm':u'span class="mathrm"', 
      u'\\mathscr':u'span class="scriptfont"', u'\\mathscr{B}':u'â„¬', 
      u'\\mathscr{E}':u'â„°', u'\\mathscr{F}':u'â„±', u'\\mathscr{H}':u'â„‹', 
      u'\\mathscr{I}':u'â„', u'\\mathscr{L}':u'â„’', u'\\mathscr{M}':u'â„³', 
      u'\\mathscr{R}':u'â„›', u'\\mathsf':u'span class="mathsf"', 
      u'\\mathtt':u'tt', 
      }

  hybridfunctions = {
      u'\\addcontentsline':[u'{$p!}{$q!}{$r!}',u'f0{}',u'ignored',], 
      u'\\addtocontents':[u'{$p!}{$q!}',u'f0{}',u'ignored',], 
      u'\\backmatter':[u'',u'f0{}',u'ignored',], 
      u'\\binom':[u'{$1}{$2}',u'f2{(}f0{f1{$1}f1{$2}}f2{)}',u'span class="binom"',u'span class="binomstack"',u'span class="bigsymbol"',], 
      u'\\boxed':[u'{$1}',u'f0{$1}',u'span class="boxed"',], 
      u'\\cfrac':[u'[$p!]{$1}{$2}',u'f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}',u'span class="fullfraction"',u'span class="numerator align-$p"',u'span class="denominator"',u'span class="ignored"',], 
      u'\\color':[u'{$p!}{$1}',u'f0{$1}',u'span style="color: $p;"',], 
      u'\\colorbox':[u'{$p!}{$1}',u'f0{$1}',u'span class="colorbox" style="background: $p;"',], 
      u'\\dbinom':[u'{$1}{$2}',u'(f0{f1{f2{$1}}f1{f2{â€…}}f1{f2{$2}}})',u'span class="binomial"',u'span class="binomrow"',u'span class="binomcell"',], 
      u'\\dfrac':[u'{$1}{$2}',u'f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}',u'span class="fullfraction"',u'span class="numerator"',u'span class="denominator"',u'span class="ignored"',], 
      u'\\displaystyle':[u'{$1}',u'f0{$1}',u'span class="displaystyle"',], 
      u'\\fancyfoot':[u'[$p!]{$q!}',u'f0{}',u'ignored',], 
      u'\\fancyhead':[u'[$p!]{$q!}',u'f0{}',u'ignored',], 
      u'\\fbox':[u'{$1}',u'f0{$1}',u'span class="fbox"',], 
      u'\\fboxrule':[u'{$p!}',u'f0{}',u'ignored',], 
      u'\\fboxsep':[u'{$p!}',u'f0{}',u'ignored',], 
      u'\\fcolorbox':[u'{$p!}{$q!}{$1}',u'f0{$1}',u'span class="boxed" style="border-color: $p; background: $q;"',], 
      u'\\frac':[u'{$1}{$2}',u'f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}',u'span class="fraction"',u'span class="numerator"',u'span class="denominator"',u'span class="ignored"',], 
      u'\\framebox':[u'[$p!][$q!]{$1}',u'f0{$1}',u'span class="framebox align-$q" style="width: $p;"',], 
      u'\\frontmatter':[u'',u'f0{}',u'ignored',], 
      u'\\href':[u'[$o]{$u!}{$t!}',u'f0{$t}',u'a href="$u"',], 
      u'\\hspace':[u'{$p!}',u'f0{ }',u'span class="hspace" style="width: $p;"',], 
      u'\\leftroot':[u'{$p!}',u'f0{ }',u'span class="leftroot" style="width: $p;px"',], 
      u'\\mainmatter':[u'',u'f0{}',u'ignored',], 
      u'\\markboth':[u'{$p!}{$q!}',u'f0{}',u'ignored',], 
      u'\\markright':[u'{$p!}',u'f0{}',u'ignored',], 
      u'\\nicefrac':[u'{$1}{$2}',u'f0{f1{$1}â„f2{$2}}',u'span class="fraction"',u'sup class="numerator"',u'sub class="denominator"',u'span class="ignored"',], 
      u'\\parbox':[u'[$p!]{$w!}{$1}',u'f0{1}',u'div class="Boxed" style="width: $w;"',], 
      u'\\raisebox':[u'{$p!}{$1}',u'f0{$1.font}',u'span class="raisebox" style="vertical-align: $p;"',], 
      u'\\renewenvironment':[u'{$1!}{$2!}{$3!}',u'',], 
      u'\\rule':[u'[$v!]{$w!}{$h!}',u'f0/',u'hr class="line" style="width: $w; height: $h;"',], 
      u'\\scriptscriptstyle':[u'{$1}',u'f0{$1}',u'span class="scriptscriptstyle"',], 
      u'\\scriptstyle':[u'{$1}',u'f0{$1}',u'span class="scriptstyle"',], 
      u'\\sqrt':[u'[$0]{$1}',u'f0{f1{$0}f2{âˆš}f4{(}f3{$1}f4{)}}',u'span class="sqrt"',u'sup class="root"',u'span class="radical"',u'span class="root"',u'span class="ignored"',], 
      u'\\stackrel':[u'{$1}{$2}',u'f0{f1{$1}f2{$2}}',u'span class="stackrel"',u'span class="upstackrel"',u'span class="downstackrel"',], 
      u'\\tbinom':[u'{$1}{$2}',u'(f0{f1{f2{$1}}f1{f2{â€…}}f1{f2{$2}}})',u'span class="binomial"',u'span class="binomrow"',u'span class="binomcell"',], 
      u'\\textcolor':[u'{$p!}{$1}',u'f0{$1}',u'span style="color: $p;"',], 
      u'\\textstyle':[u'{$1}',u'f0{$1}',u'span class="textstyle"',], 
      u'\\thispagestyle':[u'{$p!}',u'f0{}',u'ignored',], 
      u'\\unit':[u'[$0]{$1}',u'$0f0{$1.font}',u'span class="unit"',], 
      u'\\unitfrac':[u'[$0]{$1}{$2}',u'$0f0{f1{$1.font}â„f2{$2.font}}',u'span class="fraction"',u'sup class="unit"',u'sub class="unit"',], 
      u'\\uproot':[u'{$p!}',u'f0{ }',u'span class="uproot" style="width: $p;px"',], 
      u'\\url':[u'{$u!}',u'f0{$u}',u'a href="$u"',], 
      u'\\vspace':[u'{$p!}',u'f0{ }',u'span class="vspace" style="height: $p;"',], 
      }

  hybridsizes = {
      u'\\binom':u'$1+$2', u'\\cfrac':u'$1+$2', u'\\dbinom':u'$1+$2+1', 
      u'\\dfrac':u'$1+$2', u'\\frac':u'$1+$2', u'\\tbinom':u'$1+$2+1', 
      }

  labelfunctions = {
      u'\\label':u'a name="#"', 
      }

  limitcommands = {
      u'\\biginterleave':u'â«¼', u'\\bigsqcap':u'â¨…', u'\\fint':u'â¨', 
      u'\\iiiint':u'â¨Œ', u'\\int':u'âˆ«', u'\\intop':u'âˆ«', u'\\lim':u'lim', 
      u'\\prod':u'âˆ', u'\\smallint':u'âˆ«', u'\\sqint':u'â¨–', u'\\sum':u'âˆ‘', 
      u'\\varointclockwise':u'âˆ²', u'\\varprod':u'â¨‰', u'\\zcmp':u'â¨Ÿ', 
      u'\\zhide':u'â§¹', u'\\zpipe':u'â¨ ', u'\\zproject':u'â¨¡', 
      }

  misccommands = {
      u'\\limits':u'LimitPreviousCommand', u'\\newcommand':u'MacroDefinition', 
      u'\\renewcommand':u'MacroDefinition', 
      u'\\setcounter':u'SetCounterFunction', u'\\tag':u'FormulaTag', 
      u'\\tag*':u'FormulaTag', u'\\today':u'TodayCommand', 
      }

  modified = {
      u'\n':u'', u' ':u'', u'$':u'', u'&':u'	', u'\'':u'â€™', u'+':u'âŸ+âŸ', 
      u',':u',âŸ', u'-':u'âŸâˆ’âŸ', u'/':u'âŸâ„âŸ', u':':u' : ', u'<':u'âŸ&lt;âŸ', 
      u'=':u'âŸ=âŸ', u'>':u'âŸ&gt;âŸ', u'@':u'', u'~':u'', 
      }

  onefunctions = {
      u'\\Big':u'span class="bigsymbol"', u'\\Bigg':u'span class="hugesymbol"', 
      u'\\bar':u'span class="bar"', u'\\begin{array}':u'span class="arraydef"', 
      u'\\big':u'span class="symbol"', u'\\bigg':u'span class="largesymbol"', 
      u'\\bigl':u'span class="bigsymbol"', u'\\bigr':u'span class="bigsymbol"', 
      u'\\centering':u'span class="align-center"', 
      u'\\ensuremath':u'span class="ensuremath"', 
      u'\\hphantom':u'span class="phantom"', 
      u'\\noindent':u'span class="noindent"', 
      u'\\overbrace':u'span class="overbrace"', 
      u'\\overline':u'span class="overline"', 
      u'\\phantom':u'span class="phantom"', 
      u'\\underbrace':u'span class="underbrace"', u'\\underline':u'u', 
      u'\\vphantom':u'span class="phantom"', 
      }

  spacedcommands = {
      u'\\Bot':u'â««', u'\\Doteq':u'â‰‘', u'\\DownArrowBar':u'â¤“', 
      u'\\DownLeftTeeVector':u'â¥', u'\\DownLeftVectorBar':u'â¥–', 
      u'\\DownRightTeeVector':u'â¥Ÿ', u'\\DownRightVectorBar':u'â¥—', 
      u'\\Equal':u'â©µ', u'\\LeftArrowBar':u'â‡¤', u'\\LeftDownTeeVector':u'â¥¡', 
      u'\\LeftDownVectorBar':u'â¥™', u'\\LeftTeeVector':u'â¥š', 
      u'\\LeftTriangleBar':u'â§', u'\\LeftUpTeeVector':u'â¥ ', 
      u'\\LeftUpVectorBar':u'â¥˜', u'\\LeftVectorBar':u'â¥’', 
      u'\\Leftrightarrow':u'â‡”', u'\\Longmapsfrom':u'âŸ½', u'\\Longmapsto':u'âŸ¾', 
      u'\\MapsDown':u'â†§', u'\\MapsUp':u'â†¥', u'\\Nearrow':u'â‡—', 
      u'\\NestedGreaterGreater':u'âª¢', u'\\NestedLessLess':u'âª¡', 
      u'\\NotGreaterLess':u'â‰¹', u'\\NotGreaterTilde':u'â‰µ', 
      u'\\NotLessTilde':u'â‰´', u'\\Nwarrow':u'â‡–', u'\\Proportion':u'âˆ·', 
      u'\\RightArrowBar':u'â‡¥', u'\\RightDownTeeVector':u'â¥', 
      u'\\RightDownVectorBar':u'â¥•', u'\\RightTeeVector':u'â¥›', 
      u'\\RightTriangleBar':u'â§', u'\\RightUpTeeVector':u'â¥œ', 
      u'\\RightUpVectorBar':u'â¥”', u'\\RightVectorBar':u'â¥“', 
      u'\\Rightarrow':u'â‡’', u'\\Same':u'â©¶', u'\\Searrow':u'â‡˜', 
      u'\\Swarrow':u'â‡™', u'\\Top':u'â«ª', u'\\UpArrowBar':u'â¤’', u'\\VDash':u'âŠ«', 
      u'\\approx':u'â‰ˆ', u'\\approxeq':u'â‰Š', u'\\backsim':u'âˆ½', u'\\barin':u'â‹¶', 
      u'\\barleftharpoon':u'â¥«', u'\\barrightharpoon':u'â¥­', u'\\bij':u'â¤–', 
      u'\\coloneq':u'â‰”', u'\\corresponds':u'â‰™', u'\\curlyeqprec':u'â‹', 
      u'\\curlyeqsucc':u'â‹Ÿ', u'\\dashrightarrow':u'â‡¢', u'\\dlsh':u'â†²', 
      u'\\downdownharpoons':u'â¥¥', u'\\downuparrows':u'â‡µ', 
      u'\\downupharpoons':u'â¥¯', u'\\drsh':u'â†³', u'\\eqslantgtr':u'âª–', 
      u'\\eqslantless':u'âª•', u'\\equiv':u'â‰¡', u'\\ffun':u'â‡»', u'\\finj':u'â¤•', 
      u'\\ge':u'â‰¥', u'\\geq':u'â‰¥', u'\\ggcurly':u'âª¼', u'\\gnapprox':u'âªŠ', 
      u'\\gneq':u'âªˆ', u'\\gtrapprox':u'âª†', u'\\hash':u'â‹•', u'\\iddots':u'â‹°', 
      u'\\implies':u'âŸâ‡’âŸ', u'\\in':u'âˆˆ', u'\\le':u'â‰¤', u'\\leftarrow':u'â†', 
      u'\\leftarrowtriangle':u'â‡½', u'\\leftbarharpoon':u'â¥ª', 
      u'\\leftrightarrowtriangle':u'â‡¿', u'\\leftrightharpoon':u'â¥Š', 
      u'\\leftrightharpoondown':u'â¥', u'\\leftrightharpoonup':u'â¥', 
      u'\\leftrightsquigarrow':u'â†­', u'\\leftslice':u'âª¦', 
      u'\\leftsquigarrow':u'â‡œ', u'\\leftupdownharpoon':u'â¥‘', u'\\leq':u'â‰¤', 
      u'\\lessapprox':u'âª…', u'\\llcurly':u'âª»', u'\\lnapprox':u'âª‰', 
      u'\\lneq':u'âª‡', u'\\longmapsfrom':u'âŸ»', u'\\multimapboth':u'â§Ÿ', 
      u'\\multimapdotbothA':u'âŠ¶', u'\\multimapdotbothB':u'âŠ·', 
      u'\\multimapinv':u'âŸœ', u'\\nVdash':u'âŠ®', u'\\ne':u'â‰ ', u'\\neq':u'â‰ ', 
      u'\\ngeq':u'â‰±', u'\\nleq':u'â‰°', u'\\nni':u'âˆŒ', u'\\not\\in':u'âˆ‰', 
      u'\\notasymp':u'â‰­', u'\\npreceq':u'â‹ ', u'\\nsqsubseteq':u'â‹¢', 
      u'\\nsqsupseteq':u'â‹£', u'\\nsubset':u'âŠ„', u'\\nsucceq':u'â‹¡', 
      u'\\pfun':u'â‡¸', u'\\pinj':u'â¤”', u'\\precapprox':u'âª·', u'\\preceqq':u'âª³', 
      u'\\precnapprox':u'âª¹', u'\\precnsim':u'â‹¨', u'\\propto':u'âˆ', 
      u'\\psur':u'â¤€', u'\\rightarrow':u'â†’', u'\\rightarrowtriangle':u'â‡¾', 
      u'\\rightbarharpoon':u'â¥¬', u'\\rightleftharpoon':u'â¥‹', 
      u'\\rightslice':u'âª§', u'\\rightsquigarrow':u'â‡', 
      u'\\rightupdownharpoon':u'â¥', u'\\sim':u'~', u'\\strictfi':u'â¥¼', 
      u'\\strictif':u'â¥½', u'\\subset':u'âŠ‚', u'\\subseteq':u'âŠ†', 
      u'\\subsetneq':u'âŠŠ', u'\\succapprox':u'âª¸', u'\\succeqq':u'âª´', 
      u'\\succnapprox':u'âªº', u'\\supset':u'âŠƒ', u'\\supseteq':u'âŠ‡', 
      u'\\supsetneq':u'âŠ‹', u'\\times':u'Ã—', u'\\to':u'â†’', 
      u'\\updownarrows':u'â‡…', u'\\updownharpoons':u'â¥®', u'\\upupharpoons':u'â¥£', 
      u'\\vartriangleleft':u'âŠ²', u'\\vartriangleright':u'âŠ³', 
      }

  starts = {
      u'beginafter':u'}', u'beginbefore':u'\\begin{', u'bracket':u'{', 
      u'command':u'\\', u'comment':u'%', u'complex':u'\\[', u'simple':u'$', 
      u'squarebracket':u'[', u'unnumbered':u'*', 
      }

  symbolfunctions = {
      u'^':u'sup', u'_':u'sub', 
      }

  textfunctions = {
      u'\\mbox':u'span class="mbox"', u'\\text':u'span class="text"', 
      u'\\textbf':u'b', u'\\textipa':u'span class="textipa"', u'\\textit':u'i', 
      u'\\textnormal':u'span class="textnormal"', 
      u'\\textrm':u'span class="textrm"', 
      u'\\textsc':u'span class="versalitas"', 
      u'\\textsf':u'span class="textsf"', u'\\textsl':u'i', u'\\texttt':u'tt', 
      u'\\textup':u'span class="normal"', 
      }

  unmodified = {
      
      u'characters':[u'.',u'*',u'â‚¬',u'(',u')',u'[',u']',u'Â·',u'!',u';',u'|',u'Â§',u'"',], 
      }

  urls = {
      u'googlecharts':u'http://chart.googleapis.com/chart?cht=tx&chl=', 
      }

class GeneralConfig(object):
  "Configuration class from elyxer.config file"

  version = {
      u'date':u'2015-02-26', u'lyxformat':u'413', u'number':u'1.2.5', 
      }

class HeaderConfig(object):
  "Configuration class from elyxer.config file"

  parameters = {
      u'beginpreamble':u'\\begin_preamble', u'branch':u'\\branch', 
      u'documentclass':u'\\textclass', u'endbranch':u'\\end_branch', 
      u'endpreamble':u'\\end_preamble', u'language':u'\\language', 
      u'lstset':u'\\lstset', u'outputchanges':u'\\output_changes', 
      u'paragraphseparation':u'\\paragraph_separation', 
      u'pdftitle':u'\\pdf_title', u'secnumdepth':u'\\secnumdepth', 
      u'tocdepth':u'\\tocdepth', 
      }

  styles = {
      
      u'article':[u'article',u'aastex',u'aapaper',u'acmsiggraph',u'sigplanconf',u'achemso',u'amsart',u'apa',u'arab-article',u'armenian-article',u'article-beamer',u'chess',u'dtk',u'elsarticle',u'heb-article',u'IEEEtran',u'iopart',u'kluwer',u'scrarticle-beamer',u'scrartcl',u'extarticle',u'paper',u'mwart',u'revtex4',u'spie',u'svglobal3',u'ltugboat',u'agu-dtd',u'jgrga',u'agums',u'entcs',u'egs',u'ijmpc',u'ijmpd',u'singlecol-new',u'doublecol-new',u'isprs',u'tarticle',u'jsarticle',u'jarticle',u'jss',u'literate-article',u'siamltex',u'cl2emult',u'llncs',u'svglobal',u'svjog',u'svprobth',], 
      u'book':[u'book',u'amsbook',u'scrbook',u'extbook',u'tufte-book',u'report',u'extreport',u'scrreprt',u'memoir',u'tbook',u'jsbook',u'jbook',u'mwbk',u'svmono',u'svmult',u'treport',u'jreport',u'mwrep',], 
      }

class ImageConfig(object):
  "Configuration class from elyxer.config file"

  converters = {
      
      u'imagemagick':u'convert[ -density $scale][ -define $format:use-cropbox=true] "$input" "$output"', 
      u'inkscape':u'inkscape "$input" --export-png="$output"', 
      u'lyx':u'lyx -C "$input" "$output"', 
      }

  cropboxformats = {
      u'.eps':u'ps', u'.pdf':u'pdf', u'.ps':u'ps', 
      }

  formats = {
      u'default':u'.png', u'vector':[u'.svg',u'.eps',], 
      }

class LayoutConfig(object):
  "Configuration class from elyxer.config file"

  groupable = {
      
      u'allowed':[u'StringContainer',u'Constant',u'TaggedText',u'Align',u'TextFamily',u'EmphaticText',u'VersalitasText',u'BarredText',u'SizeText',u'ColorText',u'LangLine',u'Formula',], 
      }

class NewfangleConfig(object):
  "Configuration class from elyxer.config file"

  constants = {
      u'chunkref':u'chunkref{', u'endcommand':u'}', u'endmark':u'&gt;', 
      u'startcommand':u'\\', u'startmark':u'=&lt;', 
      }

class NumberingConfig(object):
  "Configuration class from elyxer.config file"

  layouts = {
      
      u'ordered':[u'Chapter',u'Section',u'Subsection',u'Subsubsection',u'Paragraph',], 
      u'roman':[u'Part',u'Book',], 
      }

  sequence = {
      u'symbols':[u'*',u'**',u'â€ ',u'â€¡',u'Â§',u'Â§Â§',u'Â¶',u'Â¶Â¶',u'#',u'##',], 
      }

class StyleConfig(object):
  "Configuration class from elyxer.config file"

  hspaces = {
      u'\\enskip{}':u'â€‚', u'\\hfill{}':u'<span class="hfill"> </span>', 
      u'\\hspace*{\\fill}':u'â€ƒ', u'\\hspace*{}':u'', u'\\hspace{}':u'â€ƒ', 
      u'\\negthinspace{}':u'', u'\\qquad{}':u'â€ƒâ€ƒ', u'\\quad{}':u'â€ƒ', 
      u'\\space{}':u'Â ', u'\\thinspace{}':u'â€‰', u'~':u'Â ', 
      }

  quotes = {
      u'ald':u'Â»', u'als':u'â€º', u'ard':u'Â«', u'ars':u'â€¹', u'eld':u'&ldquo;', 
      u'els':u'&lsquo;', u'erd':u'&rdquo;', u'ers':u'&rsquo;', u'fld':u'Â«', 
      u'fls':u'â€¹', u'frd':u'Â»', u'frs':u'â€º', u'gld':u'â€', u'gls':u'â€š', 
      u'grd':u'â€œ', u'grs':u'â€˜', u'pld':u'â€', u'pls':u'â€š', u'prd':u'â€', 
      u'prs':u'â€™', u'sld':u'â€', u'srd':u'â€', 
      }

  referenceformats = {
      u'eqref':u'(@â†•)', u'formatted':u'Â¶â†•', u'nameref':u'$â†•', u'pageref':u'#â†•', 
      u'ref':u'@â†•', u'vpageref':u'on-page#â†•', u'vref':u'@on-page#â†•', 
      }

  size = {
      u'ignoredtexts':[u'col',u'text',u'line',u'page',u'theight',u'pheight',], 
      }

  vspaces = {
      u'bigskip':u'<div class="bigskip"> </div>', 
      u'defskip':u'<div class="defskip"> </div>', 
      u'medskip':u'<div class="medskip"> </div>', 
      u'smallskip':u'<div class="smallskip"> </div>', 
      u'vfill':u'<div class="vfill"> </div>', 
      }

class TOCConfig(object):
  "Configuration class from elyxer.config file"

  extractplain = {
      
      u'allowed':[u'StringContainer',u'Constant',u'TaggedText',u'Align',u'TextFamily',u'EmphaticText',u'VersalitasText',u'BarredText',u'SizeText',u'ColorText',u'LangLine',u'Formula',], 
      u'cloned':[u'',], u'extracted':[u'',], 
      }

  extracttitle = {
      u'allowed':[u'StringContainer',u'Constant',u'Space',], 
      u'cloned':[u'TextFamily',u'EmphaticText',u'VersalitasText',u'BarredText',u'SizeText',u'ColorText',u'LangLine',u'Formula',], 
      u'extracted':[u'PlainLayout',u'TaggedText',u'Align',u'Caption',u'StandardLayout',u'FlexInset',], 
      }

class TagConfig(object):
  "Configuration class from elyxer.config file"

  barred = {
      u'under':u'u', 
      }

  family = {
      u'sans':u'span class="sans"', u'typewriter':u'tt', 
      }

  flex = {
      u'CharStyle:Code':u'span class="code"', 
      u'CharStyle:MenuItem':u'span class="menuitem"', 
      u'Code':u'span class="code"', u'MenuItem':u'span class="menuitem"', 
      u'Noun':u'span class="noun"', u'Strong':u'span class="strong"', 
      }

  group = {
      u'layouts':[u'Quotation',u'Quote',], 
      }

  layouts = {
      u'Center':u'div', u'Chapter':u'h?', u'Date':u'h2', u'Paragraph':u'div', 
      u'Part':u'h1', u'Quotation':u'blockquote', u'Quote':u'blockquote', 
      u'Section':u'h?', u'Subsection':u'h?', u'Subsubsection':u'h?', 
      }

  listitems = {
      u'Enumerate':u'ol', u'Itemize':u'ul', 
      }

  notes = {
      u'Comment':u'', u'Greyedout':u'span class="greyedout"', u'Note':u'', 
      }

  script = {
      u'subscript':u'sub', u'superscript':u'sup', 
      }

  shaped = {
      u'italic':u'i', u'slanted':u'i', u'smallcaps':u'span class="versalitas"', 
      }

class TranslationConfig(object):
  "Configuration class from elyxer.config file"

  constants = {
      u'Appendix':u'Appendix', u'Book':u'Book', u'Chapter':u'Chapter', 
      u'Paragraph':u'Paragraph', u'Part':u'Part', u'Section':u'Section', 
      u'Subsection':u'Subsection', u'Subsubsection':u'Subsubsection', 
      u'abstract':u'Abstract', u'bibliography':u'Bibliography', 
      u'figure':u'figure', u'float-algorithm':u'Algorithm ', 
      u'float-figure':u'Figure ', u'float-listing':u'Listing ', 
      u'float-table':u'Table ', u'float-tableau':u'Tableau ', 
      u'footnotes':u'Footnotes', u'generated-by':u'Document generated by ', 
      u'generated-on':u' on ', u'index':u'Index', 
      u'jsmath-enable':u'Please enable JavaScript on your browser.', 
      u'jsmath-requires':u' requires JavaScript to correctly process the mathematics on this page. ', 
      u'jsmath-warning':u'Warning: ', u'list-algorithm':u'List of Algorithms', 
      u'list-figure':u'List of Figures', u'list-table':u'List of Tables', 
      u'list-tableau':u'List of Tableaux', u'main-page':u'Main page', 
      u'next':u'Next', u'nomenclature':u'Nomenclature', 
      u'on-page':u' on page ', u'prev':u'Prev', u'references':u'References', 
      u'toc':u'Table of Contents', u'toc-for':u'Contents for ', u'up':u'Up', 
      }

  languages = {
      u'american':u'en', u'british':u'en', u'deutsch':u'de', u'dutch':u'nl', 
      u'english':u'en', u'french':u'fr', u'ngerman':u'de', u'russian':u'ru', 
      u'spanish':u'es', 
      }






class CommandLineParser(object):
  "A parser for runtime options"

  def __init__(self, options):
    self.options = options

  def parseoptions(self, args):
    "Parse command line options"
    if len(args) == 0:
      return None
    while len(args) > 0 and args[0].startswith('--'):
      key, value = self.readoption(args)
      if not key:
        return 'Option ' + value + ' not recognized'
      if not value:
        return 'Option ' + key + ' needs a value'
      setattr(self.options, key, value)
    return None

  def readoption(self, args):
    "Read the key and value for an option"
    arg = args[0][2:]
    del args[0]
    if '=' in arg:
      key = self.readequalskey(arg, args)
    else:
      key = arg.replace('-', '')
    if not hasattr(self.options, key):
      return None, key
    current = getattr(self.options, key)
    if isinstance(current, bool):
      return key, True
    # read value
    if len(args) == 0:
      return key, None
    if args[0].startswith('"'):
      initial = args[0]
      del args[0]
      return key, self.readquoted(args, initial)
    value = args[0].decode('utf-8')
    del args[0]
    if isinstance(current, list):
      current.append(value)
      return key, current
    return key, value

  def readquoted(self, args, initial):
    "Read a value between quotes"
    Trace.error('Oops')
    value = initial[1:]
    while len(args) > 0 and not args[0].endswith('"') and not args[0].startswith('--'):
      Trace.error('Appending ' + args[0])
      value += ' ' + args[0]
      del args[0]
    if len(args) == 0 or args[0].startswith('--'):
      return None
    value += ' ' + args[0:-1]
    return value

  def readequalskey(self, arg, args):
    "Read a key using equals"
    split = arg.split('=', 1)
    key = split[0]
    value = split[1]
    args.insert(0, value)
    return key



class Options(object):
  "A set of runtime options"

  instance = None

  location = None
  nocopy = False
  copyright = False
  debug = False
  quiet = False
  version = False
  hardversion = False
  versiondate = False
  html = False
  help = False
  showlines = True
  unicode = False
  iso885915 = False
  css = []
  favicon = ''
  title = None
  directory = None
  destdirectory = None
  toc = False
  toctarget = ''
  tocfor = None
  forceformat = None
  lyxformat = False
  target = None
  splitpart = None
  memory = True
  lowmem = False
  nobib = False
  converter = 'imagemagick'
  raw = False
  jsmath = None
  mathjax = None
  nofooter = False
  simplemath = False
  template = None
  noconvert = False
  notoclabels = False
  letterfoot = True
  numberfoot = False
  symbolfoot = False
  hoverfoot = True
  marginfoot = False
  endfoot = False
  supfoot = True
  alignfoot = False
  footnotes = None
  imageformat = None
  copyimages = False
  googlecharts = False
  embedcss = []

  branches = dict()

  def parseoptions(self, args):
    "Parse command line options"
    Options.location = args[0]
    del args[0]
    parser = CommandLineParser(Options)
    result = parser.parseoptions(args)
    if result:
      Trace.error(result)
      self.usage()
    self.processoptions()

  def processoptions(self):
    "Process all options parsed."
    if Options.help:
      self.usage()
    if Options.version:
      self.showversion()
    if Options.hardversion:
      self.showhardversion()
    if Options.versiondate:
      self.showversiondate()
    if Options.lyxformat:
      self.showlyxformat()
    if Options.splitpart:
      try:
        Options.splitpart = int(Options.splitpart)
        if Options.splitpart <= 0:
          Trace.error('--splitpart requires a number bigger than zero')
          self.usage()
      except:
        Trace.error('--splitpart needs a numeric argument, not ' + Options.splitpart)
        self.usage()
    if Options.lowmem or Options.toc or Options.tocfor:
      Options.memory = False
    self.parsefootnotes()
    if Options.forceformat and not Options.imageformat:
      Options.imageformat = Options.forceformat
    if Options.imageformat == 'copy':
      Options.copyimages = True
    if Options.css == []:
      Options.css = ['http://elyxer.nongnu.org/lyx.css']
    if Options.favicon == '':
      pass # no default favicon
    if Options.html:
      Options.simplemath = True
    if Options.toc and not Options.tocfor:
      Trace.error('Option --toc is deprecated; use --tocfor "page" instead')
      Options.tocfor = Options.toctarget
    if Options.nocopy:
      Trace.error('Option --nocopy is deprecated; it is no longer needed')
    if Options.jsmath:
      Trace.error('Option --jsmath is deprecated; use --mathjax instead')
    # set in Trace if necessary
    for param in dir(Trace):
      if param.endswith('mode'):
        setattr(Trace, param, getattr(self, param[:-4]))

  def usage(self):
    "Show correct usage"
    Trace.error('Usage: ' + os.path.basename(Options.location) + ' [options] [filein] [fileout]')
    Trace.error('Convert LyX input file "filein" to HTML file "fileout".')
    Trace.error('If filein (or fileout) is not given use standard input (or output).')
    Trace.error('Main program of the eLyXer package (http://elyxer.nongnu.org/).')
    self.showoptions()

  def parsefootnotes(self):
    "Parse footnotes options."
    if not Options.footnotes:
      return
    Options.marginfoot = False
    Options.letterfoot = False
    Options.hoverfoot = False
    options = Options.footnotes.split(',')
    for option in options:
      footoption = option + 'foot'
      if hasattr(Options, footoption):
        setattr(Options, footoption, True)
      else:
        Trace.error('Unknown footnotes option: ' + option)
    if not Options.endfoot and not Options.marginfoot and not Options.hoverfoot:
      Options.hoverfoot = True
    if not Options.numberfoot and not Options.symbolfoot:
      Options.letterfoot = True

  def showoptions(self):
    "Show all possible options"
    Trace.error('  Common options:')
    Trace.error('    --help:                 show this online help')
    Trace.error('    --quiet:                disables all runtime messages')
    Trace.error('')
    Trace.error('  Advanced options:')
    Trace.error('    --debug:                enable debugging messages (for developers)')
    Trace.error('    --version:              show version number and release date')
    Trace.error('    --lyxformat:            return the highest LyX version supported')
    Trace.error('  Options for HTML output:')
    Trace.error('    --title "title":        set the generated page title')
    Trace.error('    --css "file.css":       use a custom CSS file')
    Trace.error('    --embedcss "file.css":  embed styles from a CSS file into the output')
    Trace.error('    --favicon "icon.ico":   insert the specified favicon in the header.')
    Trace.error('    --html:                 output HTML 4.0 instead of the default XHTML')
    Trace.error('    --unicode:              full Unicode output')
    Trace.error('    --iso885915:            output a document with ISO-8859-15 encoding')
    Trace.error('    --nofooter:             remove the footer "generated by eLyXer"')
    Trace.error('    --simplemath:           do not generate fancy math constructions')
    Trace.error('  Options for image output:')
    Trace.error('    --directory "img_dir":  look for images in the specified directory')
    Trace.error('    --destdirectory "dest": put converted images into this directory')
    Trace.error('    --imageformat ".ext":   image output format, or "copy" to copy images')
    Trace.error('    --noconvert:            do not convert images, use in original locations')
    Trace.error('    --converter "inkscape": use an alternative program to convert images')
    Trace.error('  Options for footnote display:')
    Trace.error('    --numberfoot:           mark footnotes with numbers instead of letters')
    Trace.error('    --symbolfoot:           mark footnotes with symbols (*, **...)')
    Trace.error('    --hoverfoot:            show footnotes as hovering text (default)')
    Trace.error('    --marginfoot:           show footnotes on the page margin')
    Trace.error('    --endfoot:              show footnotes at the end of the page')
    Trace.error('    --supfoot:              use superscript for footnote markers (default)')
    Trace.error('    --alignfoot:            use aligned text for footnote markers')
    Trace.error('    --footnotes "options":  specify several comma-separated footnotes options')
    Trace.error('      Available options are: "number", "symbol", "hover", "margin", "end",')
    Trace.error('        "sup", "align"')
    Trace.error('  Advanced output options:')
    Trace.error('    --splitpart "depth":    split the resulting webpage at the given depth')
    Trace.error('    --tocfor "page":        generate a TOC that points to the given page')
    Trace.error('    --target "frame":       make all links point to the given frame')
    Trace.error('    --notoclabels:          omit the part labels in the TOC, such as Chapter')
    Trace.error('    --lowmem:               do the conversion on the fly (conserve memory)')
    Trace.error('    --raw:                  generate HTML without header or footer.')
    Trace.error('    --mathjax remote:       use MathJax remotely to display equations')
    Trace.error('    --mathjax "URL":        use MathJax from the given URL to display equations')
    Trace.error('    --googlecharts:         use Google Charts to generate formula images')
    Trace.error('    --template "file":      use a template, put everything in <!--$content-->')
    Trace.error('    --copyright:            add a copyright notice at the bottom')
    Trace.error('  Deprecated options:')
    Trace.error('    --toc:                  (deprecated) create a table of contents')
    Trace.error('    --toctarget "page":     (deprecated) generate a TOC for the given page')
    Trace.error('    --nocopy:               (deprecated) maintained for backwards compatibility')
    Trace.error('    --jsmath "URL":         use jsMath from the given URL to display equations')
    sys.exit()

  def showversion(self):
    "Return the current eLyXer version string"
    string = 'eLyXer version ' + GeneralConfig.version['number']
    string += ' (' + GeneralConfig.version['date'] + ')'
    Trace.error(string)
    sys.exit()

  def showhardversion(self):
    "Return just the version string"
    Trace.message(GeneralConfig.version['number'])
    sys.exit()

  def showversiondate(self):
    "Return just the version dte"
    Trace.message(GeneralConfig.version['date'])
    sys.exit()

  def showlyxformat(self):
    "Return just the lyxformat parameter"
    Trace.message(GeneralConfig.version['lyxformat'])
    sys.exit()

class BranchOptions(object):
  "A set of options for a branch"

  def __init__(self, name):
    self.name = name
    self.options = {'color':'#ffffff'}

  def set(self, key, value):
    "Set a branch option"
    if not key.startswith(ContainerConfig.string['startcommand']):
      Trace.error('Invalid branch option ' + key)
      return
    key = key.replace(ContainerConfig.string['startcommand'], '')
    self.options[key] = value

  def isselected(self):
    "Return if the branch is selected"
    if not 'selected' in self.options:
      return False
    return self.options['selected'] == '1'

  def __unicode__(self):
    "String representation"
    return 'options for ' + self.name + ': ' + unicode(self.options)




import urllib








class Cloner(object):
  "An object used to clone other objects."

  def clone(cls, original):
    "Return an exact copy of an object."
    "The original object must have an empty constructor."
    return cls.create(original.__class__)

  def create(cls, type):
    "Create an object of a given class."
    clone = type.__new__(type)
    clone.__init__()
    return clone

  clone = classmethod(clone)
  create = classmethod(create)

class ContainerExtractor(object):
  "A class to extract certain containers."

  def __init__(self, config):
    "The config parameter is a map containing three lists: allowed, copied and extracted."
    "Each of the three is a list of class names for containers."
    "Allowed containers are included as is into the result."
    "Cloned containers are cloned and placed into the result."
    "Extracted containers are looked into."
    "All other containers are silently ignored."
    self.allowed = config['allowed']
    self.cloned = config['cloned']
    self.extracted = config['extracted']

  def extract(self, container):
    "Extract a group of selected containers from elyxer.a container."
    list = []
    locate = lambda c: c.__class__.__name__ in self.allowed + self.cloned
    recursive = lambda c: c.__class__.__name__ in self.extracted
    process = lambda c: self.process(c, list)
    container.recursivesearch(locate, recursive, process)
    return list

  def process(self, container, list):
    "Add allowed containers, clone cloned containers and add the clone."
    name = container.__class__.__name__
    if name in self.allowed:
      list.append(container)
    elif name in self.cloned:
      list.append(self.safeclone(container))
    else:
      Trace.error('Unknown container class ' + name)

  def safeclone(self, container):
    "Return a new container with contents only in a safe list, recursively."
    clone = Cloner.clone(container)
    clone.output = container.output
    clone.contents = self.extract(container)
    return clone






class Parser(object):
  "A generic parser"

  def __init__(self):
    self.begin = 0
    self.parameters = dict()

  def parseheader(self, reader):
    "Parse the header"
    header = reader.currentline().split()
    reader.nextline()
    self.begin = reader.linenumber
    return header

  def parseparameter(self, reader):
    "Parse a parameter"
    if reader.currentline().strip().startswith('<'):
      key, value = self.parsexml(reader)
      self.parameters[key] = value
      return
    split = reader.currentline().strip().split(' ', 1)
    reader.nextline()
    if len(split) == 0:
      return
    key = split[0]
    if len(split) == 1:
      self.parameters[key] = True
      return
    if not '"' in split[1]:
      self.parameters[key] = split[1].strip()
      return
    doublesplit = split[1].split('"')
    self.parameters[key] = doublesplit[1]

  def parsexml(self, reader):
    "Parse a parameter in xml form: <param attr1=value...>"
    strip = reader.currentline().strip()
    reader.nextline()
    if not strip.endswith('>'):
      Trace.error('XML parameter ' + strip + ' should be <...>')
    split = strip[1:-1].split()
    if len(split) == 0:
      Trace.error('Empty XML parameter <>')
      return None, None
    key = split[0]
    del split[0]
    if len(split) == 0:
      return key, dict()
    attrs = dict()
    for attr in split:
      if not '=' in attr:
        Trace.error('Erroneous attribute for ' + key + ': ' + attr)
        attr += '="0"'
      parts = attr.split('=')
      attrkey = parts[0]
      value = parts[1].split('"')[1]
      attrs[attrkey] = value
    return key, attrs

  def parseending(self, reader, process):
    "Parse until the current ending is found"
    if not self.ending:
      Trace.error('No ending for ' + unicode(self))
      return
    while not reader.currentline().startswith(self.ending):
      process()

  def parsecontainer(self, reader, contents):
    container = self.factory.createcontainer(reader)
    if container:
      container.parent = self.parent
      contents.append(container)

  def __unicode__(self):
    "Return a description"
    return self.__class__.__name__ + ' (' + unicode(self.begin) + ')'

class LoneCommand(Parser):
  "A parser for just one command line"

  def parse(self,reader):
    "Read nothing"
    return []

class TextParser(Parser):
  "A parser for a command and a bit of text"

  stack = []

  def __init__(self, container):
    Parser.__init__(self)
    self.ending = None
    if container.__class__.__name__ in ContainerConfig.endings:
      self.ending = ContainerConfig.endings[container.__class__.__name__]
    self.endings = []

  def parse(self, reader):
    "Parse lines as long as they are text"
    TextParser.stack.append(self.ending)
    self.endings = TextParser.stack + [ContainerConfig.endings['Layout'],
        ContainerConfig.endings['Inset'], self.ending]
    contents = []
    while not self.isending(reader):
      self.parsecontainer(reader, contents)
    return contents

  def isending(self, reader):
    "Check if text is ending"
    current = reader.currentline().split()
    if len(current) == 0:
      return False
    if current[0] in self.endings:
      if current[0] in TextParser.stack:
        TextParser.stack.remove(current[0])
      else:
        TextParser.stack = []
      return True
    return False

class ExcludingParser(Parser):
  "A parser that excludes the final line"

  def parse(self, reader):
    "Parse everything up to (and excluding) the final line"
    contents = []
    self.parseending(reader, lambda: self.parsecontainer(reader, contents))
    return contents

class BoundedParser(ExcludingParser):
  "A parser bound by a final line"

  def parse(self, reader):
    "Parse everything, including the final line"
    contents = ExcludingParser.parse(self, reader)
    # skip last line
    reader.nextline()
    return contents

class BoundedDummy(Parser):
  "A bound parser that ignores everything"

  def parse(self, reader):
    "Parse the contents of the container"
    self.parseending(reader, lambda: reader.nextline())
    # skip last line
    reader.nextline()
    return []

class StringParser(Parser):
  "Parses just a string"

  def parseheader(self, reader):
    "Do nothing, just take note"
    self.begin = reader.linenumber + 1
    return []

  def parse(self, reader):
    "Parse a single line"
    contents = reader.currentline()
    reader.nextline()
    return contents

class InsetParser(BoundedParser):
  "Parses a LyX inset"

  def parse(self, reader):
    "Parse inset parameters into a dictionary"
    startcommand = ContainerConfig.string['startcommand']
    while reader.currentline() != '' and not reader.currentline().startswith(startcommand):
      self.parseparameter(reader)
    return BoundedParser.parse(self, reader)






class ContainerOutput(object):
  "The generic HTML output for a container."

  def gethtml(self, container):
    "Show an error."
    Trace.error('gethtml() not implemented for ' + unicode(self))

  def isempty(self):
    "Decide if the output is empty: by default, not empty."
    return False

class EmptyOutput(ContainerOutput):

  def gethtml(self, container):
    "Return empty HTML code."
    return []

  def isempty(self):
    "This output is particularly empty."
    return True

class FixedOutput(ContainerOutput):
  "Fixed output"

  def gethtml(self, container):
    "Return constant HTML code"
    return container.html

class ContentsOutput(ContainerOutput):
  "Outputs the contents converted to HTML"

  def gethtml(self, container):
    "Return the HTML code"
    html = []
    if container.contents == None:
      return html
    for element in container.contents:
      if not hasattr(element, 'gethtml'):
        Trace.error('No html in ' + element.__class__.__name__ + ': ' + unicode(element))
        return html
      html += element.gethtml()
    return html

class TaggedOutput(ContentsOutput):
  "Outputs an HTML tag surrounding the contents."

  tag = None
  breaklines = False
  empty = False

  def settag(self, tag, breaklines=False, empty=False):
    "Set the value for the tag and other attributes."
    self.tag = tag
    if breaklines:
      self.breaklines = breaklines
    if empty:
      self.empty = empty
    return self

  def setbreaklines(self, breaklines):
    "Set the value for breaklines."
    self.breaklines = breaklines
    return self

  def gethtml(self, container):
    "Return the HTML code."
    if self.empty:
      return [self.selfclosing(container)]
    html = [self.open(container)]
    html += ContentsOutput.gethtml(self, container)
    html.append(self.close(container))
    return html

  def open(self, container):
    "Get opening line."
    if not self.checktag():
      return ''
    open = '<' + self.tag + '>'
    if self.breaklines:
      return open + '\n'
    return open

  def close(self, container):
    "Get closing line."
    if not self.checktag():
      return ''
    close = '</' + self.tag.split()[0] + '>'
    if self.breaklines:
      return '\n' + close + '\n'
    return close

  def selfclosing(self, container):
    "Get self-closing line."
    if not self.checktag():
      return ''
    selfclosing = '<' + self.tag + '/>'
    if self.breaklines:
      return selfclosing + '\n'
    return selfclosing

  def checktag(self):
    "Check that the tag is valid."
    if not self.tag:
      Trace.error('No tag in ' + unicode(container))
      return False
    if self.tag == '':
      return False
    return True

class FilteredOutput(ContentsOutput):
  "Returns the output in the contents, but filtered:"
  "some strings are replaced by others."

  def __init__(self):
    "Initialize the filters."
    self.filters = []

  def addfilter(self, original, replacement):
    "Add a new filter: replace the original by the replacement."
    self.filters.append((original, replacement))

  def gethtml(self, container):
    "Return the HTML code"
    result = []
    html = ContentsOutput.gethtml(self, container)
    for line in html:
      result.append(self.filter(line))
    return result

  def filter(self, line):
    "Filter a single line with all available filters."
    for original, replacement in self.filters:
      if original in line:
        line = line.replace(original, replacement)
    return line

class StringOutput(ContainerOutput):
  "Returns a bare string as output"

  def gethtml(self, container):
    "Return a bare string"
    return [container.string]







import sys
import codecs


class LineReader(object):
  "Reads a file line by line"

  def __init__(self, filename):
    if isinstance(filename, file):
      self.file = filename
    else:
      self.file = codecs.open(filename, 'rU', 'utf-8')
    self.linenumber = 1
    self.lastline = None
    self.current = None
    self.mustread = True
    self.depleted = False
    try:
      self.readline()
    except UnicodeDecodeError:
      # try compressed file
      import gzip
      self.file = gzip.open(filename, 'rb')
      self.readline()

  def setstart(self, firstline):
    "Set the first line to read."
    for i in range(firstline):
      self.file.readline()
    self.linenumber = firstline

  def setend(self, lastline):
    "Set the last line to read."
    self.lastline = lastline

  def currentline(self):
    "Get the current line"
    if self.mustread:
      self.readline()
    return self.current

  def nextline(self):
    "Go to next line"
    if self.depleted:
      Trace.fatal('Read beyond file end')
    self.mustread = True

  def readline(self):
    "Read a line from elyxer.file"
    self.current = self.file.readline()
    if not isinstance(self.file, codecs.StreamReaderWriter):
      self.current = self.current.decode('utf-8')
    if len(self.current) == 0:
      self.depleted = True
    self.current = self.current.rstrip('\n\r')
    self.linenumber += 1
    self.mustread = False
    Trace.prefix = 'Line ' + unicode(self.linenumber) + ': '
    if self.linenumber % 1000 == 0:
      Trace.message('Parsing')

  def finished(self):
    "Find out if the file is finished"
    if self.lastline and self.linenumber == self.lastline:
      return True
    if self.mustread:
      self.readline()
    return self.depleted

  def close(self):
    self.file.close()

class LineWriter(object):
  "Writes a file as a series of lists"

  file = False

  def __init__(self, filename):
    if isinstance(filename, file):
      self.file = filename
      self.filename = None
    else:
      self.filename = filename

  def write(self, strings):
    "Write a list of strings"
    for string in strings:
      if not isinstance(string, basestring):
        Trace.error('Not a string: ' + unicode(string) + ' in ' + unicode(strings))
        return
      self.writestring(string)

  def writestring(self, string):
    "Write a string"
    if not self.file:
      self.file = codecs.open(self.filename, 'w', "utf-8")
    if self.file == sys.stdout and sys.version_info < (3,0):
      string = string.encode('utf-8')
    self.file.write(string)

  def writeline(self, line):
    "Write a line to file"
    self.writestring(line + '\n')

  def close(self):
    self.file.close()






class Globable(object):
  """A bit of text which can be globbed (lumped together in bits).
  Methods current(), skipcurrent(), checkfor() and isout() have to be
  implemented by subclasses."""

  leavepending = False

  def __init__(self):
    self.endinglist = EndingList()

  def checkbytemark(self):
    "Check for a Unicode byte mark and skip it."
    if self.finished():
      return
    if ord(self.current()) == 0xfeff:
      self.skipcurrent()

  def isout(self):
    "Find out if we are out of the position yet."
    Trace.error('Unimplemented isout()')
    return True

  def current(self):
    "Return the current character."
    Trace.error('Unimplemented current()')
    return ''

  def checkfor(self, string):
    "Check for the given string in the current position."
    Trace.error('Unimplemented checkfor()')
    return False

  def finished(self):
    "Find out if the current text has finished."
    if self.isout():
      if not self.leavepending:
        self.endinglist.checkpending()
      return True
    return self.endinglist.checkin(self)

  def skipcurrent(self):
    "Return the current character and skip it."
    Trace.error('Unimplemented skipcurrent()')
    return ''

  def glob(self, currentcheck):
    "Glob a bit of text that satisfies a check on the current char."
    glob = ''
    while not self.finished() and currentcheck():
      glob += self.skipcurrent()
    return glob

  def globalpha(self):
    "Glob a bit of alpha text"
    return self.glob(lambda: self.current().isalpha())

  def globnumber(self):
    "Glob a row of digits."
    return self.glob(lambda: self.current().isdigit())

  def isidentifier(self):
    "Return if the current character is alphanumeric or _."
    if self.current().isalnum() or self.current() == '_':
      return True
    return False

  def globidentifier(self):
    "Glob alphanumeric and _ symbols."
    return self.glob(self.isidentifier)

  def isvalue(self):
    "Return if the current character is a value character:"
    "not a bracket or a space."
    if self.current().isspace():
      return False
    if self.current() in '{}()':
      return False
    return True

  def globvalue(self):
    "Glob a value: any symbols but brackets."
    return self.glob(self.isvalue)

  def skipspace(self):
    "Skip all whitespace at current position."
    return self.glob(lambda: self.current().isspace())

  def globincluding(self, magicchar):
    "Glob a bit of text up to (including) the magic char."
    glob = self.glob(lambda: self.current() != magicchar) + magicchar
    self.skip(magicchar)
    return glob

  def globexcluding(self, excluded):
    "Glob a bit of text up until (excluding) any excluded character."
    return self.glob(lambda: self.current() not in excluded)

  def pushending(self, ending, optional = False):
    "Push a new ending to the bottom"
    self.endinglist.add(ending, optional)

  def popending(self, expected = None):
    "Pop the ending found at the current position"
    if self.isout() and self.leavepending:
      return expected
    ending = self.endinglist.pop(self)
    if expected and expected != ending:
      Trace.error('Expected ending ' + expected + ', got ' + ending)
    self.skip(ending)
    return ending

  def nextending(self):
    "Return the next ending in the queue."
    nextending = self.endinglist.findending(self)
    if not nextending:
      return None
    return nextending.ending

class EndingList(object):
  "A list of position endings"

  def __init__(self):
    self.endings = []

  def add(self, ending, optional = False):
    "Add a new ending to the list"
    self.endings.append(PositionEnding(ending, optional))

  def pickpending(self, pos):
    "Pick any pending endings from a parse position."
    self.endings += pos.endinglist.endings

  def checkin(self, pos):
    "Search for an ending"
    if self.findending(pos):
      return True
    return False

  def pop(self, pos):
    "Remove the ending at the current position"
    if pos.isout():
      Trace.error('No ending out of bounds')
      return ''
    ending = self.findending(pos)
    if not ending:
      Trace.error('No ending at ' + pos.current())
      return ''
    for each in reversed(self.endings):
      self.endings.remove(each)
      if each == ending:
        return each.ending
      elif not each.optional:
        Trace.error('Removed non-optional ending ' + each)
    Trace.error('No endings left')
    return ''

  def findending(self, pos):
    "Find the ending at the current position"
    if len(self.endings) == 0:
      return None
    for index, ending in enumerate(reversed(self.endings)):
      if ending.checkin(pos):
        return ending
      if not ending.optional:
        return None
    return None

  def checkpending(self):
    "Check if there are any pending endings"
    if len(self.endings) != 0:
      Trace.error('Pending ' + unicode(self) + ' left open')

  def __unicode__(self):
    "Printable representation"
    string = 'endings ['
    for ending in self.endings:
      string += unicode(ending) + ','
    if len(self.endings) > 0:
      string = string[:-1]
    return string + ']'

class PositionEnding(object):
  "An ending for a parsing position"

  def __init__(self, ending, optional):
    self.ending = ending
    self.optional = optional

  def checkin(self, pos):
    "Check for the ending"
    return pos.checkfor(self.ending)

  def __unicode__(self):
    "Printable representation"
    string = 'Ending ' + self.ending
    if self.optional:
      string += ' (optional)'
    return string



class Position(Globable):
  """A position in a text to parse.
  Including those in Globable, functions to implement by subclasses are:
  skip(), identifier(), extract(), isout() and current()."""

  def __init__(self):
    Globable.__init__(self)

  def skip(self, string):
    "Skip a string"
    Trace.error('Unimplemented skip()')

  def identifier(self):
    "Return an identifier for the current position."
    Trace.error('Unimplemented identifier()')
    return 'Error'

  def extract(self, length):
    "Extract the next string of the given length, or None if not enough text,"
    "without advancing the parse position."
    Trace.error('Unimplemented extract()')
    return None

  def checkfor(self, string):
    "Check for a string at the given position."
    return string == self.extract(len(string))

  def checkforlower(self, string):
    "Check for a string in lower case."
    extracted = self.extract(len(string))
    if not extracted:
      return False
    return string.lower() == self.extract(len(string)).lower()

  def skipcurrent(self):
    "Return the current character and skip it."
    current = self.current()
    self.skip(current)
    return current

  def next(self):
    "Advance the position and return the next character."
    self.skipcurrent()
    return self.current()

  def checkskip(self, string):
    "Check for a string at the given position; if there, skip it"
    if not self.checkfor(string):
      return False
    self.skip(string)
    return True

  def error(self, message):
    "Show an error message and the position identifier."
    Trace.error(message + ': ' + self.identifier())

class TextPosition(Position):
  "A parse position based on a raw text."

  def __init__(self, text):
    "Create the position from elyxer.some text."
    Position.__init__(self)
    self.pos = 0
    self.text = text
    self.checkbytemark()

  def skip(self, string):
    "Skip a string of characters."
    self.pos += len(string)

  def identifier(self):
    "Return a sample of the remaining text."
    length = 30
    if self.pos + length > len(self.text):
      length = len(self.text) - self.pos
    return '*' + self.text[self.pos:self.pos + length] + '*'

  def isout(self):
    "Find out if we are out of the text yet."
    return self.pos >= len(self.text)

  def current(self):
    "Return the current character, assuming we are not out."
    return self.text[self.pos]

  def extract(self, length):
    "Extract the next string of the given length, or None if not enough text."
    if self.pos + length > len(self.text):
      return None
    return self.text[self.pos : self.pos + length]

class FilePosition(Position):
  "A parse position based on an underlying file."

  def __init__(self, filename):
    "Create the position from a file."
    Position.__init__(self)
    self.reader = LineReader(filename)
    self.pos = 0
    self.checkbytemark()

  def skip(self, string):
    "Skip a string of characters."
    length = len(string)
    while self.pos + length > len(self.reader.currentline()):
      length -= len(self.reader.currentline()) - self.pos + 1
      self.nextline()
    self.pos += length

  def currentline(self):
    "Get the current line of the underlying file."
    return self.reader.currentline()

  def nextline(self):
    "Go to the next line."
    self.reader.nextline()
    self.pos = 0

  def linenumber(self):
    "Return the line number of the file."
    return self.reader.linenumber + 1

  def identifier(self):
    "Return the current line and line number in the file."
    before = self.reader.currentline()[:self.pos - 1]
    after = self.reader.currentline()[self.pos:]
    return 'line ' + unicode(self.getlinenumber()) + ': ' + before + '*' + after

  def isout(self):
    "Find out if we are out of the text yet."
    if self.pos > len(self.reader.currentline()):
      if self.pos > len(self.reader.currentline()) + 1:
        Trace.error('Out of the line ' + self.reader.currentline() + ': ' + unicode(self.pos))
      self.nextline()
    return self.reader.finished()

  def current(self):
    "Return the current character, assuming we are not out."
    if self.pos == len(self.reader.currentline()):
      return '\n'
    if self.pos > len(self.reader.currentline()):
      Trace.error('Out of the line ' + self.reader.currentline() + ': ' + unicode(self.pos))
      return '*'
    return self.reader.currentline()[self.pos]

  def extract(self, length):
    "Extract the next string of the given length, or None if not enough text."
    if self.pos + length > len(self.reader.currentline()):
      return None
    return self.reader.currentline()[self.pos : self.pos + length]



class Container(object):
  "A container for text and objects in a lyx file"

  partkey = None
  parent = None
  begin = None

  def __init__(self):
    self.contents = list()

  def process(self):
    "Process contents"
    pass

  def gethtml(self):
    "Get the resulting HTML"
    html = self.output.gethtml(self)
    if isinstance(html, basestring):
      Trace.error('Raw string ' + html)
      html = [html]
    return self.escapeall(html)

  def escapeall(self, lines):
    "Escape all lines in an array according to the output options."
    result = []
    for line in lines:
      if Options.html:
        line = self.escape(line, EscapeConfig.html)
      if Options.iso885915:
        line = self.escape(line, EscapeConfig.iso885915)
        line = self.escapeentities(line)
      elif not Options.unicode:
        line = self.escape(line, EscapeConfig.nonunicode)
      result.append(line)
    return result

  def escape(self, line, replacements = EscapeConfig.entities):
    "Escape a line with replacements from elyxer.a map"
    pieces = replacements.keys()
    # do them in order
    pieces.sort()
    for piece in pieces:
      if piece in line:
        line = line.replace(piece, replacements[piece])
    return line

  def escapeentities(self, line):
    "Escape all Unicode characters to HTML entities."
    result = ''
    pos = TextPosition(line)
    while not pos.finished():
      if ord(pos.current()) > 128:
        codepoint = hex(ord(pos.current()))
        if codepoint == '0xd835':
          codepoint = hex(ord(pos.next()) + 0xf800)
        result += '&#' + codepoint[1:] + ';'
      else:
        result += pos.current()
      pos.skipcurrent()
    return result

  def searchall(self, type):
    "Search for all embedded containers of a given type"
    list = []
    self.searchprocess(type, lambda container: list.append(container))
    return list

  def searchremove(self, type):
    "Search for all containers of a type and remove them"
    list = self.searchall(type)
    for container in list:
      container.parent.contents.remove(container)
    return list

  def searchprocess(self, type, process):
    "Search for elements of a given type and process them"
    self.locateprocess(lambda container: isinstance(container, type), process)

  def locateprocess(self, locate, process):
    "Search for all embedded containers and process them"
    for container in self.contents:
      container.locateprocess(locate, process)
      if locate(container):
        process(container)

  def recursivesearch(self, locate, recursive, process):
    "Perform a recursive search in the container."
    for container in self.contents:
      if recursive(container):
        container.recursivesearch(locate, recursive, process)
      if locate(container):
        process(container)

  def extracttext(self):
    "Extract all text from elyxer.allowed containers."
    result = ''
    constants = ContainerExtractor(ContainerConfig.extracttext).extract(self)
    for constant in constants:
      result += constant.string
    return result

  def group(self, index, group, isingroup):
    "Group some adjoining elements into a group"
    if index >= len(self.contents):
      return
    if hasattr(self.contents[index], 'grouped'):
      return
    while index < len(self.contents) and isingroup(self.contents[index]):
      self.contents[index].grouped = True
      group.contents.append(self.contents[index])
      self.contents.pop(index)
    self.contents.insert(index, group)

  def remove(self, index):
    "Remove a container but leave its contents"
    container = self.contents[index]
    self.contents.pop(index)
    while len(container.contents) > 0:
      self.contents.insert(index, container.contents.pop())

  def tree(self, level = 0):
    "Show in a tree"
    Trace.debug("  " * level + unicode(self))
    for container in self.contents:
      container.tree(level + 1)

  def getparameter(self, name):
    "Get the value of a parameter, if present."
    if not name in self.parameters:
      return None
    return self.parameters[name]

  def getparameterlist(self, name):
    "Get the value of a comma-separated parameter as a list."
    paramtext = self.getparameter(name)
    if not paramtext:
      return []
    return paramtext.split(',')

  def hasemptyoutput(self):
    "Check if the parent's output is empty."
    current = self.parent
    while current:
      if current.output.isempty():
        return True
      current = current.parent
    return False

  def __unicode__(self):
    "Get a description"
    if not self.begin:
      return self.__class__.__name__
    return self.__class__.__name__ + '@' + unicode(self.begin)

class BlackBox(Container):
  "A container that does not output anything"

  def __init__(self):
    self.parser = LoneCommand()
    self.output = EmptyOutput()
    self.contents = []

class LyXFormat(BlackBox):
  "Read the lyxformat command"

  def process(self):
    "Show warning if version < 276"
    version = int(self.header[1])
    if version < 276:
      Trace.error('Warning: unsupported old format version ' + str(version))
    if version > int(GeneralConfig.version['lyxformat']):
      Trace.error('Warning: unsupported new format version ' + str(version))

class StringContainer(Container):
  "A container for a single string"

  parsed = None

  def __init__(self):
    self.parser = StringParser()
    self.output = StringOutput()
    self.string = ''

  def process(self):
    "Replace special chars from elyxer.the contents."
    if self.parsed:
      self.string = self.replacespecial(self.parsed)
      self.parsed = None

  def replacespecial(self, line):
    "Replace all special chars from elyxer.a line"
    replaced = self.escape(line, EscapeConfig.entities)
    replaced = self.changeline(replaced)
    if ContainerConfig.string['startcommand'] in replaced and len(replaced) > 1:
      # unprocessed commands
      if self.begin:
        message = 'Unknown command at ' + unicode(self.begin) + ': '
      else:
        message = 'Unknown command: '
      Trace.error(message + replaced.strip())
    return replaced

  def changeline(self, line):
    line = self.escape(line, EscapeConfig.chars)
    if not ContainerConfig.string['startcommand'] in line:
      return line
    line = self.escape(line, EscapeConfig.commands)
    return line

  def extracttext(self):
    "Return all text."
    return self.string
  
  def __unicode__(self):
    "Return a printable representation."
    result = 'StringContainer'
    if self.begin:
      result += '@' + unicode(self.begin)
    ellipsis = '...'
    if len(self.string.strip()) <= 15:
      ellipsis = ''
    return result + ' (' + self.string.strip()[:15] + ellipsis + ')'

class Constant(StringContainer):
  "A constant string"

  def __init__(self, text):
    self.contents = []
    self.string = text
    self.output = StringOutput()

  def __unicode__(self):
    return 'Constant: ' + self.string

class TaggedText(Container):
  "Text inside a tag"

  output = None

  def __init__(self):
    self.parser = TextParser(self)
    self.output = TaggedOutput()

  def complete(self, contents, tag, breaklines=False):
    "Complete the tagged text and return it"
    self.contents = contents
    self.output.tag = tag
    self.output.breaklines = breaklines
    return self

  def constant(self, text, tag, breaklines=False):
    "Complete the tagged text with a constant"
    constant = Constant(text)
    return self.complete([constant], tag, breaklines)

  def __unicode__(self):
    "Return a printable representation."
    if not hasattr(self.output, 'tag'):
      return 'Emtpy tagged text'
    if not self.output.tag:
      return 'Tagged <unknown tag>'
    return 'Tagged <' + self.output.tag + '>'






class DocumentParameters(object):
  "Global parameters for the document."

  pdftitle = None
  indentstandard = False
  tocdepth = 10
  startinglevel = 0
  maxdepth = 10
  language = None
  bibliography = None
  outputchanges = False
  displaymode = False






class FormulaParser(Parser):
  "Parses a formula"

  def parseheader(self, reader):
    "See if the formula is inlined"
    self.begin = reader.linenumber + 1
    type = self.parsetype(reader)
    if not type:
      reader.nextline()
      type = self.parsetype(reader)
      if not type:
        Trace.error('Unknown formula type in ' + reader.currentline().strip())
        return ['unknown']
    return [type]

  def parsetype(self, reader):
    "Get the formula type from the first line."
    if reader.currentline().find(FormulaConfig.starts['simple']) >= 0:
      return 'inline'
    if reader.currentline().find(FormulaConfig.starts['complex']) >= 0:
      return 'block'
    if reader.currentline().find(FormulaConfig.starts['unnumbered']) >= 0:
      return 'block'
    if reader.currentline().find(FormulaConfig.starts['beginbefore']) >= 0:
      return 'numbered'
    return None
  
  def parse(self, reader):
    "Parse the formula until the end"
    formula = self.parseformula(reader)
    while not reader.currentline().startswith(self.ending):
      stripped = reader.currentline().strip()
      if len(stripped) > 0:
        Trace.error('Unparsed formula line ' + stripped)
      reader.nextline()
    reader.nextline()
    return formula

  def parseformula(self, reader):
    "Parse the formula contents"
    simple = FormulaConfig.starts['simple']
    if simple in reader.currentline():
      rest = reader.currentline().split(simple, 1)[1]
      if simple in rest:
        # formula is $...$
        return self.parsesingleliner(reader, simple, simple)
      # formula is multiline $...$
      return self.parsemultiliner(reader, simple, simple)
    if FormulaConfig.starts['complex'] in reader.currentline():
      # formula of the form \[...\]
      return self.parsemultiliner(reader, FormulaConfig.starts['complex'],
          FormulaConfig.endings['complex'])
    beginbefore = FormulaConfig.starts['beginbefore']
    beginafter = FormulaConfig.starts['beginafter']
    if beginbefore in reader.currentline():
      if reader.currentline().strip().endswith(beginafter):
        current = reader.currentline().strip()
        endsplit = current.split(beginbefore)[1].split(beginafter)
        startpiece = beginbefore + endsplit[0] + beginafter
        endbefore = FormulaConfig.endings['endbefore']
        endafter = FormulaConfig.endings['endafter']
        endpiece = endbefore + endsplit[0] + endafter
        return startpiece + self.parsemultiliner(reader, startpiece, endpiece) + endpiece
      Trace.error('Missing ' + beginafter + ' in ' + reader.currentline())
      return ''
    begincommand = FormulaConfig.starts['command']
    beginbracket = FormulaConfig.starts['bracket']
    if begincommand in reader.currentline() and beginbracket in reader.currentline():
      endbracket = FormulaConfig.endings['bracket']
      return self.parsemultiliner(reader, beginbracket, endbracket)
    Trace.error('Formula beginning ' + reader.currentline() + ' is unknown')
    return ''

  def parsesingleliner(self, reader, start, ending):
    "Parse a formula in one line"
    line = reader.currentline().strip()
    if not start in line:
      Trace.error('Line ' + line + ' does not contain formula start ' + start)
      return ''
    if not line.endswith(ending):
      Trace.error('Formula ' + line + ' does not end with ' + ending)
      return ''
    index = line.index(start)
    rest = line[index + len(start):-len(ending)]
    reader.nextline()
    return rest

  def parsemultiliner(self, reader, start, ending):
    "Parse a formula in multiple lines"
    formula = ''
    line = reader.currentline()
    if not start in line:
      Trace.error('Line ' + line.strip() + ' does not contain formula start ' + start)
      return ''
    index = line.index(start)
    line = line[index + len(start):].strip()
    while not line.endswith(ending):
      formula += line + '\n'
      reader.nextline()
      line = reader.currentline()
    formula += line[:-len(ending)]
    reader.nextline()
    return formula

class MacroParser(FormulaParser):
  "A parser for a formula macro."

  def parseheader(self, reader):
    "See if the formula is inlined"
    self.begin = reader.linenumber + 1
    return ['inline']
  
  def parse(self, reader):
    "Parse the formula until the end"
    formula = self.parsemultiliner(reader, self.parent.start, self.ending)
    reader.nextline()
    return formula
  








class FormulaBit(Container):
  "A bit of a formula"

  type = None
  size = 1
  original = ''

  def __init__(self):
    "The formula bit type can be 'alpha', 'number', 'font'."
    self.contents = []
    self.output = ContentsOutput()

  def setfactory(self, factory):
    "Set the internal formula factory."
    self.factory = factory
    return self

  def add(self, bit):
    "Add any kind of formula bit already processed"
    self.contents.append(bit)
    self.original += bit.original
    bit.parent = self

  def skiporiginal(self, string, pos):
    "Skip a string and add it to the original formula"
    self.original += string
    if not pos.checkskip(string):
      Trace.error('String ' + string + ' not at ' + pos.identifier())

  def computesize(self):
    "Compute the size of the bit as the max of the sizes of all contents."
    if len(self.contents) == 0:
      return 1
    self.size = max([element.size for element in self.contents])
    return self.size

  def clone(self):
    "Return a copy of itself."
    return self.factory.parseformula(self.original)

  def __unicode__(self):
    "Get a string representation"
    return self.__class__.__name__ + ' read in ' + self.original

class TaggedBit(FormulaBit):
  "A tagged string in a formula"

  def constant(self, constant, tag):
    "Set the constant and the tag"
    self.output = TaggedOutput().settag(tag)
    self.add(FormulaConstant(constant))
    return self

  def complete(self, contents, tag, breaklines = False):
    "Set the constant and the tag"
    self.contents = contents
    self.output = TaggedOutput().settag(tag, breaklines)
    return self

  def selfcomplete(self, tag):
    "Set the self-closing tag, no contents (as in <hr/>)."
    self.output = TaggedOutput().settag(tag, empty = True)
    return self

class FormulaConstant(Constant):
  "A constant string in a formula"

  def __init__(self, string):
    "Set the constant string"
    Constant.__init__(self, string)
    self.original = string
    self.size = 1
    self.type = None

  def computesize(self):
    "Compute the size of the constant: always 1."
    return self.size

  def clone(self):
    "Return a copy of itself."
    return FormulaConstant(self.original)

  def __unicode__(self):
    "Return a printable representation."
    return 'Formula constant: ' + self.string

class RawText(FormulaBit):
  "A bit of text inside a formula"

  def detect(self, pos):
    "Detect a bit of raw text"
    return pos.current().isalpha()

  def parsebit(self, pos):
    "Parse alphabetic text"
    alpha = pos.globalpha()
    self.add(FormulaConstant(alpha))
    self.type = 'alpha'

class FormulaSymbol(FormulaBit):
  "A symbol inside a formula"

  modified = FormulaConfig.modified
  unmodified = FormulaConfig.unmodified['characters']

  def detect(self, pos):
    "Detect a symbol"
    if pos.current() in FormulaSymbol.unmodified:
      return True
    if pos.current() in FormulaSymbol.modified:
      return True
    return False

  def parsebit(self, pos):
    "Parse the symbol"
    if pos.current() in FormulaSymbol.unmodified:
      self.addsymbol(pos.current(), pos)
      return
    if pos.current() in FormulaSymbol.modified:
      self.addsymbol(FormulaSymbol.modified[pos.current()], pos)
      return
    Trace.error('Symbol ' + pos.current() + ' not found')

  def addsymbol(self, symbol, pos):
    "Add a symbol"
    self.skiporiginal(pos.current(), pos)
    self.contents.append(FormulaConstant(symbol))

class FormulaNumber(FormulaBit):
  "A string of digits in a formula"

  def detect(self, pos):
    "Detect a digit"
    return pos.current().isdigit()

  def parsebit(self, pos):
    "Parse a bunch of digits"
    digits = pos.glob(lambda: pos.current().isdigit())
    self.add(FormulaConstant(digits))
    self.type = 'number'

class Comment(FormulaBit):
  "A LaTeX comment: % to the end of the line."

  start = FormulaConfig.starts['comment']

  def detect(self, pos):
    "Detect the %."
    return pos.current() == self.start

  def parsebit(self, pos):
    "Parse to the end of the line."
    self.original += pos.globincluding('\n')

class WhiteSpace(FormulaBit):
  "Some white space inside a formula."

  def detect(self, pos):
    "Detect the white space."
    return pos.current().isspace()

  def parsebit(self, pos):
    "Parse all whitespace."
    self.original += pos.skipspace()

  def __unicode__(self):
    "Return a printable representation."
    return 'Whitespace: *' + self.original + '*'

class Bracket(FormulaBit):
  "A {} bracket inside a formula"

  start = FormulaConfig.starts['bracket']
  ending = FormulaConfig.endings['bracket']

  def __init__(self):
    "Create a (possibly literal) new bracket"
    FormulaBit.__init__(self)
    self.inner = None

  def detect(self, pos):
    "Detect the start of a bracket"
    return pos.checkfor(self.start)

  def parsebit(self, pos):
    "Parse the bracket"
    self.parsecomplete(pos, self.innerformula)
    return self

  def parsetext(self, pos):
    "Parse a text bracket"
    self.parsecomplete(pos, self.innertext)
    return self

  def parseliteral(self, pos):
    "Parse a literal bracket"
    self.parsecomplete(pos, self.innerliteral)
    return self

  def parsecomplete(self, pos, innerparser):
    "Parse the start and end marks"
    if not pos.checkfor(self.start):
      Trace.error('Bracket should start with ' + self.start + ' at ' + pos.identifier())
      return None
    self.skiporiginal(self.start, pos)
    pos.pushending(self.ending)
    innerparser(pos)
    self.original += pos.popending(self.ending)
    self.computesize()

  def innerformula(self, pos):
    "Parse a whole formula inside the bracket"
    while not pos.finished():
      self.add(self.factory.parseany(pos))

  def innertext(self, pos):
    "Parse some text inside the bracket, following textual rules."
    specialchars = FormulaConfig.symbolfunctions.keys()
    specialchars.append(FormulaConfig.starts['command'])
    specialchars.append(FormulaConfig.starts['bracket'])
    specialchars.append(Comment.start)
    while not pos.finished():
      if pos.current() in specialchars:
        self.add(self.factory.parseany(pos))
        if pos.checkskip(' '):
          self.original += ' '
      else:
        self.add(FormulaConstant(pos.skipcurrent()))

  def innerliteral(self, pos):
    "Parse a literal inside the bracket, which does not generate HTML."
    self.literal = ''
    while not pos.finished() and not pos.current() == self.ending:
      if pos.current() == self.start:
        self.parseliteral(pos)
      else:
        self.literal += pos.skipcurrent()
    self.original += self.literal

class SquareBracket(Bracket):
  "A [] bracket inside a formula"

  start = FormulaConfig.starts['squarebracket']
  ending = FormulaConfig.endings['squarebracket']

  def clone(self):
    "Return a new square bracket with the same contents."
    bracket = SquareBracket()
    bracket.contents = self.contents
    return bracket



class MathsProcessor(object):
  "A processor for a maths construction inside the FormulaProcessor."

  def process(self, contents, index):
    "Process an element inside a formula."
    Trace.error('Unimplemented process() in ' + unicode(self))

  def __unicode__(self):
    "Return a printable description."
    return 'Maths processor ' + self.__class__.__name__

class FormulaProcessor(object):
  "A processor specifically for formulas."

  processors = []

  def process(self, bit):
    "Process the contents of every formula bit, recursively."
    self.processcontents(bit)
    self.processinsides(bit)
    self.traversewhole(bit)

  def processcontents(self, bit):
    "Process the contents of a formula bit."
    if not isinstance(bit, FormulaBit):
      return
    bit.process()
    for element in bit.contents:
      self.processcontents(element)

  def processinsides(self, bit):
    "Process the insides (limits, brackets) in a formula bit."
    if not isinstance(bit, FormulaBit):
      return
    for index, element in enumerate(bit.contents):
      for processor in self.processors:
        processor.process(bit.contents, index)
      # continue with recursive processing
      self.processinsides(element)

  def traversewhole(self, formula):
    "Traverse over the contents to alter variables and space units."
    last = None
    for bit, contents in self.traverse(formula):
      if bit.type == 'alpha':
        self.italicize(bit, contents)
      elif bit.type == 'font' and last and last.type == 'number':
        bit.contents.insert(0, FormulaConstant(u'âŸ'))
      last = bit

  def traverse(self, bit):
    "Traverse a formula and yield a flattened structure of (bit, list) pairs."
    for element in bit.contents:
      if hasattr(element, 'type') and element.type:
        yield (element, bit.contents)
      elif isinstance(element, FormulaBit):
        for pair in self.traverse(element):
          yield pair

  def italicize(self, bit, contents):
    "Italicize the given bit of text."
    index = contents.index(bit)
    contents[index] = TaggedBit().complete([bit], 'i')




class Formula(Container):
  "A LaTeX formula"

  def __init__(self):
    self.parser = FormulaParser()
    self.output = TaggedOutput().settag('span class="formula"')

  def process(self):
    "Convert the formula to tags"
    if self.header[0] == 'inline':
      DocumentParameters.displaymode = False
    else:
      DocumentParameters.displaymode = True
      self.output.settag('div class="formula"', True)
    if Options.jsmath:
      self.jsmath()
    elif Options.mathjax:
      self.mathjax()
    elif Options.googlecharts:
      self.googlecharts()
    else:
      self.classic()

  def jsmath(self):
    "Make the contents for jsMath."
    if self.header[0] != 'inline':
      self.output = TaggedOutput().settag('div class="math"')
    else:
      self.output = TaggedOutput().settag('span class="math"')
    self.contents = [Constant(self.parsed)]

  def mathjax(self):
    "Make the contents for MathJax."
    self.output.tag = 'span class="MathJax_Preview"'
    tag = 'script type="math/tex'
    if self.header[0] != 'inline':
      tag += ';mode=display'
    self.contents = [TaggedText().constant(self.parsed, tag + '"', True)]

  def googlecharts(self):
    "Make the contents using Google Charts http://code.google.com/apis/chart/."
    url = FormulaConfig.urls['googlecharts'] + urllib.quote_plus(self.parsed)
    img = '<img class="chart" src="' + url + '" alt="' + self.parsed + '"/>'
    self.contents = [Constant(img)]

  def classic(self):
    "Make the contents using classic output generation with XHTML and CSS."
    whole = FormulaFactory().parseformula(self.parsed)
    FormulaProcessor().process(whole)
    whole.parent = self
    self.contents = [whole]

  def parse(self, pos):
    "Parse using a parse position instead of self.parser."
    if pos.checkskip('$$'):
      self.parsedollarblock(pos)
    elif pos.checkskip('$'):
      self.parsedollarinline(pos)
    elif pos.checkskip('\\('):
      self.parseinlineto(pos, '\\)')
    elif pos.checkskip('\\['):
      self.parseblockto(pos, '\\]')
    else:
      pos.error('Unparseable formula')
    self.process()
    return self

  def parsedollarinline(self, pos):
    "Parse a $...$ formula."
    self.header = ['inline']
    self.parsedollar(pos)

  def parsedollarblock(self, pos):
    "Parse a $$...$$ formula."
    self.header = ['block']
    self.parsedollar(pos)
    if not pos.checkskip('$'):
      pos.error('Formula should be $$...$$, but last $ is missing.')

  def parsedollar(self, pos):
    "Parse to the next $."
    pos.pushending('$')
    self.parsed = pos.globexcluding('$')
    pos.popending('$')

  def parseinlineto(self, pos, limit):
    "Parse a \\(...\\) formula."
    self.header = ['inline']
    self.parseupto(pos, limit)

  def parseblockto(self, pos, limit):
    "Parse a \\[...\\] formula."
    self.header = ['block']
    self.parseupto(pos, limit)

  def parseupto(self, pos, limit):
    "Parse a formula that ends with the given command."
    pos.pushending(limit)
    self.parsed = pos.glob(lambda: True)
    pos.popending(limit)

  def __unicode__(self):
    "Return a printable representation."
    if self.partkey and self.partkey.number:
      return 'Formula (' + self.partkey.number + ')'
    return 'Unnumbered formula'

class WholeFormula(FormulaBit):
  "Parse a whole formula"

  def detect(self, pos):
    "Not outside the formula is enough."
    return not pos.finished()

  def parsebit(self, pos):
    "Parse with any formula bit"
    while not pos.finished():
      self.add(self.factory.parseany(pos))

class FormulaFactory(object):
  "Construct bits of formula"

  # bit types will be appended later
  types = [FormulaSymbol, RawText, FormulaNumber, Bracket, Comment, WhiteSpace]
  skippedtypes = [Comment, WhiteSpace]
  defining = False

  def __init__(self):
    "Initialize the map of instances."
    self.instances = dict()

  def detecttype(self, type, pos):
    "Detect a bit of a given type."
    if pos.finished():
      return False
    return self.instance(type).detect(pos)

  def instance(self, type):
    "Get an instance of the given type."
    if not type in self.instances or not self.instances[type]:
      self.instances[type] = self.create(type)
    return self.instances[type]

  def create(self, type):
    "Create a new formula bit of the given type."
    return Cloner.create(type).setfactory(self)

  def clearskipped(self, pos):
    "Clear any skipped types."
    while not pos.finished():
      if not self.skipany(pos):
        return
    return

  def skipany(self, pos):
    "Skip any skipped types."
    for type in self.skippedtypes:
      if self.instance(type).detect(pos):
        return self.parsetype(type, pos)
    return None

  def parseany(self, pos):
    "Parse any formula bit at the current location."
    for type in self.types + self.skippedtypes:
      if self.detecttype(type, pos):
        return self.parsetype(type, pos)
    Trace.error('Unrecognized formula at ' + pos.identifier())
    return FormulaConstant(pos.skipcurrent())

  def parsetype(self, type, pos):
    "Parse the given type and return it."
    bit = self.instance(type)
    self.instances[type] = None
    returnedbit = bit.parsebit(pos)
    if returnedbit:
      return returnedbit.setfactory(self)
    return bit

  def parseformula(self, formula):
    "Parse a string of text that contains a whole formula."
    pos = TextPosition(formula)
    whole = self.create(WholeFormula)
    if whole.detect(pos):
      whole.parsebit(pos)
      return whole
    # no formula found
    if not pos.finished():
      Trace.error('Unknown formula at: ' + pos.identifier())
      whole.add(TaggedBit().constant(formula, 'span class="unknown"'))
    return whole




import unicodedata












import gettext


class Translator(object):
  "Reads the configuration file and tries to find a translation."
  "Otherwise falls back to the messages in the config file."

  instance = None

  def translate(cls, key):
    "Get the translated message for a key."
    return cls.instance.getmessage(key)

  translate = classmethod(translate)

  def __init__(self):
    self.translation = None
    self.first = True

  def findtranslation(self):
    "Find the translation for the document language."
    self.langcodes = None
    if not DocumentParameters.language:
      Trace.error('No language in document')
      return
    if not DocumentParameters.language in TranslationConfig.languages:
      Trace.error('Unknown language ' + DocumentParameters.language)
      return
    if TranslationConfig.languages[DocumentParameters.language] == 'en':
      return
    langcodes = [TranslationConfig.languages[DocumentParameters.language]]
    try:
      self.translation = gettext.translation('elyxer', None, langcodes)
    except IOError:
      Trace.error('No translation for ' + unicode(langcodes))

  def getmessage(self, key):
    "Get the translated message for the given key."
    if self.first:
      self.findtranslation()
      self.first = False
    message = self.getuntranslated(key)
    if not self.translation:
      return message
    try:
      message = self.translation.ugettext(message)
    except IOError:
      pass
    return message

  def getuntranslated(self, key):
    "Get the untranslated message."
    if not key in TranslationConfig.constants:
      Trace.error('Cannot translate ' + key)
      return key
    return TranslationConfig.constants[key]

Translator.instance = Translator()



class NumberCounter(object):
  "A counter for numbers (by default)."
  "The type can be changed to return letters, roman numbers..."

  name = None
  value = None
  mode = None
  master = None

  letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  symbols = NumberingConfig.sequence['symbols']
  romannumerals = [
      ('M', 1000), ('CM', 900), ('D', 500), ('CD', 400), ('C', 100),
      ('XC', 90), ('L', 50), ('XL', 40), ('X', 10), ('IX', 9), ('V', 5),
      ('IV', 4), ('I', 1)
      ]

  def __init__(self, name):
    "Give a name to the counter."
    self.name = name

  def setmode(self, mode):
    "Set the counter mode. Can be changed at runtime."
    self.mode = mode
    return self

  def init(self, value):
    "Set an initial value."
    self.value = value

  def gettext(self):
    "Get the next value as a text string."
    return unicode(self.value)

  def getletter(self):
    "Get the next value as a letter."
    return self.getsequence(self.letters)

  def getsymbol(self):
    "Get the next value as a symbol."
    return self.getsequence(self.symbols)

  def getsequence(self, sequence):
    "Get the next value from elyxer.a sequence."
    return sequence[(self.value - 1) % len(sequence)]

  def getroman(self):
    "Get the next value as a roman number."
    result = ''
    number = self.value
    for numeral, value in self.romannumerals:
      if number >= value:
        result += numeral * (number / value)
        number = number % value
    return result

  def getvalue(self):
    "Get the current value as configured in the current mode."
    if not self.mode or self.mode in ['text', '1']:
      return self.gettext()
    if self.mode == 'A':
      return self.getletter()
    if self.mode == 'a':
      return self.getletter().lower()
    if self.mode == 'I':
      return self.getroman()
    if self.mode == '*':
      return self.getsymbol()
    Trace.error('Unknown counter mode ' + self.mode)
    return self.gettext()

  def getnext(self):
    "Increase the current value and get the next value as configured."
    if not self.value:
      self.value = 0
    self.value += 1
    return self.getvalue()

  def reset(self):
    "Reset the counter."
    self.value = 0

  def __unicode__(self):
    "Return a printable representation."
    result = 'Counter ' + self.name
    if self.mode:
      result += ' in mode ' + self.mode
    return result

class DependentCounter(NumberCounter):
  "A counter which depends on another one (the master)."

  def setmaster(self, master):
    "Set the master counter."
    self.master = master
    self.last = self.master.getvalue()
    return self

  def getnext(self):
    "Increase or, if the master counter has changed, restart."
    if self.last != self.master.getvalue():
      self.reset()
    value = NumberCounter.getnext(self)
    self.last = self.master.getvalue()
    return value

  def getvalue(self):
    "Get the value of the combined counter: master.dependent."
    return self.master.getvalue() + '.' + NumberCounter.getvalue(self)

class NumberGenerator(object):
  "A number generator for unique sequences and hierarchical structures. Used in:"
  "  * ordered part numbers: Chapter 3, Section 5.3."
  "  * unique part numbers: Footnote 15, Bibliography cite [15]."
  "  * chaptered part numbers: Figure 3.15, Equation (8.3)."
  "  * unique roman part numbers: Part I, Book IV."

  chaptered = None
  generator = None

  romanlayouts = [x.lower() for x in NumberingConfig.layouts['roman']]
  orderedlayouts = [x.lower() for x in NumberingConfig.layouts['ordered']]

  counters = dict()
  appendix = None

  def deasterisk(self, type):
    "Remove the possible asterisk in a layout type."
    return type.replace('*', '')

  def isunique(self, type):
    "Find out if the layout type corresponds to a unique part."
    return self.isroman(type)

  def isroman(self, type):
    "Find out if the layout type should have roman numeration."
    return self.deasterisk(type).lower() in self.romanlayouts

  def isinordered(self, type):
    "Find out if the layout type corresponds to an (un)ordered part."
    return self.deasterisk(type).lower() in self.orderedlayouts

  def isnumbered(self, type):
    "Find out if the type for a layout corresponds to a numbered layout."
    if '*' in type:
      return False
    if self.isroman(type):
      return True
    if not self.isinordered(type):
      return False
    if self.getlevel(type) > DocumentParameters.maxdepth:
      return False
    return True

  def isunordered(self, type):
    "Find out if the type contains an asterisk, basically."
    return '*' in type

  def getlevel(self, type):
    "Get the level that corresponds to a layout type."
    if self.isunique(type):
      return 0
    if not self.isinordered(type):
      Trace.error('Unknown layout type ' + type)
      return 0
    type = self.deasterisk(type).lower()
    level = self.orderedlayouts.index(type) + 1
    return level - DocumentParameters.startinglevel

  def getparttype(self, type):
    "Obtain the type for the part: without the asterisk, "
    "and switched to Appendix if necessary."
    if NumberGenerator.appendix and self.getlevel(type) == 1:
      return 'Appendix'
    return self.deasterisk(type)

  def generate(self, type):
    "Generate a number for a layout type."
    "Unique part types such as Part or Book generate roman numbers: Part I."
    "Ordered part types return dot-separated tuples: Chapter 5, Subsection 2.3.5."
    "Everything else generates unique numbers: Bibliography [1]."
    "Each invocation results in a new number."
    return self.getcounter(type).getnext()

  def getcounter(self, type):
    "Get the counter for the given type."
    type = type.lower()
    if not type in self.counters:
      self.counters[type] = self.create(type)
    return self.counters[type]

  def create(self, type):
    "Create a counter for the given type."
    if self.isnumbered(type) and self.getlevel(type) > 1:
      index = self.orderedlayouts.index(type)
      above = self.orderedlayouts[index - 1]
      master = self.getcounter(above)
      return self.createdependent(type, master)
    counter = NumberCounter(type)
    if self.isroman(type):
      counter.setmode('I')
    return counter

  def getdependentcounter(self, type, master):
    "Get (or create) a counter of the given type that depends on another."
    if not type in self.counters or not self.counters[type].master:
      self.counters[type] = self.createdependent(type, master)
    return self.counters[type]

  def createdependent(self, type, master):
    "Create a dependent counter given the master."
    return DependentCounter(type).setmaster(master)

  def startappendix(self):
    "Start appendices here."
    firsttype = self.orderedlayouts[DocumentParameters.startinglevel]
    counter = self.getcounter(firsttype)
    counter.setmode('A').reset()
    NumberGenerator.appendix = True

class ChapteredGenerator(NumberGenerator):
  "Generate chaptered numbers, as in Chapter.Number."
  "Used in equations, figures: Equation (5.3), figure 8.15."

  def generate(self, type):
    "Generate a number which goes with first-level numbers (chapters). "
    "For the article classes a unique number is generated."
    if DocumentParameters.startinglevel > 0:
      return NumberGenerator.generator.generate(type)
    chapter = self.getcounter('Chapter')
    return self.getdependentcounter(type, chapter).getnext()


NumberGenerator.chaptered = ChapteredGenerator()
NumberGenerator.generator = NumberGenerator()






class ContainerSize(object):
  "The size of a container."

  width = None
  height = None
  maxwidth = None
  maxheight = None
  scale = None

  def set(self, width = None, height = None):
    "Set the proper size with width and height."
    self.setvalue('width', width)
    self.setvalue('height', height)
    return self

  def setmax(self, maxwidth = None, maxheight = None):
    "Set max width and/or height."
    self.setvalue('maxwidth', maxwidth)
    self.setvalue('maxheight', maxheight)
    return self

  def readparameters(self, container):
    "Read some size parameters off a container."
    self.setparameter(container, 'width')
    self.setparameter(container, 'height')
    self.setparameter(container, 'scale')
    self.checkvalidheight(container)
    return self

  def setparameter(self, container, name):
    "Read a size parameter off a container, and set it if present."
    value = container.getparameter(name)
    self.setvalue(name, value)

  def setvalue(self, name, value):
    "Set the value of a parameter name, only if it's valid."
    value = self.processparameter(value)
    if value:
      setattr(self, name, value)

  def checkvalidheight(self, container):
    "Check if the height parameter is valid; otherwise erase it."
    heightspecial = container.getparameter('height_special')
    if self.height and self.extractnumber(self.height) == '1' and heightspecial == 'totalheight':
      self.height = None

  def processparameter(self, value):
    "Do the full processing on a parameter."
    if not value:
      return None
    if self.extractnumber(value) == '0':
      return None
    for ignored in StyleConfig.size['ignoredtexts']:
      if ignored in value:
        value = value.replace(ignored, '')
    return value

  def extractnumber(self, text):
    "Extract the first number in the given text."
    result = ''
    decimal = False
    for char in text:
      if char.isdigit():
        result += char
      elif char == '.' and not decimal:
        result += char
        decimal = True
      else:
        return result
    return result

  def checkimage(self, width, height):
    "Check image dimensions, set them if possible."
    if width:
      self.maxwidth = unicode(width) + 'px'
      if self.scale and not self.width:
        self.width = self.scalevalue(width)
    if height:
      self.maxheight = unicode(height) + 'px'
      if self.scale and not self.height:
        self.height = self.scalevalue(height)
    if self.width and not self.height:
      self.height = 'auto'
    if self.height and not self.width:
      self.width = 'auto'

  def scalevalue(self, value):
    "Scale the value according to the image scale and return it as unicode."
    scaled = value * int(self.scale) / 100
    return unicode(int(scaled)) + 'px'

  def removepercentwidth(self):
    "Remove percent width if present, to set it at the figure level."
    if not self.width:
      return None
    if not '%' in self.width:
      return None
    width = self.width
    self.width = None
    if self.height == 'auto':
      self.height = None
    return width

  def addstyle(self, container):
    "Add the proper style attribute to the output tag."
    if not isinstance(container.output, TaggedOutput):
      Trace.error('No tag to add style, in ' + unicode(container))
    if not self.width and not self.height and not self.maxwidth and not self.maxheight:
      # nothing to see here; move along
      return
    tag = ' style="'
    tag += self.styleparameter('width')
    tag += self.styleparameter('maxwidth')
    tag += self.styleparameter('height')
    tag += self.styleparameter('maxheight')
    if tag[-1] == ' ':
      tag = tag[:-1]
    tag += '"'
    container.output.tag += tag

  def styleparameter(self, name):
    "Get the style for a single parameter."
    value = getattr(self, name)
    if value:
      return name.replace('max', 'max-') + ': ' + value + '; '
    return ''



class QuoteContainer(Container):
  "A container for a pretty quote"

  def __init__(self):
    self.parser = BoundedParser()
    self.output = FixedOutput()

  def process(self):
    "Process contents"
    self.type = self.header[2]
    if not self.type in StyleConfig.quotes:
      Trace.error('Quote type ' + self.type + ' not found')
      self.html = ['"']
      return
    self.html = [StyleConfig.quotes[self.type]]

class LyXLine(Container):
  "A Lyx line"

  def __init__(self):
    self.parser = LoneCommand()
    self.output = FixedOutput()

  def process(self):
    self.html = ['<hr class="line" />']

class EmphaticText(TaggedText):
  "Text with emphatic mode"

  def process(self):
    self.output.tag = 'i'

class ShapedText(TaggedText):
  "Text shaped (italic, slanted)"

  def process(self):
    self.type = self.header[1]
    if not self.type in TagConfig.shaped:
      Trace.error('Unrecognized shape ' + self.header[1])
      self.output.tag = 'span'
      return
    self.output.tag = TagConfig.shaped[self.type]

class VersalitasText(TaggedText):
  "Text in versalitas"

  def process(self):
    self.output.tag = 'span class="versalitas"'

class ColorText(TaggedText):
  "Colored text"

  def process(self):
    self.color = self.header[1]
    self.output.tag = 'span class="' + self.color + '"'

class SizeText(TaggedText):
  "Sized text"

  def process(self):
    self.size = self.header[1]
    self.output.tag = 'span class="' + self.size + '"'

class BoldText(TaggedText):
  "Bold text"

  def process(self):
    self.output.tag = 'b'

class TextFamily(TaggedText):
  "A bit of text from elyxer.a different family"

  def process(self):
    "Parse the type of family"
    self.type = self.header[1]
    if not self.type in TagConfig.family:
      Trace.error('Unrecognized family ' + type)
      self.output.tag = 'span'
      return
    self.output.tag = TagConfig.family[self.type]

class Hfill(TaggedText):
  "Horizontall fill"

  def process(self):
    self.output.tag = 'span class="hfill"'

class BarredText(TaggedText):
  "Text with a bar somewhere"

  def process(self):
    "Parse the type of bar"
    self.type = self.header[1]
    if not self.type in TagConfig.barred:
      Trace.error('Unknown bar type ' + self.type)
      self.output.tag = 'span'
      return
    self.output.tag = TagConfig.barred[self.type]

class LangLine(TaggedText):
  "A line with language information"

  def process(self):
    "Only generate a span with lang info when the language is recognized."
    lang = self.header[1]
    if not lang in TranslationConfig.languages:
      self.output = ContentsOutput()
      return
    isolang = TranslationConfig.languages[lang]
    self.output = TaggedOutput().settag('span lang="' + isolang + '"', False)

class InsetLength(BlackBox):
  "A length measure inside an inset."

  def process(self):
    self.length = self.header[1]

class Space(Container):
  "A space of several types"

  def __init__(self):
    self.parser = InsetParser()
    self.output = FixedOutput()
  
  def process(self):
    self.type = self.header[2]
    if self.type not in StyleConfig.hspaces:
      Trace.error('Unknown space type ' + self.type)
      self.html = [' ']
      return
    self.html = [StyleConfig.hspaces[self.type]]
    length = self.getlength()
    if not length:
      return
    self.output = TaggedOutput().settag('span class="hspace"', False)
    ContainerSize().set(length).addstyle(self)

  def getlength(self):
    "Get the space length from elyxer.the contents or parameters."
    if len(self.contents) == 0 or not isinstance(self.contents[0], InsetLength):
      return None
    return self.contents[0].length

class VerticalSpace(Container):
  "An inset that contains a vertical space."

  def __init__(self):
    self.parser = InsetParser()
    self.output = FixedOutput()

  def process(self):
    "Set the correct tag"
    self.type = self.header[2]
    if self.type not in StyleConfig.vspaces:
      self.output = TaggedOutput().settag('div class="vspace" style="height: ' + self.type + ';"', True)
      return
    self.html = [StyleConfig.vspaces[self.type]]

class Align(Container):
  "Bit of aligned text"

  def __init__(self):
    self.parser = ExcludingParser()
    self.output = TaggedOutput().setbreaklines(True)

  def process(self):
    self.output.tag = 'div class="' + self.header[1] + '"'

class Newline(Container):
  "A newline"

  def __init__(self):
    self.parser = LoneCommand()
    self.output = FixedOutput()

  def process(self):
    "Process contents"
    self.html = ['<br/>\n']

class NewPage(Newline):
  "A new page"

  def process(self):
    "Process contents"
    self.html = ['<p><br/>\n</p>\n']

class Separator(Container):
  "A separator string which is not extracted by extracttext()."

  def __init__(self, constant):
    self.output = FixedOutput()
    self.contents = []
    self.html = [constant]

class StrikeOut(TaggedText):
  "Striken out text."

  def process(self):
    "Set the output tag to strike."
    self.output.tag = 'strike'

class StartAppendix(BlackBox):
  "Mark to start an appendix here."
  "From this point on, all chapters become appendices."

  def process(self):
    "Activate the special numbering scheme for appendices, using letters."
    NumberGenerator.generator.startappendix()






class Link(Container):
  "A link to another part of the document"

  anchor = None
  url = None
  type = None
  page = None
  target = None
  destination = None
  title = None

  def __init__(self):
    "Initialize the link, add target if configured."
    self.contents = []
    self.parser = InsetParser()
    self.output = LinkOutput()
    if Options.target:
      self.target = Options.target

  def complete(self, text, anchor = None, url = None, type = None, title = None):
    "Complete the link."
    self.contents = [Constant(text)]
    if anchor:
      self.anchor = anchor
    if url:
      self.url = url
    if type:
      self.type = type
    if title:
      self.title = title
    return self

  def computedestination(self):
    "Use the destination link to fill in the destination URL."
    if not self.destination:
      return
    self.url = ''
    if self.destination.anchor:
      self.url = '#' + self.destination.anchor
    if self.destination.page:
      self.url = self.destination.page + self.url

  def setmutualdestination(self, destination):
    "Set another link as destination, and set its destination to this one."
    self.destination = destination
    destination.destination = self

  def __unicode__(self):
    "Return a printable representation."
    result = 'Link'
    if self.anchor:
      result += ' #' + self.anchor
    if self.url:
      result += ' to ' + self.url
    return result

class URL(Link):
  "A clickable URL"

  def process(self):
    "Read URL from elyxer.parameters"
    target = self.escape(self.getparameter('target'))
    self.url = target
    type = self.getparameter('type')
    if type:
      self.url = self.escape(type) + target
    name = self.getparameter('name')
    if not name:
      name = target
    self.contents = [Constant(name)]

class FlexURL(URL):
  "A flexible URL"

  def process(self):
    "Read URL from elyxer.contents"
    self.url = self.extracttext()

class LinkOutput(ContainerOutput):
  "A link pointing to some destination"
  "Or an anchor (destination)"

  def gethtml(self, link):
    "Get the HTML code for the link"
    type = link.__class__.__name__
    if link.type:
      type = link.type
    tag = 'a class="' + type + '"'
    if link.anchor:
      tag += ' name="' + link.anchor + '"'
    if link.destination:
      link.computedestination()
    if link.url:
      tag += ' href="' + link.url + '"'
    if link.target:
      tag += ' target="' + link.target + '"'
    if link.title:
      tag += ' title="' + link.title + '"'
    return TaggedOutput().settag(tag).gethtml(link)





class Postprocessor(object):
  "Postprocess a container keeping some context"

  stages = []

  def __init__(self):
    self.stages = StageDict(Postprocessor.stages, self)
    self.current = None
    self.last = None

  def postprocess(self, next):
    "Postprocess a container and its contents."
    self.postrecursive(self.current)
    result = self.postcurrent(next)
    self.last = self.current
    self.current = next
    return result

  def postrecursive(self, container):
    "Postprocess the container contents recursively"
    if not hasattr(container, 'contents'):
      return
    if len(container.contents) == 0:
      return
    if hasattr(container, 'postprocess'):
      if not container.postprocess:
        return
    postprocessor = Postprocessor()
    contents = []
    for element in container.contents:
      post = postprocessor.postprocess(element)
      if post:
        contents.append(post)
    # two rounds to empty the pipeline
    for i in range(2):
      post = postprocessor.postprocess(None)
      if post:
        contents.append(post)
    container.contents = contents

  def postcurrent(self, next):
    "Postprocess the current element taking into account next and last."
    stage = self.stages.getstage(self.current)
    if not stage:
      return self.current
    return stage.postprocess(self.last, self.current, next)

class StageDict(object):
  "A dictionary of stages corresponding to classes"

  def __init__(self, classes, postprocessor):
    "Instantiate an element from elyxer.each class and store as a dictionary"
    instances = self.instantiate(classes, postprocessor)
    self.stagedict = dict([(x.processedclass, x) for x in instances])

  def instantiate(self, classes, postprocessor):
    "Instantiate an element from elyxer.each class"
    stages = [x.__new__(x) for x in classes]
    for element in stages:
      element.__init__()
      element.postprocessor = postprocessor
    return stages

  def getstage(self, element):
    "Get the stage for a given element, if the type is in the dict"
    if not element.__class__ in self.stagedict:
      return None
    return self.stagedict[element.__class__]



class Label(Link):
  "A label to be referenced"

  names = dict()
  lastlayout = None

  def __init__(self):
    Link.__init__(self)
    self.lastnumbered = None

  def process(self):
    "Process a label container."
    key = self.getparameter('name')
    self.create(' ', key)
    self.lastnumbered = Label.lastlayout

  def create(self, text, key, type = 'Label'):
    "Create the label for a given key."
    self.key = key
    self.complete(text, anchor = key, type = type)
    Label.names[key] = self
    if key in Reference.references:
      for reference in Reference.references[key]:
        reference.destination = self
    return self

  def findpartkey(self):
    "Get the part key for the latest numbered container seen."
    numbered = self.numbered(self)
    if numbered and numbered.partkey:
      return numbered.partkey
    return ''

  def numbered(self, container):
    "Get the numbered container for the label."
    if container.partkey:
      return container
    if not container.parent:
      if self.lastnumbered:
        return self.lastnumbered
      return None
    return self.numbered(container.parent)

  def __unicode__(self):
    "Return a printable representation."
    if not hasattr(self, 'key'):
      return 'Unnamed label'
    return 'Label ' + self.key

class Reference(Link):
  "A reference to a label."

  references = dict()
  key = 'none'

  def process(self):
    "Read the reference and set the arrow."
    self.key = self.getparameter('reference')
    if self.key in Label.names:
      self.direction = u'â†‘'
      label = Label.names[self.key]
    else:
      self.direction = u'â†“'
      label = Label().complete(' ', self.key, 'preref')
    self.destination = label
    self.formatcontents()
    if not self.key in Reference.references:
      Reference.references[self.key] = []
    Reference.references[self.key].append(self)

  def formatcontents(self):
    "Format the reference contents."
    formatkey = self.getparameter('LatexCommand')
    if not formatkey:
      formatkey = 'ref'
    self.formatted = u'â†•'
    if formatkey in StyleConfig.referenceformats:
      self.formatted = StyleConfig.referenceformats[formatkey]
    else:
      Trace.error('Unknown reference format ' + formatkey)
    self.replace(u'â†•', self.direction)
    self.replace('#', '1')
    self.replace('on-page', Translator.translate('on-page'))
    partkey = self.destination.findpartkey()
    # only if partkey and partkey.number are not null, send partkey.number
    self.replace('@', partkey and partkey.number)
    self.replace(u'Â¶', partkey and partkey.tocentry)
    if not '$' in self.formatted or not partkey or not partkey.titlecontents:
      # there is a $ left, but it should go away on preprocessing
      self.contents = [Constant(self.formatted)]
      return
    pieces = self.formatted.split('$')
    self.contents = [Constant(pieces[0])]
    for piece in pieces[1:]:
      self.contents += partkey.titlecontents
      self.contents.append(Constant(piece))

  def replace(self, key, value):
    "Replace a key in the format template with a value."
    if not key in self.formatted:
      return
    if not value:
      value = ''
    self.formatted = self.formatted.replace(key, value)

  def __unicode__(self):
    "Return a printable representation."
    return 'Reference ' + self.key



class FormulaCommand(FormulaBit):
  "A LaTeX command inside a formula"

  types = []
  start = FormulaConfig.starts['command']
  commandmap = None

  def detect(self, pos):
    "Find the current command."
    return pos.checkfor(FormulaCommand.start)

  def parsebit(self, pos):
    "Parse the command."
    command = self.extractcommand(pos)
    bit = self.parsewithcommand(command, pos)
    if bit:
      return bit
    if command.startswith('\\up') or command.startswith('\\Up'):
      upgreek = self.parseupgreek(command, pos)
      if upgreek:
        return upgreek
    if not self.factory.defining:
      Trace.error('Unknown command ' + command)
    self.output = TaggedOutput().settag('span class="unknown"')
    self.add(FormulaConstant(command))
    return None

  def parsewithcommand(self, command, pos):
    "Parse the command type once we have the command."
    for type in FormulaCommand.types:
      if command in type.commandmap:
        return self.parsecommandtype(command, type, pos)
    return None

  def parsecommandtype(self, command, type, pos):
    "Parse a given command type."
    bit = self.factory.create(type)
    bit.setcommand(command)
    returned = bit.parsebit(pos)
    if returned:
      return returned
    return bit

  def extractcommand(self, pos):
    "Extract the command from elyxer.the current position."
    if not pos.checkskip(FormulaCommand.start):
      pos.error('Missing command start ' + FormulaCommand.start)
      return
    if pos.finished():
      return self.emptycommand(pos)
    if pos.current().isalpha():
      # alpha command
      command = FormulaCommand.start + pos.globalpha()
      # skip mark of short command
      pos.checkskip('*')
      return command
    # symbol command
    return FormulaCommand.start + pos.skipcurrent()

  def emptycommand(self, pos):
    """Check for an empty command: look for command disguised as ending.
    Special case against '{ \{ \} }' situation."""
    command = ''
    if not pos.isout():
      ending = pos.nextending()
      if ending and pos.checkskip(ending):
        command = ending
    return FormulaCommand.start + command

  def parseupgreek(self, command, pos):
    "Parse the Greek \\up command.."
    if len(command) < 4:
      return None
    if command.startswith('\\up'):
      upcommand = '\\' + command[3:]
    elif pos.checkskip('\\Up'):
      upcommand = '\\' + command[3:4].upper() + command[4:]
    else:
      Trace.error('Impossible upgreek command: ' + command)
      return
    upgreek = self.parsewithcommand(upcommand, pos)
    if upgreek:
      upgreek.type = 'font'
    return upgreek

class CommandBit(FormulaCommand):
  "A formula bit that includes a command"

  def setcommand(self, command):
    "Set the command in the bit"
    self.command = command
    if self.commandmap:
      self.original += command
      self.translated = self.commandmap[self.command]
 
  def parseparameter(self, pos):
    "Parse a parameter at the current position"
    self.factory.clearskipped(pos)
    if pos.finished():
      return None
    parameter = self.factory.parseany(pos)
    self.add(parameter)
    return parameter

  def parsesquare(self, pos):
    "Parse a square bracket"
    self.factory.clearskipped(pos)
    if not self.factory.detecttype(SquareBracket, pos):
      return None
    bracket = self.factory.parsetype(SquareBracket, pos)
    self.add(bracket)
    return bracket

  def parseliteral(self, pos):
    "Parse a literal bracket."
    self.factory.clearskipped(pos)
    if not self.factory.detecttype(Bracket, pos):
      if not pos.isvalue():
        Trace.error('No literal parameter found at: ' + pos.identifier())
        return None
      return pos.globvalue()
    bracket = Bracket().setfactory(self.factory)
    self.add(bracket.parseliteral(pos))
    return bracket.literal

  def parsesquareliteral(self, pos):
    "Parse a square bracket literally."
    self.factory.clearskipped(pos)
    if not self.factory.detecttype(SquareBracket, pos):
      return None
    bracket = SquareBracket().setfactory(self.factory)
    self.add(bracket.parseliteral(pos))
    return bracket.literal

  def parsetext(self, pos):
    "Parse a text parameter."
    self.factory.clearskipped(pos)
    if not self.factory.detecttype(Bracket, pos):
      Trace.error('No text parameter for ' + self.command)
      return None
    bracket = Bracket().setfactory(self.factory).parsetext(pos)
    self.add(bracket)
    return bracket

class EmptyCommand(CommandBit):
  "An empty command (without parameters)"

  commandmap = FormulaConfig.commands

  def parsebit(self, pos):
    "Parse a command without parameters"
    self.contents = [FormulaConstant(self.translated)]

class SpacedCommand(CommandBit):
  "An empty command which should have math spacing in formulas."

  commandmap = FormulaConfig.spacedcommands

  def parsebit(self, pos):
    "Place as contents the command translated and spaced."
    self.contents = [FormulaConstant(u'âŸ' + self.translated + u'âŸ')]

class AlphaCommand(EmptyCommand):
  "A command without paramters whose result is alphabetical"

  commandmap = FormulaConfig.alphacommands

  def parsebit(self, pos):
    "Parse the command and set type to alpha"
    EmptyCommand.parsebit(self, pos)
    self.type = 'alpha'

class OneParamFunction(CommandBit):
  "A function of one parameter"

  commandmap = FormulaConfig.onefunctions
  simplified = False

  def parsebit(self, pos):
    "Parse a function with one parameter"
    self.output = TaggedOutput().settag(self.translated)
    self.parseparameter(pos)
    self.simplifyifpossible()

  def simplifyifpossible(self):
    "Try to simplify to a single character."
    if self.original in self.commandmap:
      self.output = FixedOutput()
      self.html = [self.commandmap[self.original]]
      self.simplified = True

class SymbolFunction(CommandBit):
  "Find a function which is represented by a symbol (like _ or ^)"

  commandmap = FormulaConfig.symbolfunctions

  def detect(self, pos):
    "Find the symbol"
    return pos.current() in SymbolFunction.commandmap

  def parsebit(self, pos):
    "Parse the symbol"
    self.setcommand(pos.current())
    pos.skip(self.command)
    self.output = TaggedOutput().settag(self.translated)
    self.parseparameter(pos)

class TextFunction(CommandBit):
  "A function where parameters are read as text."

  commandmap = FormulaConfig.textfunctions

  def parsebit(self, pos):
    "Parse a text parameter"
    self.output = TaggedOutput().settag(self.translated)
    self.parsetext(pos)

  def process(self):
    "Set the type to font"
    self.type = 'font'

class LabelFunction(CommandBit):
  "A function that acts as a label"

  commandmap = FormulaConfig.labelfunctions

  def parsebit(self, pos):
    "Parse a literal parameter"
    self.key = self.parseliteral(pos)

  def process(self):
    "Add an anchor with the label contents."
    self.type = 'font'
    self.label = Label().create(' ', self.key, type = 'eqnumber')
    self.contents = [self.label]
    # store as a Label so we know it's been seen
    Label.names[self.key] = self.label

class FontFunction(OneParamFunction):
  "A function of one parameter that changes the font"

  commandmap = FormulaConfig.fontfunctions

  def process(self):
    "Simplify if possible using a single character."
    self.type = 'font'
    self.simplifyifpossible()

FormulaFactory.types += [FormulaCommand, SymbolFunction]
FormulaCommand.types = [
    AlphaCommand, EmptyCommand, OneParamFunction, FontFunction, LabelFunction,
    TextFunction, SpacedCommand,
    ]












class BigSymbol(object):
  "A big symbol generator."

  symbols = FormulaConfig.bigsymbols

  def __init__(self, symbol):
    "Create the big symbol."
    self.symbol = symbol

  def getpieces(self):
    "Get an array with all pieces."
    if not self.symbol in self.symbols:
      return [self.symbol]
    if self.smalllimit():
      return [self.symbol]
    return self.symbols[self.symbol]

  def smalllimit(self):
    "Decide if the limit should be a small, one-line symbol."
    if not DocumentParameters.displaymode:
      return True
    if len(self.symbols[self.symbol]) == 1:
      return True
    return Options.simplemath

class BigBracket(BigSymbol):
  "A big bracket generator."

  def __init__(self, size, bracket, alignment='l'):
    "Set the size and symbol for the bracket."
    self.size = size
    self.original = bracket
    self.alignment = alignment
    self.pieces = None
    if bracket in FormulaConfig.bigbrackets:
      self.pieces = FormulaConfig.bigbrackets[bracket]

  def getpiece(self, index):
    "Return the nth piece for the bracket."
    function = getattr(self, 'getpiece' + unicode(len(self.pieces)))
    return function(index)

  def getpiece1(self, index):
    "Return the only piece for a single-piece bracket."
    return self.pieces[0]

  def getpiece3(self, index):
    "Get the nth piece for a 3-piece bracket: parenthesis or square bracket."
    if index == 0:
      return self.pieces[0]
    if index == self.size - 1:
      return self.pieces[-1]
    return self.pieces[1]

  def getpiece4(self, index):
    "Get the nth piece for a 4-piece bracket: curly bracket."
    if index == 0:
      return self.pieces[0]
    if index == self.size - 1:
      return self.pieces[3]
    if index == (self.size - 1)/2:
      return self.pieces[2]
    return self.pieces[1]

  def getcell(self, index):
    "Get the bracket piece as an array cell."
    piece = self.getpiece(index)
    span = 'span class="bracket align-' + self.alignment + '"'
    return TaggedBit().constant(piece, span)

  def getcontents(self):
    "Get the bracket as an array or as a single bracket."
    if self.size == 1 or not self.pieces:
      return self.getsinglebracket()
    rows = []
    for index in range(self.size):
      cell = self.getcell(index)
      rows.append(TaggedBit().complete([cell], 'span class="arrayrow"'))
    return [TaggedBit().complete(rows, 'span class="array"')]

  def getsinglebracket(self):
    "Return the bracket as a single sign."
    if self.original == '.':
      return [TaggedBit().constant('', 'span class="emptydot"')]
    return [TaggedBit().constant(self.original, 'span class="symbol"')]






class FormulaEquation(CommandBit):
  "A simple numbered equation."

  piece = 'equation'

  def parsebit(self, pos):
    "Parse the array"
    self.output = ContentsOutput()
    self.add(self.factory.parsetype(WholeFormula, pos))

class FormulaCell(FormulaCommand):
  "An array cell inside a row"

  def setalignment(self, alignment):
    self.alignment = alignment
    self.output = TaggedOutput().settag('span class="arraycell align-' + alignment +'"', True)
    return self

  def parsebit(self, pos):
    self.factory.clearskipped(pos)
    if pos.finished():
      return
    self.add(self.factory.parsetype(WholeFormula, pos))

class FormulaRow(FormulaCommand):
  "An array row inside an array"

  cellseparator = FormulaConfig.array['cellseparator']

  def setalignments(self, alignments):
    self.alignments = alignments
    self.output = TaggedOutput().settag('span class="arrayrow"', True)
    return self

  def parsebit(self, pos):
    "Parse a whole row"
    index = 0
    pos.pushending(self.cellseparator, optional=True)
    while not pos.finished():
      cell = self.createcell(index)
      cell.parsebit(pos)
      self.add(cell)
      index += 1
      pos.checkskip(self.cellseparator)
    if len(self.contents) == 0:
      self.output = EmptyOutput()

  def createcell(self, index):
    "Create the cell that corresponds to the given index."
    alignment = self.alignments[index % len(self.alignments)]
    return self.factory.create(FormulaCell).setalignment(alignment)

class MultiRowFormula(CommandBit):
  "A formula with multiple rows."

  def parserows(self, pos):
    "Parse all rows, finish when no more row ends"
    self.rows = []
    first = True
    for row in self.iteraterows(pos):
      if first:
        first = False
      else:
        # intersparse empty rows
        self.addempty()
      row.parsebit(pos)
      self.addrow(row)
    self.size = len(self.rows)

  def iteraterows(self, pos):
    "Iterate over all rows, end when no more row ends"
    rowseparator = FormulaConfig.array['rowseparator']
    while True:
      pos.pushending(rowseparator, True)
      row = self.factory.create(FormulaRow)
      yield row.setalignments(self.alignments)
      if pos.checkfor(rowseparator):
        self.original += pos.popending(rowseparator)
      else:
        return

  def addempty(self):
    "Add an empty row."
    row = self.factory.create(FormulaRow).setalignments(self.alignments)
    for index, originalcell in enumerate(self.rows[-1].contents):
      cell = row.createcell(index)
      cell.add(FormulaConstant(u'â€…'))
      row.add(cell)
    self.addrow(row)

  def addrow(self, row):
    "Add a row to the contents and to the list of rows."
    self.rows.append(row)
    self.add(row)

class FormulaArray(MultiRowFormula):
  "An array within a formula"

  piece = 'array'

  def parsebit(self, pos):
    "Parse the array"
    self.output = TaggedOutput().settag('span class="array"', False)
    self.parsealignments(pos)
    self.parserows(pos)

  def parsealignments(self, pos):
    "Parse the different alignments"
    # vertical
    self.valign = 'c'
    literal = self.parsesquareliteral(pos)
    if literal:
      self.valign = literal
    # horizontal
    literal = self.parseliteral(pos)
    self.alignments = []
    for l in literal:
      self.alignments.append(l)

class FormulaMatrix(MultiRowFormula):
  "A matrix (array with center alignment)."

  piece = 'matrix'

  def parsebit(self, pos):
    "Parse the matrix, set alignments to 'c'."
    self.output = TaggedOutput().settag('span class="array"', False)
    self.valign = 'c'
    self.alignments = ['c']
    self.parserows(pos)

class FormulaCases(MultiRowFormula):
  "A cases statement"

  piece = 'cases'

  def parsebit(self, pos):
    "Parse the cases"
    self.output = ContentsOutput()
    self.alignments = ['l', 'l']
    self.parserows(pos)
    for row in self.contents:
      for cell in row.contents:
        cell.output.settag('span class="case align-l"', True)
        cell.contents.append(FormulaConstant(u'â€ƒ'))
    array = TaggedBit().complete(self.contents, 'span class="bracketcases"', True)
    brace = BigBracket(len(self.contents), '{', 'l')
    self.contents = brace.getcontents() + [array]

class EquationEnvironment(MultiRowFormula):
  "A \\begin{}...\\end equation environment with rows and cells."

  def parsebit(self, pos):
    "Parse the whole environment."
    self.output = TaggedOutput().settag('span class="environment"', False)
    environment = self.piece.replace('*', '')
    if environment in FormulaConfig.environments:
      self.alignments = FormulaConfig.environments[environment]
    else:
      Trace.error('Unknown equation environment ' + self.piece)
      self.alignments = ['l']
    self.parserows(pos)

class BeginCommand(CommandBit):
  "A \\begin{}...\end command and what it entails (array, cases, aligned)"

  commandmap = {FormulaConfig.array['begin']:''}

  types = [FormulaEquation, FormulaArray, FormulaCases, FormulaMatrix]

  def parsebit(self, pos):
    "Parse the begin command"
    command = self.parseliteral(pos)
    bit = self.findbit(command)
    ending = FormulaConfig.array['end'] + '{' + command + '}'
    pos.pushending(ending)
    bit.parsebit(pos)
    self.add(bit)
    self.original += pos.popending(ending)
    self.size = bit.size

  def findbit(self, piece):
    "Find the command bit corresponding to the \\begin{piece}"
    for type in BeginCommand.types:
      if piece.replace('*', '') == type.piece:
        return self.factory.create(type)
    bit = self.factory.create(EquationEnvironment)
    bit.piece = piece
    return bit

FormulaCommand.types += [BeginCommand]


import datetime


class CombiningFunction(OneParamFunction):

  commandmap = FormulaConfig.combiningfunctions

  def parsebit(self, pos):
    "Parse a combining function."
    self.type = 'alpha'
    combining = self.translated
    parameter = self.parsesingleparameter(pos)
    if not parameter:
      Trace.error('Empty parameter for combining function ' + self.command)
    elif len(parameter.extracttext()) != 1:
      Trace.error('Applying combining function ' + self.command + ' to invalid string "' + parameter.extracttext() + '"')
    self.contents.append(Constant(combining))

  def parsesingleparameter(self, pos):
    "Parse a parameter, or a single letter."
    self.factory.clearskipped(pos)
    if pos.finished():
      Trace.error('Error while parsing single parameter at ' + pos.identifier())
      return None
    if self.factory.detecttype(Bracket, pos) \
        or self.factory.detecttype(FormulaCommand, pos):
      return self.parseparameter(pos)
    letter = FormulaConstant(pos.skipcurrent())
    self.add(letter)
    return letter

class DecoratingFunction(OneParamFunction):
  "A function that decorates some bit of text"

  commandmap = FormulaConfig.decoratingfunctions

  def parsebit(self, pos):
    "Parse a decorating function"
    self.type = 'alpha'
    symbol = self.translated
    self.symbol = TaggedBit().constant(symbol, 'span class="symbolover"')
    self.parameter = self.parseparameter(pos)
    self.output = TaggedOutput().settag('span class="withsymbol"')
    self.contents.insert(0, self.symbol)
    self.parameter.output = TaggedOutput().settag('span class="undersymbol"')
    self.simplifyifpossible()

class LimitCommand(EmptyCommand):
  "A command which accepts limits above and below, in display mode."

  commandmap = FormulaConfig.limitcommands

  def parsebit(self, pos):
    "Parse a limit command."
    pieces = BigSymbol(self.translated).getpieces()
    self.output = TaggedOutput().settag('span class="limits"')
    for piece in pieces:
      self.contents.append(TaggedBit().constant(piece, 'span class="limit"'))

class LimitPreviousCommand(LimitCommand):
  "A command to limit the previous command."

  commandmap = None

  def parsebit(self, pos):
    "Do nothing."
    self.output = TaggedOutput().settag('span class="limits"')
    self.factory.clearskipped(pos)

  def __unicode__(self):
    "Return a printable representation."
    return 'Limit previous command'

class LimitsProcessor(MathsProcessor):
  "A processor for limits inside an element."

  def process(self, contents, index):
    "Process the limits for an element."
    if Options.simplemath:
      return
    if self.checklimits(contents, index):
      self.modifylimits(contents, index)
    if self.checkscript(contents, index) and self.checkscript(contents, index + 1):
      self.modifyscripts(contents, index)

  def checklimits(self, contents, index):
    "Check if the current position has a limits command."
    if not DocumentParameters.displaymode:
      return False
    if self.checkcommand(contents, index + 1, LimitPreviousCommand):
      self.limitsahead(contents, index)
      return False
    if not isinstance(contents[index], LimitCommand):
      return False
    return self.checkscript(contents, index + 1)

  def limitsahead(self, contents, index):
    "Limit the current element based on the next."
    contents[index + 1].add(contents[index].clone())
    contents[index].output = EmptyOutput()

  def modifylimits(self, contents, index):
    "Modify a limits commands so that the limits appear above and below."
    limited = contents[index]
    subscript = self.getlimit(contents, index + 1)
    limited.contents.append(subscript)
    if self.checkscript(contents, index + 1):
      superscript = self.getlimit(contents, index  + 1)
    else:
      superscript = TaggedBit().constant(u'âŸ', 'sup class="limit"')
    limited.contents.insert(0, superscript)

  def getlimit(self, contents, index):
    "Get the limit for a limits command."
    limit = self.getscript(contents, index)
    limit.output.tag = limit.output.tag.replace('script', 'limit')
    return limit

  def modifyscripts(self, contents, index):
    "Modify the super- and subscript to appear vertically aligned."
    subscript = self.getscript(contents, index)
    # subscript removed so instead of index + 1 we get index again
    superscript = self.getscript(contents, index)
    scripts = TaggedBit().complete([superscript, subscript], 'span class="scripts"')
    contents.insert(index, scripts)

  def checkscript(self, contents, index):
    "Check if the current element is a sub- or superscript."
    return self.checkcommand(contents, index, SymbolFunction)

  def checkcommand(self, contents, index, type):
    "Check for the given type as the current element."
    if len(contents) <= index:
      return False
    return isinstance(contents[index], type)

  def getscript(self, contents, index):
    "Get the sub- or superscript."
    bit = contents[index]
    bit.output.tag += ' class="script"'
    del contents[index]
    return bit

class BracketCommand(OneParamFunction):
  "A command which defines a bracket."

  commandmap = FormulaConfig.bracketcommands

  def parsebit(self, pos):
    "Parse the bracket."
    OneParamFunction.parsebit(self, pos)

  def create(self, direction, character):
    "Create the bracket for the given character."
    self.original = character
    self.command = '\\' + direction
    self.contents = [FormulaConstant(character)]
    return self

class BracketProcessor(MathsProcessor):
  "A processor for bracket commands."

  def process(self, contents, index):
    "Convert the bracket using Unicode pieces, if possible."
    if Options.simplemath:
      return
    if self.checkleft(contents, index):
      return self.processleft(contents, index)

  def processleft(self, contents, index):
    "Process a left bracket."
    rightindex = self.findright(contents, index + 1)
    if not rightindex:
      return
    size = self.findmax(contents, index, rightindex)
    self.resize(contents[index], size)
    self.resize(contents[rightindex], size)

  def checkleft(self, contents, index):
    "Check if the command at the given index is left."
    return self.checkdirection(contents[index], '\\left')
  
  def checkright(self, contents, index):
    "Check if the command at the given index is right."
    return self.checkdirection(contents[index], '\\right')

  def checkdirection(self, bit, command):
    "Check if the given bit is the desired bracket command."
    if not isinstance(bit, BracketCommand):
      return False
    return bit.command == command

  def findright(self, contents, index):
    "Find the right bracket starting at the given index, or 0."
    depth = 1
    while index < len(contents):
      if self.checkleft(contents, index):
        depth += 1
      if self.checkright(contents, index):
        depth -= 1
      if depth == 0:
        return index
      index += 1
    return None

  def findmax(self, contents, leftindex, rightindex):
    "Find the max size of the contents between the two given indices."
    sliced = contents[leftindex:rightindex]
    return max([element.size for element in sliced])

  def resize(self, command, size):
    "Resize a bracket command to the given size."
    character = command.extracttext()
    alignment = command.command.replace('\\', '')
    bracket = BigBracket(size, character, alignment)
    command.output = ContentsOutput()
    command.contents = bracket.getcontents()

class TodayCommand(EmptyCommand):
  "Shows today's date."

  commandmap = None

  def parsebit(self, pos):
    "Parse a command without parameters"
    self.output = FixedOutput()
    self.html = [datetime.date.today().strftime('%b %d, %Y')]


FormulaCommand.types += [
    DecoratingFunction, CombiningFunction, LimitCommand, BracketCommand,
    ]

FormulaProcessor.processors += [
    LimitsProcessor(), BracketProcessor(),
    ]



class ParameterDefinition(object):
  "The definition of a parameter in a hybrid function."
  "[] parameters are optional, {} parameters are mandatory."
  "Each parameter has a one-character name, like {$1} or {$p}."
  "A parameter that ends in ! like {$p!} is a literal."
  "Example: [$1]{$p!} reads an optional parameter $1 and a literal mandatory parameter p."

  parambrackets = [('[', ']'), ('{', '}')]

  def __init__(self):
    self.name = None
    self.literal = False
    self.optional = False
    self.value = None
    self.literalvalue = None

  def parse(self, pos):
    "Parse a parameter definition: [$0], {$x}, {$1!}..."
    for (opening, closing) in ParameterDefinition.parambrackets:
      if pos.checkskip(opening):
        if opening == '[':
          self.optional = True
        if not pos.checkskip('$'):
          Trace.error('Wrong parameter name, did you mean $' + pos.current() + '?')
          return None
        self.name = pos.skipcurrent()
        if pos.checkskip('!'):
          self.literal = True
        if not pos.checkskip(closing):
          Trace.error('Wrong parameter closing ' + pos.skipcurrent())
          return None
        return self
    Trace.error('Wrong character in parameter template: ' + pos.skipcurrent())
    return None

  def read(self, pos, function):
    "Read the parameter itself using the definition."
    if self.literal:
      if self.optional:
        self.literalvalue = function.parsesquareliteral(pos)
      else:
        self.literalvalue = function.parseliteral(pos)
      if self.literalvalue:
        self.value = FormulaConstant(self.literalvalue)
    elif self.optional:
      self.value = function.parsesquare(pos)
    else:
      self.value = function.parseparameter(pos)

  def __unicode__(self):
    "Return a printable representation."
    result = 'param ' + self.name
    if self.value:
      result += ': ' + unicode(self.value)
    else:
      result += ' (empty)'
    return result

class ParameterFunction(CommandBit):
  "A function with a variable number of parameters defined in a template."
  "The parameters are defined as a parameter definition."

  def readparams(self, readtemplate, pos):
    "Read the params according to the template."
    self.params = dict()
    for paramdef in self.paramdefs(readtemplate):
      paramdef.read(pos, self)
      self.params['$' + paramdef.name] = paramdef

  def paramdefs(self, readtemplate):
    "Read each param definition in the template"
    pos = TextPosition(readtemplate)
    while not pos.finished():
      paramdef = ParameterDefinition().parse(pos)
      if paramdef:
        yield paramdef

  def getparam(self, name):
    "Get a parameter as parsed."
    if not name in self.params:
      return None
    return self.params[name]

  def getvalue(self, name):
    "Get the value of a parameter."
    return self.getparam(name).value

  def getliteralvalue(self, name):
    "Get the literal value of a parameter."
    param = self.getparam(name)
    if not param or not param.literalvalue:
      return None
    return param.literalvalue

class HybridFunction(ParameterFunction):
  """
  A parameter function where the output is also defined using a template.
  The template can use a number of functions; each function has an associated
  tag.
  Example: [f0{$1},span class="fbox"] defines a function f0 which corresponds
  to a span of class fbox, yielding <span class="fbox">$1</span>.
  Literal parameters can be used in tags definitions:
    [f0{$1},span style="color: $p;"]
  yields <span style="color: $p;">$1</span>, where $p is a literal parameter.
  Sizes can be specified in hybridsizes, e.g. adding parameter sizes. By
  default the resulting size is the max of all arguments. Sizes are used
  to generate the right parameters.
  A function followed by a single / is output as a self-closing XHTML tag:
    [f0/,hr]
  will generate <hr/>.
  """

  commandmap = FormulaConfig.hybridfunctions

  def parsebit(self, pos):
    "Parse a function with [] and {} parameters"
    readtemplate = self.translated[0]
    writetemplate = self.translated[1]
    self.readparams(readtemplate, pos)
    self.contents = self.writeparams(writetemplate)
    self.computehybridsize()

  def writeparams(self, writetemplate):
    "Write all params according to the template"
    return self.writepos(TextPosition(writetemplate))

  def writepos(self, pos):
    "Write all params as read in the parse position."
    result = []
    while not pos.finished():
      if pos.checkskip('$'):
        param = self.writeparam(pos)
        if param:
          result.append(param)
      elif pos.checkskip('f'):
        function = self.writefunction(pos)
        if function:
          function.type = None
          result.append(function)
      elif pos.checkskip('('):
        result.append(self.writebracket('left', '('))
      elif pos.checkskip(')'):
        result.append(self.writebracket('right', ')'))
      else:
        result.append(FormulaConstant(pos.skipcurrent()))
    return result

  def writeparam(self, pos):
    "Write a single param of the form $0, $x..."
    name = '$' + pos.skipcurrent()
    if not name in self.params:
      Trace.error('Unknown parameter ' + name)
      return None
    if not self.params[name]:
      return None
    if pos.checkskip('.'):
      self.params[name].value.type = pos.globalpha()
    return self.params[name].value

  def writefunction(self, pos):
    "Write a single function f0,...,fn."
    tag = self.readtag(pos)
    if not tag:
      return None
    if pos.checkskip('/'):
      # self-closing XHTML tag, such as <hr/>
      return TaggedBit().selfcomplete(tag)
    if not pos.checkskip('{'):
      Trace.error('Function should be defined in {}')
      return None
    pos.pushending('}')
    contents = self.writepos(pos)
    pos.popending()
    if len(contents) == 0:
      return None
    return TaggedBit().complete(contents, tag)

  def readtag(self, pos):
    "Get the tag corresponding to the given index. Does parameter substitution."
    if not pos.current().isdigit():
      Trace.error('Function should be f0,...,f9: f' + pos.current())
      return None
    index = int(pos.skipcurrent())
    if 2 + index > len(self.translated):
      Trace.error('Function f' + unicode(index) + ' is not defined')
      return None
    tag = self.translated[2 + index]
    if not '$' in tag:
      return tag
    for variable in self.params:
      if variable in tag:
        param = self.params[variable]
        if not param.literal:
          Trace.error('Parameters in tag ' + tag + ' should be literal: {' + variable + '!}')
          continue
        if param.literalvalue:
          value = param.literalvalue
        else:
          value = ''
        tag = tag.replace(variable, value)
    return tag

  def writebracket(self, direction, character):
    "Return a new bracket looking at the given direction."
    return self.factory.create(BracketCommand).create(direction, character)
  
  def computehybridsize(self):
    "Compute the size of the hybrid function."
    if not self.command in HybridSize.configsizes:
      self.computesize()
      return
    self.size = HybridSize().getsize(self)
    # set the size in all elements at first level
    for element in self.contents:
      element.size = self.size

class HybridSize(object):
  "The size associated with a hybrid function."

  configsizes = FormulaConfig.hybridsizes

  def getsize(self, function):
    "Read the size for a function and parse it."
    sizestring = self.configsizes[function.command]
    for name in function.params:
      if name in sizestring:
        size = function.params[name].value.computesize()
        sizestring = sizestring.replace(name, unicode(size))
    if '$' in sizestring:
      Trace.error('Unconverted variable in hybrid size: ' + sizestring)
      return 1
    return eval(sizestring)


FormulaCommand.types += [HybridFunction]









class HeaderParser(Parser):
  "Parses the LyX header"

  def parse(self, reader):
    "Parse header parameters into a dictionary, return the preamble."
    contents = []
    self.parseending(reader, lambda: self.parseline(reader, contents))
    # skip last line
    reader.nextline()
    return contents

  def parseline(self, reader, contents):
    "Parse a single line as a parameter or as a start"
    line = reader.currentline()
    if line.startswith(HeaderConfig.parameters['branch']):
      self.parsebranch(reader)
      return
    elif line.startswith(HeaderConfig.parameters['lstset']):
      LstParser().parselstset(reader)
      return
    elif line.startswith(HeaderConfig.parameters['beginpreamble']):
      contents.append(self.factory.createcontainer(reader))
      return
    # no match
    self.parseparameter(reader)

  def parsebranch(self, reader):
    "Parse all branch definitions."
    branch = reader.currentline().split()[1]
    reader.nextline()
    subparser = HeaderParser().complete(HeaderConfig.parameters['endbranch'])
    subparser.parse(reader)
    options = BranchOptions(branch)
    for key in subparser.parameters:
      options.set(key, subparser.parameters[key])
    Options.branches[branch] = options

  def complete(self, ending):
    "Complete the parser with the given ending."
    self.ending = ending
    return self

class PreambleParser(Parser):
  "A parser for the LyX preamble."

  preamble = []

  def parse(self, reader):
    "Parse the full preamble with all statements."
    self.ending = HeaderConfig.parameters['endpreamble']
    self.parseending(reader, lambda: self.parsepreambleline(reader))
    return []

  def parsepreambleline(self, reader):
    "Parse a single preamble line."
    PreambleParser.preamble.append(reader.currentline())
    reader.nextline()

class LstParser(object):
  "Parse global and local lstparams."

  globalparams = dict()

  def parselstset(self, reader):
    "Parse a declaration of lstparams in lstset."
    paramtext = self.extractlstset(reader)
    if not '{' in paramtext:
      Trace.error('Missing opening bracket in lstset: ' + paramtext)
      return
    lefttext = paramtext.split('{')[1]
    croppedtext = lefttext[:-1]
    LstParser.globalparams = self.parselstparams(croppedtext)

  def extractlstset(self, reader):
    "Extract the global lstset parameters."
    paramtext = ''
    while not reader.finished():
      paramtext += reader.currentline()
      reader.nextline()
      if paramtext.endswith('}'):
        return paramtext
    Trace.error('Could not find end of \\lstset settings; aborting')

  def parsecontainer(self, container):
    "Parse some lstparams from elyxer.a container."
    container.lstparams = LstParser.globalparams.copy()
    paramlist = container.getparameterlist('lstparams')
    container.lstparams.update(self.parselstparams(paramlist))

  def parselstparams(self, paramlist):
    "Process a number of lstparams from elyxer.a list."
    paramdict = dict()
    for param in paramlist:
      if not '=' in param:
        if len(param.strip()) > 0:
          Trace.error('Invalid listing parameter ' + param)
      else:
        key, value = param.split('=', 1)
        paramdict[key] = value
    return paramdict




class MacroDefinition(CommandBit):
  "A function that defines a new command (a macro)."

  macros = dict()

  def parsebit(self, pos):
    "Parse the function that defines the macro."
    self.output = EmptyOutput()
    self.parameternumber = 0
    self.defaults = []
    self.factory.defining = True
    self.parseparameters(pos)
    self.factory.defining = False
    Trace.debug('New command ' + self.newcommand + ' (' + \
        unicode(self.parameternumber) + ' parameters)')
    self.macros[self.newcommand] = self

  def parseparameters(self, pos):
    "Parse all optional parameters (number of parameters, default values)"
    "and the mandatory definition."
    self.newcommand = self.parsenewcommand(pos)
    # parse number of parameters
    literal = self.parsesquareliteral(pos)
    if literal:
      self.parameternumber = int(literal)
    # parse all default values
    bracket = self.parsesquare(pos)
    while bracket:
      self.defaults.append(bracket)
      bracket = self.parsesquare(pos)
    # parse mandatory definition
    self.definition = self.parseparameter(pos)

  def parsenewcommand(self, pos):
    "Parse the name of the new command."
    self.factory.clearskipped(pos)
    if self.factory.detecttype(Bracket, pos):
      return self.parseliteral(pos)
    if self.factory.detecttype(FormulaCommand, pos):
      return self.factory.create(FormulaCommand).extractcommand(pos)
    Trace.error('Unknown formula bit in defining function at ' + pos.identifier())
    return 'unknown'

  def instantiate(self):
    "Return an instance of the macro."
    return self.definition.clone()

class MacroParameter(FormulaBit):
  "A parameter from elyxer.a macro."

  def detect(self, pos):
    "Find a macro parameter: #n."
    return pos.checkfor('#')

  def parsebit(self, pos):
    "Parse the parameter: #n."
    if not pos.checkskip('#'):
      Trace.error('Missing parameter start #.')
      return
    self.number = int(pos.skipcurrent())
    self.original = '#' + unicode(self.number)
    self.contents = [TaggedBit().constant('#' + unicode(self.number), 'span class="unknown"')]

class MacroFunction(CommandBit):
  "A function that was defined using a macro."

  commandmap = MacroDefinition.macros

  def parsebit(self, pos):
    "Parse a number of input parameters."
    self.output = FilteredOutput()
    self.values = []
    macro = self.translated
    self.parseparameters(pos, macro)
    self.completemacro(macro)

  def parseparameters(self, pos, macro):
    "Parse as many parameters as are needed."
    self.parseoptional(pos, list(macro.defaults))
    self.parsemandatory(pos, macro.parameternumber - len(macro.defaults))
    if len(self.values) < macro.parameternumber:
      Trace.error('Missing parameters in macro ' + unicode(self))

  def parseoptional(self, pos, defaults):
    "Parse optional parameters."
    optional = []
    while self.factory.detecttype(SquareBracket, pos):
      optional.append(self.parsesquare(pos))
      if len(optional) > len(defaults):
        break
    for value in optional:
      default = defaults.pop()
      if len(value.contents) > 0:
        self.values.append(value)
      else:
        self.values.append(default)
    self.values += defaults

  def parsemandatory(self, pos, number):
    "Parse a number of mandatory parameters."
    for index in range(number):
      parameter = self.parsemacroparameter(pos, number - index)
      if not parameter:
        return
      self.values.append(parameter)

  def parsemacroparameter(self, pos, remaining):
    "Parse a macro parameter. Could be a bracket or a single letter."
    "If there are just two values remaining and there is a running number,"
    "parse as two separater numbers."
    self.factory.clearskipped(pos)
    if pos.finished():
      return None
    if self.factory.detecttype(FormulaNumber, pos):
      return self.parsenumbers(pos, remaining)
    return self.parseparameter(pos)

  def parsenumbers(self, pos, remaining):
    "Parse the remaining parameters as a running number."
    "For example, 12 would be {1}{2}."
    number = self.factory.parsetype(FormulaNumber, pos)
    if not len(number.original) == remaining:
      return number
    for digit in number.original:
      value = self.factory.create(FormulaNumber)
      value.add(FormulaConstant(digit))
      value.type = number
      self.values.append(value)
    return None

  def completemacro(self, macro):
    "Complete the macro with the parameters read."
    self.contents = [macro.instantiate()]
    replaced = [False] * len(self.values)
    for parameter in self.searchall(MacroParameter):
      index = parameter.number - 1
      if index >= len(self.values):
        Trace.error('Macro parameter index out of bounds: ' + unicode(index))
        return
      replaced[index] = True
      parameter.contents = [self.values[index].clone()]
    for index in range(len(self.values)):
      if not replaced[index]:
        self.addfilter(index, self.values[index])

  def addfilter(self, index, value):
    "Add a filter for the given parameter number and parameter value."
    original = '#' + unicode(index + 1)
    value = ''.join(self.values[0].gethtml())
    self.output.addfilter(original, value)

class FormulaMacro(Formula):
  "A math macro defined in an inset."

  def __init__(self):
    self.parser = MacroParser()
    self.output = EmptyOutput()

  def __unicode__(self):
    "Return a printable representation."
    return 'Math macro'

FormulaFactory.types += [ MacroParameter ]

FormulaCommand.types += [
    MacroFunction,
    ]



def math2html(formula):
  "Convert some TeX math to HTML."
  factory = FormulaFactory()
  whole = factory.parseformula(formula)
  FormulaProcessor().process(whole)
  whole.process()
  return ''.join(whole.gethtml())

def main():
  "Main function, called if invoked from elyxer.the command line"
  args = sys.argv
  Options().parseoptions(args)
  if len(args) != 1:
    Trace.error('Usage: math2html.py escaped_string')
    exit()
  result = math2html(args[0])
  Trace.message(result)

if __name__ == '__main__':
  main()

                         usr/local/lib/python2.7/dist-packages/docutils/utils/math/math2html.pyc                             0100644 0000000 0000062 00000752765 13077704402 024603  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   s·  d  d l  Z  d e f d „  ƒ  YZ d  d l Z d  d l  Z  d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d	 „  ƒ  YZ d
 e f d „  ƒ  YZ d e f d „  ƒ  YZ	 d e f d „  ƒ  YZ
 d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d  e f d! „  ƒ  YZ d" e f d# „  ƒ  YZ d$ e f d% „  ƒ  YZ d& e f d' „  ƒ  YZ d  d l Z d( e f d) „  ƒ  YZ d* e f d+ „  ƒ  YZ d, e f d- „  ƒ  YZ d. e f d/ „  ƒ  YZ d0 e f d1 „  ƒ  YZ d2 e f d3 „  ƒ  YZ d4 e f d5 „  ƒ  YZ d6 e f d7 „  ƒ  YZ d8 e f d9 „  ƒ  YZ  d: e f d; „  ƒ  YZ! d< e f d= „  ƒ  YZ" d> e" f d? „  ƒ  YZ# d@ e" f dA „  ƒ  YZ$ dB e" f dC „  ƒ  YZ% dD e% f dE „  ƒ  YZ& dF e% f dG „  ƒ  YZ' dH e" f dI „  ƒ  YZ( d  d l  Z  d  d l) Z) dJ e f dK „  ƒ  YZ* dL e f dM „  ƒ  YZ+ dN e f dO „  ƒ  YZ, dP e f dQ „  ƒ  YZ- dR e f dS „  ƒ  YZ. dT e, f dU „  ƒ  YZ/ dV e/ f dW „  ƒ  YZ0 dX e/ f dY „  ƒ  YZ1 dZ e f d[ „  ƒ  YZ2 d\ e2 f d] „  ƒ  YZ3 d^ e3 f d_ „  ƒ  YZ4 d` e2 f da „  ƒ  YZ5 db e5 f dc „  ƒ  YZ6 dd e2 f de „  ƒ  YZ7 df e f dg „  ƒ  YZ8 dh e f di „  ƒ  YZ9 dj e9 f dk „  ƒ  YZ: dl e2 f dm „  ƒ  YZ; dn e; f do „  ƒ  YZ< dp e6 f dq „  ƒ  YZ= dr e; f ds „  ƒ  YZ> dt e; f du „  ƒ  YZ? dv e; f dw „  ƒ  YZ@ dx e; f dy „  ƒ  YZA dz e; f d{ „  ƒ  YZB d| e; f d} „  ƒ  YZC d~ eC f d „  ƒ  YZD d€ e f d „  ƒ  YZE d‚ e f dƒ „  ƒ  YZF d„ e2 f d… „  ƒ  YZG d† e; f d‡ „  ƒ  YZH dˆ e f d‰ „  ƒ  YZI d  d lJ ZJ d  d lK ZK dŠ e f d‹ „  ƒ  YZL eL ƒ  eL _M dŒ e f d „  ƒ  YZN d eN f d „  ƒ  YZO d e f d‘ „  ƒ  YZP d’ eP f d“ „  ƒ  YZQ eQ ƒ  eP _R eP ƒ  eP _S d” e f d• „  ƒ  YZT d– e2 f d— „  ƒ  YZU d˜ e2 f d™ „  ƒ  YZV dš e7 f d› „  ƒ  YZW dœ e7 f d „  ƒ  YZX d e7 f dŸ „  ƒ  YZY d  e7 f d¡ „  ƒ  YZZ d¢ e7 f d£ „  ƒ  YZ[ d¤ e7 f d¥ „  ƒ  YZ\ d¦ e7 f d§ „  ƒ  YZ] d¨ e7 f d© „  ƒ  YZ^ dª e7 f d« „  ƒ  YZ_ d¬ e7 f d­ „  ƒ  YZ` d® e3 f d¯ „  ƒ  YZa d° e2 f d± „  ƒ  YZb d² e2 f d³ „  ƒ  YZc d´ e2 f dµ „  ƒ  YZd d¶ e2 f d· „  ƒ  YZe d¸ ee f d¹ „  ƒ  YZf dº e2 f d» „  ƒ  YZg d¼ e7 f d½ „  ƒ  YZh d¾ e3 f d¿ „  ƒ  YZi dÀ e2 f dÁ „  ƒ  YZj dÂ ej f dÃ „  ƒ  YZk dÄ ek f dÅ „  ƒ  YZl dÆ e" f dÇ „  ƒ  YZm dÈ e f dÉ „  ƒ  YZn dÊ e f dË „  ƒ  YZo dÌ ej f dÍ „  ƒ  YZp dÎ ej f dÏ „  ƒ  YZq dĞ e; f dÑ „  ƒ  YZr dÒ er f dÓ „  ƒ  YZs dÔ es f dÕ „  ƒ  YZt dÖ es f d× „  ƒ  YZu dØ et f dÙ „  ƒ  YZv dÚ es f dÛ „  ƒ  YZw dÜ es f dİ „  ƒ  YZx dŞ es f dß „  ƒ  YZy dà es f dá „  ƒ  YZz dâ ew f dã „  ƒ  YZ{ eI j| er ex g 7_| ev et ew e{ ez ey eu g er _| dä e f då „  ƒ  YZ} dæ e} f dç „  ƒ  YZ~ dè es f dé „  ƒ  YZ dê er f dë „  ƒ  YZ€ dì er f dí „  ƒ  YZ dî es f dï „  ƒ  YZ‚ dğ e‚ f dñ „  ƒ  YZƒ dò e‚ f dó „  ƒ  YZ„ dô e‚ f dõ „  ƒ  YZ… dö e‚ f d÷ „  ƒ  YZ† dø es f dù „  ƒ  YZ‡ er j| e‡ g 7_| d  d lˆ Zˆ dú ew f dû „  ƒ  YZ‰ dü ew f dı „  ƒ  YZŠ dş et f dÿ „  ƒ  YZ‹ d e‹ f d„  ƒ  YZŒ deE f d„  ƒ  YZ dew f d„  ƒ  YZ deE f d„  ƒ  YZ det f d	„  ƒ  YZ er j| eŠ e‰ e‹ e g 7_| eF j‘ e ƒ  e ƒ  g 7_‘ d
e f d„  ƒ  YZ’ des f d„  ƒ  YZ“ de“ f d„  ƒ  YZ” de f d„  ƒ  YZ• er j| e” g 7_| de f d„  ƒ  YZ– de f d„  ƒ  YZ— de f d„  ƒ  YZ˜ des f d„  ƒ  YZ™ de; f d„  ƒ  YZš des f d„  ƒ  YZ› deG f d„  ƒ  YZœ eI j| eš g 7_| er j| e› g 7_| d „  Z d!„  Z eŸ d"k r³e ƒ  n  d S(#  iÿÿÿÿNt   Tracec           B   s   e  Z d  Z e Z e Z e Z d Z d „  Z	 d „  Z
 d „  Z d „  Z d „  Z e e	 ƒ Z	 e e
 ƒ Z
 e e ƒ Z e e ƒ Z e e ƒ Z RS(   s   A tracing classc         C   s.   t  j s t  j r d St  j | t j ƒ d S(   s   Show a debug messageN(   R    t	   debugmodet	   quietmodet   showt   syst   stdout(   t   clst   message(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   debug%   s    c         C   sF   t  j r d St  j r/ t  j r/ t  j | } n  t  j | t j ƒ d S(   s   Show a trace messageN(   R    R   t   prefixt   showlinesmodeR   R   R   (   R   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   +   s
    	c         C   sC   d | } t  j r, t  j r, t  j | } n  t  j | t j ƒ d S(   s   Show an error messages   * N(   R    R	   R
   R   R   t   stderr(   R   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   error3   s    
c         C   s   t  j d | ƒ t d ƒ d S(   s#   Show an error message and terminates   FATAL: iÿÿÿÿN(   R    R   t   exit(   R   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   fatal:   s    c         C   s6   t  j d k  r! | j d ƒ } n  | j | d ƒ d S(   s   Show a message out of a channeli   i    s   utf-8s   
N(   i   i    (   R   t   version_infot   encodet   write(   R   R   t   channel(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   ?   s    N(   t   __name__t
   __module__t   __doc__t   FalseR   R   R
   t   NoneR	   R   R   R   R   R   t   classmethod(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR       s   					t   BibStylesConfigc           B   sk  e  Z d  Z i d d 6d d 6d d 6Z i d d 6d d 6d	 d 6Z i d
 d 6d d 6d d 6d d 6Z i d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d  d! 6d" d 6d d 6Z i d# d$ 6d% d& 6d% d' 6Z i d( d 6d) d 6d" d 6d* d 6Z i d+ d 6d, d 6d- d 6d. d 6d" d 6d/ d 6Z	 i d0 d 6d1 d 6d" d 6d2 d 6Z
 RS(3   s+   Configuration class from elyxer.config fileuy   $authors. $title. <i>$journal</i>,{ {$volume:}$pages,} $month $year.{ doi: $doi.}{ URL <a href="$url">$url</a>.}{ $note.}u   @articleu   $surname($year)u   citeuS   $authors. <i>$title</i>. $publisher, $year.{ URL <a href="$url">$url</a>.}{ $note.}u   defaultu˜   $authors. $title.{ <i>$journal</i>{, {$volume}{($number)}}{: $pages}{, $year}.}{ <a href="$url">$url</a>.}{ <a href="$filename">$filename</a>.}{ $note.}u   $Sur$YYut   $authors. $title.{ <i>$journal</i>,} $year.{ <a href="$url">$url</a>.}{ <a href="$filename">$filename</a>.}{ $note.}ur   $authors. $year. $title. <i>$journal</i>, <b>$volume</b>($number), $pages.{ URL <a href="$url">$url</a>.}{ $note.}uS   $authors. $year. <i>$title</i>. $publisher.{ URL <a href="$url">$url</a>.}{ $note.}u   @booku   $surname, $yearue   $authors: â€œ$titleâ€, <i>$journal</i>,{ pp. $pages,} $year.{ URL <a href="$url">$url</a>.}{ $note.}uj   {$authors: }<i>$title</i>{ ($editor, ed.)}.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}uW   $authors: <i>$title</i>.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}u   @bookletu   @conferenceu   @inbooku   $authors: <i>$title</i>{ in <i>$booktitle</i>{ ($editor, ed.)}}.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}u   @incollectionug   $authors: â€œ$titleâ€, <i>$booktitle</i>,{ pp. $pages,} $year.{ URL <a href="$url">$url</a>.}{ $note.}u   @inproceedingsu   @manualu   @mastersthesisuh   $authors: <i>$title</i>.{{ $publisher,}{ $howpublished,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}u   @miscu
   @phdthesisu   @proceedingsuG   $authors: <i>$title</i>, $year.{ URL <a href="$url">$url</a>.}{ $note.}u   @techreportuW   $authors: â€œ$titleâ€, <i>$journal</i>, $year.{ URL <a href="$url">$url</a>.}{ $note.}u   @unpublishedu   $indexu   ??u   YYu    u   authorsu   surnameu~   $authors, â€œ$titleâ€, <i>$journal</i>, vol. $volume, no. $number, pp. $pages, $year.{ URL <a href="$url">$url</a>.}{ $note.}uS   $authors, <i>$title</i>. $publisher, $year.{ URL <a href="$url">$url</a>.}{ $note.}uF   $authors, â€œ$titleâ€. $year.{ URL <a href="$url">$url</a>.}{ $note.}uv   $authors. $title.{ <i>$journal</i>{, {$volume}{($number)}}{:$pages}{, $year}.}{ URL <a href="$url">$url</a>.}{ $note.}u\   $authors. <i>$title</i>. $publisher,{ $month} $year.{ URL <a href="$url">$url</a>.}{ $note.}u~   $authors. $title.{ In <i>$booktitle</i> {($editor, ed.)}.} $publisher,{ $month} $year.{ URL <a href="$url">$url</a>.}{ $note.}uy   $authors. $title. { <i>$booktitle</i>{, {$volume}{($number)}}{:$pages}{, $year}.}{ URL <a href="$url">$url</a>.}{ $note.}uR   {$authors. }$title.{{ $publisher,} $year.}{ URL <a href="$url">$url</a>.}{ $note.}uy   $authors. $title. <i>$journal</i>, $year{;{<b>$volume</b>}{($number)}{:$pages}}.{ URL: <a href="$url">$url</a>.}{ $note.}uO   $authors. $title. {$publisher, }$year.{ URL: <a href="$url">$url</a>.}{ $note.}u`   $authors. $title; {$publisher, }$year.{ $howpublished.}{ URL: <a href="$url">$url</a>.}{ $note.}(   R   R   R   t   abbrvnatt   alphat   authordate2t   defaultt   defaulttagst   ieeetrt   plaint	   vancouver(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   R   sd   





t   BibTeXConfigc           B   s"   e  Z d  Z i d d 6d d 6Z RS(   s+   Configuration class from elyxer.config fileu   â€”u   --u   .u   ..(   R   R   R   t   replaced(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"      s   t   ContainerConfigc           B   sË  e  Z d  Z i d d 6d d 6d d 6d d 6d	 d
 6d	 d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d  6d! d" 6d# d$ 6Z i d% d& d' g d( 6d) g d* 6d+ d, d d- d" d d$ d d d d. d/ d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 d: d; d< d= d> g d? 6Z i d@ dA 6d dB 6d dC 6Z i d% d) 6dD dE 6dD dF 6d dG 6dH dI 6d dJ 6d dK 6d d 6dD dL 6dD dM 6dD dN 6dO dA 6dD dP 6d dQ 6dR dS 6dT dU 6dV dW 6d- dX 6dY dZ 6d[ d\ 6d] d^ 6d_ d` 6da db 6dc dd 6de df 6dg dh 6di dj 6dk dl 6dm dn 6do dp 6dq dr 6ds dt 6du dv 6dw dx 6dw dy 6dz d{ 6d| d} 6d~ d 6d€ d 6d/ d‚ 6dƒ d„ 6d… d† 6d‡ dˆ 6d‰ dŠ 6dY d‹ 6d[ dŒ 6d] d 6d] d 6d] d 6d] d 6d_ d‘ 6d‡ d’ 6de d“ 6dk d” 6dm d• 6dc d– 6di d— 6dm d˜ 6do d™ 6d_ dš 6dm d› 6dw dœ 6d d 6dŸ d  6d¡ d¢ 6dR d£ 6d¤ d¥ 6d¦ d§ 6d¨ d© 6dª d« 6d¬ d­ 6d® d¯ 6d° d± 6d² d³ 6d´ dµ 6d dC 6d¶ d· 6d¸ d¹ 6dº d» 6d¼ d½ 6d¾ d¿ 6dÀ dÁ 6dÀ dÂ 6dÃ dÄ 6dÅ dÆ 6d+ dÇ 6dÈ dÉ 6dÊ dË 6dÌ dÍ 6d
 dÎ 6d dÏ 6dD d	 6d d 6dD dĞ 6dD dÑ 6dD dÒ 6dD dÓ 6d dÔ 6d dÕ 6d dÖ 6d" d! 6dD d× 6dD dØ 6d d 6dD dÙ 6d. dÚ 6dÛ dÜ 6dİ dŞ 6dß dà 6dá dâ 6dã dä 6dD då 6dD dæ 6dD dç 6d$ dè 6dD dé 6d dê 6dD dë 6dD dì 6d d 6dD dí 6dD dî 6d d 6dD dï 6dğ dñ 6dD dò 6d  dó 6Z i dô dõ 6Z i dö d÷ g dø 6Z RS(ù   s+   Configuration class from elyxer.config fileu   \end_layoutu   Alignu   \baru
   BarredTextu   \seriesu   BoldTextu   </cellu   Cellu   \change_unchangedu   ChangeDeletedu   ChangeInsertedu   \coloru	   ColorTextu   \emphu   EmphaticTextu   \hfillu   Hfillu
   \end_insetu   Insetu   Layoutu   \end_documentu	   LyXFooteru   \end_headeru	   LyXHeaderu   </rowu   Rowu   \shapeu
   ShapedTextu   \sizeu   SizeTextu
   \strikeoutu	   StrikeOutu   \familyu
   TextFamilyu   \nounu   VersalitasTextu   StringContaineru   Constantu   FormulaConstantu   allowedu    u   clonedu   PlainLayoutu
   TaggedTextu   Captionu   LangLineu   Formulau   Bracketu   RawTextu   BibTagu   FormulaNumberu   AlphaCommandu   EmptyCommandu   OneParamFunctionu   SymbolFunctionu   TextFunctionu   FontFunctionu   CombiningFunctionu   DecoratingFunctionu   FormulaSymbolu   BracketCommandu   TeXCodeu	   extractedu   \end_deeperu   \begin_deeperu   \begin_insetu   \begin_layoutu   BlackBoxu   #LyXu   </lyxtabularu   <cellu   Columnu   <columnu   <rowu   \alignu   \bar defaultu   \bar nou   \begin_bodyu
   DeeperListu   \begin_documentu   \begin_headeru
   ShortTitleu   \begin_inset Argumentu   BoxInsetu   \begin_inset Boxu   Branchu   \begin_inset Branchu   \begin_inset Captionu   BiblioEntryu!   \begin_inset CommandInset bibitemu   BibTeXu    \begin_inset CommandInset bibtexu   BiblioCitationu"   \begin_inset CommandInset citationu   URLu   \begin_inset CommandInset hrefu   IncludeInsetu!   \begin_inset CommandInset includeu
   PrintIndexu%   \begin_inset CommandInset index_printu   Labelu   \begin_inset CommandInset labelu	   LineInsetu   \begin_inset CommandInset lineu   PrintNomenclatureu'   \begin_inset CommandInset nomencl_printu   NomenclatureEntryu&   \begin_inset CommandInset nomenclatureu	   Referenceu   \begin_inset CommandInset refu   TableOfContentsu   \begin_inset CommandInset tocu   ERTu   \begin_inset ERTu	   FlexInsetu   \begin_inset Flexu   NewfangledChunkRefu   \begin_inset Flex Chunkrefu   SideNoteu   \begin_inset Flex Marginnoteu   \begin_inset Flex Sidenoteu   FlexURLu   \begin_inset Flex URLu   Floatu   \begin_inset Floatu   ListOfu   \begin_inset FloatListu   Footnoteu   \begin_inset Footu   \begin_inset Formulau   FormulaMacrou   \begin_inset FormulaMacrou   Imageu   \begin_inset Graphicsu   IndexReferenceu   \begin_inset Indexu	   InfoInsetu   \begin_inset Infou!   \begin_inset LatexCommand bibitemu    \begin_inset LatexCommand bibtexu   \begin_inset LatexCommand citeu!   \begin_inset LatexCommand citealtu   \begin_inset LatexCommand citepu   \begin_inset LatexCommand citetu!   \begin_inset LatexCommand htmlurlu   \begin_inset LatexCommand indexu   \begin_inset LatexCommand labelu&   \begin_inset LatexCommand nomenclatureu#   \begin_inset LatexCommand prettyrefu$   \begin_inset LatexCommand printindexu+   \begin_inset LatexCommand printnomenclatureu   \begin_inset LatexCommand refu)   \begin_inset LatexCommand tableofcontentsu   \begin_inset LatexCommand urlu   \begin_inset LatexCommand vrefu   \begin_inset Marginalu   NewlineInsetu   \begin_inset Newlineu   NewPageInsetu   \begin_inset Newpageu   Noteu   \begin_inset Noteu   \begin_inset OptArgu   PhantomTextu   \begin_inset Phantomu   QuoteContaineru   \begin_inset Quotesu   Tableu   \begin_inset Tabularu	   InsetTextu   \begin_inset Textu   VerticalSpaceu   \begin_inset VSpaceu   Wrapu   \begin_inset Wrapu   Listingu   \begin_inset listingsu   ScriptInsetu   \begin_inset scriptu   Spaceu   \begin_inset spaceu   Abstractu   \begin_layout Abstractu   Authoru   \begin_layout Authoru   Bibliographyu   \begin_layout Bibliographyu   NewfangledChunku   \begin_layout Chunku   Descriptionu   \begin_layout Descriptionu   ListItemu   \begin_layout Enumerateu   \begin_layout Itemizeu   Listu   \begin_layout Listu   LyXCodeu   \begin_layout LyX-Codeu   \begin_layout Plainu   StandardLayoutu   \begin_layout Standardu   Titleu   \begin_layout Titleu   LyXPreambleu   \begin_preambleu   \change_deletedu   \change_insertedu   \color inheritu   \color noneu   \emph defaultu	   \emph offu   \emph onu   \emph toggleu	   \end_bodyu   \family defaultu   \family romanu   \labelwidthstringu   \langu   InsetLengthu   \lengthu	   LyXFormatu
   \lyxformatu   LyXLineu   \lyxlineu   Newlineu   \newlineu   NewPageu   \newpageu	   \noindentu   \noun defaultu	   \noun offu   \noun onu   \paragraph_spacingu   \series boldu   \series defaultu   \series mediumu   \shape defaultu	   \shape upu   \size normalu   StartAppendixu   \start_of_appendixu   \strikeout defaultu   \strikeout onu   \u   startcommandu   <lyxtabularu	   <featuresu   headers(	   R   R   R   t   endingst   extracttextt   startendingst   startst   stringt   table(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR$   ¤   sâ   
[

t   EscapeConfigc           B   sÚ   e  Z d  Z i d d 6d d 6d d 6d d 6d d	 6Z i d
 d 6d d 6d
 d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6Z i d d 6d d  6d! d" 6Z i d" d# 6Z i d$ d
 6d% d& 6d' d( 6Z i d) d( 6Z RS(*   s+   Configuration class from elyxer.config fileu    u   
u    â€” u    -- u    --- u   â€™u   'u   â€˜u   `u   Â u   \InsetSpace \space{}u   â€‰u   \InsetSpace \thinspace{}u   \InsetSpace ~u   \SpecialChar \-u   .u   \SpecialChar \@.u   â€¦u   \SpecialChar \ldots{}u   Â â–·Â u   \SpecialChar \menuseparatoru   -u   \SpecialChar \nobreakdash-u   /u   \SpecialChar \slash{}u    \SpecialChar \textcompwordmark{}u   \u
   \backslashu   &amp;u   &u   &lt;u   <u   &gt;u   >u   />u   &nbsp;u   &emsp;u   â€ƒu   &#8197;u   âŸu   â€…(	   R   R   R   t   charst   commandst   entitiest   htmlt	   iso885915t
   nonunicode(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR+   #  s$   &
t   FormulaConfigc           B   só  e  Z d  Z iI d d 6d d 6d d 6d d 6d	 d
 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d  6d! d" 6d# d$ 6d% d& 6d' d( 6d) d* 6d+ d, 6d% d- 6d. d/ 6d0 d1 6d0 d2 6d3 d4 6d5 d6 6d5 d7 6d8 d9 6d: d; 6d< d= 6d> d? 6d@ dA 6dB dC 6dD dE 6dF dG 6dH dI 6dJ dK 6dL dM 6dN dO 6dP dQ 6dR dS 6dT dU 6dV dW 6dX dY 6dZ d[ 6d\ d] 6d^ d_ 6d` da 6db dc 6dd de 6df dg 6dh di 6dj dk 6dl dm 6dn do 6dp dq 6dr ds 6dt du 6dv dw 6dx dy 6dz d{ 6d| d} 6d~ d 6d€ d 6dJ d‚ 6dƒ d„ 6d… d† 6d‡ dˆ 6d‰ dŠ 6d‹ dŒ 6d d 6Z i d d 6d‘ d’ 6d“ d” 6d• d– 6Z i d— d˜ d™ g dš 6d› dœ d g d 6dŸ d  d¡ g d¢ 6d£ d¤ d¥ g d¦ 6d§ d¨ d© dª g d« 6d¬ g d¬ 6d­ d¨ d® d¯ g d° 6d± g d± 6Z i d² d³ g d´ 6dµ d¶ g d· 6Z i d¸ d¹ 6dº d» 6d¸ d¼ 6d¸ d½ 6d¾ d¿ 6Z i dÀ dÁ 6dÂ dÃ 6dÄ dÅ 6dÆ dÇ 6dÂ dÈ 6dÉ dÊ 6dË dÌ 6dÍ dÎ 6dÏ dĞ 6dÑ dÒ 6dÀ dÓ 6dÔ dÕ 6dÆ dÖ 6dÄ d× 6dØ dÙ 6dÚ dÛ 6dÜ dİ 6dØ dŞ 6dß dà 6dá dâ 6dã dä 6då dæ 6dÏ dç 6dÜ dè 6då dé 6Z iRdê dë 6dì dí 6dî dï 6dğ dñ 6dò dó 6d‘ dô 6dõ dö 6d÷ dø 6dù dú 6dû dü 6dı dş 6dÿ d 6dd6dd6dd6dd6d	d
6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd 6d!d"6d#d$6d%d&6d'd(6d)d*6d+d,6d-d.6d/d06d1d26d3d46d5d66d7d86d9d:6dh d;6d<d=6d>d?6d@dA6dBdC6dDdE6dj dF6dGdH6dIdJ6dKdL6dMdN6dOdP6dQdR6dSdT6dUdV6dWdX6dYdZ6dl d[6d\d]6dn d^6dp d_6d`da6dr db6dcdd6dedf6dgdh6didj6dkdl6dmdn6dodp6dqdr6dsdt6dudv6dt dw6dxdy6dzd{6d|d}6d~d6dv d€6dd‚6dƒd„6dx d…6d†d‡6d± dˆ6d‰dŠ6d‹dŒ6dz d6dd6dd• 6d‘d’6d“d”6d•d–6d—d˜6d™dš6d›dœ6dd6dŸd 6d¡d¢6d£d¤6d¥d¦6d§d¨6d©dª6d«d¬6d­d®6d¯d°6d±d²6d³d´6dµd¶6d·d¸6d¹dº6d»d¼6d½d¾6d¿dÀ6ddÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dedæ6dçdè6dédê6dëdì6dídî6dïdğ6dñdò6dódô6dõdö6d÷dø6dùdú6dûdü6dıdş6dÿd 6dd6dd6dd6dd6d¿d	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6d d!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d•d:6d;d<6d=d>6d?d@6dAdB6dCdD6dEdF6dÂdG6dHdI6dJdK6dLdM6dNdO6dPdQ6dPdR6dSdT6dUdV6dWdX6dYdZ6dYd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6d'dh6didj6dkdl6dmdn6dodp6dqdr6dsdt6dudv6dwdx6dydz6d{d|6d}d~6dd€6dd‚6dƒd„6d…d†6d‡dˆ6d‰dŠ6d‹dŒ6dd6dd6d‘d’6d“d”6d1d•6d–d—6d˜d™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¤d¥6d¦d§6d¨d©6dªd«6d¬d­6d®d¯6d°d±6d®d²6d³d´6dµd¶6d·d¸6d¹dº6d»d¼6d½d¾6d¿dÀ6dÁdÂ6dÃdÄ6dÅdÆ6dÇdÈ6dÉdÊ6dËdÌ6dÍdÎ6dÏdĞ6dÑdÒ6dÓdÔ6dÕdÖ6d×dØ6dÍdÙ6dÚdÛ6dÜdİ6dŞdß6d0 d2 6dàdá6dâdã6dädå6dædç6dèdé6dêdë6d5 d7 6dìdí6dîdï6dÖdğ6dñdò6dódô6dõdö6d÷dø6d« dù6d« dú6d¢ dû6düdı6dydş6dÿd 6d³d6dd6dd6dd6dd	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd 6d!d"6d#d$6d%d&6d'd(6d)d*6d+d,6d-d.6d/d06d1d26d3d46d5d66d7d86d9d:6d;d<6d=d>6d?d@6dAdB6dCdD6dEdF6dGdH6dIdJ6dKdL6dMdN6dOdP6dQdR6dSdT6dUdV6dWdX6dÔdY6dZd[6d\d]6d^d_6dì d`6dadb6dcdd6dedf6dgdh6didj6dkdl6dmdn6dodp6dqdr6dsdt6dudv6dwdx6dydz6d{d|6d}d~6dd€6dd‚6dƒd„6d…d†6d‡dˆ6d‰dŠ6d‹dŒ6dd6dd6d‘d’6dGd“6dGd”6d•d–6d—d˜6dd™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¢d¤6d¥d¦6d§d¨6d©dª6d«d¬6d­d®6d¯d°6dì d±6dì d²6dGd³6d«d´6dµd¶6dd·6d¸d¹6dºd»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dÄdä6d1då6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dÆdò6dódô6dÈdõ6d¢dö6d± d÷6dødù6dúdû6dédü6dıdş6dÿd 6dd6dd6dd6dd6d	d
6dd6dd6dd6dd6dd6dd6dd6dd6dõ d6dd6dd6dd 6d!d"6d#d$6d° d%6d° d&6d¦ d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d:d>6d<d?6d@dA6dBdC6dDdE6dFdG6dHdI6dJdK6dLdM6dNdO6dPdQ6dRdS6dTdU6dVdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dhdi6djdk6dldm6dndo6dpdq6dbdr6dsdt6dudv6dwdx6dydz6d{d|6d}d~6dd€6dd‚6dì dƒ6d„d…6d†d‡6dˆd‰6dŠd‹6dÊdŒ6dd6dd6d‘d’6d“d”6dd•6d–d—6d˜d™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¢d¤6d¥d¦6d§d¨6d©dª6d«d¬6d­d®6d¯d°6d±d²6d³d´6dµd¶6d·d¸6d¹dº6d»d¼6d½d¾6did¿6dˆdÀ6d³dÁ6dÂdÃ6dÄdÅ6dydÆ6dÇdÈ6dÇdÉ6d1dÊ6dËdÌ6dÍdÎ6dÏdĞ6dÑdÒ6dÓdÔ6dÕdÖ6d×dØ6d"dÙ6d4dÚ6dudÛ6dÜdİ6dŞdß6dõ dà6dádâ6dãdä6dådæ6dĞdç6d/dè6dédê6dëdì6dídî6dïdğ6dñdò6dódô6dõdö6d÷dø6dùdú6dédû6dïdü6dïdı6dşdÿ6d d6dd6dd6dÒd6dd6d	d
6dd6d{d6dd6did6dÏd6dd6dd6dd6dd6dÔd6dÔd6dd6dwd6dd6d d!6d"d#6dÖd$6dÖd%6d&d'6d(d)6d*d+6d,d-6d« d.6d± d/6d° d06Z	 i  Z
 i dMdÛ 6dSdİ 6did16Z i d° d26d3d46d° d56d6d76d¦ d86Z i d9d:g d;6d9d<d:g d=6d:d:g d>6Z i: d?d@6dAdB6dCdD6dEdF6dGdH6dIdJ6dKdL6dMdN6dOdP6dQdR6dSdT6dUdV6dWdX6dYdZ6d[d\6d]d^6d_d`6dadb6dcdd6dedf6dgdh6didj6d?dk6dldm6dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d|d}6d~d6d€d6d‚dƒ6d„d…6d<d†6dmd‡6dˆd‰6dŠd‹6d dŒ6dd6d d6dd‘6d’d“6d”d•6d–d—6dld˜6dnd™6dpdš6drd›6dtdœ6dvd6dxd6dzdŸ6d|d 6d¡d¢6d£d¤6Z i, d¥d¦d§g d¨6d©d¦d§g dª6dì d¦d§g d«6d¬d­d®d¯d°g d±6d²d³d´g dµ6d¶d·d¸d¹dºd»g d¼6d½d³d¾g d¿6d½d³dÀg dÁ6d¬dÂdÃdÄdÅg dÆ6d¬d·d¸dÇdºd»g dÈ6d²d³dÉg dÊ6dËd¦d§g dÌ6dËd¦d§g dÍ6d²d³dÎg dÏ6dĞd¦d§g dÑ6dĞd¦d§g dÒ6dÓd³dÔg dÕ6d¬d·dÖdÇdºd»g d×6dØd³dÙg dÚ6dì d¦d§g dÛ6dÜdİdŞg dß6dĞdàdág dâ6dĞdàdãg dä6dì d¦d§g då6d©d¦d§g dæ6dĞd¦d§g dç6d¬dèdÖdédêd»g dë6dìdídîg dï6d½dğdñg dò6dódì g dô6dõdöd÷g dø6d²d³dùg dú6d²d³dûg dü6dıdşdÿd ddd»g d6d¬ddddg d6d¬dÂdÃdÄdÅg d	6d½d³d¾g d
6d²d³dg d6dĞd¦d§g d6dıddg d6dddÖddg d6dĞdàdg d6dddŞg d6dĞdàdg d6Z i dd±6dd¼6ddÆ6ddÈ6dd×6dd	6Z i dd 6Z i d!d"6d#d$6d%d&6d'd(6d· d)6d· d*6d+d,6d-d.6d· d/6d0d16d´ d26d3d46d5d66d7d86d9d:6d;d<6d=d>6Z i d?d@6dAdB6dAdC6dDdE6dFdG6dFdH6dIdJ6Z i dì dK6dì dõ 6dì dğ 6dLd‘ 6d×dM6dNdO6dPdQ6dRdS6dTdU6dVdW6dXdÍ6dYdZ6d[dË6dì d\6dì dˆ6Z i d°d]6d^d_6d`dÊ 6dadb6d¸ dc6ddde6d°df6d°dg6dhdi6djdk6dldm6dndo6dpdq6drds6dldt6dudv6dwdx6dldy6Z i‘ dzd{6dud|6d}d~6dd€6dd‚6dƒd„6d…d†6d‡dˆ6dd‰6dŠd‹6dŒd6dd6dd‘6d’d“6d”d•6d–d—6d˜d™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¤d¥6d¦d§6d d¨6d©dª6d«d¬6d­d®6d¯d°6d8d±6d²d³6d´dµ6d¶d·6d¸d¹6dºd»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6d4dÜ6d!dİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6d®dø6d®dù6dúdû6düdı6dşdÿ6d d6dd6dd6dd6dd	6dd
6d³d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd 6d!d"6d#d$6d%d&6d'd(6d)d*6d+d,6d-d.6d/d06d1d26d3d46dµd56dµd66dœd76d©d86d¼d96dºd:6d;d<6d=d>6d?d@6dAdB6dCdD6dĞdE6dFdG6dHdI6dJdK6dLdM6dNdO6dPdQ6ddR6dSdT6d4dU6dVdW6dXdY6dZd[6d\d]6dÿd^6d_d`6dˆda6dbdc6ddde6dfdg6dhdi6djdk6dldm6dndo6dpdq6drds6dtdu6dvdw6dxdy6d4dz6d{d|6d}d~6dd€6d/d6d0d‚6Z i	 d° dƒ6d„d…6d« d26d³d†6dò d‡6dˆd46dğ d‰6d¢ d86dŠd‹6Z i d«di6dŒd‘6Z i dd6dd6d?d‘6d’d“6dŠd”6d•d–6d—d˜6d™dš6d›dœ6dŠd6d£d6dŸd 6Z i d¡dŠd1dš d d¢ d¦ d¢d£d¤d¬ dud¥g d¦6Z i d§d¨6Z RS(©  s+   Configuration class from elyxer.config fileu   Ã…u   \AAu   Ã†u   \AEu#   <span class="versalitas">AmS</span>u   \AmSu   â„«u
   \Angstroemu   Ãu   \DHu   Ïu   \Koppau   Åu   \Lu   Âµu   \Microu   Ã˜u   \Ou   Å’u   \OEu   Ï u   \Sampiu   Ïšu   \Stigmau   Ãu   \THu   Ã¥u   \aau   Ã¦u   \aeu   Î±u   \alphau   Î²u   \betau   Î´u   \deltau   Ã°u   \dhu   Ïu   \digammau   Ïµu   \epsilonu   Î·u   \etau   \ethu   Î³u   \gammau   Ä±u   \iu   \imathu   Î¹u   \iotau   È·u   \ju   \jmathu   Îºu   \kappau   ÏŸu   \koppau   Å‚u   \lu   Î»u   \lambdau   Î¼u   \muu   Î½u   \nuu   Ã¸u   \ou   Å“u   \oeu   Ï‰u   \omegau   Ï†u   \phiu   Ï€u   \piu   Ïˆu   \psiu   Ïu   \rhou   Ï¡u   \sampiu   Ïƒu   \sigmau   ÃŸu   \ssu   Ï›u   \stigmau   Ï„u   \tauu   â„¦u   \tcohmu   Ä§u   \textcrhu   Ã¾u   \thu   Î¸u   \thetau   Ï…u   \upsilonu   âˆ†u	   \varDeltau   Î“u	   \varGammau   Î›u
   \varLambdau   Î©u	   \varOmegau   Î¦u   \varPhiu   Î u   \varPiu   Î¨u   \varPsiu   Î£u	   \varSigmau   Î˜u	   \varThetau   Î¥u   \varUpsilonu   Îu   \varXiu   Ïu   \varbetau   Îµu   \varepsilonu   Ï°u	   \varkappau   \varphiu   Ï–u   \varpiu   Ï±u   \varrhou   Ï‚u	   \varsigmau   Ï‘u	   \varthetau   Î¾u   \xiu   Î¶u   \zetau   \beginu   beginu   &u   cellseparatoru   \endu   endu   \\u   rowseparatoru   â›u   âœu   âu   (u   âu   âŸu   â u   )u   â¡u   â¢u   â£u   [u   â¤u   â¥u   â¦u   ]u   â§u   âªu   â¨u   â©u   {u   |u   â«u   â¬u   â­u   }u   âˆ¥u   â²u   â³u   âˆ‘u   âŒ u   âŒ¡u   âˆ«u   span class="symbol"u   \leftu   <span class="leftdot"></span>u   \left.u   \middleu   \rightu   <span class="rightdot"></span>u   \right.u   Ìˆu   \"u   Ìu   \'u   Ì‚u   \^u   Ì€u   \`u   \acuteu   Ì„u   \baru   Ì†u   \breveu   Ì§u   \cu   ÌŒu   \checku   âƒ›u   \dddotu   \ddotu   Ì‡u   \dotu   \graveu   \hatu   ÌŠu	   \mathringu   âƒ–u   \overleftarrowu   âƒ—u   \overrightarrowu   \ru   Ì©u   \su   âƒu   \textcircledu   Ì¥u   \textsubringu   Ìƒu   \tildeu   \vu   \vecu   \~u   Â u   \ u    u   \!u   #u   \#u   $u   \$u   %u   \%u   \&u    u   \,u   âŸu   \:u   â€„u   \;u   âˆ¿u   \ACu   âu   \APLcommentu   â—u   \APLdownarrowboxu   âu	   \APLinputu   âŒ¹u   \APLinvu   â‡u   \APLleftarrowboxu   âŸu   \APLlogu   âˆu   \APLrightarrowboxu   âu   \APLuparrowboxu   â–¡u   \Boxu   â‰u   \Bumpequ   â—u   \CIRCLEu   â‹’u   \Capu   â……u   \CapitalDifferentialDu   â˜‘u   \CheckedBoxu   â—‹u   \Circleu   â©´u	   \Coloneqqu   â…ˆu	   \ComplexIu   â…‰u	   \ComplexJu   â‰™u   \Correspondsu   â‹“u   \Cupu   Î”u   \Deltau   â—‡u   \Diamondu   â—†u   \Diamondblacku   âŸu   \Diamonddotu   â…†u   \DifferentialDu   â‡“u
   \Downarrowu   â‚¬u   \EURu   â„‡u   \Euleru   â…‡u   \ExponetialEu   â„²u   \Finvu   â…u   \Gameu   \Gammau   â„‘u   \Imu   â¨u   \Joinu   â—–u   \LEFTCIRCLEu   â—u   \LEFTcircleu   â—€u   \LHDu   \Lambdau   âŸ…u   \Lbagu   â‡u
   \Leftarrowu   â‡šu   \Lleftarrowu   âŸ¸u   \Longleftarrowu   âŸºu   \Longleftrightarrowu   âŸ¹u   \Longrightarrowu   â¦…u   \Lparenu   â†°u   \Lshu   â‡|u	   \Mapsfromu   |â‡’u   \Mapstou   \Omegau   Â¶u   \Pu   \Phiu   \Piu   Pru   \Pru   \Psiu   Ï˜u   \Qoppau   â–¶u   \RHDu   â——u   \RIGHTCIRCLEu   â—‘u   \RIGHTcircleu   âŸ†u   \Rbagu   â„œu   \Reu   â¦†u   \Rparenu   â‡›u   \Rrightarrowu   â†±u   \Rshu   Â§u   \Su   \Sigmau   â˜u   \Squareu   â‹u   \Subsetu   â˜‰u   \Sunu   â‹‘u   \Supsetu   \Thetau   â‡‘u   \Uparrowu   â‡•u   \Updownarrowu   \Upsilonu   âŠ©u   \Vdashu   \Vertu   âŠªu   \Vvdashu   â˜’u   \XBoxu   \Xiu   â…„u   \Yupu   <br/>u   _u   \_u   â„µu   \alephu   âˆu   \amalgu   âš“u   \anchoru   âˆ u   \angleu   â™’u	   \aquariusu   arccosu   \arccosu   arcsinu   \arcsinu   arctanu   \arctanu   argu   \argu   â™ˆu   \ariesu   â¢u   \arrowbulletu   âˆ—u   \astu   â‰u   \asympu   âˆu   \backepsilonu   â€µu
   \backprimeu   â‹u
   \backsimequ   \u
   \backslashu   âœ—u   \ballotxu   âŠ¼u	   \barwedgeu   âˆµu   \becauseu   â„¶u   \bethu   â‰¬u   \betweenu   âˆ©u   \bigcapu   \bigcircu   âˆªu   \bigcupu   âŠ™u   \bigodotu   âŠ•u	   \bigoplusu   âŠ—u
   \bigotimesu   âŠ”u	   \bigsqcupu   â˜…u   \bigstaru   â–½u   \bigtriangledownu   â–³u   \bigtriangleupu   âŠu	   \biguplusu   âˆ¨u   \bigveeu   âˆ§u	   \bigwedgeu   â˜£u
   \biohazardu   â§«u   \blacklozengeu   â˜»u   \blacksmileyu   â– u   \blacksquareu   â–²u   \blacktriangleu   â–¼u   \blacktriangledownu   â—‚u   \blacktriangleleftu   \blacktrianglerightu   â–´u   \blacktriangleupu   âŠ¥u   \botu   â‹ˆu   \bowtieu   â–«u   \boxu   â§†u   \boxastu   â—«u   \boxbaru   â§ˆu   \boxboxu   â§…u
   \boxbslashu   â§‡u
   \boxcircleu   âŠ¡u   \boxdotu   âŠŸu	   \boxminusu   âŠu   \boxplusu   â§„u	   \boxslashu   âŠ u	   \boxtimesu   â€¢u   \bulletu   â‰u   \bumpequ   â™‹u   \canceru   \capu   â™‘u   \capricornusu   â€u   \catu   â‹…u   \cdotu   â‹¯u   \cdotsu   Â¢u   \centu   âˆ™u
   \centerdotu   âœ“u
   \checkmarku   Ï‡u   \chiu   âˆ˜u   \circu   â‰—u   \circequ   â†ºu   \circlearrowleftu   â†»u   \circlearrowrightu   Â®u	   \circledRu   âŠ›u   \circledastu   â¦¸u   \circledbslashu   âŠšu   \circledcircu   âŠu   \circleddashu   â§u   \circledgtru   â§€u   \circledlessu   â™£u	   \clubsuitu   : u   \colonu   â‰”u	   \coloneqqu   âˆu   \complementu   â‰…u   \congu   \coprodu   Â©u
   \copyrightu   cosu   \cosu   coshu   \coshu   cotu   \cotu   cothu   \cothu   cscu   \cscu   \cupu   â‹u	   \curlyveeu   â‹u   \curlywedgeu   â†¶u   \curvearrowleftu   â†·u   \curvearrowrightu   â€ u   \dagu   \daggeru   â„¸u   \dalethu   â‡ u   \dashleftarrowu   âŠ£u   \dashvu   â€¡u   \ddagu   \ddaggeru   â‹±u   \ddotsu   degu   \degu   detu   \detu   â•²u	   \diagdownu   â•±u   \diagupu   âŒ€u	   \diameteru   \diamondu   â™¦u   \diamondsuitu   dimu   \dimu   Ã·u   \divu   â‹‡u   \divideontimesu   âˆ¸u   \dotdivu   â‰u   \dotequ   â‰‘u	   \doteqdotu   âˆ”u   \dotplusu   â€¦u   \dotsu   âŒ†u   \doublebarwedgeu   â†“u
   \downarrowu   â‡Šu   \downdownarrowsu   â‡ƒu   \downharpoonleftu   â‡‚u   \downharpoonrightu   â©¤u   \dsubu   â™u   \earthu   â™ªu   \eighthnoteu   â„“u   \ellu   âˆ…u	   \emptysetu   â‰–u   \eqcircu   â‰•u   \eqcolonu   â‰‚u   \eqsimu   \eurou   âˆƒu   \existsu   expu   \expu   â‰’u   \fallingdotsequ   â¨¾u   \fcmpu   â™€u   \femaleu   â™­u   \flatu   âˆ€u   \forallu   â—u   \fourthu   âŒ¢u   \frownu   â˜¹u   \frownieu   gcdu   \gcdu   â™Šu   \geminiu   â‰¥u   \geq)u   â‰§u   \geqqu	   \geqslantu   â†u   \getsu   â‰«u   \ggu   â‹™u   \gggu   â„·u   \gimelu   â‰©u   \gneqqu   â‹§u   \gnsimu   â‹—u   \gtrdotu   â‹šu
   \gtreqlessu   âªŒu   \gtreqqlessu   â‰·u   \gtrlessu   â‰³u   \gtrsimu   Â«u   \guillemotleftu   Â»u   \guillemotrightu   â„u   \hbaru   â™¥u
   \heartsuitu   <span class="hfill"> </span>u   \hfillu   homu   \homu   â†©u   \hookleftarrowu   â†ªu   \hookrightarrowu   \hslashu(   <span class="bigsymbol">âˆ«â‹¯âˆ«</span>u	   \idotsintu"   <span class="bigsymbol">âˆ­</span>u   \iiintu"   <span class="bigsymbol">âˆ¬</span>u   \iintu   infu   \infu   âˆu   \inftyu   âŠºu	   \intercalu   â«´u   \interleaveu   â…‹u   \invampu   âŒu   \invnegu   â™ƒu   \jupiteru   keru   \keru   \landu"   <span class="bigsymbol">âˆ±</span>u
   \landupintu   âŸªu   \langu   âŸ¨u   \langleu   â¦‰u   \lblotu   \lbraceu   \lbrace)u   \lbracku   âŒˆu   \lceilu   \ldotsu   â‡u   \leadstou   \leftarrow)u   â†¢u   \leftarrowtailu   â‡¤u   \leftarrowtobaru   â†½u   \leftharpoondownu   â†¼u   \leftharpoonupu   â‡‡u   \leftleftarrowsu   â¥¢u   \leftleftharpoonsu   â˜¾u	   \leftmoonu   â†”u   \leftrightarrowu   â‡†u   \leftrightarrowsu   â‡‹u   \leftrightharpoonsu   â‹‹u   \leftthreetimesu   â™Œu   \leou   â‰¤u   \leq)u   â‰¦u   \leqqu	   \leqslantu   â‹–u   \lessdotu   â‹›u
   \lesseqgtru   âª‹u   \lesseqqgtru   â‰¶u   \lessgtru   â‰²u   \lesssimu   âŒŠu   \lflooru   lgu   \lgu   âŸ®u   \lgroupu   âŠ²u   \lhdu   â™u   \librau   â†¯u
   \lightningu   â¦‡u   \limgu   liminfu   \liminfu   limsupu   \limsupu   â‰ªu   \llu   âŸ¦u
   \llbracketu   âŒu	   \llcorneru   â‹˜u   \lllu   lnu   \lnu   â‰¨u   \lneqqu   Â¬u   \lnotu   â‹¦u   \lnsimu   logu   \logu   âŸµu   \longleftarrowu   âŸ·u   \longleftrightarrowu   âŸ¼u   \longmapstou   âŸ¶u   \longrightarrowu   â†«u   \looparrowleftu   â†¬u   \looparrowrightu   \loru   â—Šu   \lozengeu   âŒŸu	   \lrcorneru   â‹‰u   \ltimesu   \lyxlocku   â™‚u   \maleu   âœ u   \malteseu   â†¤u	   \mapsfromu   â†¦u   \mapstou   ^u   \mathcircumflexu   maxu   \maxu   âˆ¡u   \measuredangleu   âš«u
   \medbulletu   âšªu   \medcircu   â˜¿u   \mercuryu   â„§u   \mhou   âˆ£u   \midu   minu   \minu   âŠ¨u   \modelsu   âˆ“u   \mpu   âŠ¸u	   \multimapu   â‡u   \nLeftarrowu   â‡u   \nLeftrightarrowu   â‡u   \nRightarrowu   âŠ¯u   \nVDashu   âˆ‡u   \nablau   â‰‰u   \napproxu   â™®u   \naturalu   â‰‡u   \ncongu   â†—u   \nearrowu   \negu   \neg)u   â™†u   \neptuneu   â‰¢u   \nequivu   \newlineu   âˆ„u   \nexistsu   â‰±u
   \ngeqslantu   â‰¯u   \ngtru   â‰¹u	   \ngtrlessu   âˆ‹u   \niu   \ni)u   â†šu   \nleftarrowu   â†®u   \nleftrightarrowu   â‰°u
   \nleqslantu   â‰®u   \nlessu   â‰¸u	   \nlessgtru   âˆ¤u   \nmidu	   \nolimitsu	   \nonumberu   \notu   \not<u   â‰ u   \not=u   \not>u   â€u   \notbackslashu   âˆ‰u   \notinu   âˆŒu   \notniu   âŒ¿u	   \notslashu   âˆ¦u
   \nparallelu   âŠ€u   \nprecu   â†›u   \nrightarrowu   â‰u   \nsimu   â‰„u   \nsimequ   âŠÌ¸u
   \nsqsubsetu   âŠˆu
   \nsubsetequ   âŠu   \nsuccu   â‹¡u   \nsucccurlyequ   âŠ…u   \nsupsetu   âŠ‰u
   \nsupsetequ   â‹ªu   \ntriangleleftu   â‹¬u   \ntriangleleftequ   â‹«u   \ntrianglerightu   â‹­u   \ntrianglerightequ   âŠ­u   \nvDashu   âŠ¬u   \nvdashu   â†–u   \nwarrowu   \odotu   \officialeurou"   <span class="bigsymbol">âˆ°</span>u   \oiiintu"   <span class="bigsymbol">âˆ¯</span>u   \oiintu"   <span class="bigsymbol">âˆ®</span>u   \ointu"   <span class="bigsymbol">âˆ²</span>u   \ointclockwiseu"   <span class="bigsymbol">âˆ³</span>u   \ointctrclockwiseu   âŠ–u   \ominusu   \oplusu   âŠ˜u   \oslashu   \otimesu   \ownsu	   \parallelu   âˆ‚u   \partialu   âœu   \pencilu   \perpu   â™“u   \piscesu   â‹”u
   \pitchforku   â™‡u   \plutou   Â±u   \pmu   âªu   \pointeru   â˜u   \pointrightu   Â£u   \poundsu   â‰ºu   \precu   â‰¼u   \preccurlyequ   \precequ   â‰¾u   \precsimu   â€²u   \primeu   âˆu   \promptou   Ï™u   \qoppau     u   \qquadu   \quadu   â™©u   \quarternoteu   â˜¢u
   \radiationu   âŸ«u   \rangu   âŸ©u   \rangleu   â¦Šu   \rblotu   \rbraceu   \rbrace)u   \rbracku   âŒ‰u   \rceilu   â™»u   \recycleu   âŒ‹u   \rflooru   âŸ¯u   \rgroupu   âŠ³u   \rhdu   âˆŸu   \rightangleu   â†’u   \rightarrow)u   â†£u   \rightarrowtailu   â‡¥u   \rightarrowtobaru   â‡u   \rightharpoondownu   â‡€u   \rightharpoonupu   \rightharpooondownu   \rightharpooonupu   â‡„u   \rightleftarrowsu   â‡Œu   \rightleftharpoonsu   â˜½u
   \rightmoonu   â‡‰u   \rightrightarrowsu   â¥¤u   \rightrightharpoonsu   â‹Œu   \rightthreetimesu   â¦ˆu   \rimgu   â‰“u   \risingdotsequ   âŸ§u
   \rrbracketu   â©¥u   \rsubu   â‹Šu   \rtimesu   â™u   \sagittariusu   â™„u   \saturnu   â™u   \scorpiou   â†˜u   \searrowu   secu   \secu   â€³u   \secondu   âˆ–u	   \setminusu   â™¯u   \sharpu   â‰ƒu   \simequ   sinu   \sinu   sinhu   \sinhu   â™¬u   \sixteenthnoteu   â˜ u   \skullu   âˆ•u   \slashu   \smallsetminusu   â–¿u   \smalltriangledownu   â—ƒu   \smalltriangleleftu   â–¹u   \smalltrianglerightu   â–µu   \smalltriangleupu   âŒ£u   \smileu   â˜ºu   \smileyu   â™ u
   \spadesuitu   Â¨u   \spddotu   \sphatu   âˆ¢u   \sphericalangleu   â¦u   \spotu   ~u   \sptildeu   âŠ“u   \sqcapu   \sqcupu   âŠu	   \sqsubsetu   âŠ‘u   \sqsubsetequ   âŠu	   \sqsupsetu   âŠ’u   \sqsupsetequ   \squareu   â«½u   \sslashu   â‹†u   \staru   â˜•u	   \steamingu   â«…u
   \subseteqqu   â«‹u   \subsetneqqu   â‰»u   \succu   â‰½u   \succcurlyequ   \succequ   â‹©u	   \succnsimu   â‰¿u   \succsimu   â˜¼u   \sunu   supu   \supu   â«†u
   \supseteqqu   â«Œu   \supsetneqqu   âˆšu   \surdu   â†™u   \swarrowu   âš”u   \swordsu   â«¾u   \talloblongu   tanu   \tanu   tanhu   \tanhu   â™‰u   \taurusu   \textasciicircumu   \textasciitildeu   \textbackslashu   Â©'u   \textcopyrightu   Â°u   \textdegreeu   \textellipsisu   â€”u   \textemdashu   \textendashu	   \texteurou   >u   \textgreateru   <u	   \textlessu   Âªu   \textordfeminineu   Âºu   \textordmasculineu   â€œu   \textquotedblleftu   â€u   \textquotedblrightu   â€™u   \textquoterightu   \textregisteredu   \textrightarrowu   \textsectionu   â„¢u   \texttrademarku   Â²u   \texttwosuperioru   \textvisiblespaceu   âˆ´u
   \thereforeu   â€´u   \thirdu   âŠ¤u   \topu	   \triangleu   \triangleleftu   âŠ´u   \triangleleftequ   â‰œu
   \trianglequ   â–·u   \trianglerightu   âŠµu   \trianglerightequ   â†u   \twoheadleftarrowu   â† u   \twoheadrightarrowu   â™«u	   \twonotesu   âŠu   \udotu   âŒœu	   \ulcorneru   \unlhdu   \unrhdu   \unrhlu   â†‘u   \uparrowu   â†•u   \updownarrowu   â†¿u   \upharpoonleftu   â†¾u   \upharpoonrightu   \uplusu   â‡ˆu   \upuparrowsu   â™…u   \uranusu   âŒu	   \urcorneru   \vDashu   â™§u   \varclubsuitu   \vardiamondsuitu   \varheartsuitu   \varnothingu   â™¤u   \varspadesuitu   âŠ¢u   \vdashu   â‹®u   \vdotsu   \veeu   \vee)u   âŠ»u   \veebaru   \vertu   â™u   \virgou   âš u   \warningu   âŒ‘u   \wasylozengeu   \wedgeu   \wedge)u   â„˜u   \wpu   â‰€u   \wru   Â¥u   \yenu   â˜¯u   \yinyangu   \{u   \|u   \}u   \widehatu   bracketu   \]u   complexu   endafteru   \end{u	   endbeforeu   squarebracketu   ru   lu   alignu   cu   eqnarrayu   gatheredu   bu   \boldsymbolu   span class="blackboard"u   \mathbbu   ğ”¸u
   \mathbb{A}u   ğ”¹u
   \mathbb{B}u   â„‚u
   \mathbb{C}u   ğ”»u
   \mathbb{D}u   ğ”¼u
   \mathbb{E}u   ğ”½u
   \mathbb{F}u   ğ”¾u
   \mathbb{G}u   â„u
   \mathbb{H}u   ğ•u
   \mathbb{J}u   ğ•‚u
   \mathbb{K}u   ğ•ƒu
   \mathbb{L}u   â„•u
   \mathbb{N}u   ğ•†u
   \mathbb{O}u   â„™u
   \mathbb{P}u   â„šu
   \mathbb{Q}u   â„u
   \mathbb{R}u   ğ•Šu
   \mathbb{S}u   ğ•‹u
   \mathbb{T}u   ğ•u
   \mathbb{W}u   â„¤u
   \mathbb{Z}u   \mathbfu   span class="scriptfont"u   \mathcalu   â„¬u   \mathcal{B}u   â„°u   \mathcal{E}u   â„±u   \mathcal{F}u   â„‹u   \mathcal{H}u   â„u   \mathcal{I}u   â„’u   \mathcal{L}u   â„³u   \mathcal{M}u   â„›u   \mathcal{R}u   span class="fraktur"u	   \mathfraku   â„­u   \mathfrak{C}u   ğ”‰u   \mathfrak{F}u   â„Œu   \mathfrak{H}u   \mathfrak{I}u   \mathfrak{R}u   â„¨u   \mathfrak{Z}u   iu   \mathitu   \mathring{A}u   Å®u   \mathring{U}u   \mathring{a}u   Å¯u   \mathring{u}u   áº˜u   \mathring{w}u   áº™u   \mathring{y}u   span class="mathrm"u   \mathrmu   \mathscru   \mathscr{B}u   \mathscr{E}u   \mathscr{F}u   \mathscr{H}u   \mathscr{I}u   \mathscr{L}u   \mathscr{M}u   \mathscr{R}u   span class="mathsf"u   \mathsfu   ttu   \mathttu   {$p!}{$q!}{$r!}u   f0{}u   ignoredu   \addcontentslineu
   {$p!}{$q!}u   \addtocontentsu   \backmatteru   {$1}{$2}u   f2{(}f0{f1{$1}f1{$2}}f2{)}u   span class="binom"u   span class="binomstack"u   span class="bigsymbol"u   \binomu   {$1}u   f0{$1}u   span class="boxed"u   \boxedu   [$p!]{$1}{$2}u!   f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}u   span class="fullfraction"u   span class="numerator align-$p"u   span class="denominator"u   span class="ignored"u   \cfracu	   {$p!}{$1}u   span style="color: $p;"u   \coloru-   span class="colorbox" style="background: $p;"u	   \colorboxu%   (f0{f1{f2{$1}}f1{f2{â€…}}f1{f2{$2}}})u   span class="binomial"u   span class="binomrow"u   span class="binomcell"u   \dbinomu   span class="numerator"u   \dfracu   span class="displaystyle"u   \displaystyleu
   [$p!]{$q!}u
   \fancyfootu
   \fancyheadu   span class="fbox"u   \fboxu   {$p!}u	   \fboxruleu   \fboxsepu   {$p!}{$q!}{$1}u<   span class="boxed" style="border-color: $p; background: $q;"u
   \fcolorboxu   span class="fraction"u   \fracu   [$p!][$q!]{$1}u1   span class="framebox align-$q" style="width: $p;"u	   \frameboxu   \frontmatteru   [$o]{$u!}{$t!}u   f0{$t}u   a href="$u"u   \hrefu   f0{ }u&   span class="hspace" style="width: $p;"u   \hspaceu*   span class="leftroot" style="width: $p;px"u	   \leftrootu   \mainmatteru	   \markbothu
   \markrightu   f0{f1{$1}â„f2{$2}}u   sup class="numerator"u   sub class="denominator"u	   \nicefracu   [$p!]{$w!}{$1}u   f0{1}u$   div class="Boxed" style="width: $w;"u   \parboxu   f0{$1.font}u1   span class="raisebox" style="vertical-align: $p;"u	   \raiseboxu   {$1!}{$2!}{$3!}u   \renewenvironmentu   [$v!]{$w!}{$h!}u   f0/u.   hr class="line" style="width: $w; height: $h;"u   \ruleu   span class="scriptscriptstyle"u   \scriptscriptstyleu   span class="scriptstyle"u   \scriptstyleu   [$0]{$1}u!   f0{f1{$0}f2{âˆš}f4{(}f3{$1}f4{)}}u   span class="sqrt"u   sup class="root"u   span class="radical"u   span class="root"u   \sqrtu   f0{f1{$1}f2{$2}}u   span class="stackrel"u   span class="upstackrel"u   span class="downstackrel"u	   \stackrelu   \tbinomu
   \textcoloru   span class="textstyle"u
   \textstyleu   \thispagestyleu   $0f0{$1.font}u   span class="unit"u   \unitu   [$0]{$1}{$2}u   $0f0{f1{$1.font}â„f2{$2.font}}u   sup class="unit"u   sub class="unit"u	   \unitfracu(   span class="uproot" style="width: $p;px"u   \uprootu   {$u!}u   f0{$u}u   \urlu'   span class="vspace" style="height: $p;"u   \vspaceu   $1+$2u   $1+$2+1u
   a name="#"u   \labelu   â«¼u   \biginterleaveu   â¨…u	   \bigsqcapu   â¨u   \fintu   â¨Œu   \iiiintu   \intu   \intopu   limu   \limu   âˆu   \produ	   \smallintu   â¨–u   \sqintu   \sumu   âˆ²u   \varointclockwiseu   â¨‰u   \varprodu   â¨Ÿu   \zcmpu   â§¹u   \zhideu   â¨ u   \zpipeu   â¨¡u	   \zprojectu   LimitPreviousCommandu   \limitsu   MacroDefinitionu   \newcommandu   \renewcommandu   SetCounterFunctionu   \setcounteru
   FormulaTagu   \tagu   \tag*u   TodayCommandu   \todayu   
u   	u   'u   âŸ+âŸu   +u   ,âŸu   ,u	   âŸâˆ’âŸu   -u	   âŸâ„âŸu   /u    : u   :u
   âŸ&lt;âŸu   âŸ=âŸu   =u
   âŸ&gt;âŸu   @u   \Bigu   span class="hugesymbol"u   \Biggu   span class="bar"u   span class="arraydef"u   \begin{array}u   \bigu   span class="largesymbol"u   \biggu   \biglu   \bigru   span class="align-center"u
   \centeringu   span class="ensuremath"u   \ensuremathu   span class="phantom"u	   \hphantomu   span class="noindent"u	   \noindentu   span class="overbrace"u
   \overbraceu   span class="overline"u	   \overlineu   \phantomu   span class="underbrace"u   \underbraceu   uu
   \underlineu	   \vphantomu   â««u   \Botu   \Dotequ   â¤“u   \DownArrowBaru   â¥u   \DownLeftTeeVectoru   â¥–u   \DownLeftVectorBaru   â¥Ÿu   \DownRightTeeVectoru   â¥—u   \DownRightVectorBaru   â©µu   \Equalu   \LeftArrowBaru   â¥¡u   \LeftDownTeeVectoru   â¥™u   \LeftDownVectorBaru   â¥šu   \LeftTeeVectoru   â§u   \LeftTriangleBaru   â¥ u   \LeftUpTeeVectoru   â¥˜u   \LeftUpVectorBaru   â¥’u   \LeftVectorBaru   â‡”u   \Leftrightarrowu   âŸ½u   \Longmapsfromu   âŸ¾u   \Longmapstou   â†§u	   \MapsDownu   â†¥u   \MapsUpu   â‡—u   \Nearrowu   âª¢u   \NestedGreaterGreateru   âª¡u   \NestedLessLessu   \NotGreaterLessu   â‰µu   \NotGreaterTildeu   â‰´u   \NotLessTildeu   â‡–u   \Nwarrowu   âˆ·u   \Proportionu   \RightArrowBaru   â¥u   \RightDownTeeVectoru   â¥•u   \RightDownVectorBaru   â¥›u   \RightTeeVectoru   â§u   \RightTriangleBaru   â¥œu   \RightUpTeeVectoru   â¥”u   \RightUpVectorBaru   â¥“u   \RightVectorBaru   â‡’u   \Rightarrowu   â©¶u   \Sameu   â‡˜u   \Searrowu   â‡™u   \Swarrowu   â«ªu   \Topu   â¤’u   \UpArrowBaru   âŠ«u   \VDashu   â‰ˆu   \approxu   â‰Šu	   \approxequ   âˆ½u   \backsimu   â‹¶u   \barinu   â¥«u   \barleftharpoonu   â¥­u   \barrightharpoonu   â¤–u   \biju   \colonequ   \correspondsu   â‹u   \curlyeqprecu   â‹Ÿu   \curlyeqsuccu   â‡¢u   \dashrightarrowu   â†²u   \dlshu   â¥¥u   \downdownharpoonsu   â‡µu   \downuparrowsu   â¥¯u   \downupharpoonsu   â†³u   \drshu   âª–u   \eqslantgtru   âª•u   \eqslantlessu   â‰¡u   \equivu   â‡»u   \ffunu   â¤•u   \finju   \geu   \gequ   âª¼u   \ggcurlyu   âªŠu	   \gnapproxu   âªˆu   \gnequ   âª†u
   \gtrapproxu   â‹•u   \hashu   â‹°u   \iddotsu	   âŸâ‡’âŸu   \impliesu   âˆˆu   \inu   \leu
   \leftarrowu   â‡½u   \leftarrowtriangleu   â¥ªu   \leftbarharpoonu   â‡¿u   \leftrightarrowtriangleu   â¥Šu   \leftrightharpoonu   â¥u   \leftrightharpoondownu   â¥u   \leftrightharpoonupu   â†­u   \leftrightsquigarrowu   âª¦u
   \leftsliceu   â‡œu   \leftsquigarrowu   â¥‘u   \leftupdownharpoonu   \lequ   âª…u   \lessapproxu   âª»u   \llcurlyu   âª‰u	   \lnapproxu   âª‡u   \lnequ   âŸ»u   \longmapsfromu   â§Ÿu   \multimapbothu   âŠ¶u   \multimapdotbothAu   âŠ·u   \multimapdotbothBu   âŸœu   \multimapinvu   âŠ®u   \nVdashu   \neu   \nequ   \ngequ   \nlequ   \nniu   \not\inu   â‰­u	   \notasympu   â‹ u   \nprecequ   â‹¢u   \nsqsubsetequ   â‹£u   \nsqsupsetequ   âŠ„u   \nsubsetu   \nsuccequ   â‡¸u   \pfunu   â¤”u   \pinju   âª·u   \precapproxu   âª³u   \preceqqu   âª¹u   \precnapproxu   â‹¨u	   \precnsimu   \proptou   â¤€u   \psuru   \rightarrowu   â‡¾u   \rightarrowtriangleu   â¥¬u   \rightbarharpoonu   â¥‹u   \rightleftharpoonu   âª§u   \rightsliceu   \rightsquigarrowu   â¥u   \rightupdownharpoonu   \simu   â¥¼u	   \strictfiu   â¥½u	   \strictifu   âŠ‚u   \subsetu   âŠ†u	   \subsetequ   âŠŠu
   \subsetnequ   âª¸u   \succapproxu   âª´u   \succeqqu   âªºu   \succnapproxu   âŠƒu   \supsetu   âŠ‡u	   \supsetequ   âŠ‹u
   \supsetnequ   Ã—u   \timesu   \tou   â‡…u   \updownarrowsu   â¥®u   \updownharpoonsu   â¥£u   \upupharpoonsu   \vartriangleleftu   \vartrianglerightu
   beginafteru   \begin{u   beginbeforeu   commandu   commentu   \[u   simpleu   *u
   unnumberedu   subu   span class="mbox"u   \mboxu   span class="text"u   \textu   \textbfu   span class="textipa"u   \textipau   \textitu   span class="textnormal"u   \textnormalu   span class="textrm"u   \textrmu   span class="versalitas"u   \textscu   span class="textsf"u   \textsfu   \textslu   \textttu   span class="normal"u   \textupu   .u   Â·u   !u   ;u   "u
   charactersu-   http://chart.googleapis.com/chart?cht=tx&chl=u   googlecharts(   R   R   R   t   alphacommandst   arrayt   bigbracketst
   bigsymbolst   bracketcommandst   combiningfunctionsR-   t   decoratedcommandt   decoratingfunctionsR%   t   environmentst   fontfunctionst   hybridfunctionst   hybridsizest   labelfunctionst   limitcommandst   misccommandst   modifiedt   onefunctionst   spacedcommandsR(   t   symbolfunctionst   textfunctionst
   unmodifiedt   urls(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR2   C  s>  ##
0- 
####

*#

1t   GeneralConfigc           B   s)   e  Z d  Z i d d 6d d 6d d 6Z RS(   s+   Configuration class from elyxer.config fileu
   2015-02-26u   dateu   413u	   lyxformatu   1.2.5u   number(   R   R   R   t   version(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRI     s   t   HeaderConfigc        1   B   sB  e  Z d  Z i d d 6d d 6d d 6d d 6d	 d
 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6Z i d d d d d d d d  d! d" d# d$ d% d& d' d( d) d* d+ d, d- d. d/ d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 d: d; d< d= d> d? d@ dA dB dC dD dE dF dG dH g0 d 6dI dJ dK dL dM dN dO dP dQ dR dS dT dU dV dW dX dY dZ g dI 6Z RS([   s+   Configuration class from elyxer.config fileu   \begin_preambleu   beginpreambleu   \branchu   branchu
   \textclassu   documentclassu   \end_branchu	   endbranchu   \end_preambleu   endpreambleu	   \languageu   languageu   \lstsetu   lstsetu   \output_changesu   outputchangesu   \paragraph_separationu   paragraphseparationu
   \pdf_titleu   pdftitleu   \secnumdepthu   secnumdepthu	   \tocdepthu   tocdepthu   articleu   aastexu   aapaperu   acmsiggraphu   sigplanconfu   achemsou   amsartu   apau   arab-articleu   armenian-articleu   article-beameru   chessu   dtku
   elsarticleu   heb-articleu   IEEEtranu   iopartu   kluweru   scrarticle-beameru   scrartclu
   extarticleu   paperu   mwartu   revtex4u   spieu	   svglobal3u   ltugboatu   agu-dtdu   jgrgau   agumsu   entcsu   egsu   ijmpcu   ijmpdu   singlecol-newu   doublecol-newu   isprsu   tarticleu	   jsarticleu   jarticleu   jssu   literate-articleu   siamltexu   cl2emultu   llncsu   svglobalu   svjogu   svprobthu   booku   amsbooku   scrbooku   extbooku
   tufte-booku   reportu	   extreportu   scrreprtu   memoiru   tbooku   jsbooku   jbooku   mwbku   svmonou   svmultu   treportu   jreportu   mwrep(   R   R   R   t
   parameterst   styles(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRK     s   
—t   ImageConfigc           B   s^   e  Z d  Z i d d 6d d 6d d 6Z i d d 6d	 d
 6d d 6Z i d d 6d d g d 6Z RS(   s+   Configuration class from elyxer.config fileuO   convert[ -density $scale][ -define $format:use-cropbox=true] "$input" "$output"u   imagemagicku(   inkscape "$input" --export-png="$output"u   inkscapeu   lyx -C "$input" "$output"u   lyxu   psu   .epsu   pdfu   .pdfu   .psu   .pngu   defaultu   .svgu   vector(   R   R   R   t
   converterst   cropboxformatst   formats(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRN   2  s   
t   LayoutConfigc           B   s?   e  Z d  Z i d d d d d d d d d	 d
 d d g d 6Z RS(   s+   Configuration class from elyxer.config fileu   StringContaineru   Constantu
   TaggedTextu   Alignu
   TextFamilyu   EmphaticTextu   VersalitasTextu
   BarredTextu   SizeTextu	   ColorTextu   LangLineu   Formulau   allowed(   R   R   R   t	   groupable(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRR   D  s   t   NewfangleConfigc           B   s7   e  Z d  Z i d d 6d d 6d d 6d d 6d	 d
 6Z RS(   s+   Configuration class from elyxer.config fileu	   chunkref{u   chunkrefu   }u
   endcommandu   &gt;u   endmarku   \u   startcommandu   =&lt;u	   startmark(   R   R   R   t	   constants(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRT   L  s   t   NumberingConfigc           B   sb   e  Z d  Z i d d d d d g d 6d d g d	 6Z i d
 d d d d d d d d d g
 d 6Z RS(   s+   Configuration class from elyxer.config fileu   Chapteru   Sectionu
   Subsectionu   Subsubsectionu	   Paragraphu   orderedu   Partu   Booku   romanu   *u   **u   â€ u   â€¡u   Â§u   Â§Â§u   Â¶u   Â¶Â¶u   #u   ##u   symbols(   R   R   R   t   layoutst   sequence(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRV   T  s   t   StyleConfigc           B   s€  e  Z d  Z i d d 6d d 6d d 6d d 6d d	 6d d
 6d d 6d d 6d d 6d d 6d d 6Z i d d 6d d 6d d 6d d 6d d 6d d 6d d  6d! d" 6d d# 6d d$ 6d d% 6d d& 6d' d( 6d) d* 6d+ d, 6d- d. 6d' d/ 6d) d0 6d1 d2 6d3 d4 6d1 d5 6d1 d6 6Z i d7 d8 6d9 d: 6d; d< 6d= d> 6d? d@ 6dA dB 6dC dD 6Z i dE dF dG dH dI dJ g dK 6Z i dL dM 6dN dO 6dP dQ 6dR dS 6dT dU 6Z RS(V   s+   Configuration class from elyxer.config fileu   â€‚u	   \enskip{}u   <span class="hfill"> </span>u   \hfill{}u   â€ƒu   \hspace*{\fill}u    u
   \hspace*{}u	   \hspace{}u   \negthinspace{}u   â€ƒâ€ƒu   \qquad{}u   \quad{}u   Â u   \space{}u   â€‰u   \thinspace{}u   ~u   Â»u   aldu   â€ºu   alsu   Â«u   ardu   â€¹u   arsu   &ldquo;u   eldu   &lsquo;u   elsu   &rdquo;u   erdu   &rsquo;u   ersu   fldu   flsu   frdu   frsu   â€u   gldu   â€šu   glsu   â€œu   grdu   â€˜u   grsu   pldu   plsu   â€u   prdu   â€™u   prsu   sldu   srdu   (@â†•)u   eqrefu   Â¶â†•u	   formattedu   $â†•u   namerefu   #â†•u   pagerefu   @â†•u   refu   on-page#â†•u   vpagerefu   @on-page#â†•u   vrefu   colu   textu   lineu   pageu   theightu   pheightu   ignoredtextsu   <div class="bigskip"> </div>u   bigskipu   <div class="defskip"> </div>u   defskipu   <div class="medskip"> </div>u   medskipu   <div class="smallskip"> </div>u	   smallskipu   <div class="vfill"> </div>u   vfill(   R   R   R   t   hspacest   quotest   referenceformatst   sizet   vspaces(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRY   a  s.   ###t	   TOCConfigc           B   s¡   e  Z d  Z i d d d d d d d d d	 d
 d d g d 6d g d 6d g d 6Z i d d d g d 6d d d d d	 d
 d d g d 6d d d d d d g d 6Z RS(   s+   Configuration class from elyxer.config fileu   StringContaineru   Constantu
   TaggedTextu   Alignu
   TextFamilyu   EmphaticTextu   VersalitasTextu
   BarredTextu   SizeTextu	   ColorTextu   LangLineu   Formulau   allowedu    u   clonedu	   extractedu   Spaceu   PlainLayoutu   Captionu   StandardLayoutu	   FlexInset(   R   R   R   t   extractplaint   extracttitle(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR_   „  s   +t	   TagConfigc           B   s  e  Z d  Z i d d 6Z i d d 6d d 6Z i d d 6d	 d
 6d d 6d	 d 6d d 6d d 6Z i d d g d 6Z i
 d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d  6Z i d! d" 6d# d$ 6Z i d% d& 6d' d( 6d% d) 6Z	 i d* d+ 6d, d- 6Z
 i d. d/ 6d. d0 6d1 d2 6Z RS(3   s+   Configuration class from elyxer.config fileu   uu   underu   span class="sans"u   sansu   ttu
   typewriteru   span class="code"u   CharStyle:Codeu   span class="menuitem"u   CharStyle:MenuItemu   Codeu   MenuItemu   span class="noun"u   Nounu   span class="strong"u   Strongu	   Quotationu   Quoteu   layoutsu   divu   Centeru   h?u   Chapteru   h2u   Dateu	   Paragraphu   h1u   Partu
   blockquoteu   Sectionu
   Subsectionu   Subsubsectionu   olu	   Enumerateu   ulu   Itemizeu    u   Commentu   span class="greyedout"u	   Greyedoutu   Noteu   subu	   subscriptu   supu   superscriptu   iu   italicu   slantedu   span class="versalitas"u	   smallcaps(   R   R   R   t   barredt   familyt   flext   groupRW   t	   listitemst   notest   scriptt   shaped(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRb   “  s0   
t   TranslationConfigc           B   sU  e  Z d  Z i$ d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d	 d
 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d  d! 6d" d# 6d$ d% 6d& d' 6d( d) 6d* d+ 6d, d- 6d. d/ 6d0 d1 6d2 d3 6d4 d5 6d6 d7 6d8 d9 6d: d; 6d< d= 6d> d? 6Z i	 d@ dA 6d@ dB 6dC dD 6dE dF 6d@ dG 6dH dI 6dC dJ 6dK dL 6dM dN 6Z RS(O   s+   Configuration class from elyxer.config fileu   Appendixu   Booku   Chapteru	   Paragraphu   Partu   Sectionu
   Subsectionu   Subsubsectionu   Abstractu   abstractu   Bibliographyu   bibliographyu   figureu
   Algorithm u   float-algorithmu   Figure u   float-figureu   Listing u   float-listingu   Table u   float-tableu   Tableau u   float-tableauu	   Footnotesu	   footnotesu   Document generated by u   generated-byu    on u   generated-onu   Indexu   indexu)   Please enable JavaScript on your browser.u   jsmath-enableuH    requires JavaScript to correctly process the mathematics on this page. u   jsmath-requiresu	   Warning: u   jsmath-warningu   List of Algorithmsu   list-algorithmu   List of Figuresu   list-figureu   List of Tablesu
   list-tableu   List of Tableauxu   list-tableauu	   Main pageu	   main-pageu   Nextu   nextu   Nomenclatureu   nomenclatureu	    on page u   on-pageu   Prevu   prevu
   Referencesu
   referencesu   Table of Contentsu   tocu   Contents for u   toc-foru   Upu   upu   enu   americanu   britishu   deu   deutschu   nlu   dutchu   englishu   fru   frenchu   ngermanu   ruu   russianu   esu   spanish(   R   R   R   RU   t	   languages(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRk   ¿  s.   t   CommandLineParserc           B   s;   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z RS(   s   A parser for runtime optionsc         C   s   | |  _  d  S(   N(   t   options(   t   selfRn   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   __init__ä  s    c         C   s’   t  | ƒ d k r d Sxu t  | ƒ d k r | d j d ƒ r |  j | ƒ \ } } | se d | d S| sw d | d St |  j | | ƒ q Wd S(   s   Parse command line optionsi    s   --s   Option s    not recognizeds    needs a valueN(   t   lenR   t
   startswitht
   readoptiont   setattrRn   (   Ro   t   argst   keyt   value(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parseoptionsç  s    (c         C   s/  | d d } | d =d | k r6 |  j  | | ƒ } n | j d d ƒ } t |  j | ƒ sd d | f St |  j | ƒ } t | t ƒ r | t f St	 | ƒ d k r« | d f S| d j
 d ƒ rå | d } | d =| |  j | | ƒ f S| d j d ƒ } | d =t | t ƒ r%| j | ƒ | | f S| | f S(	   s$   Read the key and value for an optioni    i   t   =t   -t    t   "s   utf-8N(   t   readequalskeyt   replacet   hasattrRn   R   t   getattrt
   isinstancet   boolt   TrueRq   Rr   t
   readquotedt   decodet   listt   append(   Ro   Ru   t   argRv   t   currentt   initialRw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRs   ô  s,    




c         C   sÈ   t  j d ƒ | d } xl t | ƒ d k r… | d j d ƒ r… | d j d ƒ r… t  j d | d ƒ | d | d 7} | d =q Wt | ƒ d k s« | d j d ƒ r¯ d	 S| d | d d !7} | S(
   s   Read a value between quotest   Oopsi   i    R|   s   --s
   Appending t    iÿÿÿÿN(   R    R   Rq   t   endswithRr   R   (   Ro   Ru   RŠ   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR„     s    
=%c         C   s:   | j  d d ƒ } | d } | d } | j d | ƒ | S(   s   Read a key using equalsRy   i   i    (   t   splitt   insert(   Ro   Rˆ   Ru   R   Rv   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR}     s
    

(   R   R   R   Rp   Rx   Rs   R„   R}   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRm   á  s   				t   Optionsc           B   sš  e  Z d  Z d Z d Z e Z e Z e Z	 e Z
 e Z e Z e Z e Z e Z e Z e Z e Z g  Z d Z d Z d Z d Z e Z d Z d Z d Z e Z d Z d Z e Z  e Z! e Z" d Z# e Z$ d Z% d Z& e Z' e Z( d Z) e Z* e Z+ e Z, e Z- e Z. e Z/ e Z0 e Z1 e Z2 e Z3 d Z4 d Z5 e Z6 e Z7 g  Z8 e9 ƒ  Z: d „  Z; d „  Z< d „  Z= d „  Z> d „  Z? d „  Z@ d	 „  ZA d
 „  ZB d „  ZC RS(   s   A set of runtime optionsR{   t   imagemagickc         C   s]   | d t  _ | d =t t  ƒ } | j | ƒ } | rO t j | ƒ |  j ƒ  n  |  j ƒ  d S(   s   Parse command line optionsi    N(   R   t   locationRm   Rx   R    R   t   usaget   processoptions(   Ro   Ru   t   parsert   result(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRx   `  s    c         C   s?  t  j r |  j ƒ  n  t  j r, |  j ƒ  n  t  j rB |  j ƒ  n  t  j rX |  j ƒ  n  t  j	 rn |  j
 ƒ  n  t  j rá y? t t  j ƒ t  _ t  j d k rµ t j d ƒ |  j ƒ  n  Wqá t j d t  j ƒ |  j ƒ  qá Xn  t  j sü t  j sü t  j rt t  _ n  |  j ƒ  t  j r4t  j r4t  j t  _ n  t  j d k rOt t  _ n  t  j g  k rmd g t  _ n  t  j d k rn  t  j r”t t  _ n  t  j rÃt  j rÃt j d ƒ t  j t  _ n  t  j rÜt j d ƒ n  t  j rõt j d	 ƒ n  xC t  t ƒ D]5 } | j! d
 ƒ rt" t | t# |  | d  ƒ ƒ qqWd S(   s   Process all options parsed.i    s.   --splitpart requires a number bigger than zeros*   --splitpart needs a numeric argument, not t   copys    http://elyxer.nongnu.org/lyx.cssR{   s7   Option --toc is deprecated; use --tocfor "page" insteads5   Option --nocopy is deprecated; it is no longer neededs4   Option --jsmath is deprecated; use --mathjax insteadt   modeiüÿÿÿN($   R   t   helpR“   RJ   t   showversiont   hardversiont   showhardversiont   versiondatet   showversiondatet	   lyxformatt   showlyxformatt	   splitpartt   intR    R   t   lowmemt   toct   tocforR   t   memoryt   parsefootnotest   forceformatt   imageformatRƒ   t
   copyimagest   csst   faviconR/   t
   simplematht	   toctargett   nocopyt   jsmatht   dirR   Rt   R€   (   Ro   t   param(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR”   k  sT    						
			c         C   sY   t  j d t j j t j ƒ d ƒ t  j d ƒ t  j d ƒ t  j d ƒ |  j ƒ  d S(   s   Show correct usages   Usage: s    [options] [filein] [fileout]s7   Convert LyX input file "filein" to HTML file "fileout".sC   If filein (or fileout) is not given use standard input (or output).s?   Main program of the eLyXer package (http://elyxer.nongnu.org/).N(   R    R   t   ost   patht   basenameR   R’   t   showoptions(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR“   ™  s
    $c         C   sÖ   t  j s d St t  _ t t  _ t t  _ t  j j d ƒ } xK | D]C } | d } t t  | ƒ rs t t  | t	 ƒ qA t
 j d | ƒ qA Wt  j r² t  j r² t  j r² t	 t  _ n  t  j rÒ t  j rÒ t	 t  _ n  d S(   s   Parse footnotes options.Nt   ,t   foots   Unknown footnotes option: (   R   t	   footnotesR   t
   marginfoott
   letterfoott	   hoverfootR   R   Rt   Rƒ   R    R   t   endfoott
   numberfoott
   symbolfoot(   Ro   Rn   t   optiont
   footoption(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR§   ¡  s    				
c         C   s²  t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d	 ƒ t  j d
 ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d ƒ t  j d  ƒ t  j d! ƒ t  j d" ƒ t  j d# ƒ t  j d$ ƒ t  j d% ƒ t  j d& ƒ t  j d' ƒ t  j d( ƒ t  j d) ƒ t  j d* ƒ t  j d+ ƒ t  j d, ƒ t  j d- ƒ t  j d. ƒ t  j d/ ƒ t  j d0 ƒ t  j d1 ƒ t  j d2 ƒ t  j d3 ƒ t  j d4 ƒ t j ƒ  d5 S(6   s   Show all possible optionss     Common options:s1       --help:                 show this online helps9       --quiet:                disables all runtime messagesR{   s     Advanced options:sF       --debug:                enable debugging messages (for developers)s@       --version:              show version number and release datesD       --lyxformat:            return the highest LyX version supporteds     Options for HTML output:s8       --title "title":        set the generated page titles1       --css "file.css":       use a custom CSS filesH       --embedcss "file.css":  embed styles from a CSS file into the outputsG       --favicon "icon.ico":   insert the specified favicon in the header.sH       --html:                 output HTML 4.0 instead of the default XHTMLs/       --unicode:              full Unicode outputsG       --iso885915:            output a document with ISO-8859-15 encodingsC       --nofooter:             remove the footer "generated by eLyXer"sD       --simplemath:           do not generate fancy math constructionss     Options for image output:sF       --directory "img_dir":  look for images in the specified directorysD       --destdirectory "dest": put converted images into this directorysI       --imageformat ".ext":   image output format, or "copy" to copy imagessL       --noconvert:            do not convert images, use in original locationssH       --converter "inkscape": use an alternative program to convert imagess     Options for footnote display:sJ       --numberfoot:           mark footnotes with numbers instead of letterssB       --symbolfoot:           mark footnotes with symbols (*, **...)sE       --hoverfoot:            show footnotes as hovering text (default)s=       --marginfoot:           show footnotes on the page marginsA       --endfoot:              show footnotes at the end of the pagesJ       --supfoot:              use superscript for footnote markers (default)sA       --alignfoot:            use aligned text for footnote markerssM       --footnotes "options":  specify several comma-separated footnotes optionssJ         Available options are: "number", "symbol", "hover", "margin", "end",s           "sup", "align"s     Advanced output options:sJ       --splitpart "depth":    split the resulting webpage at the given depthsH       --tocfor "page":        generate a TOC that points to the given pagesC       --target "frame":       make all links point to the given framesL       --notoclabels:          omit the part labels in the TOC, such as ChaptersJ       --lowmem:               do the conversion on the fly (conserve memory)sC       --raw:                  generate HTML without header or footer.sE       --mathjax remote:       use MathJax remotely to display equationssO       --mathjax "URL":        use MathJax from the given URL to display equationssH       --googlecharts:         use Google Charts to generate formula imagessM       --template "file":      use a template, put everything in <!--$content-->s@       --copyright:            add a copyright notice at the bottoms     Deprecated options:sC       --toc:                  (deprecated) create a table of contentssJ       --toctarget "page":     (deprecated) generate a TOC for the given pagesO       --nocopy:               (deprecated) maintained for backwards compatibilitysN       --jsmath "URL":         use jsMath from the given URL to display equationsN(   R    R   R   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¶   ´  sj    c         C   sE   d t  j d } | d t  j d d 7} t j | ƒ t j ƒ  d S(   s(   Return the current eLyXer version strings   eLyXer version t   numbers    (t   datet   )N(   RI   RJ   R    R   R   R   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRš   ì  s    c         C   s"   t  j t j d ƒ t j ƒ  d S(   s   Return just the version stringRÂ   N(   R    R   RI   RJ   R   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRœ   ó  s    c         C   s"   t  j t j d ƒ t j ƒ  d S(   s   Return just the version dteRÃ   N(   R    R   RI   RJ   R   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   ø  s    c         C   s"   t  j t j d ƒ t j ƒ  d S(   s#   Return just the lyxformat parameterRŸ   N(   R    R   RI   RJ   R   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    ı  s    N(D   R   R   R   R   t   instanceR’   R   R¯   t	   copyrightR   t   quietRJ   R›   R   R/   R™   Rƒ   t	   showlinest   unicodeR0   R«   R¬   t   titlet	   directoryt   destdirectoryR¤   R®   R¥   R¨   RŸ   t   targetR¡   R¦   R£   t   nobibt	   convertert   rawR°   t   mathjaxt   nofooterR­   t   templatet	   noconvertt   notoclabelsR»   R¾   R¿   R¼   Rº   R½   t   supfoott	   alignfootR¹   R©   Rª   t   googlechartst   embedcsst   dictt   branchesRx   R”   R“   R§   R¶   Rš   Rœ   R   R    (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   &  s|   			.			8			t   BranchOptionsc           B   s2   e  Z d  Z d „  Z d „  Z d „  Z d „  Z RS(   s   A set of options for a branchc         C   s   | |  _  i d d 6|  _ d  S(   Ns   #fffffft   color(   t   nameRn   (   Ro   RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp     s    	c         C   sU   | j  t j d ƒ s+ t j d | ƒ d S| j t j d d ƒ } | |  j | <d S(   s   Set a branch optiont   startcommands   Invalid branch option NR{   (   Rr   R$   R)   R    R   R~   Rn   (   Ro   Rv   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   set	  s
    c         C   s$   d |  j  k r t S|  j  d d k S(   s    Return if the branch is selectedt   selectedt   1(   Rn   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   isselected  s    c         C   s   d |  j  d t |  j ƒ S(   s   String representations   options for s   : (   RŞ   RÉ   Rn   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   __unicode__  s    (   R   R   R   Rp   Rà   Rã   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÜ     s
   			t   Clonerc           B   s8   e  Z d  Z d „  Z d „  Z e e ƒ Z e e ƒ Z RS(   s&   An object used to clone other objects.c         C   s   |  j  | j ƒ S(   s"   Return an exact copy of an object.(   t   createt	   __class__(   R   t   original(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   clone*  s    c         C   s   | j  | ƒ } | j ƒ  | S(   s"   Create an object of a given class.(   t   __new__Rp   (   R   t   typeRé   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRæ   /  s    
(   R   R   R   Ré   Ræ   R   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRå   '  s
   		t   ContainerExtractorc           B   s2   e  Z d  Z d „  Z d „  Z d „  Z d „  Z RS(   s&   A class to extract certain containers.c         C   s+   | d |  _  | d |  _ | d |  _ d S(   sT   The config parameter is a map containing three lists: allowed, copied and extracted.t   allowedt   clonedt	   extractedN(   Rí   Rî   Rï   (   Ro   t   config(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ;  s    c            sM   g  ‰  ‡ f d †  } ‡ f d †  } ‡  ‡ f d †  } | j  | | | ƒ ˆ  S(   s?   Extract a group of selected containers from elyxer.a container.c            s   |  j  j ˆ  j ˆ  j k S(   N(   Rç   R   Rí   Rî   (   t   c(   Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   <lambda>I  s    c            s   |  j  j ˆ  j k S(   N(   Rç   R   Rï   (   Rñ   (   Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   J  s    c            s   ˆ j  |  ˆ  ƒ S(   N(   t   process(   Rñ   (   R†   Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   K  s    (   t   recursivesearch(   Ro   t	   containert   locatet	   recursiveRó   (    (   R†   Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   extractF  s    c         C   sh   | j  j } | |  j k r+ | j | ƒ n9 | |  j k rS | j |  j | ƒ ƒ n t j d | ƒ d S(   sB   Add allowed containers, clone cloned containers and add the clone.s   Unknown container class N(   Rç   R   Rí   R‡   Rî   t	   safecloneR    R   (   Ro   Rõ   R†   RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   O  s    c         C   s1   t  j | ƒ } | j | _ |  j | ƒ | _ | S(   sF   Return a new container with contents only in a safe list, recursively.(   Rå   Ré   t   outputRø   t   contents(   Ro   Rõ   Ré   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRù   Y  s    (   R   R   R   Rp   Rø   Ró   Rù   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì   8  s
   				
t   Parserc           B   sM   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 RS(   s   A generic parserc         C   s   d |  _  t ƒ  |  _ d  S(   Ni    (   t   beginRÚ   RL   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   h  s    	c         C   s,   | j  ƒ  j ƒ  } | j ƒ  | j |  _ | S(   s   Parse the header(   t   currentlineR   t   nextlinet
   linenumberRı   (   Ro   t   readert   header(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parseheaderl  s    
c         C   sÿ   | j  ƒ  j ƒ  j d ƒ rA |  j | ƒ \ } } | |  j | <d S| j  ƒ  j ƒ  j d d ƒ } | j ƒ  t | ƒ d k r d S| d } t | ƒ d k r¬ t |  j | <d Sd | d k r× | d j ƒ  |  j | <d S| d j d ƒ } | d |  j | <d S(   s   Parse a parametert   <NRŒ   i   i    R|   (	   Rş   t   stripRr   t   parsexmlRL   R   Rÿ   Rq   Rƒ   (   Ro   R  Rv   Rw   R   t   doublesplit(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parseparameters  s"    

c   
      C   s9  | j  ƒ  j ƒ  } | j ƒ  | j d ƒ sC t j d | d ƒ n  | d d !j ƒ  } t | ƒ d k ry t j d ƒ d S| d } | d =t | ƒ d k r© | t	 ƒ  f St	 ƒ  } xz | D]r } d | k rñ t j d	 | d
 | ƒ | d 7} n  | j d ƒ } | d } | d j d ƒ d }	 |	 | | <q¹ W| | f S(   s5   Parse a parameter in xml form: <param attr1=value...>t   >s   XML parameter s    should be <...>i   iÿÿÿÿi    s   Empty XML parameter <>Ry   s   Erroneous attribute for s   : s   ="0"R|   N(   NN(
   Rş   R  Rÿ   R   R    R   R   Rq   R   RÚ   (
   Ro   R  R  R   Rv   t   attrst   attrt   partst   attrkeyRw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ‡  s,    

	
c         C   sN   |  j  s$ t j d t |  ƒ ƒ d Sx# | j ƒ  j |  j  ƒ sI | ƒ  q' Wd S(   s'   Parse until the current ending is founds   No ending for N(   t   endingR    R   RÉ   Rş   Rr   (   Ro   R  Ró   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parseending   s
    	c         C   s8   |  j  j | ƒ } | r4 |  j | _ | j | ƒ n  d  S(   N(   t   factoryt   createcontainert   parentR‡   (   Ro   R  Rû   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parsecontainer¨  s    c         C   s   |  j  j d t |  j ƒ d S(   s   Return a descriptions    (RÄ   (   Rç   R   RÉ   Rı   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   ®  s    (
   R   R   R   Rp   R  R  R  R  R  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRü   e  s   						t   LoneCommandc           B   s   e  Z d  Z d „  Z RS(   s"   A parser for just one command linec         C   s   g  S(   s   Read nothing(    (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parseµ  s    (   R   R   R   R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ²  s   t
   TextParserc           B   s/   e  Z d  Z g  Z d „  Z d „  Z d „  Z RS(   s(   A parser for a command and a bit of textc         C   sQ   t  j |  ƒ d  |  _ | j j t j k rD t j | j j |  _ n  g  |  _ d  S(   N(   Rü   Rp   R   R  Rç   R   R$   R%   (   Ro   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ¾  s
    	c         C   sm   t  j j |  j ƒ t  j t j d t j d |  j g |  _ g  } x# |  j | ƒ sh |  j | | ƒ qF W| S(   s$   Parse lines as long as they are textt   Layoutt   Inset(   R  t   stackR‡   R  R$   R%   t   isendingR  (   Ro   R  Rû   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Å  s    c         C   sv   | j  ƒ  j ƒ  } t | ƒ d k r( t S| d |  j k rr | d t j k re t j j | d ƒ n	 g  t _ t St S(   s   Check if text is endingi    (	   Rş   R   Rq   R   R%   R  R  t   removeRƒ   (   Ro   R  R‰   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Ï  s    	(   R   R   R   R  Rp   R  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ¹  s
   		
t   ExcludingParserc           B   s   e  Z d  Z d „  Z RS(   s%   A parser that excludes the final linec            s)   g  ‰  ˆ j  ˆ ‡  ‡ ‡ f d †  ƒ ˆ  S(   s5   Parse everything up to (and excluding) the final linec              s   ˆ j  ˆ ˆ  ƒ S(   N(   R  (    (   Rû   R  Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   â  s    (   R  (   Ro   R  (    (   Rû   R  Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ß  s    (   R   R   R   R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Ü  s   t   BoundedParserc           B   s   e  Z d  Z d „  Z RS(   s   A parser bound by a final linec         C   s    t  j |  | ƒ } | j ƒ  | S(   s*   Parse everything, including the final line(   R  R  Rÿ   (   Ro   R  Rû   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  è  s    
(   R   R   R   R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  å  s   t   BoundedDummyc           B   s   e  Z d  Z d „  Z RS(   s&   A bound parser that ignores everythingc            s'   |  j  ˆ  ‡  f d †  ƒ ˆ  j ƒ  g  S(   s#   Parse the contents of the containerc              s
   ˆ  j  ƒ  S(   N(   Rÿ   (    (   R  (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   ô  s    (   R  Rÿ   (   Ro   R  (    (   R  s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ò  s    
(   R   R   R   R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ï  s   t   StringParserc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   Parses just a stringc         C   s   | j  d |  _ g  S(   s   Do nothing, just take notei   (   R   Rı   (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ü  s    c         C   s   | j  ƒ  } | j ƒ  | S(   s   Parse a single line(   Rş   Rÿ   (   Ro   R  Rû   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    s    
(   R   R   R   R  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ù  s   	t   InsetParserc           B   s   e  Z d  Z d „  Z RS(   s   Parses a LyX insetc         C   sY   t  j d } x9 | j ƒ  d k rH | j ƒ  j | ƒ rH |  j | ƒ q Wt j |  | ƒ S(   s(   Parse inset parameters into a dictionaryRß   R{   (   R$   R)   Rş   Rr   R  R  R  (   Ro   R  Rß   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  
  s    +(   R   R   R   R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR     s   t   ContainerOutputc           B   s    e  Z d  Z d „  Z d „  Z RS(   s(   The generic HTML output for a container.c         C   s   t  j d t |  ƒ ƒ d S(   s   Show an error.s   gethtml() not implemented for N(   R    R   RÉ   (   Ro   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   gethtml  s    c         C   s   t  S(   s5   Decide if the output is empty: by default, not empty.(   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   isempty  s    (   R   R   R   R"  R#  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR!    s   	t   EmptyOutputc           B   s   e  Z d  „  Z d „  Z RS(   c         C   s   g  S(   s   Return empty HTML code.(    (   Ro   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"  #  s    c         C   s   t  S(   s"   This output is particularly empty.(   Rƒ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR#  '  s    (   R   R   R"  R#  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR$  !  s   	t   FixedOutputc           B   s   e  Z d  Z d „  Z RS(   s   Fixed outputc         C   s   | j  S(   s   Return constant HTML code(   R/   (   Ro   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"  .  s    (   R   R   R   R"  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR%  +  s   t   ContentsOutputc           B   s   e  Z d  Z d „  Z RS(   s&   Outputs the contents converted to HTMLc         C   sy   g  } | j  d k r | SxY | j  D]N } t | d ƒ sa t j d | j j d t | ƒ ƒ | S| | j ƒ  7} q# W| S(   s   Return the HTML codeR"  s   No html in s   : N(	   Rû   R   R   R    R   Rç   R   RÉ   R"  (   Ro   Rõ   R/   t   element(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"  5  s    %(   R   R   R   R"  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR&  2  s   t   TaggedOutputc           B   se   e  Z d  Z d Z e Z e Z e e d „ Z d „  Z	 d „  Z
 d „  Z d „  Z d „  Z d „  Z RS(	   s-   Outputs an HTML tag surrounding the contents.c         C   s1   | |  _  | r | |  _ n  | r- | |  _ n  |  S(   s/   Set the value for the tag and other attributes.(   t   tagt
   breaklinest   empty(   Ro   R)  R*  R+  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   settagH  s    	c         C   s   | |  _  |  S(   s   Set the value for breaklines.(   R*  (   Ro   R*  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setbreaklinesQ  s    	c         C   s[   |  j  r |  j | ƒ g S|  j | ƒ g } | t j |  | ƒ 7} | j |  j | ƒ ƒ | S(   s   Return the HTML code.(   R+  t   selfclosingt   openR&  R"  R‡   t   close(   Ro   Rõ   R/   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"  V  s    	c         C   s6   |  j  ƒ  s d Sd |  j d } |  j r2 | d S| S(   s   Get opening line.R{   R  R	  s   
(   t   checktagR)  R*  (   Ro   Rõ   R/  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR/  _  s    	c         C   sD   |  j  ƒ  s d Sd |  j j ƒ  d d } |  j r@ d | d S| S(   s   Get closing line.R{   s   </i    R	  s   
(   R1  R)  R   R*  (   Ro   Rõ   R0  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR0  h  s    	c         C   s6   |  j  ƒ  s d Sd |  j d } |  j r2 | d S| S(   s   Get self-closing line.R{   R  s   />s   
(   R1  R)  R*  (   Ro   Rõ   R.  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR.  q  s    	c         C   s;   |  j  s$ t j d t t ƒ ƒ t S|  j  d k r7 t St S(   s   Check that the tag is valid.s
   No tag in R{   (   R)  R    R   RÉ   Rõ   R   Rƒ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR1  z  s    	N(   R   R   R   R   R)  R   R*  R+  R,  R-  R"  R/  R0  R.  R1  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR(  A  s   										t   FilteredOutputc           B   s2   e  Z d  Z d „  Z d „  Z d „  Z d „  Z RS(   s1   Returns the output in the contents, but filtered:c         C   s   g  |  _  d S(   s   Initialize the filters.N(   t   filters(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ‡  s    c         C   s   |  j  j | | f ƒ d S(   s:   Add a new filter: replace the original by the replacement.N(   R3  R‡   (   Ro   Rè   t   replacement(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   addfilter‹  s    c         C   sC   g  } t  j |  | ƒ } x$ | D] } | j |  j | ƒ ƒ q W| S(   s   Return the HTML code(   R&  R"  R‡   t   filter(   Ro   Rõ   R–   R/   t   line(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"    s
    c         C   s?   x8 |  j  D]- \ } } | | k r
 | j | | ƒ } q
 q
 W| S(   s0   Filter a single line with all available filters.(   R3  R~   (   Ro   R7  Rè   R4  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR6  —  s    (   R   R   R   Rp   R5  R"  R6  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR2  ƒ  s
   			t   StringOutputc           B   s   e  Z d  Z d „  Z RS(   s   Returns a bare string as outputc         C   s
   | j  g S(   s   Return a bare string(   R)   (   Ro   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"  ¡  s    (   R   R   R   R"  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR8    s   t
   LineReaderc           B   sV   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 RS(	   s   Reads a file line by linec         C   s±   t  | t ƒ r | |  _ n t j | d d ƒ |  _ d |  _ d  |  _ d  |  _ t |  _	 t
 |  _ y |  j ƒ  Wn< t k
 r¬ d d  l } | j | d ƒ |  _ |  j ƒ  n Xd  S(   Nt   rUs   utf-8i   iÿÿÿÿt   rb(   R   t   filet   codecsR/  R   R   t   lastlineR‰   Rƒ   t   mustreadR   t   depletedt   readlinet   UnicodeDecodeErrort   gzip(   Ro   t   filenameRC  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ²  s    					c         C   s1   x! t  | ƒ D] } |  j j ƒ  q W| |  _ d S(   s   Set the first line to read.N(   t   rangeR<  RA  R   (   Ro   t	   firstlinet   i(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setstartÄ  s    c         C   s   | |  _  d S(   s   Set the last line to read.N(   R>  (   Ro   R>  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setendÊ  s    c         C   s   |  j  r |  j ƒ  n  |  j S(   s   Get the current line(   R?  RA  R‰   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRş   Î  s    	c         C   s&   |  j  r t j d ƒ n  t |  _ d S(   s   Go to next lines   Read beyond file endN(   R@  R    R   Rƒ   R?  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÿ   Ô  s    	c         C   sÎ   |  j  j ƒ  |  _ t |  j  t j ƒ s? |  j j d ƒ |  _ n  t |  j ƒ d k r` t |  _	 n  |  j j
 d ƒ |  _ |  j d 7_ t |  _ d t |  j ƒ d t _ |  j d d k rÊ t j d ƒ n  d	 S(
   s   Read a line from elyxer.files   utf-8i    s   
i   s   Line s   : iè  t   ParsingN(   R<  RA  R‰   R   R=  t   StreamReaderWriterR…   Rq   Rƒ   R@  t   rstripR   R   R?  RÉ   R    R	   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRA  Ú  s    	c         C   s<   |  j  r |  j |  j  k r t S|  j r5 |  j ƒ  n  |  j S(   s    Find out if the file is finished(   R>  R   Rƒ   R?  RA  R@  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   finishedè  s
    	c         C   s   |  j  j ƒ  d  S(   N(   R<  R0  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR0  ğ  s    (   R   R   R   Rp   RH  RI  Rş   Rÿ   RA  RM  R0  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR9  ¯  s   							t
   LineWriterc           B   sA   e  Z d  Z e Z d „  Z d „  Z d „  Z d „  Z d „  Z	 RS(   s"   Writes a file as a series of listsc         C   s1   t  | t ƒ r$ | |  _ d  |  _ n	 | |  _ d  S(   N(   R   R<  R   RD  (   Ro   RD  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ø  s    	c         C   sZ   xS | D]K } t  | t ƒ sE t j d t | ƒ d t | ƒ ƒ d S|  j | ƒ q Wd S(   s   Write a list of stringss   Not a string: s    in N(   R   t
   basestringR    R   RÉ   t   writestring(   Ro   t   stringsR)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   ÿ  s
    %c         C   sn   |  j  s' t j |  j d d ƒ |  _  n  |  j  t j k rZ t j d k  rZ | j d ƒ } n  |  j  j | ƒ d S(   s   Write a stringt   ws   utf-8i   i    N(   i   i    (	   R<  R=  R/  RD  R   R   R   R   R   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRP    s
    	!c         C   s   |  j  | d ƒ d S(   s   Write a line to files   
N(   RP  (   Ro   R7  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   writeline  s    c         C   s   |  j  j ƒ  d  S(   N(   R<  R0  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR0    s    (
   R   R   R   R   R<  Rp   R   RP  RS  R0  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRN  ó  s   				t   Globablec           B   sÎ   e  Z d  Z e Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d „  Z d „  Z d	 „  Z d
 „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z e d „ Z d d „ Z d „  Z RS(   s    A bit of text which can be globbed (lumped together in bits).
  Methods current(), skipcurrent(), checkfor() and isout() have to be
  implemented by subclasses.c         C   s   t  ƒ  |  _ d  S(   N(   t
   EndingListt
   endinglist(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   "  s    c         C   s9   |  j  ƒ  r d St |  j ƒ  ƒ d k r5 |  j ƒ  n  d S(   s*   Check for a Unicode byte mark and skip it.Niÿş  (   RM  t   ordR‰   t   skipcurrent(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   checkbytemark%  s    c         C   s   t  j d ƒ t S(   s+   Find out if we are out of the position yet.s   Unimplemented isout()(   R    R   Rƒ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   isout,  s    c         C   s   t  j d ƒ d S(   s   Return the current character.s   Unimplemented current()R{   (   R    R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR‰   1  s    c         C   s   t  j d ƒ t S(   s3   Check for the given string in the current position.s   Unimplemented checkfor()(   R    R   R   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   checkfor6  s    c         C   s9   |  j  ƒ  r) |  j s% |  j j ƒ  n  t S|  j j |  ƒ S(   s*   Find out if the current text has finished.(   RZ  t   leavependingRV  t   checkpendingRƒ   t   checkin(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRM  ;  s
    	c         C   s   t  j d ƒ d S(   s)   Return the current character and skip it.s   Unimplemented skipcurrent()R{   (   R    R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRX  C  s    c         C   s7   d } x* |  j  ƒ  r2 | ƒ  r2 | |  j ƒ  7} q	 W| S(   s>   Glob a bit of text that satisfies a check on the current char.R{   (   RM  RX  (   Ro   t   currentcheckt   glob(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR`  H  s    c            s   ˆ  j  ‡  f d †  ƒ S(   s   Glob a bit of alpha textc              s   ˆ  j  ƒ  j ƒ  S(   N(   R‰   t   isalpha(    (   Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   Q  s    (   R`  (   Ro   (    (   Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   globalphaO  s    c            s   ˆ  j  ‡  f d †  ƒ S(   s   Glob a row of digits.c              s   ˆ  j  ƒ  j ƒ  S(   N(   R‰   t   isdigit(    (   Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   U  s    (   R`  (   Ro   (    (   Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   globnumberS  s    c         C   s,   |  j  ƒ  j ƒ  s$ |  j  ƒ  d k r( t St S(   s5   Return if the current character is alphanumeric or _.t   _(   R‰   t   isalnumRƒ   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   isidentifierW  s    $c         C   s   |  j  |  j ƒ S(   s    Glob alphanumeric and _ symbols.(   R`  Rg  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   globidentifier]  s    c         C   s0   |  j  ƒ  j ƒ  r t S|  j  ƒ  d k r, t St S(   s5   Return if the current character is a value character:s   {}()(   R‰   t   isspaceR   Rƒ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   isvaluea  s
    c         C   s   |  j  |  j ƒ S(   s'   Glob a value: any symbols but brackets.(   R`  Rj  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   globvaluej  s    c            s   ˆ  j  ‡  f d †  ƒ S(   s(   Skip all whitespace at current position.c              s   ˆ  j  ƒ  j ƒ  S(   N(   R‰   Ri  (    (   Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   p  s    (   R`  (   Ro   (    (   Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   skipspacen  s    c            s0   ˆ j  ‡  ‡ f d †  ƒ ˆ  } ˆ j ˆ  ƒ | S(   s4   Glob a bit of text up to (including) the magic char.c              s   ˆ j  ƒ  ˆ  k S(   N(   R‰   (    (   t	   magiccharRo   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   t  s    (   R`  t   skip(   Ro   Rm  R`  (    (   Rm  Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   globincludingr  s    c            s   ˆ j  ‡  ‡ f d †  ƒ S(   s?   Glob a bit of text up until (excluding) any excluded character.c              s   ˆ j  ƒ  ˆ  k S(   N(   R‰   (    (   t   excludedRo   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   z  s    (   R`  (   Ro   Rp  (    (   Rp  Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   globexcludingx  s    c         C   s   |  j  j | | ƒ d S(   s   Push a new ending to the bottomN(   RV  t   add(   Ro   R  t   optional(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   pushending|  s    c         C   sj   |  j  ƒ  r |  j r | S|  j j |  ƒ } | rY | | k rY t j d | d | ƒ n  |  j | ƒ | S(   s,   Pop the ending found at the current positions   Expected ending s   , got (   RZ  R\  RV  t   popR    R   Rn  (   Ro   t   expectedR  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   popending€  s    c         C   s#   |  j  j |  ƒ } | s d S| j S(   s$   Return the next ending in the queue.N(   RV  t
   findendingR   R  (   Ro   t
   nextending(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRy  Š  s    N(   R   R   R   R   R\  Rp   RY  RZ  R‰   R[  RM  RX  R`  Rb  Rd  Rg  Rh  Rj  Rk  Rl  Ro  Rq  Rt  R   Rw  Ry  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRT    s,   																		
RU  c           B   sY   e  Z d  Z d „  Z e d „ Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d „  Z RS(	   s   A list of position endingsc         C   s   g  |  _  d  S(   N(   R%   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ”  s    c         C   s   |  j  j t | | ƒ ƒ d S(   s   Add a new ending to the listN(   R%   R‡   t   PositionEnding(   Ro   R  Rs  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRr  —  s    c         C   s   |  j  | j j  7_  d S(   s/   Pick any pending endings from a parse position.N(   R%   RV  (   Ro   t   pos(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   pickpending›  s    c         C   s   |  j  | ƒ r t St S(   s   Search for an ending(   Rx  Rƒ   R   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR^  Ÿ  s    c         C   s¸   | j  ƒ  r t j d ƒ d S|  j | ƒ } | sM t j d | j ƒ  ƒ d SxW t |  j ƒ D]F } |  j j | ƒ | | k r† | j S| j	 s] t j d | ƒ q] q] Wt j d ƒ d S(   s)   Remove the ending at the current positions   No ending out of boundsR{   s   No ending at s   Removed non-optional ending s   No endings left(
   RZ  R    R   Rx  R‰   t   reversedR%   R  R  Rs  (   Ro   R{  R  t   each(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRu  ¥  s    	c         C   sc   t  |  j ƒ d k r d SxC t t |  j ƒ ƒ D], \ } } | j | ƒ rN | S| j s/ d Sq/ Wd S(   s'   Find the ending at the current positioni    N(   Rq   R%   R   t	   enumerateR}  R^  Rs  (   Ro   R{  t   indexR  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRx  ·  s    "	c         C   s7   t  |  j ƒ d k r3 t j d t |  ƒ d ƒ n  d S(   s&   Check if there are any pending endingsi    s   Pending s
    left openN(   Rq   R%   R    R   RÉ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR]  Â  s    c         C   sX   d } x% |  j  D] } | t | ƒ d 7} q Wt |  j  ƒ d k rP | d  } n  | d S(   s   Printable representations	   endings [R·   i    iÿÿÿÿt   ](   R%   RÉ   Rq   (   Ro   R)   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   Ç  s    (   R   R   R   Rp   R   Rr  R|  R^  Ru  Rx  R]  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRU  ‘  s   						Rz  c           B   s)   e  Z d  Z d „  Z d „  Z d „  Z RS(   s    An ending for a parsing positionc         C   s   | |  _  | |  _ d  S(   N(   R  Rs  (   Ro   R  Rs  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   Ó  s    	c         C   s   | j  |  j ƒ S(   s   Check for the ending(   R[  R  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR^  ×  s    c         C   s'   d |  j  } |  j r# | d 7} n  | S(   s   Printable representations   Ending s    (optional)(   R  Rs  (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   Û  s    	(   R   R   R   Rp   R^  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRz  Ğ  s   		t   Positionc           B   sh   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d	 „  Z d
 „  Z RS(   s¡   A position in a text to parse.
  Including those in Globable, functions to implement by subclasses are:
  skip(), identifier(), extract(), isout() and current().c         C   s   t  j |  ƒ d  S(   N(   RT  Rp   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   é  s    c         C   s   t  j d ƒ d S(   s   Skip a strings   Unimplemented skip()N(   R    R   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRn  ì  s    c         C   s   t  j d ƒ d S(   s.   Return an identifier for the current position.s   Unimplemented identifier()t   Error(   R    R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   identifierğ  s    c         C   s   t  j d ƒ d S(   sH   Extract the next string of the given length, or None if not enough text,s   Unimplemented extract()N(   R    R   R   (   Ro   t   length(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRø   õ  s    c         C   s   | |  j  t | ƒ ƒ k S(   s)   Check for a string at the given position.(   Rø   Rq   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR[  û  s    c         C   sD   |  j  t | ƒ ƒ } | s t S| j ƒ  |  j  t | ƒ ƒ j ƒ  k S(   s!   Check for a string in lower case.(   Rø   Rq   R   t   lower(   Ro   R)   Rï   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   checkforlowerÿ  s    c         C   s   |  j  ƒ  } |  j | ƒ | S(   s)   Return the current character and skip it.(   R‰   Rn  (   Ro   R‰   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRX    s    c         C   s   |  j  ƒ  |  j ƒ  S(   s3   Advance the position and return the next character.(   RX  R‰   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   next  s    
c         C   s$   |  j  | ƒ s t S|  j | ƒ t S(   s;   Check for a string at the given position; if there, skip it(   R[  R   Rn  Rƒ   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   checkskip  s    c         C   s   t  j | d |  j ƒ  ƒ d S(   s2   Show an error message and the position identifier.s   : N(   R    R   R„  (   Ro   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR     s    (   R   R   R   Rp   Rn  R„  Rø   R[  R‡  RX  Rˆ  R‰  R   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR‚  ä  s   									t   TextPositionc           B   sD   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z RS(   s%   A parse position based on a raw text.c         C   s-   t  j |  ƒ d |  _ | |  _ |  j ƒ  d S(   s*   Create the position from elyxer.some text.i    N(   R‚  Rp   R{  t   textRY  (   Ro   R‹  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp     s    		c         C   s   |  j  t | ƒ 7_  d S(   s   Skip a string of characters.N(   R{  Rq   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRn  &  s    c         C   s[   d } |  j  | t |  j ƒ k r; t |  j ƒ |  j  } n  d |  j |  j  |  j  | !d S(   s&   Return a sample of the remaining text.i   t   *(   R{  Rq   R‹  (   Ro   R…  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR„  *  s    c         C   s   |  j  t |  j ƒ k S(   s'   Find out if we are out of the text yet.(   R{  Rq   R‹  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRZ  1  s    c         C   s   |  j  |  j S(   s6   Return the current character, assuming we are not out.(   R‹  R{  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR‰   5  s    c         C   s8   |  j  | t |  j ƒ k r  d S|  j |  j  |  j  | !S(   sH   Extract the next string of the given length, or None if not enough text.N(   R{  Rq   R‹  R   (   Ro   R…  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRø   9  s    (	   R   R   R   Rp   Rn  R„  RZ  R‰   Rø   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRŠ    s   					t   FilePositionc           B   s_   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d	 „  Z RS(
   s-   A parse position based on an underlying file.c         C   s3   t  j |  ƒ t | ƒ |  _ d |  _ |  j ƒ  d S(   s    Create the position from a file.i    N(   R‚  Rp   R9  R  R{  RY  (   Ro   RD  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   B  s    	c         C   sv   t  | ƒ } xT |  j | t  |  j j ƒ  ƒ k rb | t  |  j j ƒ  ƒ |  j d 8} |  j ƒ  q W|  j | 7_ d S(   s   Skip a string of characters.i   N(   Rq   R{  R  Rş   Rÿ   (   Ro   R)   R…  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRn  I  s
    %$c         C   s   |  j  j ƒ  S(   s,   Get the current line of the underlying file.(   R  Rş   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRş   Q  s    c         C   s   |  j  j ƒ  d |  _ d S(   s   Go to the next line.i    N(   R  Rÿ   R{  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÿ   U  s    c         C   s   |  j  j d S(   s#   Return the line number of the file.i   (   R  R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   Z  s    c         C   sT   |  j  j ƒ  |  j d  } |  j  j ƒ  |  j } d t |  j ƒ  ƒ d | d | S(   s4   Return the current line and line number in the file.i   s   line s   : RŒ  (   R  Rş   R{  RÉ   t   getlinenumber(   Ro   t   beforet   after(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR„  ^  s    c         C   sˆ   |  j  t |  j j ƒ  ƒ k r{ |  j  t |  j j ƒ  ƒ d k rn t j d |  j j ƒ  d t |  j  ƒ ƒ n  |  j ƒ  n  |  j j ƒ  S(   s'   Find out if we are out of the text yet.i   s   Out of the line s   : (	   R{  Rq   R  Rş   R    R   RÉ   Rÿ   RM  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRZ  d  s
    ".c         C   sƒ   |  j  t |  j j ƒ  ƒ k r" d S|  j  t |  j j ƒ  ƒ k ro t j d |  j j ƒ  d t |  j  ƒ ƒ d S|  j j ƒ  |  j  S(   s6   Return the current character, assuming we are not out.s   
s   Out of the line s   : RŒ  (   R{  Rq   R  Rş   R    R   RÉ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR‰   l  s    +c         C   sD   |  j  | t |  j j ƒ  ƒ k r& d S|  j j ƒ  |  j  |  j  | !S(   sH   Extract the next string of the given length, or None if not enough text.N(   R{  Rq   R  Rş   R   (   Ro   R…  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRø   u  s    "(   R   R   R   Rp   Rn  Rş   Rÿ   R   R„  RZ  R‰   Rø   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ?  s   									t	   Containerc           B   sÔ   e  Z d  Z d Z d Z d Z d „  Z d „  Z d „  Z	 d „  Z
 e j d „ Z d „  Z d „  Z d „  Z d	 „  Z d
 „  Z d „  Z d „  Z d „  Z d „  Z d d „ Z d „  Z d „  Z d „  Z d „  Z RS(   s.   A container for text and objects in a lyx filec         C   s   t  ƒ  |  _ d  S(   N(   R†   Rû   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   „  s    c         C   s   d S(   s   Process contentsN(    (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ‡  s    c         C   sK   |  j  j |  ƒ } t | t ƒ r> t j d | ƒ | g } n  |  j | ƒ S(   s   Get the resulting HTMLs   Raw string (   Rú   R"  R   RO  R    R   t	   escapeall(   Ro   R/   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"  ‹  s
    c         C   sš   g  } x | D]… } t  j r4 |  j | t j ƒ } n  t  j rd |  j | t j ƒ } |  j | ƒ } n! t  j s… |  j | t j ƒ } n  | j | ƒ q W| S(   s=   Escape all lines in an array according to the output options.(	   R   R/   t   escapeR+   R0   t   escapeentitiesRÉ   R1   R‡   (   Ro   t   linesR–   R7  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR’  “  s    			c         C   sP   | j  ƒ  } | j ƒ  x3 | D]+ } | | k r | j | | | ƒ } q q W| S(   s1   Escape a line with replacements from elyxer.a map(   t   keyst   sortR~   (   Ro   R7  t   replacementst   piecest   piece(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR“  ¡  s    
c         C   s·   d } t  | ƒ } x | j ƒ  s² t | j ƒ  ƒ d k r• t t | j ƒ  ƒ ƒ } | d k r| t t | j ƒ  ƒ d ƒ } n  | d | d d 7} n | | j ƒ  7} | j ƒ  q W| S(   s/   Escape all Unicode characters to HTML entities.R{   i€   t   0xd835i ø  s   &#i   t   ;(   RŠ  RM  RW  R‰   t   hexRˆ  RX  (   Ro   R7  R–   R{  t	   codepoint(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR”  «  s    c            s#   g  ‰  |  j  | ‡  f d †  ƒ ˆ  S(   s2   Search for all embedded containers of a given typec            s   ˆ  j  |  ƒ S(   N(   R‡   (   Rõ   (   R†   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   ½  s    (   t   searchprocess(   Ro   Rë   (    (   R†   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   searchallº  s    c         C   s7   |  j  | ƒ } x! | D] } | j j j | ƒ q W| S(   s3   Search for all containers of a type and remove them(   R   R  Rû   R  (   Ro   Rë   R†   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   searchremoveÀ  s    c            s   |  j  ‡  f d †  | ƒ d S(   s4   Search for elements of a given type and process themc            s   t  |  ˆ  ƒ S(   N(   R   (   Rõ   (   Rë   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   É  s    N(   t   locateprocess(   Ro   Rë   Ró   (    (   Rë   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRŸ  Ç  s    c         C   sA   x: |  j  D]/ } | j | | ƒ | | ƒ r
 | | ƒ q
 q
 Wd S(   s3   Search for all embedded containers and process themN(   Rû   R¢  (   Ro   Rö   Ró   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¢  Ë  s    c         C   sS   xL |  j  D]A } | | ƒ r2 | j | | | ƒ n  | | ƒ r
 | | ƒ q
 q
 Wd S(   s,   Perform a recursive search in the container.N(   Rû   Rô   (   Ro   Rö   R÷   Ró   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRô   Ò  s
    c         C   s@   d } t  t j ƒ j |  ƒ } x | D] } | | j 7} q% W| S(   s0   Extract all text from elyxer.allowed containers.R{   (   Rì   R$   R&   Rø   R)   (   Ro   R–   RU   t   constant(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR&   Ú  s
    c         C   s°   | t  |  j ƒ k r d St |  j | d ƒ r3 d Sxc | t  |  j ƒ k  r˜ | |  j | ƒ r˜ t |  j | _ | j j |  j | ƒ |  j j | ƒ q6 W|  j j | | ƒ d S(   s*   Group some adjoining elements into a groupNt   grouped(   Rq   Rû   R   Rƒ   R¤  R‡   Ru  R   (   Ro   R€  Rf   t	   isingroup(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRf   â  s    +c         C   sY   |  j  | } |  j  j | ƒ x5 t | j  ƒ d k rT |  j  j | | j  j ƒ  ƒ q  Wd S(   s)   Remove a container but leave its contentsi    N(   Rû   Ru  Rq   R   (   Ro   R€  Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  î  s    i    c         C   sD   t  j d | t |  ƒ ƒ x" |  j D] } | j | d ƒ q% Wd S(   s   Show in a trees     i   N(   R    R   RÉ   Rû   t   tree(   Ro   t   levelRõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¦  õ  s    c         C   s   | |  j  k r d S|  j  | S(   s)   Get the value of a parameter, if present.N(   RL   R   (   Ro   RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getparameterû  s    c         C   s&   |  j  | ƒ } | s g  S| j d ƒ S(   s7   Get the value of a comma-separated parameter as a list.R·   (   R¨  R   (   Ro   RŞ   t	   paramtext(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getparameterlist	  s    c         C   s6   |  j  } x& | r1 | j j ƒ  r% t S| j  } q Wt S(   s&   Check if the parent's output is empty.(   R  Rú   R#  Rƒ   R   (   Ro   R‰   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   hasemptyoutput	  s    		c         C   s.   |  j  s |  j j S|  j j d t |  j  ƒ S(   s   Get a descriptiont   @(   Rı   Rç   R   RÉ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   	  s    	
N(   R   R   R   R   t   partkeyR  Rı   Rp   Ró   R"  R’  R+   R.   R“  R”  R   R¡  RŸ  R¢  Rô   R&   Rf   R  R¦  R¨  Rª  R«  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR‘  }  s.   				
													t   BlackBoxc           B   s   e  Z d  Z d „  Z RS(   s)   A container that does not output anythingc         C   s%   t  ƒ  |  _ t ƒ  |  _ g  |  _ d  S(   N(   R  R•   R$  Rú   Rû   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   	  s    (   R   R   R   Rp   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR®  	  s   t	   LyXFormatc           B   s   e  Z d  Z d „  Z RS(   s   Read the lyxformat commandc         C   sp   t  |  j d ƒ } | d k  r9 t j d t | ƒ ƒ n  | t  t j d ƒ k rl t j d t | ƒ ƒ n  d S(   s   Show warning if version < 276i   i  s(   Warning: unsupported old format version RŸ   s(   Warning: unsupported new format version N(   R¢   R  R    R   t   strRI   RJ   (   Ro   RJ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   "	  s
    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¯  	  s   t   StringContainerc           B   sJ   e  Z d  Z d Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 RS(   s   A container for a single stringc         C   s%   t  ƒ  |  _ t ƒ  |  _ d |  _ d  S(   NR{   (   R  R•   R8  Rú   R)   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   /	  s    c         C   s.   |  j  r* |  j |  j  ƒ |  _ d |  _  n  d S(   s/   Replace special chars from elyxer.the contents.N(   t   parsedt   replacespecialR)   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   4	  s    	c         C   s   |  j  | t j ƒ } |  j | ƒ } t j d | k rŒ t | ƒ d k rŒ |  j rl d t |  j ƒ d } n d } t	 j
 | | j ƒ  ƒ n  | S(   s,   Replace all special chars from elyxer.a lineRß   i   s   Unknown command at s   : s   Unknown command: (   R“  R+   R.   t
   changelineR$   R)   Rq   Rı   RÉ   R    R   R  (   Ro   R7  R#   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR³  :	  s    %	c         C   sE   |  j  | t j ƒ } t j d | k r, | S|  j  | t j ƒ } | S(   NRß   (   R“  R+   R,   R$   R)   R-   (   Ro   R7  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR´  G	  s
    c         C   s   |  j  S(   s   Return all text.(   R)   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR&   N	  s    c         C   st   d } |  j  r) | d t |  j  ƒ 7} n  d } t |  j j ƒ  ƒ d k rS d } n  | d |  j j ƒ  d  | d S(   s"   Return a printable representation.R±  R¬  s   ...i   R{   s    (RÄ   (   Rı   RÉ   Rq   R)   R  (   Ro   R–   t   ellipsis(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   R	  s    		N(   R   R   R   R   R²  Rp   Ró   R³  R´  R&   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR±  *	  s   					t   Constantc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   A constant stringc         C   s"   g  |  _  | |  _ t ƒ  |  _ d  S(   N(   Rû   R)   R8  Rú   (   Ro   R‹  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   _	  s    		c         C   s   d |  j  S(   Ns
   Constant: (   R)   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   d	  s    (   R   R   R   Rp   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¶  \	  s   	t
   TaggedTextc           B   s>   e  Z d  Z d Z d „  Z e d „ Z e d „ Z d „  Z	 RS(   s   Text inside a tagc         C   s   t  |  ƒ |  _ t ƒ  |  _ d  S(   N(   R  R•   R(  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   l	  s    c         C   s%   | |  _  | |  j _ | |  j _ |  S(   s&   Complete the tagged text and return it(   Rû   Rú   R)  R*  (   Ro   Rû   R)  R*  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   completep	  s    	c         C   s"   t  | ƒ } |  j | g | | ƒ S(   s(   Complete the tagged text with a constant(   R¶  R¸  (   Ro   R‹  R)  R*  R£  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR£  w	  s    c         C   s8   t  |  j d ƒ s d S|  j j s& d Sd |  j j d S(   s"   Return a printable representation.R)  s   Emtpy tagged texts   Tagged <unknown tag>s   Tagged <R	  (   R   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   |	  s
    N(
   R   R   R   R   Rú   Rp   R   R¸  R£  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR·  g	  s   	t   DocumentParametersc           B   sD   e  Z d  Z d Z e Z d Z d Z d Z	 d Z
 d Z e Z e Z RS(   s#   Global parameters for the document.i
   i    N(   R   R   R   R   t   pdftitleR   t   indentstandardt   tocdeptht   startinglevelt   maxdeptht   languaget   bibliographyt   outputchangest   displaymode(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¹  ‰	  s   t   FormulaParserc           B   sD   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z RS(   s   Parses a formulac         C   sr   | j  d |  _ |  j | ƒ } | sk | j ƒ  |  j | ƒ } | sk t j d | j ƒ  j ƒ  ƒ d g Sn  | g S(   s   See if the formula is inlinedi   s   Unknown formula type in t   unknown(   R   Rı   t	   parsetypeRÿ   R    R   Rş   R  (   Ro   R  Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  	  s    

c         C   sœ   | j  ƒ  j t j d ƒ d k r& d S| j  ƒ  j t j d ƒ d k rL d S| j  ƒ  j t j d ƒ d k rr d S| j  ƒ  j t j d ƒ d k r˜ d Sd	 S(
   s)   Get the formula type from the first line.t   simplei    t   inlinet   complext   blockt
   unnumberedt   beginbeforet   numberedN(   Rş   t   findR2   R(   R   (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÅ  ª	  s    """"c         C   s~   |  j  | ƒ } x^ | j ƒ  j |  j ƒ so | j ƒ  j ƒ  } t | ƒ d k rb t j d | ƒ n  | j ƒ  q W| j ƒ  | S(   s   Parse the formula until the endi    s   Unparsed formula line (	   t   parseformulaRş   Rr   R  R  Rq   R    R   Rÿ   (   Ro   R  t   formulat   stripped(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ¶	  s    
c         C   s  t  j d } | | j ƒ  k rm | j ƒ  j | d ƒ d } | | k rZ |  j | | | ƒ S|  j | | | ƒ St  j d | j ƒ  k r§ |  j | t  j d t  j d ƒ St  j d } t  j d } | | j ƒ  k r˜| j ƒ  j ƒ  j | ƒ ru| j ƒ  j ƒ  } | j | ƒ d j | ƒ } | | d | } t  j d }	 t  j d }
 |	 | d |
 } | |  j | | | ƒ | St	 j
 d	 | d
 | j ƒ  ƒ d St  j d } t  j d } | | j ƒ  k rö| | j ƒ  k röt  j d } |  j | | | ƒ St	 j
 d | j ƒ  d ƒ d S(   s   Parse the formula contentsRÆ  i   RÈ  RË  t
   beginafteri    t	   endbeforet   endafters   Missing s    in R{   t   commandt   brackets   Formula beginning s    is unknown(   R2   R(   Rş   R   t   parsesinglelinert   parsemultilinerR%   R  R   R    R   (   Ro   R  RÆ  t   restRË  RÑ  R‰   t   endsplitt
   startpieceRÒ  RÓ  t   endpiecet   begincommandt   beginbrackett
   endbracket(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÎ  Á	  s:    $c         C   s¢   | j  ƒ  j ƒ  } | | k r; t j d | d | ƒ d S| j | ƒ sg t j d | d | ƒ d S| j | ƒ } | | t | ƒ t | ƒ !} | j ƒ  | S(   s   Parse a formula in one lines   Line s     does not contain formula start R{   s   Formula s    does not end with (   Rş   R  R    R   R   R€  Rq   Rÿ   (   Ro   R  t   startR  R7  R€  RØ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÖ  ä	  s    
c         C   sÇ   d } | j  ƒ  } | | k rA t j d | j ƒ  d | ƒ d S| j | ƒ } | | t | ƒ j ƒ  } x7 | j | ƒ s£ | | d 7} | j ƒ  | j  ƒ  } qm W| | t | ƒ  7} | j ƒ  | S(   s!   Parse a formula in multiple linesR{   s   Line s     does not contain formula start s   
(   Rş   R    R   R  R€  Rq   R   Rÿ   (   Ro   R  Rß  R  RÏ  R7  R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR×  ò	  s    

(	   R   R   R   R  RÅ  R  RÎ  RÖ  R×  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÃ  ›	  s   				#	t   MacroParserc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   A parser for a formula macro.c         C   s   | j  d |  _ d g S(   s   See if the formula is inlinedi   RÇ  (   R   Rı   (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  
  s    c         C   s,   |  j  | |  j j |  j ƒ } | j ƒ  | S(   s   Parse the formula until the end(   R×  R  Rß  R  Rÿ   (   Ro   R  RÏ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  
  s    
(   R   R   R   R  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRà  
  s   	t
   FormulaBitc           B   s_   e  Z d  Z d
 Z d Z d Z d „  Z d „  Z d „  Z	 d „  Z
 d „  Z d „  Z d	 „  Z RS(   s   A bit of a formulai   R{   c         C   s   g  |  _  t ƒ  |  _ d S(   s6   The formula bit type can be 'alpha', 'number', 'font'.N(   Rû   R&  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp    
  s    	c         C   s   | |  _  |  S(   s!   Set the internal formula factory.(   R  (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   setfactory%
  s    	c         C   s/   |  j  j | ƒ |  j | j 7_ |  | _ d S(   s-   Add any kind of formula bit already processedN(   Rû   R‡   Rè   R  (   Ro   t   bit(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRr  *
  s    c         C   sD   |  j  | 7_  | j | ƒ s@ t j d | d | j ƒ  ƒ n  d S(   s0   Skip a string and add it to the original formulas   String s    not at N(   Rè   R‰  R    R   R„  (   Ro   R)   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   skiporiginal0
  s    c         C   sH   t  |  j ƒ d k r d St g  |  j D] } | j ^ q& ƒ |  _ |  j S(   sD   Compute the size of the bit as the max of the sizes of all contents.i    i   (   Rq   Rû   t   maxR]   (   Ro   R'  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   computesize6
  s    (c         C   s   |  j  j |  j ƒ S(   s   Return a copy of itself.(   R  RÎ  Rè   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRé   =
  s    c         C   s   |  j  j d |  j S(   s   Get a string representations	    read in (   Rç   R   Rè   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   A
  s    N(   R   R   R   R   Rë   R]   Rè   Rp   Râ  Rr  Rä  Ræ  Ré   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRá  
  s   						t	   TaggedBitc           B   s,   e  Z d  Z d „  Z e d „ Z d „  Z RS(   s   A tagged string in a formulac         C   s,   t  ƒ  j | ƒ |  _ |  j t | ƒ ƒ |  S(   s   Set the constant and the tag(   R(  R,  Rú   Rr  t   FormulaConstant(   Ro   R£  R)  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR£  H
  s    c         C   s%   | |  _  t ƒ  j | | ƒ |  _ |  S(   s   Set the constant and the tag(   Rû   R(  R,  Rú   (   Ro   Rû   R)  R*  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¸  N
  s    	c         C   s   t  ƒ  j | d t ƒ|  _ |  S(   s4   Set the self-closing tag, no contents (as in <hr/>).R+  (   R(  R,  Rƒ   Rú   (   Ro   R)  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   selfcompleteT
  s    (   R   R   R   R£  R   R¸  Ré  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRç  E
  s   	Rè  c           B   s2   e  Z d  Z d „  Z d „  Z d „  Z d „  Z RS(   s   A constant string in a formulac         C   s/   t  j |  | ƒ | |  _ d |  _ d |  _ d S(   s   Set the constant stringi   N(   R¶  Rp   Rè   R]   R   Rë   (   Ro   R)   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   \
  s    		c         C   s   |  j  S(   s+   Compute the size of the constant: always 1.(   R]   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRæ  c
  s    c         C   s   t  |  j ƒ S(   s   Return a copy of itself.(   Rè  Rè   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRé   g
  s    c         C   s   d |  j  S(   s"   Return a printable representation.s   Formula constant: (   R)   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   k
  s    (   R   R   R   Rp   Ræ  Ré   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRè  Y
  s
   			t   RawTextc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   A bit of text inside a formulac         C   s   | j  ƒ  j ƒ  S(   s   Detect a bit of raw text(   R‰   Ra  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   detectr
  s    c         C   s,   | j  ƒ  } |  j t | ƒ ƒ d |  _ d S(   s   Parse alphabetic textR   N(   Rb  Rr  Rè  Rë   (   Ro   R{  R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parsebitv
  s    (   R   R   R   Rë  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRê  o
  s   	t   FormulaSymbolc           B   s?   e  Z d  Z e j Z e j d Z d „  Z d „  Z d „  Z RS(   s   A symbol inside a formulat
   charactersc         C   s6   | j  ƒ  t j k r t S| j  ƒ  t j k r2 t St S(   s   Detect a symbol(   R‰   Rí  RG   Rƒ   RB   R   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  ‚
  s
    c         C   s„   | j  ƒ  t j k r/ |  j | j  ƒ  | ƒ d S| j  ƒ  t j k re |  j t j | j  ƒ  | ƒ d St j d | j  ƒ  d ƒ d S(   s   Parse the symbolNs   Symbol s
    not found(   R‰   Rí  RG   t	   addsymbolRB   R    R   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Š
  s    c         C   s0   |  j  | j ƒ  | ƒ |  j j t | ƒ ƒ d S(   s   Add a symbolN(   Rä  R‰   Rû   R‡   Rè  (   Ro   t   symbolR{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRï  ”
  s    (	   R   R   R   R2   RB   RG   Rë  Rì  Rï  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRí  |
  s   			
t   FormulaNumberc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   A string of digits in a formulac         C   s   | j  ƒ  j ƒ  S(   s   Detect a digit(   R‰   Rc  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  œ
  s    c            s8   ˆ  j  ‡  f d †  ƒ } |  j t | ƒ ƒ d |  _ d S(   s   Parse a bunch of digitsc              s   ˆ  j  ƒ  j ƒ  S(   N(   R‰   Rc  (    (   R{  (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   ¢
  s    RÂ   N(   R`  Rr  Rè  Rë   (   Ro   R{  t   digits(    (   R{  s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì   
  s    (   R   R   R   Rë  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRñ  ™
  s   	t   Commentc           B   s-   e  Z d  Z e j d Z d „  Z d „  Z RS(   s*   A LaTeX comment: % to the end of the line.t   commentc         C   s   | j  ƒ  |  j k S(   s   Detect the %.(   R‰   Rß  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  «
  s    c         C   s   |  j  | j d ƒ 7_  d S(   s   Parse to the end of the line.s   
N(   Rè   Ro  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  ¯
  s    (   R   R   R   R2   R(   Rß  Rë  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó  ¦
  s   	t
   WhiteSpacec           B   s)   e  Z d  Z d „  Z d „  Z d „  Z RS(   s"   Some white space inside a formula.c         C   s   | j  ƒ  j ƒ  S(   s   Detect the white space.(   R‰   Ri  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  ¶
  s    c         C   s   |  j  | j ƒ  7_  d S(   s   Parse all whitespace.N(   Rè   Rl  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  º
  s    c         C   s   d |  j  d S(   s"   Return a printable representation.s   Whitespace: *RŒ  (   Rè   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   ¾
  s    (   R   R   R   Rë  Rì  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRõ  ³
  s   		t   Bracketc           B   sy   e  Z d  Z e j d Z e j d Z d „  Z d „  Z	 d „  Z
 d „  Z d „  Z d „  Z d „  Z d	 „  Z d
 „  Z RS(   s   A {} bracket inside a formulaRÕ  c         C   s   t  j |  ƒ d |  _ d S(   s'   Create a (possibly literal) new bracketN(   Rá  Rp   R   t   inner(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   È
  s    c         C   s   | j  |  j ƒ S(   s   Detect the start of a bracket(   R[  Rß  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  Í
  s    c         C   s   |  j  | |  j ƒ |  S(   s   Parse the bracket(   t   parsecompletet   innerformula(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Ñ
  s    c         C   s   |  j  | |  j ƒ |  S(   s   Parse a text bracket(   Rø  t	   innertext(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   parsetextÖ
  s    c         C   s   |  j  | |  j ƒ |  S(   s   Parse a literal bracket(   Rø  t   innerliteral(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parseliteralÛ
  s    c         C   s   | j  |  j ƒ s8 t j d |  j d | j ƒ  ƒ d S|  j |  j | ƒ | j |  j ƒ | | ƒ |  j	 | j
 |  j ƒ 7_	 |  j ƒ  d S(   s   Parse the start and end markss   Bracket should start with s    at N(   R[  Rß  R    R   R„  R   Rä  Rt  R  Rè   Rw  Ræ  (   Ro   R{  t   innerparser(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRø  à
  s    "
c         C   s0   x) | j  ƒ  s+ |  j |  j j | ƒ ƒ q Wd S(   s(   Parse a whole formula inside the bracketN(   RM  Rr  R  t   parseany(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRù  ë
  s    c         C   sÆ   t  j j ƒ  } | j t  j d ƒ | j t  j d ƒ | j t j ƒ xx | j ƒ  sÁ | j ƒ  | k r¥ |  j	 |  j
 j | ƒ ƒ | j d ƒ r¾ |  j d 7_ q¾ qJ |  j	 t | j ƒ  ƒ ƒ qJ Wd S(   s<   Parse some text inside the bracket, following textual rules.RÔ  RÕ  RŒ   N(   R2   RE   R–  R‡   R(   Ró  Rß  RM  R‰   Rr  R  Rÿ  R‰  Rè   Rè  RX  (   Ro   R{  t   specialchars(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRú  ğ
  s    c         C   sƒ   d |  _  xa | j ƒ  rl | j ƒ  |  j k rl | j ƒ  |  j k rT |  j | ƒ q |  j  | j ƒ  7_  q W|  j |  j  7_ d S(   sA   Parse a literal inside the bracket, which does not generate HTML.R{   N(   t   literalRM  R‰   R  Rß  Rı  RX  Rè   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRü  ş
  s    	&(   R   R   R   R2   R(   Rß  R%   R  Rp   Rë  Rì  Rû  Rı  Rø  Rù  Rú  Rü  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRö  Â
  s   								t   SquareBracketc           B   s1   e  Z d  Z e j d Z e j d Z d „  Z RS(   s   A [] bracket inside a formulat   squarebracketc         C   s   t  ƒ  } |  j | _ | S(   s3   Return a new square bracket with the same contents.(   R  Rû   (   Ro   RÕ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRé     s    	(	   R   R   R   R2   R(   Rß  R%   R  Ré   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    s   t   MathsProcessorc           B   s    e  Z d  Z d „  Z d „  Z RS(   sA   A processor for a maths construction inside the FormulaProcessor.c         C   s   t  j d t |  ƒ ƒ d S(   s$   Process an element inside a formula.s   Unimplemented process() in N(   R    R   RÉ   (   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó     s    c         C   s   d |  j  j S(   s   Return a printable description.s   Maths processor (   Rç   R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä     s    (   R   R   R   Ró   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    s   	t   FormulaProcessorc           B   sJ   e  Z d  Z g  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 RS(   s&   A processor specifically for formulas.c         C   s+   |  j  | ƒ |  j | ƒ |  j | ƒ d S(   s7   Process the contents of every formula bit, recursively.N(   t   processcontentst   processinsidest   traversewhole(   Ro   Rã  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   &  s    c         C   sB   t  | t ƒ s d S| j ƒ  x | j D] } |  j | ƒ q' Wd S(   s&   Process the contents of a formula bit.N(   R   Rá  Ró   Rû   R  (   Ro   Rã  R'  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ,  s
    
c         C   sk   t  | t ƒ s d SxQ t | j ƒ D]@ \ } } x$ |  j D] } | j | j | ƒ q9 W|  j | ƒ q# Wd S(   s8   Process the insides (limits, brackets) in a formula bit.N(   R   Rá  R  Rû   t
   processorsRó   R  (   Ro   Rã  R€  R'  t	   processor(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  4  s    c         C   s’   d } x… |  j | ƒ D]t \ } } | j d k rD |  j | | ƒ n@ | j d k r„ | r„ | j d k r„ | j j d t d ƒ ƒ n  | } q Wd S(   s>   Traverse over the contents to alter variables and space units.R   t   fontRÂ   i    u   âŸN(   R   t   traverseRë   t	   italicizeRû   R   Rè  (   Ro   RÏ  t   lastRã  Rû   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  >  s    $c         c   sr   xk | j  D]` } t | d ƒ r9 | j r9 | | j  f Vq
 t | t ƒ r
 x |  j | ƒ D] } | VqX Wq
 q
 Wd S(   sH   Traverse a formula and yield a flattened structure of (bit, list) pairs.Rë   N(   Rû   R   Rë   R   Rá  R  (   Ro   Rã  R'  t   pair(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  H  s    c         C   s/   | j  | ƒ } t ƒ  j | g d ƒ | | <d S(   s    Italicize the given bit of text.RG  N(   R€  Rç  R¸  (   Ro   Rã  Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Q  s    (
   R   R   R   R	  Ró   R  R  R  R  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  !  s   			
	
		t   Formulac           B   sŒ   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d	 „  Z d
 „  Z d „  Z d „  Z d „  Z d „  Z RS(   s   A LaTeX formulac         C   s%   t  ƒ  |  _ t ƒ  j d ƒ |  _ d  S(   Ns   span class="formula"(   RÃ  R•   R(  R,  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   \  s    c         C   s‹   |  j  d d k r t t _ n t t _ |  j j d t ƒ t j rQ |  j ƒ  n6 t j	 rg |  j	 ƒ  n  t j
 r} |  j
 ƒ  n
 |  j ƒ  d S(   s   Convert the formula to tagsi    RÇ  s   div class="formula"N(   R  R   R¹  RÂ  Rƒ   Rú   R,  R   R°   RÑ   RØ   t   classic(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   `  s    				c         C   sY   |  j  d d k r+ t ƒ  j d ƒ |  _ n t ƒ  j d ƒ |  _ t |  j ƒ g |  _ d S(   s   Make the contents for jsMath.i    RÇ  s   div class="math"s   span class="math"N(   R  R(  R,  Rú   R¶  R²  Rû   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR°   p  s    c         C   s[   d |  j  _ d } |  j d d k r2 | d 7} n  t ƒ  j |  j | d t ƒ g |  _ d S(   s   Make the contents for MathJax.s   span class="MathJax_Preview"s   script type="math/texi    RÇ  s   ;mode=displayR|   N(   Rú   R)  R  R·  R£  R²  Rƒ   Rû   (   Ro   R)  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÑ   x  s
    c         C   sL   t  j d t j |  j ƒ } d | d |  j d } t | ƒ g |  _ d S(   sI   Make the contents using Google Charts http://code.google.com/apis/chart/.RØ   s   <img class="chart" src="s   " alt="s   "/>N(   R2   RH   t   urllibt
   quote_plusR²  R¶  Rû   (   Ro   t   urlt   img(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRØ   €  s    c         C   s>   t  ƒ  j |  j ƒ } t ƒ  j | ƒ |  | _ | g |  _ d S(   sE   Make the contents using classic output generation with XHTML and CSS.N(   t   FormulaFactoryRÎ  R²  R  Ró   R  Rû   (   Ro   t   whole(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  †  s    	c         C   s   | j  d ƒ r |  j | ƒ np | j  d ƒ r> |  j | ƒ nQ | j  d ƒ r` |  j | d ƒ n/ | j  d ƒ r‚ |  j | d ƒ n | j d ƒ |  j ƒ  |  S(   s4   Parse using a parse position instead of self.parser.s   $$t   $s   \(s   \)s   \[s   \]s   Unparseable formula(   R‰  t   parsedollarblockt   parsedollarinlinet   parseinlinetot   parseblocktoR   Ró   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    s    
c         C   s   d g |  _  |  j | ƒ d S(   s   Parse a $...$ formula.RÇ  N(   R  t   parsedollar(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  œ  s    c         C   s<   d g |  _  |  j | ƒ | j d ƒ s8 | j d ƒ n  d S(   s   Parse a $$...$$ formula.RÉ  R  s1   Formula should be $$...$$, but last $ is missing.N(   R  R  R‰  R   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ¡  s    c         C   s0   | j  d ƒ | j d ƒ |  _ | j d ƒ d S(   s   Parse to the next $.R  N(   Rt  Rq  R²  Rw  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ¨  s    c         C   s    d g |  _  |  j | | ƒ d S(   s   Parse a \(...\) formula.RÇ  N(   R  t	   parseupto(   Ro   R{  t   limit(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ®  s    c         C   s    d g |  _  |  j | | ƒ d S(   s   Parse a \[...\] formula.RÉ  N(   R  R  (   Ro   R{  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ³  s    c         C   s3   | j  | ƒ | j d „  ƒ |  _ | j | ƒ d S(   s1   Parse a formula that ends with the given command.c           S   s   t  S(   N(   Rƒ   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   »  s    N(   Rt  R`  R²  Rw  (   Ro   R{  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ¸  s    c         C   s+   |  j  r' |  j  j r' d |  j  j d Sd S(   s"   Return a printable representation.s	   Formula (RÄ   s   Unnumbered formula(   R­  RÂ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   ¾  s    (   R   R   R   Rp   Ró   R°   RÑ   RØ   R  R  R  R  R  R  R  R  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Y  s   													t   WholeFormulac           B   s    e  Z d  Z d „  Z d „  Z RS(   s   Parse a whole formulac         C   s   | j  ƒ  S(   s"   Not outside the formula is enough.(   RM  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  Ç  s    c         C   s0   x) | j  ƒ  s+ |  j |  j j | ƒ ƒ q Wd S(   s   Parse with any formula bitN(   RM  Rr  R  Rÿ  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Ë  s    (   R   R   R   Rë  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   Ä  s   	R  c           B   s‰   e  Z d  Z e e e e e e g Z	 e e g Z
 e Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d	 „  Z RS(
   s   Construct bits of formulac         C   s   t  ƒ  |  _ d S(   s    Initialize the map of instances.N(   RÚ   t	   instances(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   Ø  s    c         C   s&   | j  ƒ  r t S|  j | ƒ j | ƒ S(   s   Detect a bit of a given type.(   RM  R   RÅ   Rë  (   Ro   Rë   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   detecttypeÜ  s    c         C   sA   | |  j  k s |  j  | r6 |  j | ƒ |  j  | <n  |  j  | S(   s"   Get an instance of the given type.(   R!  Ræ   (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÅ   â  s    c         C   s   t  j | ƒ j |  ƒ S(   s+   Create a new formula bit of the given type.(   Rå   Ræ   Râ  (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRæ   è  s    c         C   s*   x# | j  ƒ  s% |  j | ƒ s d Sq Wd S(   s   Clear any skipped types.N(   RM  t   skipany(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   clearskippedì  s    c         C   s@   x9 |  j  D]. } |  j | ƒ j | ƒ r
 |  j | | ƒ Sq
 Wd S(   s   Skip any skipped types.N(   t   skippedtypesRÅ   Rë  RÅ  R   (   Ro   R{  Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR#  ó  s    c         C   sd   x: |  j  |  j D]( } |  j | | ƒ r |  j | | ƒ Sq Wt j d | j ƒ  ƒ t | j ƒ  ƒ S(   s.   Parse any formula bit at the current location.s   Unrecognized formula at (	   t   typesR%  R"  RÅ  R    R   R„  Rè  RX  (   Ro   R{  Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÿ  ú  s
    c         C   sB   |  j  | ƒ } d |  j | <| j | ƒ } | r> | j |  ƒ S| S(   s#   Parse the given type and return it.N(   RÅ   R   R!  Rì  Râ  (   Ro   Rë   R{  Rã  t   returnedbit(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÅ    s    c         C   s   t  | ƒ } |  j t ƒ } | j | ƒ r; | j | ƒ | S| j ƒ  s} t j d | j ƒ  ƒ | j	 t
 ƒ  j | d ƒ ƒ n  | S(   s5   Parse a string of text that contains a whole formula.s   Unknown formula at: s   span class="unknown"(   RŠ  Ræ   R   Rë  Rì  RM  R    R   R„  Rr  Rç  R£  (   Ro   RÏ  R{  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÎ    s    (   R   R   R   Rí  Rê  Rñ  Rö  Ró  Rõ  R&  R%  R   t   definingRp   R"  RÅ   Ræ   R$  R#  Rÿ  RÅ  RÎ  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Ğ  s   									t
   Translatorc           B   sM   e  Z d  Z d Z d „  Z e e ƒ Z d „  Z d „  Z d „  Z	 d „  Z
 RS(   s=   Reads the configuration file and tries to find a translation.c         C   s   |  j  j | ƒ S(   s%   Get the translated message for a key.(   RÅ   t
   getmessage(   R   Rv   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   translate1  s    c         C   s   d  |  _ t |  _ d  S(   N(   R   t   translationRƒ   t   first(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   7  s    	c         C   sÅ   d |  _ t j s# t j d ƒ d St j t j k rM t j d t j ƒ d St j t j d k rg d St j t j g } y t j	 d d | ƒ |  _	 Wn( t
 k
 rÀ t j d t | ƒ ƒ n Xd S(   s/   Find the translation for the document language.s   No language in documentNs   Unknown language t   ent   elyxers   No translation for (   R   t	   langcodesR¹  R¿  R    R   Rk   Rl   t   gettextR,  t   IOErrorRÉ   (   Ro   R0  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   findtranslation;  s    		c         C   si   |  j  r |  j ƒ  t |  _  n  |  j | ƒ } |  j s; | Sy |  j j | ƒ } Wn t k
 rd n X| S(   s-   Get the translated message for the given key.(   R-  R3  R   t   getuntranslatedR,  t   ugettextR2  (   Ro   Rv   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR*  L  s    	
	c         C   s/   | t  j k r$ t j d | ƒ | St  j | S(   s   Get the untranslated message.s   Cannot translate (   Rk   RU   R    R   (   Ro   Rv   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR4  Z  s    N(   R   R   R   R   RÅ   R+  R   Rp   R3  R*  R4  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR)  +  s   				t   NumberCounterc           B   sÒ   e  Z d  Z d) Z d) Z d) Z d) Z d Z e	 j
 d Z d* d+ d, d- d. d/ d0 d1 d2 d3 d4 d5 d6 g Z d „  Z d „  Z d „  Z d  „  Z d! „  Z d" „  Z d# „  Z d$ „  Z d% „  Z d& „  Z d' „  Z d( „  Z RS(7   s#   A counter for numbers (by default).t   ABCDEFGHIJKLMNOPQRSTUVWXYZt   symbolst   Miè  t   CMi„  t   Diô  t   CDi  t   Cid   t   XCiZ   t   Li2   t   XLi(   t   Xi
   t   IXi	   t   Vi   t   IVi   t   Ii   c         C   s   | |  _  d S(   s   Give a name to the counter.N(   RŞ   (   Ro   RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   v  s    c         C   s   | |  _  |  S(   s0   Set the counter mode. Can be changed at runtime.(   R˜   (   Ro   R˜   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setmodez  s    	c         C   s   | |  _  d S(   s   Set an initial value.N(   Rw   (   Ro   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   init  s    c         C   s   t  |  j ƒ S(   s$   Get the next value as a text string.(   RÉ   Rw   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR1  ƒ  s    c         C   s   |  j  |  j ƒ S(   s   Get the next value as a letter.(   t   getsequencet   letters(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   getletter‡  s    c         C   s   |  j  |  j ƒ S(   s   Get the next value as a symbol.(   RH  R8  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   getsymbol‹  s    c         C   s   | |  j  d t | ƒ S(   s*   Get the next value from elyxer.a sequence.i   (   Rw   Rq   (   Ro   RX   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRH    s    c         C   sX   d } |  j  } xB |  j D]7 \ } } | | k r | | | | 7} | | } q q W| S(   s%   Get the next value as a roman number.R{   (   Rw   t   romannumerals(   Ro   R–   RÂ   t   numeralRw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getroman“  s    	c         C   s«   |  j  s |  j  d k r# |  j ƒ  S|  j  d k r< |  j ƒ  S|  j  d k r[ |  j ƒ  j ƒ  S|  j  d k rt |  j ƒ  S|  j  d k r |  j ƒ  St j d |  j  ƒ |  j ƒ  S(	   s8   Get the current value as configured in the current mode.R‹  Râ   t   At   aRE  RŒ  s   Unknown counter mode (   s   textRâ   (   R˜   R1  RJ  R†  RN  RK  R    R   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getvalue  s    



c         C   s.   |  j  s d |  _  n  |  j  d 7_  |  j ƒ  S(   s@   Increase the current value and get the next value as configured.i    i   (   Rw   RQ  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getnext¬  s    	c         C   s   d |  _  d S(   s   Reset the counter.i    N(   Rw   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   reset³  s    c         C   s.   d |  j  } |  j r* | d |  j 7} n  | S(   s"   Return a printable representation.s   Counter s	    in mode (   RŞ   R˜   (   Ro   R–   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   ·  s    	N(   R9  iè  (   R:  i„  (   R;  iô  (   R<  i  (   R=  id   (   R>  iZ   (   R?  i2   (   R@  i(   (   RA  i
   (   RB  i	   (   RC  i   (   RD  i   (   RE  i   (   R   R   R   R   RŞ   Rw   R˜   t   masterRI  RV   RX   R8  RL  Rp   RF  RG  R1  RJ  RK  RH  RN  RQ  RR  RS  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR6  e  s,   								
			t   DependentCounterc           B   s)   e  Z d  Z d „  Z d „  Z d „  Z RS(   s4   A counter which depends on another one (the master).c         C   s   | |  _  |  j  j ƒ  |  _ |  S(   s   Set the master counter.(   RT  RQ  R  (   Ro   RT  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   setmasterÁ  s    	c         C   sJ   |  j  |  j j ƒ  k r% |  j ƒ  n  t j |  ƒ } |  j j ƒ  |  _  | S(   s8   Increase or, if the master counter has changed, restart.(   R  RT  RQ  RS  R6  RR  (   Ro   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRR  Ç  s
    c         C   s   |  j  j ƒ  d t j |  ƒ S(   s8   Get the value of the combined counter: master.dependent.t   .(   RT  RQ  R6  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRQ  Ï  s    (   R   R   R   RV  RR  RQ  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRU  ¾  s   		t   NumberGeneratorc           B   só   e  Z d  Z d Z d Z g  e j d D] Z e j	 ƒ  ^ q& Z
 g  e j d D] Z e j	 ƒ  ^ qL Z e ƒ  Z d Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d	 „  Z d
 „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z RS(   sM   A number generator for unique sequences and hierarchical structures. Used in:t   romant   orderedc         C   s   | j  d d ƒ S(   s.   Remove the possible asterisk in a layout type.RŒ  R{   (   R~   (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   deasteriskã  s    c         C   s   |  j  | ƒ S(   s9   Find out if the layout type corresponds to a unique part.(   t   isroman(   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   isuniqueç  s    c         C   s   |  j  | ƒ j ƒ  |  j k S(   s9   Find out if the layout type should have roman numeration.(   R[  R†  t   romanlayouts(   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR\  ë  s    c         C   s   |  j  | ƒ j ƒ  |  j k S(   s?   Find out if the layout type corresponds to an (un)ordered part.(   R[  R†  t   orderedlayouts(   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   isinorderedï  s    c         C   sV   d | k r t  S|  j | ƒ r# t S|  j | ƒ s6 t  S|  j | ƒ t j k rR t  St S(   sC   Find out if the type for a layout corresponds to a numbered layout.RŒ  (   R   R\  Rƒ   R`  t   getlevelR¹  R¾  (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   isnumberedó  s    c         C   s
   d | k S(   s5   Find out if the type contains an asterisk, basically.RŒ  (    (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   isunorderedÿ  s    c         C   sm   |  j  | ƒ r d S|  j | ƒ s7 t j d | ƒ d S|  j | ƒ j ƒ  } |  j j | ƒ d } | t j	 S(   s0   Get the level that corresponds to a layout type.i    s   Unknown layout type i   (
   R]  R`  R    R   R[  R†  R_  R€  R¹  R½  (   Ro   Rë   R§  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRa    s    c         C   s/   t  j r" |  j | ƒ d k r" d S|  j | ƒ S(   s4   Obtain the type for the part: without the asterisk, i   t   Appendix(   RX  t   appendixRa  R[  (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getparttype  s    c         C   s   |  j  | ƒ j ƒ  S(   s$   Generate a number for a layout type.(   t
   getcounterRR  (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   generate  s    c         C   s?   | j  ƒ  } | |  j k r4 |  j | ƒ |  j | <n  |  j | S(   s#   Get the counter for the given type.(   R†  t   countersRæ   (   Ro   Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRg    s    c         C   s•   |  j  | ƒ rf |  j | ƒ d k rf |  j j | ƒ } |  j | d } |  j | ƒ } |  j | | ƒ St | ƒ } |  j | ƒ r‘ | j d ƒ n  | S(   s$   Create a counter for the given type.i   RE  (	   Rb  Ra  R_  R€  Rg  t   createdependentR6  R\  RF  (   Ro   Rë   R€  t   aboveRT  t   counter(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRæ   $  s    $c         C   sG   | |  j  k s  |  j  | j r< |  j | | ƒ |  j  | <n  |  j  | S(   sD   Get (or create) a counter of the given type that depends on another.(   Ri  RT  Rj  (   Ro   Rë   RT  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getdependentcounter0  s     c         C   s   t  | ƒ j | ƒ S(   s,   Create a dependent counter given the master.(   RU  RV  (   Ro   Rë   RT  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRj  6  s    c         C   s?   |  j  t j } |  j | ƒ } | j d ƒ j ƒ  t t _ d S(   s   Start appendices here.RO  N(	   R_  R¹  R½  Rg  RF  RS  Rƒ   RX  Re  (   Ro   t	   firsttypeRl  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   startappendix:  s    N(   R   R   R   R   t	   chapteredt	   generatorRV   RW   t   xR†  R^  R_  RÚ   Ri  Re  R[  R]  R\  R`  Rb  Rc  Ra  Rf  Rh  Rg  Ræ   Rm  Rj  Ro  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRX  Ó  s*   &&														t   ChapteredGeneratorc           B   s   e  Z d  Z d „  Z RS(   s1   Generate chaptered numbers, as in Chapter.Number.c         C   sD   t  j d k r t j j | ƒ S|  j d ƒ } |  j | | ƒ j ƒ  S(   sB   Generate a number which goes with first-level numbers (chapters). i    t   Chapter(   R¹  R½  RX  Rq  Rh  Rg  Rm  RR  (   Ro   Rë   t   chapter(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRh  E  s    (   R   R   R   Rh  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRs  A  s   t   ContainerSizec           B   s­   e  Z d  Z d Z d Z d Z d Z d Z d d d „ Z	 d d d „ Z
 d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d	 „  Z d
 „  Z d „  Z d „  Z d „  Z RS(   s   The size of a container.c         C   s$   |  j  d | ƒ |  j  d | ƒ |  S(   s*   Set the proper size with width and height.t   widtht   height(   t   setvalue(   Ro   Rw  Rx  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRà   _  s    c         C   s$   |  j  d | ƒ |  j  d | ƒ |  S(   s   Set max width and/or height.t   maxwidtht	   maxheight(   Ry  (   Ro   Rz  R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setmaxe  s    c         C   sA   |  j  | d ƒ |  j  | d ƒ |  j  | d ƒ |  j | ƒ |  S(   s*   Read some size parameters off a container.Rw  Rx  t   scale(   t   setparametert   checkvalidheight(   Ro   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   readparametersk  s
    c         C   s#   | j  | ƒ } |  j | | ƒ d S(   s=   Read a size parameter off a container, and set it if present.N(   R¨  Ry  (   Ro   Rõ   RŞ   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR~  s  s    c         C   s,   |  j  | ƒ } | r( t |  | | ƒ n  d S(   s6   Set the value of a parameter name, only if it's valid.N(   t   processparameterRt   (   Ro   RŞ   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRy  x  s    c         C   sL   | j  d ƒ } |  j rH |  j |  j ƒ d k rH | d k rH d |  _ n  d S(   s;   Check if the height parameter is valid; otherwise erase it.t   height_specialRâ   t   totalheightN(   R¨  Rx  t   extractnumberR   (   Ro   Rõ   t   heightspecial(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ~  s    -c         C   s`   | s
 d S|  j | ƒ d k r# d Sx6 t j d D]' } | | k r1 | j | d ƒ } q1 q1 W| S(   s&   Do the full processing on a parameter.t   0t   ignoredtextsR{   N(   R   R„  RY   R]   R~   (   Ro   Rw   t   ignored(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  „  s    c         C   sd   d } t  } xQ | D]I } | j ƒ  r2 | | 7} q | d k rX | rX | | 7} t } q | Sq W| S(   s+   Extract the first number in the given text.R{   RW  (   R   Rc  Rƒ   (   Ro   R‹  R–   t   decimalt   char(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR„    s    
	c         C   sÊ   | rD t  | ƒ d |  _ |  j rD |  j rD |  j | ƒ |  _ qD n  | rˆ t  | ƒ d |  _ |  j rˆ |  j rˆ |  j | ƒ |  _ qˆ n  |  j r§ |  j r§ d |  _ n  |  j rÆ |  j rÆ d |  _ n  d S(   s-   Check image dimensions, set them if possible.t   pxt   autoN(   RÉ   Rz  R}  Rw  t
   scalevalueR{  Rx  (   Ro   Rw  Rx  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   checkimage  s    c         C   s+   | t  |  j ƒ d } t t  | ƒ ƒ d S(   sF   Scale the value according to the image scale and return it as unicode.id   R‹  (   R¢   R}  RÉ   (   Ro   Rw   t   scaled(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ¬  s    c         C   sQ   |  j  s d Sd |  j  k r  d S|  j  } d |  _  |  j d k rM d |  _ n  | S(   s?   Remove percent width if present, to set it at the figure level.t   %RŒ  N(   Rw  R   Rx  (   Ro   Rw  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   removepercentwidth±  s    			c         C   sç   t  | j t ƒ s, t j d t | ƒ ƒ n  |  j rX |  j rX |  j rX |  j	 rX d Sd } | |  j
 d ƒ 7} | |  j
 d ƒ 7} | |  j
 d ƒ 7} | |  j
 d ƒ 7} | d d	 k rÇ | d  } n  | d
 7} | j j | 7_ d S(   s1   Add the proper style attribute to the output tag.s   No tag to add style, in Ns    style="Rw  Rz  Rx  R{  iÿÿÿÿRŒ   R|   (   R   Rú   R(  R    R   RÉ   Rw  Rx  Rz  R{  t   styleparameterR)  (   Ro   Rõ   R)  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   addstyle½  s    (
c         C   s5   t  |  | ƒ } | r1 | j d d ƒ d | d Sd S(   s%   Get the style for a single parameter.Rå  s   max-s   : s   ; R{   (   R€   R~   (   Ro   RŞ   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR’  Î  s    N(   R   R   R   R   Rw  Rx  Rz  R{  R}  Rà   R|  R€  R~  Ry  R  R  R„  R  R  R‘  R“  R’  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRv  V  s&   										t   QuoteContainerc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   A container for a pretty quotec         C   s   t  ƒ  |  _ t ƒ  |  _ d  S(   N(   R  R•   R%  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   Ú  s    c         C   sd   |  j  d |  _ |  j t j k rJ t j d |  j d ƒ d g |  _ d St j |  j g |  _ d S(   s   Process contentsi   s   Quote type s
    not foundR|   N(   R  Rë   RY   R[   R    R   R/   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   Ş  s    (   R   R   R   Rp   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR”  ×  s   	t   LyXLinec           B   s    e  Z d  Z d „  Z d „  Z RS(   s
   A Lyx linec         C   s   t  ƒ  |  _ t ƒ  |  _ d  S(   N(   R  R•   R%  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ê  s    c         C   s   d g |  _  d  S(   Ns   <hr class="line" />(   R/   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   î  s    (   R   R   R   Rp   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR•  ç  s   	t   EmphaticTextc           B   s   e  Z d  Z d „  Z RS(   s   Text with emphatic modec         C   s   d |  j  _ d  S(   NRG  (   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ô  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR–  ñ  s   t
   ShapedTextc           B   s   e  Z d  Z d „  Z RS(   s   Text shaped (italic, slanted)c         C   sd   |  j  d |  _ |  j t j k rJ t j d |  j  d ƒ d |  j _ d  St j |  j |  j _ d  S(   Ni   s   Unrecognized shape t   span(   R  Rë   Rb   Rj   R    R   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ú  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR—  ÷  s   t   VersalitasTextc           B   s   e  Z d  Z d „  Z RS(   s   Text in versalitasc         C   s   d |  j  _ d  S(   Ns   span class="versalitas"(   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó     s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR™    s   t	   ColorTextc           B   s   e  Z d  Z d „  Z RS(   s   Colored textc         C   s+   |  j  d |  _ d |  j d |  j _ d  S(   Ni   s   span class="R|   (   R  Rİ   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó     s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRš    s   t   SizeTextc           B   s   e  Z d  Z d „  Z RS(   s
   Sized textc         C   s+   |  j  d |  _ d |  j d |  j _ d  S(   Ni   s   span class="R|   (   R  R]   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó     s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR›    s   t   BoldTextc           B   s   e  Z d  Z d „  Z RS(   s	   Bold textc         C   s   d |  j  _ d  S(   Nt   b(   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó     s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRœ    s   t
   TextFamilyc           B   s   e  Z d  Z d „  Z RS(   s,   A bit of text from elyxer.a different familyc         C   s]   |  j  d |  _ |  j t j k rC t j d t ƒ d |  j _ d St j |  j |  j _ d S(   s   Parse the type of familyi   s   Unrecognized family R˜  N(   R  Rë   Rb   Rd   R    R   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó     s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    s   t   Hfillc           B   s   e  Z d  Z d „  Z RS(   s   Horizontall fillc         C   s   d |  j  _ d  S(   Ns   span class="hfill"(   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   +  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRŸ  (  s   t
   BarredTextc           B   s   e  Z d  Z d „  Z RS(   s   Text with a bar somewherec         C   s`   |  j  d |  _ |  j t j k rF t j d |  j ƒ d |  j _ d St j |  j |  j _ d S(   s   Parse the type of bari   s   Unknown bar type R˜  N(   R  Rë   Rb   Rc   R    R   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   1  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR   .  s   t   LangLinec           B   s   e  Z d  Z d „  Z RS(   s    A line with language informationc         C   s]   |  j  d } | t j k r, t ƒ  |  _ d St j | } t ƒ  j d | d t ƒ |  _ d S(   sD   Only generate a span with lang info when the language is recognized.i   Ns   span lang="R|   (   R  Rk   Rl   R&  Rú   R(  R,  R   (   Ro   t   langt   isolang(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   =  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¡  :  s   t   InsetLengthc           B   s   e  Z d  Z d „  Z RS(   s!   A length measure inside an inset.c         C   s   |  j  d |  _ d  S(   Ni   (   R  R…  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   I  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¤  F  s   t   Spacec           B   s)   e  Z d  Z d „  Z d „  Z d „  Z RS(   s   A space of several typesc         C   s   t  ƒ  |  _ t ƒ  |  _ d  S(   N(   R   R•   R%  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   O  s    c         C   s§   |  j  d |  _ |  j t j k rF t j d |  j ƒ d g |  _ d  St j |  j g |  _ |  j ƒ  } | sr d  St ƒ  j	 d t
 ƒ |  _ t ƒ  j | ƒ j |  ƒ d  S(   Ni   s   Unknown space type RŒ   s   span class="hspace"(   R  Rë   RY   RZ   R    R   R/   t	   getlengthR(  R,  R   Rú   Rv  Rà   R“  (   Ro   R…  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   S  s    c         C   s>   t  |  j ƒ d k s, t |  j d t ƒ r0 d S|  j d j S(   s<   Get the space length from elyxer.the contents or parameters.i    N(   Rq   Rû   R   R¤  R   R…  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¦  `  s    ,(   R   R   R   Rp   Ró   R¦  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¥  L  s   		t   VerticalSpacec           B   s    e  Z d  Z d „  Z d „  Z RS(   s(   An inset that contains a vertical space.c         C   s   t  ƒ  |  _ t ƒ  |  _ d  S(   N(   R   R•   R%  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   i  s    c         C   sc   |  j  d |  _ |  j t j k rI t ƒ  j d |  j d t ƒ |  _ d St j |  j g |  _ d S(   s   Set the correct tagi   s"   div class="vspace" style="height: s   ;"N(	   R  Rë   RY   R^   R(  R,  Rƒ   Rú   R/   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   m  s
    #(   R   R   R   Rp   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR§  f  s   	t   Alignc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   Bit of aligned textc         C   s%   t  ƒ  |  _ t ƒ  j t ƒ |  _ d  S(   N(   R  R•   R(  R-  Rƒ   Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   x  s    c         C   s   d |  j  d d |  j _ d  S(   Ns   div class="i   R|   (   R  Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   |  s    (   R   R   R   Rp   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¨  u  s   	t   Newlinec           B   s    e  Z d  Z d „  Z d „  Z RS(   s	   A newlinec         C   s   t  ƒ  |  _ t ƒ  |  _ d  S(   N(   R  R•   R%  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ‚  s    c         C   s   d g |  _  d S(   s   Process contentss   <br/>
N(   R/   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   †  s    (   R   R   R   Rp   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR©    s   	t   NewPagec           B   s   e  Z d  Z d „  Z RS(   s
   A new pagec         C   s   d g |  _  d S(   s   Process contentss   <p><br/>
</p>
N(   R/   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó     s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRª  Š  s   t	   Separatorc           B   s   e  Z d  Z d „  Z RS(   s;   A separator string which is not extracted by extracttext().c         C   s%   t  ƒ  |  _ g  |  _ | g |  _ d  S(   N(   R%  Rú   Rû   R/   (   Ro   R£  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ”  s    	(   R   R   R   Rp   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR«  ‘  s   t	   StrikeOutc           B   s   e  Z d  Z d „  Z RS(   s   Striken out text.c         C   s   d |  j  _ d S(   s   Set the output tag to strike.t   strikeN(   Rú   R)  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   œ  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¬  ™  s   t   StartAppendixc           B   s   e  Z d  Z d „  Z RS(   s   Mark to start an appendix here.c         C   s   t  j j ƒ  d S(   sD   Activate the special numbering scheme for appendices, using letters.N(   RX  Rq  Ro  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ¤  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR®     s   t   Linkc           B   sq   e  Z d  Z d Z d Z d Z d Z d Z d Z	 d Z
 d „  Z d d d d d „ Z d „  Z d „  Z d „  Z RS(   s&   A link to another part of the documentc         C   s=   g  |  _  t ƒ  |  _ t ƒ  |  _ t j r9 t j |  _ n  d S(   s.   Initialize the link, add target if configured.N(   Rû   R   R•   t
   LinkOutputRú   R   RÍ   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ¸  s
    		c         C   s^   t  | ƒ g |  _ | r$ | |  _ n  | r6 | |  _ n  | rH | |  _ n  | rZ | |  _ n  |  S(   s   Complete the link.(   R¶  Rû   t   anchorR  Rë   RÊ   (   Ro   R‹  R±  R  Rë   RÊ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¸  À  s    c         C   sa   |  j  s d Sd |  _ |  j  j r8 d |  j  j |  _ n  |  j  j r] |  j  j |  j |  _ n  d S(   s8   Use the destination link to fill in the destination URL.NR{   t   #(   t   destinationR  R±  t   page(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   computedestinationÍ  s    		c         C   s   | |  _  |  | _  d S(   sE   Set another link as destination, and set its destination to this one.N(   R³  (   Ro   R³  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setmutualdestination×  s    	c         C   sD   d } |  j  r# | d |  j  7} n  |  j r@ | d |  j 7} n  | S(   s"   Return a printable representation.R¯  s    #s    to (   R±  R  (   Ro   R–   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   Ü  s    		N(   R   R   R   R   R±  R  Rë   R´  RÍ   R³  RÊ   Rp   R¸  Rµ  R¶  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¯  ­  s   		
	t   URLc           B   s   e  Z d  Z d „  Z RS(   s   A clickable URLc         C   sƒ   |  j  |  j d ƒ ƒ } | |  _ |  j d ƒ } | rO |  j  | ƒ | |  _ n  |  j d ƒ } | sm | } n  t | ƒ g |  _ d S(   s   Read URL from elyxer.parametersRÍ   Rë   RŞ   N(   R“  R¨  R  R¶  Rû   (   Ro   RÍ   Rë   RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   è  s    		(   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR·  å  s   t   FlexURLc           B   s   e  Z d  Z d „  Z RS(   s   A flexible URLc         C   s   |  j  ƒ  |  _ d S(   s   Read URL from elyxer.contentsN(   R&   R  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ÷  s    (   R   R   R   Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¸  ô  s   R°  c           B   s   e  Z d  Z d „  Z RS(   s#   A link pointing to some destinationc         C   sâ   | j  j } | j r! | j } n  d | d } | j rP | d | j d 7} n  | j rf | j ƒ  n  | j r‡ | d | j d 7} n  | j r¨ | d | j d 7} n  | j rÉ | d | j d 7} n  t	 ƒ  j
 | ƒ j | ƒ S(   s   Get the HTML code for the links	   a class="R|   s    name="s    href="s	    target="s    title="(   Rç   R   Rë   R±  R³  Rµ  R  RÍ   RÊ   R(  R,  R"  (   Ro   t   linkRë   R)  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR"  ÿ  s    						(   R   R   R   R"  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR°  û  s   t   Postprocessorc           B   s8   e  Z d  Z g  Z d „  Z d „  Z d „  Z d „  Z RS(   s,   Postprocess a container keeping some contextc         C   s+   t  t j |  ƒ |  _ d  |  _ d  |  _ d  S(   N(   t	   StageDictRº  t   stagesR   R‰   R  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp     s    	c         C   s8   |  j  |  j ƒ |  j | ƒ } |  j |  _ | |  _ | S(   s)   Postprocess a container and its contents.(   t   postrecursiveR‰   t   postcurrentR  (   Ro   Rˆ  R–   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   postprocess  s
    	c         C   sÜ   t  | d ƒ s d St | j ƒ d k r, d St  | d ƒ rK | j sK d Sn  t ƒ  } g  } x6 | j D]+ } | j | ƒ } | rd | j | ƒ qd qd Wx9 t d ƒ D]+ } | j d ƒ } | r  | j | ƒ q  q  W| | _ d S(   s.   Postprocess the container contents recursivelyRû   Ni    R¿  i   (   R   Rq   Rû   R¿  Rº  R‡   RE  R   (   Ro   Rõ   t   postprocessorRû   R'  t   postRG  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR½  '  s$    		c         C   s;   |  j  j |  j ƒ } | s" |  j S| j |  j |  j | ƒ S(   sB   Postprocess the current element taking into account next and last.(   R¼  t   getstageR‰   R¿  R  (   Ro   Rˆ  t   stage(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¾  =  s    (   R   R   R   R¼  Rp   R¿  R½  R¾  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRº    s   			R»  c           B   s)   e  Z d  Z d „  Z d „  Z d „  Z RS(   s/   A dictionary of stages corresponding to classesc         C   sA   |  j  | | ƒ } t g  | D] } | j | f ^ q ƒ |  _ d S(   sG   Instantiate an element from elyxer.each class and store as a dictionaryN(   t   instantiateRÚ   t   processedclasst	   stagedict(   Ro   t   classesRÀ  R!  Rr  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   G  s    c         C   sJ   g  | D] } | j  | ƒ ^ q } x! | D] } | j ƒ  | | _ q) W| S(   s-   Instantiate an element from elyxer.each class(   Rê   Rp   RÀ  (   Ro   RÇ  RÀ  Rr  R¼  R'  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÄ  L  s
    "
c         C   s$   | j  |  j k r d S|  j | j  S(   s=   Get the stage for a given element, if the type is in the dictN(   Rç   RÆ  R   (   Ro   R'  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÂ  T  s    (   R   R   R   Rp   RÄ  RÂ  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR»  D  s   		t   Labelc           B   sV   e  Z d  Z e ƒ  Z d Z d „  Z d „  Z d d „ Z	 d „  Z
 d „  Z d „  Z RS(	   s   A label to be referencedc         C   s   t  j |  ƒ d  |  _ d  S(   N(   R¯  Rp   R   t   lastnumbered(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   b  s    c         C   s/   |  j  d ƒ } |  j d | ƒ t j |  _ d S(   s   Process a label container.RŞ   RŒ   N(   R¨  Ræ   RÈ  t
   lastlayoutRÉ  (   Ro   Rv   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   f  s    RÈ  c         C   sf   | |  _  |  j | d | d | ƒ|  t j | <| t j k rb x! t j | D] } |  | _ qL Wn  |  S(   s!   Create the label for a given key.R±  Rë   (   Rv   R¸  RÈ  t   namest	   Referencet
   referencesR³  (   Ro   R‹  Rv   Rë   t	   reference(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRæ   l  s    	c         C   s)   |  j  |  ƒ } | r% | j r% | j Sd S(   s8   Get the part key for the latest numbered container seen.R{   (   RÌ  R­  (   Ro   RÌ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   findpartkeyv  s    c         C   s:   | j  r | S| j s* |  j r& |  j Sd S|  j | j ƒ S(   s)   Get the numbered container for the label.N(   R­  R  RÉ  R   RÌ  (   Ro   Rõ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÌ  }  s    			c         C   s   t  |  d ƒ s d Sd |  j S(   s"   Return a printable representation.Rv   s   Unnamed labels   Label (   R   Rv   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   ‡  s    N(   R   R   R   RÚ   RË  R   RÊ  Rp   Ró   Ræ   RÏ  RÌ  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÈ  \  s   			
		
RÌ  c           B   sA   e  Z d  Z e ƒ  Z d Z d „  Z d „  Z d „  Z d „  Z	 RS(   s   A reference to a label.t   nonec         C   s·   |  j  d ƒ |  _ |  j t j k r@ d |  _ t j |  j } n$ d |  _ t ƒ  j d |  j d ƒ } | |  _ |  j ƒ  |  j t j	 k rœ g  t j	 |  j <n  t j	 |  j j
 |  ƒ d S(   s%   Read the reference and set the arrow.RÎ  u   â†‘u   â†“RŒ   t   prerefN(   R¨  Rv   RÈ  RË  t	   directionR¸  R³  t   formatcontentsRÌ  RÍ  R‡   (   Ro   t   label(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   “  s    			
c         C   sy  |  j  d ƒ } | s d } n  d |  _ | t j k rI t j | |  _ n t j d | ƒ |  j d |  j ƒ |  j d d ƒ |  j d t j	 d ƒ ƒ |  j
 j ƒ  } |  j d | oº | j ƒ |  j d	 | oÓ | j ƒ d
 |  j k s÷ | s÷ | j rt |  j ƒ g |  _ d S|  j j d
 ƒ } t | d ƒ g |  _ x: | d D]. } |  j | j 7_ |  j j t | ƒ ƒ qCWd S(   s   Format the reference contents.t   LatexCommandt   refu   â†•s   Unknown reference format R²  Râ   s   on-pageR¬  u   Â¶R  Ni    i   (   R¨  t	   formattedRY   R\   R    R   R~   RÒ  R)  R+  R³  RÏ  RÂ   t   tocentryt   titlecontentsR¶  Rû   R   R‡   (   Ro   t	   formatkeyR­  R™  Rš  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÓ  ¢  s*    		 c         C   s>   | |  j  k r d S| s" d } n  |  j  j | | ƒ |  _  d S(   s2   Replace a key in the format template with a value.NR{   (   R×  R~   (   Ro   Rv   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR~   ½  s
    	c         C   s   d |  j  S(   s"   Return a printable representation.s
   Reference (   Rv   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   Å  s    (
   R   R   R   RÚ   RÍ  Rv   Ró   RÓ  R~   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÌ    s   				t   FormulaCommandc           B   sf   e  Z d  Z g  Z e j d Z d	 Z d „  Z	 d „  Z
 d „  Z d „  Z d „  Z d „  Z d „  Z RS(
   s    A LaTeX command inside a formulaRÔ  c         C   s   | j  t j ƒ S(   s   Find the current command.(   R[  RÛ  Rß  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  Ò  s    c         C   s´   |  j  | ƒ } |  j | | ƒ } | r+ | S| j d ƒ sI | j d ƒ rh |  j | | ƒ } | rh | Sn  |  j j sˆ t j d | ƒ n  t ƒ  j	 d ƒ |  _
 |  j t | ƒ ƒ d S(   s   Parse the command.s   \ups   \Ups   Unknown command s   span class="unknown"N(   t   extractcommandt   parsewithcommandRr   t   parseupgreekR  R(  R    R   R(  R,  Rú   Rr  Rè  R   (   Ro   R{  RÔ  Rã  t   upgreek(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Ö  s    c         C   s:   x3 t  j D]( } | | j k r
 |  j | | | ƒ Sq
 Wd S(   s0   Parse the command type once we have the command.N(   RÛ  R&  t
   commandmapt   parsecommandtypeR   (   Ro   RÔ  R{  Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRİ  æ  s    c         C   s<   |  j  j | ƒ } | j | ƒ | j | ƒ } | r8 | S| S(   s   Parse a given command type.(   R  Ræ   t
   setcommandRì  (   Ro   RÔ  Rë   R{  Rã  t   returned(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRá  í  s    c         C   sŠ   | j  t j ƒ s* | j d t j ƒ d S| j ƒ  rC |  j | ƒ S| j ƒ  j ƒ  ry t j | j ƒ  } | j  d ƒ | St j | j	 ƒ  S(   s5   Extract the command from elyxer.the current position.s   Missing command start NRŒ  (
   R‰  RÛ  Rß  R   RM  t   emptycommandR‰   Ra  Rb  RX  (   Ro   R{  RÔ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÜ  ö  s    c         C   sJ   d } | j  ƒ  s? | j ƒ  } | r? | j | ƒ r? | } q? n  t j | S(   sq   Check for an empty command: look for command disguised as ending.
    Special case against '{ \{ \} }' situation.R{   (   RZ  Ry  R‰  RÛ  Rß  (   Ro   R{  RÔ  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä    s    c         C   s¤   t  | ƒ d k  r d S| j d ƒ r6 d | d } nF | j d ƒ rg d | d d !j ƒ  | d } n t j d | ƒ d S|  j | | ƒ } | r  d | _ n  | S(	   s   Parse the Greek \up command..i   s   \ups   \i   s   \Ups   Impossible upgreek command: NR  (	   Rq   R   Rr   R‰  t   upperR    R   Rİ  Rë   (   Ro   RÔ  R{  t	   upcommandRß  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRŞ    s    "N(   R   R   R   R&  R2   R(   Rß  R   Rà  Rë  Rì  Rİ  Rá  RÜ  Rä  RŞ  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÛ  Ë  s   							
t
   CommandBitc           B   sD   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z RS(   s%   A formula bit that includes a commandc         C   s;   | |  _  |  j r7 |  j | 7_ |  j |  j  |  _ n  d S(   s   Set the command in the bitN(   RÔ  Rà  Rè   t
   translated(   Ro   RÔ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRâ  #  s    		c         C   sC   |  j  j | ƒ | j ƒ  r  d S|  j  j | ƒ } |  j | ƒ | S(   s)   Parse a parameter at the current positionN(   R  R$  RM  R   Rÿ  Rr  (   Ro   R{  t	   parameter(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  *  s    c         C   sO   |  j  j | ƒ |  j  j t | ƒ s) d S|  j  j t | ƒ } |  j | ƒ | S(   s   Parse a square bracketN(   R  R$  R"  R  R   RÅ  Rr  (   Ro   R{  RÕ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parsesquare3  s    c         C   sˆ   |  j  j | ƒ |  j  j t | ƒ sV | j ƒ  sL t j d | j ƒ  ƒ d S| j	 ƒ  St ƒ  j
 |  j  ƒ } |  j | j | ƒ ƒ | j S(   s   Parse a literal bracket.s   No literal parameter found at: N(   R  R$  R"  Rö  Rj  R    R   R„  R   Rk  Râ  Rr  Rı  R  (   Ro   R{  RÕ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRı  <  s    
c         C   s[   |  j  j | ƒ |  j  j t | ƒ s) d St ƒ  j |  j  ƒ } |  j | j | ƒ ƒ | j S(   s!   Parse a square bracket literally.N(	   R  R$  R"  R  R   Râ  Rr  Rı  R  (   Ro   R{  RÕ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   parsesquareliteralH  s    c         C   sl   |  j  j | ƒ |  j  j t | ƒ s= t j d |  j ƒ d St ƒ  j |  j  ƒ j	 | ƒ } |  j
 | ƒ | S(   s   Parse a text parameter.s   No text parameter for N(   R  R$  R"  Rö  R    R   RÔ  R   Râ  Rû  Rr  (   Ro   R{  RÕ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRû  Q  s    (	   R   R   R   Râ  R  Rê  Rı  Rë  Rû  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRç     s   								t   EmptyCommandc           B   s    e  Z d  Z e j Z d „  Z RS(   s%   An empty command (without parameters)c         C   s   t  |  j ƒ g |  _ d S(   s"   Parse a command without parametersN(   Rè  Rè  Rû   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  `  s    (   R   R   R   R2   R-   Rà  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  [  s   	t   SpacedCommandc           B   s    e  Z d  Z e j Z d „  Z RS(   s<   An empty command which should have math spacing in formulas.c         C   s!   t  d |  j d ƒ g |  _ d S(   s4   Place as contents the command translated and spaced.u   âŸN(   Rè  Rè  Rû   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  i  s    (   R   R   R   R2   RD   Rà  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRí  d  s   	t   AlphaCommandc           B   s    e  Z d  Z e j Z d „  Z RS(   s8   A command without paramters whose result is alphabeticalc         C   s   t  j |  | ƒ d |  _ d S(   s'   Parse the command and set type to alphaR   N(   Rì  Rì  Rë   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  r  s    (   R   R   R   R2   R3   Rà  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRî  m  s   	t   OneParamFunctionc           B   s/   e  Z d  Z e j Z e Z d „  Z d „  Z	 RS(   s   A function of one parameterc         C   s3   t  ƒ  j |  j ƒ |  _ |  j | ƒ |  j ƒ  d S(   s#   Parse a function with one parameterN(   R(  R,  Rè  Rú   R  t   simplifyifpossible(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  }  s    c         C   sD   |  j  |  j k r@ t ƒ  |  _ |  j |  j  g |  _ t |  _ n  d S(   s&   Try to simplify to a single character.N(   Rè   Rà  R%  Rú   R/   Rƒ   t
   simplified(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRğ  ƒ  s    (
   R   R   R   R2   RC   Rà  R   Rñ  Rì  Rğ  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRï  w  s
   		t   SymbolFunctionc           B   s)   e  Z d  Z e j Z d „  Z d „  Z RS(   s>   Find a function which is represented by a symbol (like _ or ^)c         C   s   | j  ƒ  t j k S(   s   Find the symbol(   R‰   Rò  Rà  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë    s    c         C   sL   |  j  | j ƒ  ƒ | j |  j ƒ t ƒ  j |  j ƒ |  _ |  j | ƒ d S(   s   Parse the symbolN(	   Râ  R‰   Rn  RÔ  R(  R,  Rè  Rú   R  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  “  s    (   R   R   R   R2   RE   Rà  Rë  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò  Š  s   		t   TextFunctionc           B   s)   e  Z d  Z e j Z d „  Z d „  Z RS(   s-   A function where parameters are read as text.c         C   s)   t  ƒ  j |  j ƒ |  _ |  j | ƒ d S(   s   Parse a text parameterN(   R(  R,  Rè  Rú   Rû  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Ÿ  s    c         C   s   d |  _  d S(   s   Set the type to fontR  N(   Rë   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ¤  s    (   R   R   R   R2   RF   Rà  Rì  Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó  š  s   		t   LabelFunctionc           B   s)   e  Z d  Z e j Z d „  Z d „  Z RS(   s   A function that acts as a labelc         C   s   |  j  | ƒ |  _ d S(   s   Parse a literal parameterN(   Rı  Rv   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  ­  s    c         C   sP   d |  _  t ƒ  j d |  j d d ƒ|  _ |  j g |  _ |  j t j |  j <d S(   s&   Add an anchor with the label contents.R  RŒ   Rë   t   eqnumberN(   Rë   RÈ  Ræ   Rv   RÔ  Rû   RË  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ±  s    	!(   R   R   R   R2   R?   Rà  Rì  Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRô  ¨  s   		t   FontFunctionc           B   s    e  Z d  Z e j Z d „  Z RS(   s1   A function of one parameter that changes the fontc         C   s   d |  _  |  j ƒ  d S(   s.   Simplify if possible using a single character.R  N(   Rë   Rğ  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ¾  s    	(   R   R   R   R2   R<   Rà  Ró   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRö  ¹  s   	t	   BigSymbolc           B   s2   e  Z d  Z e j Z d „  Z d „  Z d „  Z RS(   s   A big symbol generator.c         C   s   | |  _  d S(   s   Create the big symbol.N(   Rğ  (   Ro   Rğ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   Ù  s    c         C   s@   |  j  |  j k r |  j  g S|  j ƒ  r2 |  j  g S|  j |  j  S(   s   Get an array with all pieces.(   Rğ  R8  t
   smalllimit(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   getpiecesİ  s
    

c         C   s4   t  j s t St |  j |  j ƒ d k r- t St j S(   s7   Decide if the limit should be a small, one-line symbol.i   (   R¹  RÂ  Rƒ   Rq   R8  Rğ  R   R­   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRø  å  s
    	(	   R   R   R   R2   R6   R8  Rp   Rù  Rø  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR÷  Ô  s
   			t
   BigBracketc           B   sY   e  Z d  Z d d „ Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d	 „  Z
 RS(
   s   A big bracket generator.t   lc         C   sJ   | |  _  | |  _ | |  _ d |  _ | t j k rF t j | |  _ n  d S(   s(   Set the size and symbol for the bracket.N(   R]   Rè   t	   alignmentR   R™  R2   R5   (   Ro   R]   RÕ  Rü  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   ğ  s    				c         C   s,   t  |  d t t |  j ƒ ƒ ƒ } | | ƒ S(   s%   Return the nth piece for the bracket.t   getpiece(   R€   RÉ   Rq   R™  (   Ro   R€  t   function(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRı  ù  s    "c         C   s   |  j  d S(   s1   Return the only piece for a single-piece bracket.i    (   R™  (   Ro   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   getpiece1ş  s    c         C   s@   | d k r |  j  d S| |  j d k r5 |  j  d S|  j  d S(   sG   Get the nth piece for a 3-piece bracket: parenthesis or square bracket.i    i   iÿÿÿÿ(   R™  R]   (   Ro   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   getpiece3  s
    c         C   sb   | d k r |  j  d S| |  j d k r5 |  j  d S| |  j d d k rW |  j  d S|  j  d S(   s7   Get the nth piece for a 4-piece bracket: curly bracket.i    i   i   i   (   R™  R]   (   Ro   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   getpiece4
  s    c         C   s3   |  j  | ƒ } d |  j d } t ƒ  j | | ƒ S(   s'   Get the bracket piece as an array cell.s   span class="bracket align-R|   (   Rı  Rü  Rç  R£  (   Ro   R€  Rš  R˜  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getcell  s    c         C   s‡   |  j  d k s |  j r# |  j ƒ  Sg  } xE t |  j  ƒ D]4 } |  j | ƒ } | j t ƒ  j | g d ƒ ƒ q9 Wt ƒ  j | d ƒ g S(   s3   Get the bracket as an array or as a single bracket.i   s   span class="arrayrow"s   span class="array"(   R]   R™  t   getsinglebracketRE  R  R‡   Rç  R¸  (   Ro   t   rowsR€  t   cell(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getcontents  s    
#c         C   s>   |  j  d k r% t ƒ  j d d ƒ g St ƒ  j |  j  d ƒ g S(   s$   Return the bracket as a single sign.RW  R{   s   span class="emptydot"s   span class="symbol"(   Rè   Rç  R£  (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  $  s    (   R   R   R   Rp   Rı  Rÿ  R   R  R  R  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRú  í  s   					
		
t   FormulaEquationc           B   s   e  Z d  Z d Z d „  Z RS(   s   A simple numbered equation.t   equationc         C   s,   t  ƒ  |  _ |  j |  j j t | ƒ ƒ d S(   s   Parse the arrayN(   R&  Rú   Rr  R  RÅ  R   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  4  s    (   R   R   R   Rš  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  /  s   t   FormulaCellc           B   s    e  Z d  Z d „  Z d „  Z RS(   s   An array cell inside a rowc         C   s-   | |  _  t ƒ  j d | d t ƒ |  _ |  S(   Ns   span class="arraycell align-R|   (   Rü  R(  R,  Rƒ   Rú   (   Ro   Rü  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setalignment<  s    	 c         C   s@   |  j  j | ƒ | j ƒ  r  d  S|  j |  j  j t | ƒ ƒ d  S(   N(   R  R$  RM  Rr  RÅ  R   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  A  s    (   R   R   R   R
  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR	  9  s   	t
   FormulaRowc           B   s6   e  Z d  Z e j d Z d „  Z d „  Z d „  Z RS(   s   An array row inside an arrayt   cellseparatorc         C   s%   | |  _  t ƒ  j d t ƒ |  _ |  S(   Ns   span class="arrayrow"(   t
   alignmentsR(  R,  Rƒ   Rú   (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   setalignmentsL  s    	c         C   sš   d } | j  |  j d t ƒxS | j ƒ  sq |  j | ƒ } | j | ƒ |  j | ƒ | d 7} | j |  j ƒ q Wt |  j	 ƒ d k r– t
 ƒ  |  _ n  d S(   s   Parse a whole rowi    Rs  i   N(   Rt  R  Rƒ   RM  t
   createcellRì  Rr  R‰  Rq   Rû   R$  Rú   (   Ro   R{  R€  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Q  s    
c         C   s3   |  j  | t |  j  ƒ } |  j j t ƒ j | ƒ S(   s4   Create the cell that corresponds to the given index.(   R  Rq   R  Ræ   R	  R
  (   Ro   R€  Rü  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ^  s    (	   R   R   R   R2   R4   R  R  Rì  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  G  s
   		t   MultiRowFormulac           B   s2   e  Z d  Z d „  Z d „  Z d „  Z d „  Z RS(   s   A formula with multiple rows.c         C   sr   g  |  _  t } xJ |  j | ƒ D]9 } | r4 t } n
 |  j ƒ  | j | ƒ |  j | ƒ q Wt |  j  ƒ |  _ d S(   s,   Parse all rows, finish when no more row endsN(	   R  Rƒ   t   iteraterowsR   t   addemptyRì  t   addrowRq   R]   (   Ro   R{  R-  t   row(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   parserowsf  s    		
c         c   s   t  j d } xk t rz | j | t ƒ |  j j t ƒ } | j |  j ƒ V| j	 | ƒ rs |  j
 | j | ƒ 7_
 q d Sq Wd S(   s0   Iterate over all rows, end when no more row endst   rowseparatorN(   R2   R4   Rƒ   Rt  R  Ræ   R  R  R  R[  Rè   Rw  (   Ro   R{  R  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  t  s    	c         C   s…   |  j  j t ƒ j |  j ƒ } xS t |  j d j ƒ D]; \ } } | j | ƒ } | j	 t
 d ƒ ƒ | j	 | ƒ q5 W|  j | ƒ d S(   s   Add an empty row.iÿÿÿÿu   â€…N(   R  Ræ   R  R  R  R  R  Rû   R  Rr  Rè  R  (   Ro   R  R€  t   originalcellR  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  €  s    #c         C   s!   |  j  j | ƒ |  j | ƒ d S(   s2   Add a row to the contents and to the list of rows.N(   R  R‡   Rr  (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ‰  s    (   R   R   R   R  R  R  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  c  s
   				t   FormulaArrayc           B   s&   e  Z d  Z d Z d „  Z d „  Z RS(   s   An array within a formulaR4   c         C   s6   t  ƒ  j d t ƒ |  _ |  j | ƒ |  j | ƒ d S(   s   Parse the arrays   span class="array"N(   R(  R,  R   Rú   t   parsealignmentsR  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  “  s    c         C   sg   d |  _  |  j | ƒ } | r* | |  _  n  |  j | ƒ } g  |  _ x | D] } |  j j | ƒ qI Wd S(   s   Parse the different alignmentsRñ   N(   t   valignRë  Rı  R  R‡   (   Ro   R{  R  Rû  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ™  s    		(   R   R   R   Rš  Rì  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    s   	t   FormulaMatrixc           B   s   e  Z d  Z d Z d „  Z RS(   s'   A matrix (array with center alignment).t   matrixc         C   s>   t  ƒ  j d t ƒ |  _ d |  _ d g |  _ |  j | ƒ d S(   s(   Parse the matrix, set alignments to 'c'.s   span class="array"Rñ   N(   R(  R,  R   Rú   R  R  R  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  «  s    	(   R   R   R   Rš  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ¦  s   t   FormulaCasesc           B   s   e  Z d  Z d Z d „  Z RS(   s   A cases statementt   casesc         C   sÉ   t  ƒ  |  _ d d g |  _ |  j | ƒ xN |  j D]C } x: | j D]/ } | j j d t ƒ | j j t d ƒ ƒ qB Wq2 Wt	 ƒ  j
 |  j d t ƒ } t t |  j ƒ d d ƒ } | j ƒ  | g |  _ d S(   s   Parse the casesRû  s   span class="case align-l"u   â€ƒs   span class="bracketcases"t   {N(   R&  Rú   R  R  Rû   R,  Rƒ   R‡   Rè  Rç  R¸  Rú  Rq   R  (   Ro   R{  R  R  R4   t   brace(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  ·  s    (   R   R   R   Rš  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ²  s   t   EquationEnvironmentc           B   s   e  Z d  Z d „  Z RS(   s;   A \begin{}...\end equation environment with rows and cells.c         C   s€   t  ƒ  j d t ƒ |  _ |  j j d d ƒ } | t j k rO t j | |  _ n  t	 j
 d |  j ƒ d g |  _ |  j | ƒ d S(   s   Parse the whole environment.s   span class="environment"RŒ  R{   s   Unknown equation environment Rû  N(   R(  R,  R   Rú   Rš  R~   R2   R;   R  R    R   R  (   Ro   R{  t   environment(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Ç  s    (   R   R   R   Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR!  Ä  s   t   BeginCommandc           B   sF   e  Z d  Z i d e j d 6Z e e e e	 g Z
 d „  Z d „  Z RS(   sE   A \begin{}...\end command and what it entails (array, cases, aligned)R{   Rı   c         C   s†   |  j  | ƒ } |  j | ƒ } t j d d | d } | j | ƒ | j | ƒ |  j | ƒ |  j | j | ƒ 7_ | j	 |  _	 d S(   s   Parse the begin commandt   endR  t   }N(
   Rı  t   findbitR2   R4   Rt  Rì  Rr  Rè   Rw  R]   (   Ro   R{  RÔ  Rã  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Ù  s    c         C   s^   x< t  j D]1 } | j d d ƒ | j k r
 |  j j | ƒ Sq
 W|  j j t ƒ } | | _ | S(   s7   Find the command bit corresponding to the \begin{piece}RŒ  R{   (   R#  R&  R~   Rš  R  Ræ   R!  (   Ro   Rš  Rë   Rã  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR&  ä  s    	(   R   R   R   R2   R4   Rà  R  R  R  R  R&  Rì  R&  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR#  Ò  s
   	t   CombiningFunctionc           B   s#   e  Z e j Z d  „  Z d „  Z RS(   c         C   s™   d |  _  |  j } |  j | ƒ } | s> t j d |  j ƒ nA t | j ƒ  ƒ d k r t j d |  j d | j ƒ  d ƒ n  |  j j	 t
 | ƒ ƒ d S(   s   Parse a combining function.R   s'   Empty parameter for combining function i   s   Applying combining function s    to invalid string "R|   N(   Rë   Rè  t   parsesingleparameterR    R   RÔ  Rq   R&   Rû   R‡   R¶  (   Ro   R{  t	   combiningRé  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  ÷  s    		)c         C   s‘   |  j  j | ƒ | j ƒ  r7 t j d | j ƒ  ƒ d S|  j  j t | ƒ sa |  j  j t	 | ƒ rn |  j
 | ƒ St | j ƒ  ƒ } |  j | ƒ | S(   s&   Parse a parameter, or a single letter.s(   Error while parsing single parameter at N(   R  R$  RM  R    R   R„  R   R"  Rö  RÛ  R  Rè  RX  Rr  (   Ro   R{  t   letter(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR(    s    (   R   R   R2   R8   Rà  Rì  R(  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR'  ó  s   		t   DecoratingFunctionc           B   s    e  Z d  Z e j Z d „  Z RS(   s*   A function that decorates some bit of textc         C   s   d |  _  |  j } t ƒ  j | d ƒ |  _ |  j | ƒ |  _ t ƒ  j d ƒ |  _	 |  j
 j d |  j ƒ t ƒ  j d ƒ |  j _	 |  j ƒ  d S(   s   Parse a decorating functionR   s   span class="symbolover"s   span class="withsymbol"i    s   span class="undersymbol"N(   Rë   Rè  Rç  R£  Rğ  R  Ré  R(  R,  Rú   Rû   R   Rğ  (   Ro   R{  Rğ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì    s    		(   R   R   R   R2   R:   Rà  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR+    s   	t   LimitCommandc           B   s    e  Z d  Z e j Z d „  Z RS(   s@   A command which accepts limits above and below, in display mode.c         C   s^   t  |  j ƒ j ƒ  } t ƒ  j d ƒ |  _ x- | D]% } |  j j t ƒ  j	 | d ƒ ƒ q1 Wd S(   s   Parse a limit command.s   span class="limits"s   span class="limit"N(
   R÷  Rè  Rù  R(  R,  Rú   Rû   R‡   Rç  R£  (   Ro   R{  R™  Rš  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  $  s    (   R   R   R   R2   R@   Rà  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR,    s   	t   LimitPreviousCommandc           B   s&   e  Z d  Z d Z d „  Z d „  Z RS(   s(   A command to limit the previous command.c         C   s)   t  ƒ  j d ƒ |  _ |  j j | ƒ d S(   s   Do nothing.s   span class="limits"N(   R(  R,  Rú   R  R$  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  0  s    c         C   s   d S(   s"   Return a printable representation.s   Limit previous command(    (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   5  s    N(   R   R   R   R   Rà  Rì  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR-  +  s   	t   LimitsProcessorc           B   s_   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d	 „  Z RS(
   s)   A processor for limits inside an element.c         C   sq   t  j r d S|  j | | ƒ r2 |  j | | ƒ n  |  j | | ƒ rm |  j | | d ƒ rm |  j | | ƒ n  d S(   s"   Process the limits for an element.Ni   (   R   R­   t   checklimitst   modifylimitst   checkscriptt   modifyscripts(   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   <  s    	(c         C   se   t  j s t S|  j | | d t ƒ r: |  j | | ƒ t St | | t ƒ sQ t S|  j | | d ƒ S(   s3   Check if the current position has a limits command.i   (	   R¹  RÂ  R   t   checkcommandR-  t   limitsaheadR   R,  R1  (   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR/  E  s    	c         C   s3   | | d j  | | j ƒ  ƒ t ƒ  | | _ d S(   s,   Limit the current element based on the next.i   N(   Rr  Ré   R$  Rú   (   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR4  P  s    c         C   s‹   | | } |  j  | | d ƒ } | j j | ƒ |  j | | d ƒ r_ |  j  | | d ƒ } n t ƒ  j d d ƒ } | j j d | ƒ d S(   sC   Modify a limits commands so that the limits appear above and below.i   u   âŸs   sup class="limit"i    N(   t   getlimitRû   R‡   R1  Rç  R£  R   (   Ro   Rû   R€  t   limitedt	   subscriptt   superscript(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR0  U  s    
c         C   s4   |  j  | | ƒ } | j j j d d ƒ | j _ | S(   s#   Get the limit for a limits command.Ri   R  (   t	   getscriptRú   R)  R~   (   Ro   Rû   R€  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR5  `  s    c         C   sS   |  j  | | ƒ } |  j  | | ƒ } t ƒ  j | | g d ƒ } | j | | ƒ d S(   s=   Modify the super- and subscript to appear vertically aligned.s   span class="scripts"N(   R9  Rç  R¸  R   (   Ro   Rû   R€  R7  R8  t   scripts(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR2  f  s    c         C   s   |  j  | | t ƒ S(   s6   Check if the current element is a sub- or superscript.(   R3  Rò  (   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR1  n  s    c         C   s'   t  | ƒ | k r t St | | | ƒ S(   s0   Check for the given type as the current element.(   Rq   R   R   (   Ro   Rû   R€  Rë   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR3  r  s    c         C   s'   | | } | j  j d 7_ | | =| S(   s   Get the sub- or superscript.s    class="script"(   Rú   R)  (   Ro   Rû   R€  Rã  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR9  x  s    
(   R   R   R   Ró   R/  R4  R0  R5  R2  R1  R3  R9  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR.  9  s   									t   BracketCommandc           B   s)   e  Z d  Z e j Z d „  Z d „  Z RS(   s"   A command which defines a bracket.c         C   s   t  j |  | ƒ d S(   s   Parse the bracket.N(   Rï  Rì  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  „  s    c         C   s,   | |  _  d | |  _ t | ƒ g |  _ |  S(   s+   Create the bracket for the given character.s   \(   Rè   RÔ  Rè  Rû   (   Ro   RÒ  t	   character(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRæ   ˆ  s    	(   R   R   R   R2   R7   Rà  Rì  Ræ   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR;    s   		t   BracketProcessorc           B   sV   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 RS(	   s!   A processor for bracket commands.c         C   s3   t  j r d S|  j | | ƒ r/ |  j | | ƒ Sd S(   s6   Convert the bracket using Unicode pieces, if possible.N(   R   R­   t	   checkleftt   processleft(   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRó   ’  s    	c         C   sa   |  j  | | d ƒ } | s  d S|  j | | | ƒ } |  j | | | ƒ |  j | | | ƒ d S(   s   Process a left bracket.i   N(   t	   findrightt   findmaxt   resize(   Ro   Rû   R€  t
   rightindexR]   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR?  ™  s    c         C   s   |  j  | | d ƒ S(   s0   Check if the command at the given index is left.s   \left(   t   checkdirection(   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR>  ¢  s    c         C   s   |  j  | | d ƒ S(   s1   Check if the command at the given index is right.s   \right(   RD  (   Ro   Rû   R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   checkright¦  s    c         C   s    t  | t ƒ s t S| j | k S(   s6   Check if the given bit is the desired bracket command.(   R   R;  R   RÔ  (   Ro   Rã  RÔ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRD  ª  s    c         C   s{   d } xn | t  | ƒ k  rv |  j | | ƒ r: | d 7} n  |  j | | ƒ rY | d 8} n  | d k ri | S| d 7} q	 Wd S(   s9   Find the right bracket starting at the given index, or 0.i   i    N(   Rq   R>  RE  R   (   Ro   Rû   R€  t   depth(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR@  °  s    c         C   s-   | | | !} t  g  | D] } | j ^ q ƒ S(   s@   Find the max size of the contents between the two given indices.(   Rå  R]   (   Ro   Rû   t	   leftindexRC  t   slicedR'  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRA  ½  s    c         C   sR   | j  ƒ  } | j j d d ƒ } t | | | ƒ } t ƒ  | _ | j ƒ  | _ d S(   s+   Resize a bracket command to the given size.s   \R{   N(   R&   RÔ  R~   Rú  R&  Rú   R  Rû   (   Ro   RÔ  R]   R<  Rü  RÕ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRB  Â  s
    (   R   R   R   Ró   R?  R>  RE  RD  R@  RA  RB  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR=    s   								t   TodayCommandc           B   s   e  Z d  Z d Z d „  Z RS(   s   Shows today's date.c         C   s.   t  ƒ  |  _ t j j ƒ  j d ƒ g |  _ d S(   s"   Parse a command without parameterss	   %b %d, %YN(   R%  Rú   t   datetimeRÃ   t   todayt   strftimeR/   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Ï  s    N(   R   R   R   R   Rà  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRI  Ê  s   t   ParameterDefinitionc           B   s>   e  Z d  Z d	 d
 g Z d „  Z d „  Z d „  Z d „  Z RS(   s3   The definition of a parameter in a hybrid function.t   [R  R  R%  c         C   s1   d  |  _ t |  _ t |  _ d  |  _ d  |  _ d  S(   N(   R   RŞ   R   R  Rs  Rw   t   literalvalue(   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   è  s
    				c         C   sâ   xÄ t  j D]¹ \ } } | j | ƒ r
 | d k r= t |  _ n  | j d ƒ sk t j d | j ƒ  d ƒ d S| j	 ƒ  |  _
 | j d ƒ r• t |  _ n  | j | ƒ s¿ t j d | j	 ƒ  ƒ d S|  Sq
 Wt j d | j	 ƒ  ƒ d S(	   s2   Parse a parameter definition: [$0], {$x}, {$1!}...RN  R  s$   Wrong parameter name, did you mean $t   ?t   !s   Wrong parameter closing s'   Wrong character in parameter template: N(   RM  t   parambracketsR‰  Rƒ   Rs  R    R   R‰   R   RX  RŞ   R  (   Ro   R{  t   openingt   closing(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ï  s     c         C   s   |  j  rZ |  j r' | j | ƒ |  _ n | j | ƒ |  _ |  j rŠ t |  j ƒ |  _ qŠ n0 |  j rx | j | ƒ |  _ n | j | ƒ |  _ d S(   s/   Read the parameter itself using the definition.N(	   R  Rs  Rë  RO  Rı  Rè  Rw   Rê  R  (   Ro   R{  Rş  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   read  s    				c         C   s>   d |  j  } |  j r0 | d t |  j ƒ 7} n
 | d 7} | S(   s"   Return a printable representation.s   param s   : s    (empty)(   RŞ   Rw   RÉ   (   Ro   R–   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä     s
    	
(   RN  R  (   R  R%  (   R   R   R   RR  Rp   R  RU  Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRM  ß  s   			t   ParameterFunctionc           B   s;   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z RS(   sF   A function with a variable number of parameters defined in a template.c         C   sN   t  ƒ  |  _ x; |  j | ƒ D]* } | j | |  ƒ | |  j d | j <q Wd S(   s*   Read the params according to the template.R  N(   RÚ   t   paramst	   paramdefsRU  RŞ   (   Ro   t   readtemplateR{  t   paramdef(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt
   readparams  s    c         c   sC   t  | ƒ } x0 | j ƒ  s> t ƒ  j | ƒ } | r | Vq q Wd S(   s*   Read each param definition in the templateN(   RŠ  RM  RM  R  (   Ro   RY  R{  RZ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRX  $  s
    c         C   s   | |  j  k r d S|  j  | S(   s   Get a parameter as parsed.N(   RW  R   (   Ro   RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getparam,  s    c         C   s   |  j  | ƒ j S(   s   Get the value of a parameter.(   R\  Rw   (   Ro   RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRQ  2  s    c         C   s+   |  j  | ƒ } | s  | j r$ d S| j S(   s%   Get the literal value of a parameter.N(   R\  RO  R   (   Ro   RŞ   R²   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   getliteralvalue6  s    (   R   R   R   R[  RX  R\  RQ  R]  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRV    s   				t   HybridFunctionc           B   s_   e  Z d  Z e j Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d „  Z d „  Z d „  Z RS(	   s   
  A parameter function where the output is also defined using a template.
  The template can use a number of functions; each function has an associated
  tag.
  Example: [f0{$1},span class="fbox"] defines a function f0 which corresponds
  to a span of class fbox, yielding <span class="fbox">$1</span>.
  Literal parameters can be used in tags definitions:
    [f0{$1},span style="color: $p;"]
  yields <span style="color: $p;">$1</span>, where $p is a literal parameter.
  Sizes can be specified in hybridsizes, e.g. adding parameter sizes. By
  default the resulting size is the max of all arguments. Sizes are used
  to generate the right parameters.
  A function followed by a single / is output as a self-closing XHTML tag:
    [f0/,hr]
  will generate <hr/>.
  c         C   sJ   |  j  d } |  j  d } |  j | | ƒ |  j | ƒ |  _ |  j ƒ  d S(   s*   Parse a function with [] and {} parametersi    i   N(   Rè  R[  t   writeparamsRû   t   computehybridsize(   Ro   R{  RY  t   writetemplate(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  Q  s
    c         C   s   |  j  t | ƒ ƒ S(   s*   Write all params according to the template(   t   writeposRŠ  (   Ro   Ra  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR_  Y  s    c         C   s  g  } xö | j  ƒ  sş | j d ƒ rL |  j | ƒ } | rû | j | ƒ qû q	 | j d ƒ rŒ |  j | ƒ } | rû d | _ | j | ƒ qû q	 | j d ƒ r· | j |  j d d ƒ ƒ q	 | j d ƒ râ | j |  j d d ƒ ƒ q	 | j t | j	 ƒ  ƒ ƒ q	 W| S(   s/   Write all params as read in the parse position.R  t   ft   (t   leftRÄ   t   rightN(
   RM  R‰  t
   writeparamR‡   t   writefunctionR   Rë   t   writebracketRè  RX  (   Ro   R{  R–   R²   Rş  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRb  ]  s"    	c         C   s~   d | j  ƒ  } | |  j k r4 t j d | ƒ d S|  j | sE d S| j d ƒ rp | j ƒ  |  j | j _ n  |  j | j S(   s*   Write a single param of the form $0, $x...R  s   Unknown parameter RW  N(	   RX  RW  R    R   R   R‰  Rb  Rw   Rë   (   Ro   R{  RŞ   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRg  r  s    c         C   s§   |  j  | ƒ } | s d S| j d ƒ r8 t ƒ  j | ƒ S| j d ƒ sX t j d ƒ d S| j d ƒ |  j | ƒ } | j	 ƒ  t
 | ƒ d k r” d St ƒ  j | | ƒ S(   s"   Write a single function f0,...,fn.t   /R  s    Function should be defined in {}R%  i    N(   t   readtagR   R‰  Rç  Ré  R    R   Rt  Rb  Rw  Rq   R¸  (   Ro   R{  R)  Rû   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRh  ~  s    
c         C   s%  | j  ƒ  j ƒ  s- t j d | j  ƒ  ƒ d
 St | j ƒ  ƒ } d | t |  j ƒ k rw t j d t	 | ƒ d ƒ d
 S|  j d | } d | k r˜ | Sx† |  j
 D]{ } | | k r¢ |  j
 | } | j sí t j d | d | d ƒ q¢ n  | j r| j } n d	 } | j | | ƒ } q¢ q¢ W| S(   sJ   Get the tag corresponding to the given index. Does parameter substitution.s   Function should be f0,...,f9: fi   s
   Function fs    is not definedR  s   Parameters in tag s    should be literal: {s   !}R{   N(   R‰   Rc  R    R   R   R¢   RX  Rq   Rè  RÉ   RW  R  RO  R~   (   Ro   R{  R€  R)  t   variableR²   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRk    s*    		c         C   s   |  j  j t ƒ j | | ƒ S(   s4   Return a new bracket looking at the given direction.(   R  Ræ   R;  (   Ro   RÒ  R<  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRi  ©  s    c         C   sY   |  j  t j k r  |  j ƒ  d St ƒ  j |  ƒ |  _ x |  j D] } |  j | _ q? Wd S(   s(   Compute the size of the hybrid function.N(   RÔ  t
   HybridSizet   configsizesRæ  t   getsizeR]   Rû   (   Ro   R'  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR`  ­  s    
(   R   R   R   R2   R=   Rà  Rì  R_  Rb  Rg  Rh  Rk  Ri  R`  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR^  =  s   								Rm  c           B   s    e  Z d  Z e j Z d „  Z RS(   s+   The size associated with a hybrid function.c         C   sŒ   |  j  | j } xN | j D]C } | | k r | j | j j ƒ  } | j | t | ƒ ƒ } q q Wd | k r‚ t j d | ƒ d St	 | ƒ S(   s*   Read the size for a function and parse it.R  s%   Unconverted variable in hybrid size: i   (
   Rn  RÔ  RW  Rw   Ræ  R~   RÉ   R    R   t   eval(   Ro   Rş  t
   sizestringRŞ   R]   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRo  ¼  s    (   R   R   R   R2   R>   Rn  Ro  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRm  ·  s   	t   HeaderParserc           B   s2   e  Z d  Z d „  Z d „  Z d „  Z d „  Z RS(   s   Parses the LyX headerc            s3   g  ‰  ˆ j  ˆ ‡  ‡ ‡ f d †  ƒ ˆ j ƒ  ˆ  S(   s?   Parse header parameters into a dictionary, return the preamble.c              s   ˆ j  ˆ ˆ  ƒ S(   N(   t	   parseline(    (   Rû   R  Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò   Ù  s    (   R  Rÿ   (   Ro   R  (    (   Rû   R  Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Ö  s    
c         C   s¡   | j  ƒ  } | j t j d ƒ r3 |  j | ƒ d S| j t j d ƒ r] t ƒ  j | ƒ d S| j t j d ƒ r | j |  j j	 | ƒ ƒ d S|  j
 | ƒ d S(   s0   Parse a single line as a parameter or as a startt   branchNt   lstsett   beginpreamble(   Rş   Rr   RK   RL   t   parsebrancht	   LstParsert   parselstsetR‡   R  R  R  (   Ro   R  Rû   R7  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRs  Ş  s    c         C   s   | j  ƒ  j ƒ  d } | j ƒ  t ƒ  j t j d ƒ } | j | ƒ t | ƒ } x( | j D] } | j	 | | j | ƒ q\ W| t
 j | <d S(   s   Parse all branch definitions.i   t	   endbranchN(   Rş   R   Rÿ   Rr  R¸  RK   RL   R  RÜ   Rà   R   RÛ   (   Ro   R  Rt  t	   subparserRn   Rv   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRw  í  s    
c         C   s   | |  _  |  S(   s*   Complete the parser with the given ending.(   R  (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR¸  ø  s    	(   R   R   R   R  Rs  Rw  R¸  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRr  Ó  s
   			t   PreambleParserc           B   s&   e  Z d  Z g  Z d „  Z d „  Z RS(   s   A parser for the LyX preamble.c            s0   t  j d ˆ _ ˆ j ˆ  ‡  ‡ f d †  ƒ g  S(   s,   Parse the full preamble with all statements.t   endpreamblec              s   ˆ j  ˆ  ƒ S(   N(   t   parsepreambleline(    (   R  Ro   (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRò     s    (   RK   RL   R  R  (   Ro   R  (    (   R  Ro   s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR    s    c         C   s$   t  j j | j ƒ  ƒ | j ƒ  d S(   s   Parse a single preamble line.N(   R|  t   preambleR‡   Rş   Rÿ   (   Ro   R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR~    s    (   R   R   R   R  R  R~  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR|  ı  s   	Rx  c           B   s;   e  Z d  Z e ƒ  Z d „  Z d „  Z d „  Z d „  Z RS(   s!   Parse global and local lstparams.c         C   sc   |  j  | ƒ } d | k r0 t j d | ƒ d S| j d ƒ d } | d  } |  j | ƒ t _ d S(   s+   Parse a declaration of lstparams in lstset.R  s#   Missing opening bracket in lstset: Ni   iÿÿÿÿ(   t   extractlstsetR    R   R   t   parselstparamsRx  t   globalparams(   Ro   R  R©  t   lefttextt   croppedtext(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRy    s    
c         C   sW   d } x= | j  ƒ  sE | | j ƒ  7} | j ƒ  | j d ƒ r	 | Sq	 Wt j d ƒ d S(   s%   Extract the global lstset parameters.R{   R%  s0   Could not find end of \lstset settings; abortingN(   RM  Rş   Rÿ   R   R    R   (   Ro   R  R©  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR€    s    
c         C   s>   t  j j ƒ  | _ | j d ƒ } | j j |  j | ƒ ƒ d S(   s-   Parse some lstparams from elyxer.a container.t	   lstparamsN(   Rx  R‚  R—   R…  Rª  t   updateR  (   Ro   Rõ   t	   paramlist(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  &  s    c         C   s{   t  ƒ  } xk | D]c } d | k rQ t | j ƒ  ƒ d k rs t j d | ƒ qs q | j d d ƒ \ } } | | | <q W| S(   s1   Process a number of lstparams from elyxer.a list.Ry   i    s   Invalid listing parameter i   (   RÚ   Rq   R  R    R   R   (   Ro   R‡  t	   paramdictR²   Rv   Rw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  ,  s    	(	   R   R   R   RÚ   R‚  Ry  R€  R  R  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRx    s   		
	
	t   MacroDefinitionc           B   s;   e  Z d  Z e ƒ  Z d „  Z d „  Z d „  Z d „  Z RS(   s0   A function that defines a new command (a macro).c         C   s€   t  ƒ  |  _ d |  _ g  |  _ t |  j _ |  j | ƒ t |  j _ t	 j
 d |  j d t |  j ƒ d ƒ |  |  j |  j <d S(   s*   Parse the function that defines the macro.i    s   New command s    (s    parameters)N(   R$  Rú   t   parameternumbert   defaultsRƒ   R  R(  t   parseparametersR   R    R   t
   newcommandRÉ   t   macros(   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  @  s    		#c         C   sŠ   |  j  | ƒ |  _ |  j | ƒ } | r9 t | ƒ |  _ n  |  j | ƒ } x) | rs |  j j | ƒ |  j | ƒ } qK W|  j | ƒ |  _	 d S(   sD   Parse all optional parameters (number of parameters, default values)N(
   t   parsenewcommandR  Rë  R¢   RŠ  Rê  R‹  R‡   R  t
   definition(   Ro   R{  R  RÕ  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRŒ  L  s    	c         C   s{   |  j  j | ƒ |  j  j t | ƒ r2 |  j | ƒ S|  j  j t | ƒ r` |  j  j t ƒ j | ƒ St j	 d | j
 ƒ  ƒ d S(   s"   Parse the name of the new command.s,   Unknown formula bit in defining function at RÄ  (   R  R$  R"  Rö  Rı  RÛ  Ræ   RÜ  R    R   R„  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  \  s    c         C   s   |  j  j ƒ  S(   s    Return an instance of the macro.(   R  Ré   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRÄ  f  s    (	   R   R   R   RÚ   R  Rì  RŒ  R  RÄ  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR‰  ;  s   				
t   MacroParameterc           B   s    e  Z d  Z d „  Z d „  Z RS(   s    A parameter from elyxer.a macro.c         C   s   | j  d ƒ S(   s   Find a macro parameter: #n.R²  (   R[  (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRë  m  s    c         C   sw   | j  d ƒ s  t j d ƒ d St | j ƒ  ƒ |  _ d t |  j ƒ |  _ t ƒ  j	 d t |  j ƒ d ƒ g |  _
 d S(   s   Parse the parameter: #n.R²  s   Missing parameter start #.Ns   span class="unknown"(   R‰  R    R   R¢   RX  RÂ   RÉ   Rè   Rç  R£  Rû   (   Ro   R{  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì  q  s    (   R   R   R   Rë  Rì  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR‘  j  s   	t   MacroFunctionc           B   s_   e  Z d  Z e j Z d „  Z d „  Z d „  Z d „  Z	 d „  Z
 d „  Z d „  Z d „  Z RS(	   s*   A function that was defined using a macro.c         C   s?   t  ƒ  |  _ g  |  _ |  j } |  j | | ƒ |  j | ƒ d S(   s#   Parse a number of input parameters.N(   R2  Rú   t   valuesRè  RŒ  t   completemacro(   Ro   R{  t   macro(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRì    s
    		c         C   so   |  j  | t | j ƒ ƒ |  j | | j t | j ƒ ƒ t |  j ƒ | j k  rk t j d t	 |  ƒ ƒ n  d S(   s'   Parse as many parameters as are needed.s   Missing parameters in macro N(
   t   parseoptionalR†   R‹  t   parsemandatoryRŠ  Rq   R“  R    R   RÉ   (   Ro   R{  R•  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRŒ  ‡  s     c         C   s¼   g  } xK |  j  j t | ƒ rS | j |  j | ƒ ƒ t | ƒ t | ƒ k r	 Pq	 q	 WxR | D]J } | j ƒ  } t | j ƒ d k r• |  j j | ƒ q[ |  j j | ƒ q[ W|  j | 7_ d S(   s   Parse optional parameters.i    N(	   R  R"  R  R‡   Rê  Rq   Ru  Rû   R“  (   Ro   R{  R‹  Rs  Rw   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR–    s    c         C   sK   xD t  | ƒ D]6 } |  j | | | ƒ } | s3 d S|  j j | ƒ q Wd S(   s'   Parse a number of mandatory parameters.N(   RE  t   parsemacroparameterR“  R‡   (   Ro   R{  RÂ   R€  Ré  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR—    s
    c         C   sR   |  j  j | ƒ | j ƒ  r  d S|  j  j t | ƒ rE |  j | | ƒ S|  j | ƒ S(   s?   Parse a macro parameter. Could be a bracket or a single letter.N(   R  R$  RM  R   R"  Rñ  t   parsenumbersR  (   Ro   R{  t	   remaining(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR˜  ¥  s    c         C   s„   |  j  j t | ƒ } t | j ƒ | k s. | SxO | j D]D } |  j  j t ƒ } | j t | ƒ ƒ | | _ |  j	 j
 | ƒ q8 Wd S(   s3   Parse the remaining parameters as a running number.N(   R  RÅ  Rñ  Rq   Rè   Ræ   Rr  Rè  Rë   R“  R‡   R   (   Ro   R{  Rš  RÂ   t   digitRw   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR™  °  s    	c         C   sê   | j  ƒ  g |  _ t g t |  j ƒ } xw |  j t ƒ D]f } | j d } | t |  j ƒ k r{ t j	 d t
 | ƒ ƒ d St | | <|  j | j ƒ  g | _ q8 WxA t t |  j ƒ ƒ D]* } | | s¸ |  j | |  j | ƒ q¸ q¸ Wd S(   s,   Complete the macro with the parameters read.i   s%   Macro parameter index out of bounds: N(   RÄ  Rû   R   Rq   R“  R   R‘  RÂ   R    R   RÉ   Rƒ   Ré   RE  R5  (   Ro   R•  R#   Ré  R€  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR”  ½  s    

c         C   sG   d t  | d ƒ } d j |  j d j ƒ  ƒ } |  j j | | ƒ d S(   s@   Add a filter for the given parameter number and parameter value.R²  i   R{   i    N(   RÉ   t   joinR“  R"  Rú   R5  (   Ro   R€  Rw   Rè   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR5  Ì  s    (   R   R   R   R‰  R  Rà  Rì  RŒ  R–  R—  R˜  R™  R”  R5  (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR’  z  s   								t   FormulaMacroc           B   s    e  Z d  Z d „  Z d „  Z RS(   s!   A math macro defined in an inset.c         C   s   t  ƒ  |  _ t ƒ  |  _ d  S(   N(   Rà  R•   R$  Rú   (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRp   Õ  s    c         C   s   d S(   s"   Return a printable representation.s
   Math macro(    (   Ro   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyRä   Ù  s    (   R   R   R   Rp   Rä   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyR  Ò  s   	c         C   sE   t  ƒ  } | j |  ƒ } t ƒ  j | ƒ | j ƒ  d j | j ƒ  ƒ S(   s   Convert some TeX math to HTML.R{   (   R  RÎ  R  Ró   Rœ  R"  (   RÏ  R  R  (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt	   math2htmlå  s
    	
c          C   sc   t  j }  t ƒ  j |  ƒ t |  ƒ d k rB t j d ƒ t ƒ  n  t |  d ƒ } t j	 | ƒ d S(   s=   Main function, called if invoked from elyxer.the command linei   s"   Usage: math2html.py escaped_stringi    N(
   R   t   argvR   Rx   Rq   R    R   R   R  R   (   Ru   R–   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   mainí  s    	
t   __main__(    R   t   objectR    t   os.pathR³   R   R"   R$   R+   R2   RI   RK   RN   RR   RT   RV   RY   R_   Rb   Rk   Rm   R   RÜ   R  Rå   Rì   Rü   R  R  R  R  R  R  R   R!  R$  R%  R&  R(  R2  R8  R=  R9  RN  RT  RU  Rz  R‚  RŠ  R  R‘  R®  R¯  R±  R¶  R·  R¹  RÃ  Rà  Rá  Rç  Rè  Rê  Rí  Rñ  Ró  Rõ  Rö  R  R  R  R  R   R  t   unicodedataR1  R)  RÅ   R6  RU  RX  Rs  Rp  Rq  Rv  R”  R•  R–  R—  R™  Rš  R›  Rœ  R  RŸ  R   R¡  R¤  R¥  R§  R¨  R©  Rª  R«  R¬  R®  R¯  R·  R¸  R°  Rº  R»  RÈ  RÌ  RÛ  Rç  Rì  Rí  Rî  Rï  Rò  Ró  Rô  Rö  R&  R÷  Rú  R  R	  R  R  R  R  R  R!  R#  RJ  R'  R+  R,  R-  R.  R;  R=  RI  R	  RM  RV  R^  Rm  Rr  R|  Rx  R‰  R‘  R’  R  R  R   R   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/math2html.pyt   <module>   sV  2K ÿ Ö#,"EÜ	-M#	


BD(v?8#>š2"h,F8kK6Yn

8/1>U;		

B
+F;:$z
*./X		
           usr/local/lib/python2.7/dist-packages/docutils/utils/math/tex2mathml_extern.py                      0100644 0000000 0000062 00000013002 13077704374 026170  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        #!/usr/bin/env python
# -*- coding: utf-8 -*-

# :Id: $Id: tex2mathml_extern.py 7861 2015-04-10 23:48:51Z milde $
# :Copyright: Â© 2015 GÃ¼nter Milde.
# :License: Released under the terms of the `2-Clause BSD license`_, in short:
#
#    Copying and distribution of this file, with or without modification,
#    are permitted in any medium without royalty provided the copyright
#    notice and this notice are preserved.
#    This file is offered as-is, without any warranty.
#
# .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause

# Wrappers for TeX->MathML conversion by external tools
# =====================================================

import subprocess

document_template = r"""\documentclass{article}
\usepackage{amsmath}
\begin{document}
%s
\end{document}
"""

def latexml(math_code, reporter=None):
    """Convert LaTeX math code to MathML with LaTeXML_
    
    .. _LaTeXML: http://dlmf.nist.gov/LaTeXML/
    """
    p = subprocess.Popen(['latexml',
                             '-', # read from stdin
                             # '--preload=amsmath',
                             '--inputencoding=utf8',
                            ],
                            stdin=subprocess.PIPE,
                            stdout=subprocess.PIPE,
                            stderr=subprocess.PIPE,
                            close_fds=True)
    p.stdin.write((document_template % math_code).encode('utf8'))
    p.stdin.close()
    latexml_code = p.stdout.read()
    latexml_err = p.stderr.read().decode('utf8')
    if reporter and latexml_err.find('Error') >= 0 or not latexml_code:
        reporter.error(latexml_err)

    post_p = subprocess.Popen(['latexmlpost',
                               '-',
                               '--nonumbersections',
                               '--format=xhtml',
                               # '--linelength=78', # experimental
                               '--'
                              ],
                              stdin=subprocess.PIPE,
                              stdout=subprocess.PIPE,
                              stderr=subprocess.PIPE,
                              close_fds=True)
    post_p.stdin.write(latexml_code)
    post_p.stdin.close()
    result = post_p.stdout.read().decode('utf8')
    post_p_err = post_p.stderr.read().decode('utf8')
    if reporter and post_p_err.find('Error') >= 0 or not result:
        reporter.error(post_p_err)
    
    # extract MathML code:
    start,end = result.find('<math'), result.find('</math>')+7
    result = result[start:end]
    if 'class="ltx_ERROR' in result:
        raise SyntaxError(result)
    return result

def ttm(math_code, reporter=None):
    """Convert LaTeX math code to MathML with TtM_
    
    .. _TtM: http://hutchinson.belmont.ma.us/tth/mml/
    """
    p = subprocess.Popen(['ttm',
                          # '-i', # italic font for equations. Default roman.
                          '-u', # unicode character encoding. (Default iso-8859-1).
                          '-r', # output raw MathML (no preamble or  postlude)
                         ],
                         stdin=subprocess.PIPE,
                         stdout=subprocess.PIPE,
                         stderr=subprocess.PIPE,
                         close_fds=True)
    p.stdin.write((document_template % math_code).encode('utf8'))
    p.stdin.close()
    result = p.stdout.read()
    err = p.stderr.read().decode('utf8')
    if err.find('**** Unknown') >= 0:
        msg = '\n'.join([line for line in err.splitlines()
                         if line.startswith('****')])
        raise SyntaxError('\nMessage from external converter TtM:\n'+ msg)
    if reporter and err.find('**** Error') >= 0 or not result:
        reporter.error(err)
    start,end = result.find('<math'), result.find('</math>')+7
    result = result[start:end]
    return result

def blahtexml(math_code, inline=True, reporter=None):
    """Convert LaTeX math code to MathML with blahtexml_
    
    .. _blahtexml: http://gva.noekeon.org/blahtexml/
    """
    options = ['--mathml',
               '--indented',
               '--spacing', 'moderate',
               '--mathml-encoding', 'raw',
               '--other-encoding', 'raw',
               '--doctype-xhtml+mathml',
               '--annotate-TeX',
              ]
    if inline:
        mathmode_arg = ''
    else:
        mathmode_arg = 'mode="display"'
        options.append('--displaymath')
    
    p = subprocess.Popen(['blahtexml']+options,
                         stdin=subprocess.PIPE,
                         stdout=subprocess.PIPE,
                         stderr=subprocess.PIPE,
                         close_fds=True)
    p.stdin.write(math_code.encode('utf8'))
    p.stdin.close()
    result = p.stdout.read().decode('utf8')
    err = p.stderr.read().decode('utf8')
    
    print err
    if result.find('<error>') >= 0:
        raise SyntaxError('\nMessage from external converter blahtexml:\n'
                +result[result.find('<message>')+9:result.find('</message>')])
    if reporter and (err.find('**** Error') >= 0 or not result):
        reporter.error(err)
    start,end = result.find('<markup>')+9, result.find('</markup>')
    result = ('<math xmlns="http://www.w3.org/1998/Math/MathML"%s>\n'
              '%s</math>\n') % (mathmode_arg, result[start:end])
    return result

# self-test

if __name__ == "__main__":
    example = ur'\frac{\partial \sin^2(\alpha)}{\partial \vec r} \varpi \, \text{GrÃ¼ÃŸe}'
    # print latexml(example).encode('utf8')
    # print ttm(example)#.encode('utf8')
    print blahtexml(example).encode('utf8')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              usr/local/lib/python2.7/dist-packages/docutils/utils/math/tex2mathml_extern.pyc                     0100644 0000000 0000062 00000007767 13077704402 026350  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   sf   d  d l  Z  d Z d d „ Z d d „ Z e d d „ Z e d k rb d Z e e ƒ j	 d ƒ GHn  d S(	   iÿÿÿÿNsP   \documentclass{article}
\usepackage{amsmath}
\begin{document}
%s
\end{document}
c   
   
   C   sÉ  t  j d d d g d t  j d t  j d t  j d t ƒ} | j j t |  j d ƒ ƒ | j j ƒ  | j	 j
 ƒ  } | j j
 ƒ  j d ƒ } | r¥ | j d	 ƒ d
 k s¬ | r¼ | j | ƒ n  t  j d d d d d g d t  j d t  j d t  j d t ƒ} | j j | ƒ | j j ƒ  | j	 j
 ƒ  j d ƒ } | j j
 ƒ  j d ƒ } | rc| j d	 ƒ d
 k sj| rz| j | ƒ n  | j d ƒ | j d ƒ d } }	 | | |	 !} d | k rÅt | ƒ ‚ n  | S(   sh   Convert LaTeX math code to MathML with LaTeXML_
    
    .. _LaTeXML: http://dlmf.nist.gov/LaTeXML/
    t   latexmlt   -s   --inputencoding=utf8t   stdint   stdoutt   stderrt	   close_fdst   utf8t   Errori    t   latexmlposts   --nonumbersectionss   --format=xhtmls   --s   <maths   </math>i   s   class="ltx_ERROR(   t
   subprocesst   Popent   PIPEt   TrueR   t   writet   document_templatet   encodet   closeR   t   readR   t   decodet   findt   errort   SyntaxError(
   t	   math_codet   reportert   pt   latexml_codet   latexml_errt   post_pt   resultt
   post_p_errt   startt   end(    (    sG   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/tex2mathml_extern.pyR       sB    						"						"#c   	   
   C   sO  t  j d d d g d t  j d t  j d t  j d t ƒ} | j j t |  j d ƒ ƒ | j j ƒ  | j	 j
 ƒ  } | j j
 ƒ  j d ƒ } | j d	 ƒ d
 k ré d j g  | j ƒ  D] } | j d ƒ r² | ^ q² ƒ } t d | ƒ ‚ n  | r| j d ƒ d
 k s| r| j | ƒ n  | j d ƒ | j d ƒ d } } | | | !} | S(   sk   Convert LaTeX math code to MathML with TtM_
    
    .. _TtM: http://hutchinson.belmont.ma.us/tth/mml/
    t   ttms   -us   -rR   R   R   R   R   s   **** Unknowni    s   
s   ****s&   
Message from external converter TtM:
s
   **** Errors   <maths   </math>i   (   R	   R
   R   R   R   R   R   R   R   R   R   R   R   R   t   joint
   splitlinest
   startswithR   R   (	   R   R   R   R   t   errt   linet   msgR   R   (    (    sG   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/tex2mathml_extern.pyR    I   s(    						"#c   
   
   C   s  d d d d d d d d d d	 g
 } | r3 d
 } n d } | j  d ƒ t j d g | d t j d t j d t j d t ƒ} | j j |  j d ƒ ƒ | j j ƒ  | j	 j
 ƒ  j d ƒ } | j j
 ƒ  j d ƒ } | GH| j d ƒ d k rt d | | j d ƒ d | j d ƒ !ƒ ‚ n  | rO| j d ƒ d k s?| rO| j | ƒ n  | j d ƒ d | j d ƒ } }	 d | | | |	 !f } | S(   sp   Convert LaTeX math code to MathML with blahtexml_
    
    .. _blahtexml: http://gva.noekeon.org/blahtexml/
    s   --mathmls
   --indenteds	   --spacingt   moderates   --mathml-encodingt   raws   --other-encodings   --doctype-xhtml+mathmls   --annotate-TeXt    s   mode="display"s   --displaymatht	   blahtexmlR   R   R   R   R   s   <error>i    s,   
Message from external converter blahtexml:
s	   <message>i	   s
   </message>s
   **** Errors   <markup>s	   </markup>s>   <math xmlns="http://www.w3.org/1998/Math/MathML"%s>
%s</math>
(   t   appendR	   R
   R   R   R   R   R   R   R   R   R   R   R   R   R   (
   R   t   inlineR   t   optionst   mathmode_argR   R   R$   R   R   (    (    sG   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/tex2mathml_extern.pyR*   e   s<    						*"#t   __main__uH   \frac{\partial \sin^2(\alpha)}{\partial \vec r} \varpi \, \text{GrÃ¼ÃŸe}R   (
   R	   R   t   NoneR    R    R   R*   t   __name__t   exampleR   (    (    (    sG   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/tex2mathml_extern.pyt   <module>   s   .*         usr/local/lib/python2.7/dist-packages/docutils/utils/math/tex2unichar.py                            0100644 0000000 0000062 00000104445 13077704374 024766  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # -*- coding: utf-8 -*-

# LaTeX math to Unicode symbols translation dictionaries.
# Generated with ``write_tex2unichar.py`` from the data in
# http://milde.users.sourceforge.net/LUCR/Math/

# Includes commands from: wasysym, stmaryrd, mathdots, mathabx, esint, bbold, amsxtra, amsmath, amssymb, standard LaTeX

mathaccent = {
    'acute': u'\u0301', # xÌ COMBINING ACUTE ACCENT
    'bar': u'\u0304', # xÌ„ COMBINING MACRON
    'breve': u'\u0306', # xÌ† COMBINING BREVE
    'check': u'\u030c', # xÌŒ COMBINING CARON
    'ddddot': u'\u20dc', # xâƒœ COMBINING FOUR DOTS ABOVE
    'dddot': u'\u20db', # xâƒ› COMBINING THREE DOTS ABOVE
    'ddot': u'\u0308', # xÌˆ COMBINING DIAERESIS
    'dot': u'\u0307', # xÌ‡ COMBINING DOT ABOVE
    'grave': u'\u0300', # xÌ€ COMBINING GRAVE ACCENT
    'hat': u'\u0302', # xÌ‚ COMBINING CIRCUMFLEX ACCENT
    'mathring': u'\u030a', # xÌŠ COMBINING RING ABOVE
    'not': u'\u0338', # xÌ¸ COMBINING LONG SOLIDUS OVERLAY
    'overleftarrow': u'\u20d6', # xâƒ– COMBINING LEFT ARROW ABOVE
    'overleftrightarrow': u'\u20e1', # xâƒ¡ COMBINING LEFT RIGHT ARROW ABOVE
    'overline': u'\u0305', # xÌ… COMBINING OVERLINE
    'overrightarrow': u'\u20d7', # xâƒ— COMBINING RIGHT ARROW ABOVE
    'tilde': u'\u0303', # xÌƒ COMBINING TILDE
    'underbar': u'\u0331', # xÌ± COMBINING MACRON BELOW
    'underleftarrow': u'\u20ee', # xâƒ® COMBINING LEFT ARROW BELOW
    'underline': u'\u0332', # xÌ² COMBINING LOW LINE
    'underrightarrow': u'\u20ef', # xâƒ¯ COMBINING RIGHT ARROW BELOW
    'vec': u'\u20d7', # xâƒ— COMBINING RIGHT ARROW ABOVE
    'widehat': u'\u0302', # xÌ‚ COMBINING CIRCUMFLEX ACCENT
    'widetilde': u'\u0303', # xÌƒ COMBINING TILDE
    }
mathalpha = {
    'Bbbk': u'\U0001d55c', # ğ•œ MATHEMATICAL DOUBLE-STRUCK SMALL K
    'Delta': u'\u0394', # Î” GREEK CAPITAL LETTER DELTA
    'Gamma': u'\u0393', # Î“ GREEK CAPITAL LETTER GAMMA
    'Im': u'\u2111', # â„‘ BLACK-LETTER CAPITAL I
    'Lambda': u'\u039b', # Î› GREEK CAPITAL LETTER LAMDA
    'Omega': u'\u03a9', # Î© GREEK CAPITAL LETTER OMEGA
    'Phi': u'\u03a6', # Î¦ GREEK CAPITAL LETTER PHI
    'Pi': u'\u03a0', # Î  GREEK CAPITAL LETTER PI
    'Psi': u'\u03a8', # Î¨ GREEK CAPITAL LETTER PSI
    'Re': u'\u211c', # â„œ BLACK-LETTER CAPITAL R
    'Sigma': u'\u03a3', # Î£ GREEK CAPITAL LETTER SIGMA
    'Theta': u'\u0398', # Î˜ GREEK CAPITAL LETTER THETA
    'Upsilon': u'\u03a5', # Î¥ GREEK CAPITAL LETTER UPSILON
    'Xi': u'\u039e', # Î GREEK CAPITAL LETTER XI
    'aleph': u'\u2135', # â„µ ALEF SYMBOL
    'alpha': u'\u03b1', # Î± GREEK SMALL LETTER ALPHA
    'beta': u'\u03b2', # Î² GREEK SMALL LETTER BETA
    'beth': u'\u2136', # â„¶ BET SYMBOL
    'chi': u'\u03c7', # Ï‡ GREEK SMALL LETTER CHI
    'daleth': u'\u2138', # â„¸ DALET SYMBOL
    'delta': u'\u03b4', # Î´ GREEK SMALL LETTER DELTA
    'digamma': u'\u03dc', # Ïœ GREEK LETTER DIGAMMA
    'ell': u'\u2113', # â„“ SCRIPT SMALL L
    'epsilon': u'\u03f5', # Ïµ GREEK LUNATE EPSILON SYMBOL
    'eta': u'\u03b7', # Î· GREEK SMALL LETTER ETA
    'eth': u'\xf0', # Ã° LATIN SMALL LETTER ETH
    'gamma': u'\u03b3', # Î³ GREEK SMALL LETTER GAMMA
    'gimel': u'\u2137', # â„· GIMEL SYMBOL
    'hbar': u'\u210f', # â„ PLANCK CONSTANT OVER TWO PI
    'hslash': u'\u210f', # â„ PLANCK CONSTANT OVER TWO PI
    'imath': u'\u0131', # Ä± LATIN SMALL LETTER DOTLESS I
    'iota': u'\u03b9', # Î¹ GREEK SMALL LETTER IOTA
    'jmath': u'\u0237', # È· LATIN SMALL LETTER DOTLESS J
    'kappa': u'\u03ba', # Îº GREEK SMALL LETTER KAPPA
    'lambda': u'\u03bb', # Î» GREEK SMALL LETTER LAMDA
    'mu': u'\u03bc', # Î¼ GREEK SMALL LETTER MU
    'nu': u'\u03bd', # Î½ GREEK SMALL LETTER NU
    'omega': u'\u03c9', # Ï‰ GREEK SMALL LETTER OMEGA
    'phi': u'\u03d5', # Ï• GREEK PHI SYMBOL
    'pi': u'\u03c0', # Ï€ GREEK SMALL LETTER PI
    'psi': u'\u03c8', # Ïˆ GREEK SMALL LETTER PSI
    'rho': u'\u03c1', # Ï GREEK SMALL LETTER RHO
    'sigma': u'\u03c3', # Ïƒ GREEK SMALL LETTER SIGMA
    'tau': u'\u03c4', # Ï„ GREEK SMALL LETTER TAU
    'theta': u'\u03b8', # Î¸ GREEK SMALL LETTER THETA
    'upsilon': u'\u03c5', # Ï… GREEK SMALL LETTER UPSILON
    'varDelta': u'\U0001d6e5', # ğ›¥ MATHEMATICAL ITALIC CAPITAL DELTA
    'varGamma': u'\U0001d6e4', # ğ›¤ MATHEMATICAL ITALIC CAPITAL GAMMA
    'varLambda': u'\U0001d6ec', # ğ›¬ MATHEMATICAL ITALIC CAPITAL LAMDA
    'varOmega': u'\U0001d6fa', # ğ›º MATHEMATICAL ITALIC CAPITAL OMEGA
    'varPhi': u'\U0001d6f7', # ğ›· MATHEMATICAL ITALIC CAPITAL PHI
    'varPi': u'\U0001d6f1', # ğ›± MATHEMATICAL ITALIC CAPITAL PI
    'varPsi': u'\U0001d6f9', # ğ›¹ MATHEMATICAL ITALIC CAPITAL PSI
    'varSigma': u'\U0001d6f4', # ğ›´ MATHEMATICAL ITALIC CAPITAL SIGMA
    'varTheta': u'\U0001d6e9', # ğ›© MATHEMATICAL ITALIC CAPITAL THETA
    'varUpsilon': u'\U0001d6f6', # ğ›¶ MATHEMATICAL ITALIC CAPITAL UPSILON
    'varXi': u'\U0001d6ef', # ğ›¯ MATHEMATICAL ITALIC CAPITAL XI
    'varepsilon': u'\u03b5', # Îµ GREEK SMALL LETTER EPSILON
    'varkappa': u'\U0001d718', # ğœ˜ MATHEMATICAL ITALIC KAPPA SYMBOL
    'varphi': u'\u03c6', # Ï† GREEK SMALL LETTER PHI
    'varpi': u'\u03d6', # Ï– GREEK PI SYMBOL
    'varrho': u'\u03f1', # Ï± GREEK RHO SYMBOL
    'varsigma': u'\u03c2', # Ï‚ GREEK SMALL LETTER FINAL SIGMA
    'vartheta': u'\u03d1', # Ï‘ GREEK THETA SYMBOL
    'wp': u'\u2118', # â„˜ SCRIPT CAPITAL P
    'xi': u'\u03be', # Î¾ GREEK SMALL LETTER XI
    'zeta': u'\u03b6', # Î¶ GREEK SMALL LETTER ZETA
    }
mathbin = {
    'Cap': u'\u22d2', # â‹’ DOUBLE INTERSECTION
    'Circle': u'\u25cb', # â—‹ WHITE CIRCLE
    'Cup': u'\u22d3', # â‹“ DOUBLE UNION
    'LHD': u'\u25c0', # â—€ BLACK LEFT-POINTING TRIANGLE
    'RHD': u'\u25b6', # â–¶ BLACK RIGHT-POINTING TRIANGLE
    'amalg': u'\u2a3f', # â¨¿ AMALGAMATION OR COPRODUCT
    'ast': u'\u2217', # âˆ— ASTERISK OPERATOR
    'barwedge': u'\u22bc', # âŠ¼ NAND
    'bigtriangledown': u'\u25bd', # â–½ WHITE DOWN-POINTING TRIANGLE
    'bigtriangleup': u'\u25b3', # â–³ WHITE UP-POINTING TRIANGLE
    'bindnasrepma': u'\u214b', # â…‹ TURNED AMPERSAND
    'blacklozenge': u'\u29eb', # â§« BLACK LOZENGE
    'blacktriangledown': u'\u25be', # â–¾ BLACK DOWN-POINTING SMALL TRIANGLE
    'blacktriangleleft': u'\u25c2', # â—‚ BLACK LEFT-POINTING SMALL TRIANGLE
    'blacktriangleright': u'\u25b8', # â–¸ BLACK RIGHT-POINTING SMALL TRIANGLE
    'blacktriangleup': u'\u25b4', # â–´ BLACK UP-POINTING SMALL TRIANGLE
    'boxast': u'\u29c6', # â§† SQUARED ASTERISK
    'boxbar': u'\u25eb', # â—« WHITE SQUARE WITH VERTICAL BISECTING LINE
    'boxbox': u'\u29c8', # â§ˆ SQUARED SQUARE
    'boxbslash': u'\u29c5', # â§… SQUARED FALLING DIAGONAL SLASH
    'boxcircle': u'\u29c7', # â§‡ SQUARED SMALL CIRCLE
    'boxdot': u'\u22a1', # âŠ¡ SQUARED DOT OPERATOR
    'boxminus': u'\u229f', # âŠŸ SQUARED MINUS
    'boxplus': u'\u229e', # âŠ SQUARED PLUS
    'boxslash': u'\u29c4', # â§„ SQUARED RISING DIAGONAL SLASH
    'boxtimes': u'\u22a0', # âŠ  SQUARED TIMES
    'bullet': u'\u2219', # âˆ™ BULLET OPERATOR
    'cap': u'\u2229', # âˆ© INTERSECTION
    'cdot': u'\u22c5', # â‹… DOT OPERATOR
    'circ': u'\u2218', # âˆ˜ RING OPERATOR
    'circledast': u'\u229b', # âŠ› CIRCLED ASTERISK OPERATOR
    'circledcirc': u'\u229a', # âŠš CIRCLED RING OPERATOR
    'circleddash': u'\u229d', # âŠ CIRCLED DASH
    'cup': u'\u222a', # âˆª UNION
    'curlyvee': u'\u22ce', # â‹ CURLY LOGICAL OR
    'curlywedge': u'\u22cf', # â‹ CURLY LOGICAL AND
    'dagger': u'\u2020', # â€  DAGGER
    'ddagger': u'\u2021', # â€¡ DOUBLE DAGGER
    'diamond': u'\u22c4', # â‹„ DIAMOND OPERATOR
    'div': u'\xf7', # Ã· DIVISION SIGN
    'divideontimes': u'\u22c7', # â‹‡ DIVISION TIMES
    'dotplus': u'\u2214', # âˆ” DOT PLUS
    'doublebarwedge': u'\u2a5e', # â© LOGICAL AND WITH DOUBLE OVERBAR
    'intercal': u'\u22ba', # âŠº INTERCALATE
    'interleave': u'\u2af4', # â«´ TRIPLE VERTICAL BAR BINARY RELATION
    'land': u'\u2227', # âˆ§ LOGICAL AND
    'leftthreetimes': u'\u22cb', # â‹‹ LEFT SEMIDIRECT PRODUCT
    'lhd': u'\u25c1', # â— WHITE LEFT-POINTING TRIANGLE
    'lor': u'\u2228', # âˆ¨ LOGICAL OR
    'ltimes': u'\u22c9', # â‹‰ LEFT NORMAL FACTOR SEMIDIRECT PRODUCT
    'mp': u'\u2213', # âˆ“ MINUS-OR-PLUS SIGN
    'odot': u'\u2299', # âŠ™ CIRCLED DOT OPERATOR
    'ominus': u'\u2296', # âŠ– CIRCLED MINUS
    'oplus': u'\u2295', # âŠ• CIRCLED PLUS
    'oslash': u'\u2298', # âŠ˜ CIRCLED DIVISION SLASH
    'otimes': u'\u2297', # âŠ— CIRCLED TIMES
    'pm': u'\xb1', # Â± PLUS-MINUS SIGN
    'rhd': u'\u25b7', # â–· WHITE RIGHT-POINTING TRIANGLE
    'rightthreetimes': u'\u22cc', # â‹Œ RIGHT SEMIDIRECT PRODUCT
    'rtimes': u'\u22ca', # â‹Š RIGHT NORMAL FACTOR SEMIDIRECT PRODUCT
    'setminus': u'\u29f5', # â§µ REVERSE SOLIDUS OPERATOR
    'slash': u'\u2215', # âˆ• DIVISION SLASH
    'smallsetminus': u'\u2216', # âˆ– SET MINUS
    'smalltriangledown': u'\u25bf', # â–¿ WHITE DOWN-POINTING SMALL TRIANGLE
    'smalltriangleleft': u'\u25c3', # â—ƒ WHITE LEFT-POINTING SMALL TRIANGLE
    'smalltriangleright': u'\u25b9', # â–¹ WHITE RIGHT-POINTING SMALL TRIANGLE
    'smalltriangleup': u'\u25b5', # â–µ WHITE UP-POINTING SMALL TRIANGLE
    'sqcap': u'\u2293', # âŠ“ SQUARE CAP
    'sqcup': u'\u2294', # âŠ” SQUARE CUP
    'sslash': u'\u2afd', # â«½ DOUBLE SOLIDUS OPERATOR
    'star': u'\u22c6', # â‹† STAR OPERATOR
    'talloblong': u'\u2afe', # â«¾ WHITE VERTICAL BAR
    'times': u'\xd7', # Ã— MULTIPLICATION SIGN
    'triangle': u'\u25b3', # â–³ WHITE UP-POINTING TRIANGLE
    'triangledown': u'\u25bf', # â–¿ WHITE DOWN-POINTING SMALL TRIANGLE
    'triangleleft': u'\u25c3', # â—ƒ WHITE LEFT-POINTING SMALL TRIANGLE
    'triangleright': u'\u25b9', # â–¹ WHITE RIGHT-POINTING SMALL TRIANGLE
    'uplus': u'\u228e', # âŠ MULTISET UNION
    'vartriangle': u'\u25b3', # â–³ WHITE UP-POINTING TRIANGLE
    'vee': u'\u2228', # âˆ¨ LOGICAL OR
    'veebar': u'\u22bb', # âŠ» XOR
    'wedge': u'\u2227', # âˆ§ LOGICAL AND
    'wr': u'\u2240', # â‰€ WREATH PRODUCT
    }
mathclose = {
    'Rbag': u'\u27c6', # âŸ† RIGHT S-SHAPED BAG DELIMITER
    'lrcorner': u'\u231f', # âŒŸ BOTTOM RIGHT CORNER
    'rangle': u'\u27e9', # âŸ© MATHEMATICAL RIGHT ANGLE BRACKET
    'rbag': u'\u27c6', # âŸ† RIGHT S-SHAPED BAG DELIMITER
    'rbrace': u'}', # } RIGHT CURLY BRACKET
    'rbrack': u']', # ] RIGHT SQUARE BRACKET
    'rceil': u'\u2309', # âŒ‰ RIGHT CEILING
    'rfloor': u'\u230b', # âŒ‹ RIGHT FLOOR
    'rgroup': u'\u27ef', # âŸ¯ MATHEMATICAL RIGHT FLATTENED PARENTHESIS
    'rrbracket': u'\u27e7', # âŸ§ MATHEMATICAL RIGHT WHITE SQUARE BRACKET
    'rrparenthesis': u'\u2988', # â¦ˆ Z NOTATION RIGHT IMAGE BRACKET
    'urcorner': u'\u231d', # âŒ TOP RIGHT CORNER
    '}': u'}', # } RIGHT CURLY BRACKET
    }
mathfence = {
    'Vert': u'\u2016', # â€– DOUBLE VERTICAL LINE
    'vert': u'|', # | VERTICAL LINE
    '|': u'\u2016', # â€– DOUBLE VERTICAL LINE
    }
mathop = {
    'Join': u'\u2a1d', # â¨ JOIN
    'bigcap': u'\u22c2', # â‹‚ N-ARY INTERSECTION
    'bigcup': u'\u22c3', # â‹ƒ N-ARY UNION
    'biginterleave': u'\u2afc', # â«¼ LARGE TRIPLE VERTICAL BAR OPERATOR
    'bigodot': u'\u2a00', # â¨€ N-ARY CIRCLED DOT OPERATOR
    'bigoplus': u'\u2a01', # â¨ N-ARY CIRCLED PLUS OPERATOR
    'bigotimes': u'\u2a02', # â¨‚ N-ARY CIRCLED TIMES OPERATOR
    'bigsqcup': u'\u2a06', # â¨† N-ARY SQUARE UNION OPERATOR
    'biguplus': u'\u2a04', # â¨„ N-ARY UNION OPERATOR WITH PLUS
    'bigvee': u'\u22c1', # â‹ N-ARY LOGICAL OR
    'bigwedge': u'\u22c0', # â‹€ N-ARY LOGICAL AND
    'coprod': u'\u2210', # âˆ N-ARY COPRODUCT
    'fatsemi': u'\u2a1f', # â¨Ÿ Z NOTATION SCHEMA COMPOSITION
    'fint': u'\u2a0f', # â¨ INTEGRAL AVERAGE WITH SLASH
    'iiiint': u'\u2a0c', # â¨Œ QUADRUPLE INTEGRAL OPERATOR
    'iiint': u'\u222d', # âˆ­ TRIPLE INTEGRAL
    'iint': u'\u222c', # âˆ¬ DOUBLE INTEGRAL
    'int': u'\u222b', # âˆ« INTEGRAL
    'oiint': u'\u222f', # âˆ¯ SURFACE INTEGRAL
    'oint': u'\u222e', # âˆ® CONTOUR INTEGRAL
    'ointctrclockwise': u'\u2233', # âˆ³ ANTICLOCKWISE CONTOUR INTEGRAL
    'prod': u'\u220f', # âˆ N-ARY PRODUCT
    'sqint': u'\u2a16', # â¨– QUATERNION INTEGRAL OPERATOR
    'sum': u'\u2211', # âˆ‘ N-ARY SUMMATION
    'varointclockwise': u'\u2232', # âˆ² CLOCKWISE CONTOUR INTEGRAL
    }
mathopen = {
    'Lbag': u'\u27c5', # âŸ… LEFT S-SHAPED BAG DELIMITER
    'langle': u'\u27e8', # âŸ¨ MATHEMATICAL LEFT ANGLE BRACKET
    'lbag': u'\u27c5', # âŸ… LEFT S-SHAPED BAG DELIMITER
    'lbrace': u'{', # { LEFT CURLY BRACKET
    'lbrack': u'[', # [ LEFT SQUARE BRACKET
    'lceil': u'\u2308', # âŒˆ LEFT CEILING
    'lfloor': u'\u230a', # âŒŠ LEFT FLOOR
    'lgroup': u'\u27ee', # âŸ® MATHEMATICAL LEFT FLATTENED PARENTHESIS
    'llbracket': u'\u27e6', # âŸ¦ MATHEMATICAL LEFT WHITE SQUARE BRACKET
    'llcorner': u'\u231e', # âŒ BOTTOM LEFT CORNER
    'llparenthesis': u'\u2987', # â¦‡ Z NOTATION LEFT IMAGE BRACKET
    'ulcorner': u'\u231c', # âŒœ TOP LEFT CORNER
    '{': u'{', # { LEFT CURLY BRACKET
    }
mathord = {
    '#': u'#', # # NUMBER SIGN
    '$': u'$', # $ DOLLAR SIGN
    '%': u'%', # % PERCENT SIGN
    '&': u'&', # & AMPERSAND
    'AC': u'\u223f', # âˆ¿ SINE WAVE
    'APLcomment': u'\u235d', # â APL FUNCTIONAL SYMBOL UP SHOE JOT
    'APLdownarrowbox': u'\u2357', # â— APL FUNCTIONAL SYMBOL QUAD DOWNWARDS ARROW
    'APLinput': u'\u235e', # â APL FUNCTIONAL SYMBOL QUOTE QUAD
    'APLinv': u'\u2339', # âŒ¹ APL FUNCTIONAL SYMBOL QUAD DIVIDE
    'APLleftarrowbox': u'\u2347', # â‡ APL FUNCTIONAL SYMBOL QUAD LEFTWARDS ARROW
    'APLlog': u'\u235f', # âŸ APL FUNCTIONAL SYMBOL CIRCLE STAR
    'APLrightarrowbox': u'\u2348', # âˆ APL FUNCTIONAL SYMBOL QUAD RIGHTWARDS ARROW
    'APLuparrowbox': u'\u2350', # â APL FUNCTIONAL SYMBOL QUAD UPWARDS ARROW
    'Aries': u'\u2648', # â™ˆ ARIES
    'CIRCLE': u'\u25cf', # â— BLACK CIRCLE
    'CheckedBox': u'\u2611', # â˜‘ BALLOT BOX WITH CHECK
    'Diamond': u'\u25c7', # â—‡ WHITE DIAMOND
    'Finv': u'\u2132', # â„² TURNED CAPITAL F
    'Game': u'\u2141', # â… TURNED SANS-SERIF CAPITAL G
    'Gemini': u'\u264a', # â™Š GEMINI
    'Jupiter': u'\u2643', # â™ƒ JUPITER
    'LEFTCIRCLE': u'\u25d6', # â—– LEFT HALF BLACK CIRCLE
    'LEFTcircle': u'\u25d0', # â— CIRCLE WITH LEFT HALF BLACK
    'Leo': u'\u264c', # â™Œ LEO
    'Libra': u'\u264e', # â™ LIBRA
    'Mars': u'\u2642', # â™‚ MALE SIGN
    'Mercury': u'\u263f', # â˜¿ MERCURY
    'Neptune': u'\u2646', # â™† NEPTUNE
    'Pluto': u'\u2647', # â™‡ PLUTO
    'RIGHTCIRCLE': u'\u25d7', # â—— RIGHT HALF BLACK CIRCLE
    'RIGHTcircle': u'\u25d1', # â—‘ CIRCLE WITH RIGHT HALF BLACK
    'Saturn': u'\u2644', # â™„ SATURN
    'Scorpio': u'\u264f', # â™ SCORPIUS
    'Square': u'\u2610', # â˜ BALLOT BOX
    'Sun': u'\u2609', # â˜‰ SUN
    'Taurus': u'\u2649', # â™‰ TAURUS
    'Uranus': u'\u2645', # â™… URANUS
    'Venus': u'\u2640', # â™€ FEMALE SIGN
    'XBox': u'\u2612', # â˜’ BALLOT BOX WITH X
    'Yup': u'\u2144', # â…„ TURNED SANS-SERIF CAPITAL Y
    '_': u'_', # _ LOW LINE
    'angle': u'\u2220', # âˆ  ANGLE
    'aquarius': u'\u2652', # â™’ AQUARIUS
    'aries': u'\u2648', # â™ˆ ARIES
    'ast': u'*', # * ASTERISK
    'backepsilon': u'\u03f6', # Ï¶ GREEK REVERSED LUNATE EPSILON SYMBOL
    'backprime': u'\u2035', # â€µ REVERSED PRIME
    'backslash': u'\\', # \ REVERSE SOLIDUS
    'because': u'\u2235', # âˆµ BECAUSE
    'bigstar': u'\u2605', # â˜… BLACK STAR
    'binampersand': u'&', # & AMPERSAND
    'blacklozenge': u'\u2b27', # â¬§ BLACK MEDIUM LOZENGE
    'blacksmiley': u'\u263b', # â˜» BLACK SMILING FACE
    'blacksquare': u'\u25fc', # â—¼ BLACK MEDIUM SQUARE
    'bot': u'\u22a5', # âŠ¥ UP TACK
    'boy': u'\u2642', # â™‚ MALE SIGN
    'cancer': u'\u264b', # â™‹ CANCER
    'capricornus': u'\u2651', # â™‘ CAPRICORN
    'cdots': u'\u22ef', # â‹¯ MIDLINE HORIZONTAL ELLIPSIS
    'cent': u'\xa2', # Â¢ CENT SIGN
    'centerdot': u'\u2b1d', # â¬ BLACK VERY SMALL SQUARE
    'checkmark': u'\u2713', # âœ“ CHECK MARK
    'circlearrowleft': u'\u21ba', # â†º ANTICLOCKWISE OPEN CIRCLE ARROW
    'circlearrowright': u'\u21bb', # â†» CLOCKWISE OPEN CIRCLE ARROW
    'circledR': u'\xae', # Â® REGISTERED SIGN
    'circledcirc': u'\u25ce', # â— BULLSEYE
    'clubsuit': u'\u2663', # â™£ BLACK CLUB SUIT
    'complement': u'\u2201', # âˆ COMPLEMENT
    'dasharrow': u'\u21e2', # â‡¢ RIGHTWARDS DASHED ARROW
    'dashleftarrow': u'\u21e0', # â‡  LEFTWARDS DASHED ARROW
    'dashrightarrow': u'\u21e2', # â‡¢ RIGHTWARDS DASHED ARROW
    'diameter': u'\u2300', # âŒ€ DIAMETER SIGN
    'diamondsuit': u'\u2662', # â™¢ WHITE DIAMOND SUIT
    'earth': u'\u2641', # â™ EARTH
    'exists': u'\u2203', # âˆƒ THERE EXISTS
    'female': u'\u2640', # â™€ FEMALE SIGN
    'flat': u'\u266d', # â™­ MUSIC FLAT SIGN
    'forall': u'\u2200', # âˆ€ FOR ALL
    'fourth': u'\u2057', # â— QUADRUPLE PRIME
    'frownie': u'\u2639', # â˜¹ WHITE FROWNING FACE
    'gemini': u'\u264a', # â™Š GEMINI
    'girl': u'\u2640', # â™€ FEMALE SIGN
    'heartsuit': u'\u2661', # â™¡ WHITE HEART SUIT
    'infty': u'\u221e', # âˆ INFINITY
    'invneg': u'\u2310', # âŒ REVERSED NOT SIGN
    'jupiter': u'\u2643', # â™ƒ JUPITER
    'ldots': u'\u2026', # â€¦ HORIZONTAL ELLIPSIS
    'leftmoon': u'\u263e', # â˜¾ LAST QUARTER MOON
    'leftturn': u'\u21ba', # â†º ANTICLOCKWISE OPEN CIRCLE ARROW
    'leo': u'\u264c', # â™Œ LEO
    'libra': u'\u264e', # â™ LIBRA
    'lnot': u'\xac', # Â¬ NOT SIGN
    'lozenge': u'\u25ca', # â—Š LOZENGE
    'male': u'\u2642', # â™‚ MALE SIGN
    'maltese': u'\u2720', # âœ  MALTESE CROSS
    'mathdollar': u'$', # $ DOLLAR SIGN
    'measuredangle': u'\u2221', # âˆ¡ MEASURED ANGLE
    'mercury': u'\u263f', # â˜¿ MERCURY
    'mho': u'\u2127', # â„§ INVERTED OHM SIGN
    'nabla': u'\u2207', # âˆ‡ NABLA
    'natural': u'\u266e', # â™® MUSIC NATURAL SIGN
    'neg': u'\xac', # Â¬ NOT SIGN
    'neptune': u'\u2646', # â™† NEPTUNE
    'nexists': u'\u2204', # âˆ„ THERE DOES NOT EXIST
    'notbackslash': u'\u2340', # â€ APL FUNCTIONAL SYMBOL BACKSLASH BAR
    'partial': u'\u2202', # âˆ‚ PARTIAL DIFFERENTIAL
    'pisces': u'\u2653', # â™“ PISCES
    'pluto': u'\u2647', # â™‡ PLUTO
    'pounds': u'\xa3', # Â£ POUND SIGN
    'prime': u'\u2032', # â€² PRIME
    'quarternote': u'\u2669', # â™© QUARTER NOTE
    'rightmoon': u'\u263d', # â˜½ FIRST QUARTER MOON
    'rightturn': u'\u21bb', # â†» CLOCKWISE OPEN CIRCLE ARROW
    'sagittarius': u'\u2650', # â™ SAGITTARIUS
    'saturn': u'\u2644', # â™„ SATURN
    'scorpio': u'\u264f', # â™ SCORPIUS
    'second': u'\u2033', # â€³ DOUBLE PRIME
    'sharp': u'\u266f', # â™¯ MUSIC SHARP SIGN
    'sim': u'~', # ~ TILDE
    'slash': u'/', # / SOLIDUS
    'smiley': u'\u263a', # â˜º WHITE SMILING FACE
    'spadesuit': u'\u2660', # â™  BLACK SPADE SUIT
    'spddot': u'\xa8', # Â¨ DIAERESIS
    'sphat': u'^', # ^ CIRCUMFLEX ACCENT
    'sphericalangle': u'\u2222', # âˆ¢ SPHERICAL ANGLE
    'sptilde': u'~', # ~ TILDE
    'square': u'\u25fb', # â—» WHITE MEDIUM SQUARE
    'sun': u'\u263c', # â˜¼ WHITE SUN WITH RAYS
    'taurus': u'\u2649', # â™‰ TAURUS
    'therefore': u'\u2234', # âˆ´ THEREFORE
    'third': u'\u2034', # â€´ TRIPLE PRIME
    'top': u'\u22a4', # âŠ¤ DOWN TACK
    'triangleleft': u'\u25c5', # â—… WHITE LEFT-POINTING POINTER
    'triangleright': u'\u25bb', # â–» WHITE RIGHT-POINTING POINTER
    'twonotes': u'\u266b', # â™« BEAMED EIGHTH NOTES
    'uranus': u'\u2645', # â™… URANUS
    'varEarth': u'\u2641', # â™ EARTH
    'varnothing': u'\u2205', # âˆ… EMPTY SET
    'virgo': u'\u264d', # â™ VIRGO
    'wasylozenge': u'\u2311', # âŒ‘ SQUARE LOZENGE
    'wasytherefore': u'\u2234', # âˆ´ THEREFORE
    'yen': u'\xa5', # Â¥ YEN SIGN
    }
mathover = {
    'overbrace': u'\u23de', # â TOP CURLY BRACKET
    'wideparen': u'\u23dc', # âœ TOP PARENTHESIS
    }
mathradical = {
    'sqrt': u'\u221a', # âˆš SQUARE ROOT
    'sqrt[3]': u'\u221b', # âˆ› CUBE ROOT
    'sqrt[4]': u'\u221c', # âˆœ FOURTH ROOT
    }
mathrel = {
    'Bumpeq': u'\u224e', # â‰ GEOMETRICALLY EQUIVALENT TO
    'Doteq': u'\u2251', # â‰‘ GEOMETRICALLY EQUAL TO
    'Downarrow': u'\u21d3', # â‡“ DOWNWARDS DOUBLE ARROW
    'Leftarrow': u'\u21d0', # â‡ LEFTWARDS DOUBLE ARROW
    'Leftrightarrow': u'\u21d4', # â‡” LEFT RIGHT DOUBLE ARROW
    'Lleftarrow': u'\u21da', # â‡š LEFTWARDS TRIPLE ARROW
    'Longleftarrow': u'\u27f8', # âŸ¸ LONG LEFTWARDS DOUBLE ARROW
    'Longleftrightarrow': u'\u27fa', # âŸº LONG LEFT RIGHT DOUBLE ARROW
    'Longmapsfrom': u'\u27fd', # âŸ½ LONG LEFTWARDS DOUBLE ARROW FROM BAR
    'Longmapsto': u'\u27fe', # âŸ¾ LONG RIGHTWARDS DOUBLE ARROW FROM BAR
    'Longrightarrow': u'\u27f9', # âŸ¹ LONG RIGHTWARDS DOUBLE ARROW
    'Lsh': u'\u21b0', # â†° UPWARDS ARROW WITH TIP LEFTWARDS
    'Mapsfrom': u'\u2906', # â¤† LEFTWARDS DOUBLE ARROW FROM BAR
    'Mapsto': u'\u2907', # â¤‡ RIGHTWARDS DOUBLE ARROW FROM BAR
    'Rightarrow': u'\u21d2', # â‡’ RIGHTWARDS DOUBLE ARROW
    'Rrightarrow': u'\u21db', # â‡› RIGHTWARDS TRIPLE ARROW
    'Rsh': u'\u21b1', # â†± UPWARDS ARROW WITH TIP RIGHTWARDS
    'Subset': u'\u22d0', # â‹ DOUBLE SUBSET
    'Supset': u'\u22d1', # â‹‘ DOUBLE SUPERSET
    'Uparrow': u'\u21d1', # â‡‘ UPWARDS DOUBLE ARROW
    'Updownarrow': u'\u21d5', # â‡• UP DOWN DOUBLE ARROW
    'VDash': u'\u22ab', # âŠ« DOUBLE VERTICAL BAR DOUBLE RIGHT TURNSTILE
    'Vdash': u'\u22a9', # âŠ© FORCES
    'Vvdash': u'\u22aa', # âŠª TRIPLE VERTICAL BAR RIGHT TURNSTILE
    'apprge': u'\u2273', # â‰³ GREATER-THAN OR EQUIVALENT TO
    'apprle': u'\u2272', # â‰² LESS-THAN OR EQUIVALENT TO
    'approx': u'\u2248', # â‰ˆ ALMOST EQUAL TO
    'approxeq': u'\u224a', # â‰Š ALMOST EQUAL OR EQUAL TO
    'asymp': u'\u224d', # â‰ EQUIVALENT TO
    'backsim': u'\u223d', # âˆ½ REVERSED TILDE
    'backsimeq': u'\u22cd', # â‹ REVERSED TILDE EQUALS
    'barin': u'\u22f6', # â‹¶ ELEMENT OF WITH OVERBAR
    'barleftharpoon': u'\u296b', # â¥« LEFTWARDS HARPOON WITH BARB DOWN BELOW LONG DASH
    'barrightharpoon': u'\u296d', # â¥­ RIGHTWARDS HARPOON WITH BARB DOWN BELOW LONG DASH
    'between': u'\u226c', # â‰¬ BETWEEN
    'bowtie': u'\u22c8', # â‹ˆ BOWTIE
    'bumpeq': u'\u224f', # â‰ DIFFERENCE BETWEEN
    'circeq': u'\u2257', # â‰— RING EQUAL TO
    'coloneq': u'\u2254', # â‰” COLON EQUALS
    'cong': u'\u2245', # â‰… APPROXIMATELY EQUAL TO
    'corresponds': u'\u2259', # â‰™ ESTIMATES
    'curlyeqprec': u'\u22de', # â‹ EQUAL TO OR PRECEDES
    'curlyeqsucc': u'\u22df', # â‹Ÿ EQUAL TO OR SUCCEEDS
    'curvearrowleft': u'\u21b6', # â†¶ ANTICLOCKWISE TOP SEMICIRCLE ARROW
    'curvearrowright': u'\u21b7', # â†· CLOCKWISE TOP SEMICIRCLE ARROW
    'dashv': u'\u22a3', # âŠ£ LEFT TACK
    'ddots': u'\u22f1', # â‹± DOWN RIGHT DIAGONAL ELLIPSIS
    'dlsh': u'\u21b2', # â†² DOWNWARDS ARROW WITH TIP LEFTWARDS
    'doteq': u'\u2250', # â‰ APPROACHES THE LIMIT
    'doteqdot': u'\u2251', # â‰‘ GEOMETRICALLY EQUAL TO
    'downarrow': u'\u2193', # â†“ DOWNWARDS ARROW
    'downdownarrows': u'\u21ca', # â‡Š DOWNWARDS PAIRED ARROWS
    'downdownharpoons': u'\u2965', # â¥¥ DOWNWARDS HARPOON WITH BARB LEFT BESIDE DOWNWARDS HARPOON WITH BARB RIGHT
    'downharpoonleft': u'\u21c3', # â‡ƒ DOWNWARDS HARPOON WITH BARB LEFTWARDS
    'downharpoonright': u'\u21c2', # â‡‚ DOWNWARDS HARPOON WITH BARB RIGHTWARDS
    'downuparrows': u'\u21f5', # â‡µ DOWNWARDS ARROW LEFTWARDS OF UPWARDS ARROW
    'downupharpoons': u'\u296f', # â¥¯ DOWNWARDS HARPOON WITH BARB LEFT BESIDE UPWARDS HARPOON WITH BARB RIGHT
    'drsh': u'\u21b3', # â†³ DOWNWARDS ARROW WITH TIP RIGHTWARDS
    'eqcirc': u'\u2256', # â‰– RING IN EQUAL TO
    'eqcolon': u'\u2255', # â‰• EQUALS COLON
    'eqsim': u'\u2242', # â‰‚ MINUS TILDE
    'eqslantgtr': u'\u2a96', # âª– SLANTED EQUAL TO OR GREATER-THAN
    'eqslantless': u'\u2a95', # âª• SLANTED EQUAL TO OR LESS-THAN
    'equiv': u'\u2261', # â‰¡ IDENTICAL TO
    'fallingdotseq': u'\u2252', # â‰’ APPROXIMATELY EQUAL TO OR THE IMAGE OF
    'frown': u'\u2322', # âŒ¢ FROWN
    'ge': u'\u2265', # â‰¥ GREATER-THAN OR EQUAL TO
    'geq': u'\u2265', # â‰¥ GREATER-THAN OR EQUAL TO
    'geqq': u'\u2267', # â‰§ GREATER-THAN OVER EQUAL TO
    'geqslant': u'\u2a7e', # â©¾ GREATER-THAN OR SLANTED EQUAL TO
    'gets': u'\u2190', # â† LEFTWARDS ARROW
    'gg': u'\u226b', # â‰« MUCH GREATER-THAN
    'ggcurly': u'\u2abc', # âª¼ DOUBLE SUCCEEDS
    'ggg': u'\u22d9', # â‹™ VERY MUCH GREATER-THAN
    'gnapprox': u'\u2a8a', # âªŠ GREATER-THAN AND NOT APPROXIMATE
    'gneq': u'\u2a88', # âªˆ GREATER-THAN AND SINGLE-LINE NOT EQUAL TO
    'gneqq': u'\u2269', # â‰© GREATER-THAN BUT NOT EQUAL TO
    'gnsim': u'\u22e7', # â‹§ GREATER-THAN BUT NOT EQUIVALENT TO
    'gtrapprox': u'\u2a86', # âª† GREATER-THAN OR APPROXIMATE
    'gtrdot': u'\u22d7', # â‹— GREATER-THAN WITH DOT
    'gtreqless': u'\u22db', # â‹› GREATER-THAN EQUAL TO OR LESS-THAN
    'gtreqqless': u'\u2a8c', # âªŒ GREATER-THAN ABOVE DOUBLE-LINE EQUAL ABOVE LESS-THAN
    'gtrless': u'\u2277', # â‰· GREATER-THAN OR LESS-THAN
    'gtrsim': u'\u2273', # â‰³ GREATER-THAN OR EQUIVALENT TO
    'hash': u'\u22d5', # â‹• EQUAL AND PARALLEL TO
    'hookleftarrow': u'\u21a9', # â†© LEFTWARDS ARROW WITH HOOK
    'hookrightarrow': u'\u21aa', # â†ª RIGHTWARDS ARROW WITH HOOK
    'iddots': u'\u22f0', # â‹° UP RIGHT DIAGONAL ELLIPSIS
    'impliedby': u'\u27f8', # âŸ¸ LONG LEFTWARDS DOUBLE ARROW
    'implies': u'\u27f9', # âŸ¹ LONG RIGHTWARDS DOUBLE ARROW
    'in': u'\u2208', # âˆˆ ELEMENT OF
    'le': u'\u2264', # â‰¤ LESS-THAN OR EQUAL TO
    'leftarrow': u'\u2190', # â† LEFTWARDS ARROW
    'leftarrowtail': u'\u21a2', # â†¢ LEFTWARDS ARROW WITH TAIL
    'leftarrowtriangle': u'\u21fd', # â‡½ LEFTWARDS OPEN-HEADED ARROW
    'leftbarharpoon': u'\u296a', # â¥ª LEFTWARDS HARPOON WITH BARB UP ABOVE LONG DASH
    'leftharpoondown': u'\u21bd', # â†½ LEFTWARDS HARPOON WITH BARB DOWNWARDS
    'leftharpoonup': u'\u21bc', # â†¼ LEFTWARDS HARPOON WITH BARB UPWARDS
    'leftleftarrows': u'\u21c7', # â‡‡ LEFTWARDS PAIRED ARROWS
    'leftleftharpoons': u'\u2962', # â¥¢ LEFTWARDS HARPOON WITH BARB UP ABOVE LEFTWARDS HARPOON WITH BARB DOWN
    'leftrightarrow': u'\u2194', # â†” LEFT RIGHT ARROW
    'leftrightarrows': u'\u21c6', # â‡† LEFTWARDS ARROW OVER RIGHTWARDS ARROW
    'leftrightarrowtriangle': u'\u21ff', # â‡¿ LEFT RIGHT OPEN-HEADED ARROW
    'leftrightharpoon': u'\u294a', # â¥Š LEFT BARB UP RIGHT BARB DOWN HARPOON
    'leftrightharpoons': u'\u21cb', # â‡‹ LEFTWARDS HARPOON OVER RIGHTWARDS HARPOON
    'leftrightsquigarrow': u'\u21ad', # â†­ LEFT RIGHT WAVE ARROW
    'leftslice': u'\u2aa6', # âª¦ LESS-THAN CLOSED BY CURVE
    'leftsquigarrow': u'\u21dc', # â‡œ LEFTWARDS SQUIGGLE ARROW
    'leq': u'\u2264', # â‰¤ LESS-THAN OR EQUAL TO
    'leqq': u'\u2266', # â‰¦ LESS-THAN OVER EQUAL TO
    'leqslant': u'\u2a7d', # â©½ LESS-THAN OR SLANTED EQUAL TO
    'lessapprox': u'\u2a85', # âª… LESS-THAN OR APPROXIMATE
    'lessdot': u'\u22d6', # â‹– LESS-THAN WITH DOT
    'lesseqgtr': u'\u22da', # â‹š LESS-THAN EQUAL TO OR GREATER-THAN
    'lesseqqgtr': u'\u2a8b', # âª‹ LESS-THAN ABOVE DOUBLE-LINE EQUAL ABOVE GREATER-THAN
    'lessgtr': u'\u2276', # â‰¶ LESS-THAN OR GREATER-THAN
    'lesssim': u'\u2272', # â‰² LESS-THAN OR EQUIVALENT TO
    'lightning': u'\u21af', # â†¯ DOWNWARDS ZIGZAG ARROW
    'll': u'\u226a', # â‰ª MUCH LESS-THAN
    'llcurly': u'\u2abb', # âª» DOUBLE PRECEDES
    'lll': u'\u22d8', # â‹˜ VERY MUCH LESS-THAN
    'lnapprox': u'\u2a89', # âª‰ LESS-THAN AND NOT APPROXIMATE
    'lneq': u'\u2a87', # âª‡ LESS-THAN AND SINGLE-LINE NOT EQUAL TO
    'lneqq': u'\u2268', # â‰¨ LESS-THAN BUT NOT EQUAL TO
    'lnsim': u'\u22e6', # â‹¦ LESS-THAN BUT NOT EQUIVALENT TO
    'longleftarrow': u'\u27f5', # âŸµ LONG LEFTWARDS ARROW
    'longleftrightarrow': u'\u27f7', # âŸ· LONG LEFT RIGHT ARROW
    'longmapsfrom': u'\u27fb', # âŸ» LONG LEFTWARDS ARROW FROM BAR
    'longmapsto': u'\u27fc', # âŸ¼ LONG RIGHTWARDS ARROW FROM BAR
    'longrightarrow': u'\u27f6', # âŸ¶ LONG RIGHTWARDS ARROW
    'looparrowleft': u'\u21ab', # â†« LEFTWARDS ARROW WITH LOOP
    'looparrowright': u'\u21ac', # â†¬ RIGHTWARDS ARROW WITH LOOP
    'mapsfrom': u'\u21a4', # â†¤ LEFTWARDS ARROW FROM BAR
    'mapsto': u'\u21a6', # â†¦ RIGHTWARDS ARROW FROM BAR
    'mid': u'\u2223', # âˆ£ DIVIDES
    'models': u'\u22a7', # âŠ§ MODELS
    'multimap': u'\u22b8', # âŠ¸ MULTIMAP
    'nLeftarrow': u'\u21cd', # â‡ LEFTWARDS DOUBLE ARROW WITH STROKE
    'nLeftrightarrow': u'\u21ce', # â‡ LEFT RIGHT DOUBLE ARROW WITH STROKE
    'nRightarrow': u'\u21cf', # â‡ RIGHTWARDS DOUBLE ARROW WITH STROKE
    'nVDash': u'\u22af', # âŠ¯ NEGATED DOUBLE VERTICAL BAR DOUBLE RIGHT TURNSTILE
    'nVdash': u'\u22ae', # âŠ® DOES NOT FORCE
    'ncong': u'\u2247', # â‰‡ NEITHER APPROXIMATELY NOR ACTUALLY EQUAL TO
    'ne': u'\u2260', # â‰  NOT EQUAL TO
    'nearrow': u'\u2197', # â†— NORTH EAST ARROW
    'neq': u'\u2260', # â‰  NOT EQUAL TO
    'ngeq': u'\u2271', # â‰± NEITHER GREATER-THAN NOR EQUAL TO
    'ngtr': u'\u226f', # â‰¯ NOT GREATER-THAN
    'ni': u'\u220b', # âˆ‹ CONTAINS AS MEMBER
    'nleftarrow': u'\u219a', # â†š LEFTWARDS ARROW WITH STROKE
    'nleftrightarrow': u'\u21ae', # â†® LEFT RIGHT ARROW WITH STROKE
    'nleq': u'\u2270', # â‰° NEITHER LESS-THAN NOR EQUAL TO
    'nless': u'\u226e', # â‰® NOT LESS-THAN
    'nmid': u'\u2224', # âˆ¤ DOES NOT DIVIDE
    'notasymp': u'\u226d', # â‰­ NOT EQUIVALENT TO
    'notin': u'\u2209', # âˆ‰ NOT AN ELEMENT OF
    'notowner': u'\u220c', # âˆŒ DOES NOT CONTAIN AS MEMBER
    'notslash': u'\u233f', # âŒ¿ APL FUNCTIONAL SYMBOL SLASH BAR
    'nparallel': u'\u2226', # âˆ¦ NOT PARALLEL TO
    'nprec': u'\u2280', # âŠ€ DOES NOT PRECEDE
    'npreceq': u'\u22e0', # â‹  DOES NOT PRECEDE OR EQUAL
    'nrightarrow': u'\u219b', # â†› RIGHTWARDS ARROW WITH STROKE
    'nsim': u'\u2241', # â‰ NOT TILDE
    'nsubseteq': u'\u2288', # âŠˆ NEITHER A SUBSET OF NOR EQUAL TO
    'nsucc': u'\u2281', # âŠ DOES NOT SUCCEED
    'nsucceq': u'\u22e1', # â‹¡ DOES NOT SUCCEED OR EQUAL
    'nsupseteq': u'\u2289', # âŠ‰ NEITHER A SUPERSET OF NOR EQUAL TO
    'ntriangleleft': u'\u22ea', # â‹ª NOT NORMAL SUBGROUP OF
    'ntrianglelefteq': u'\u22ec', # â‹¬ NOT NORMAL SUBGROUP OF OR EQUAL TO
    'ntriangleright': u'\u22eb', # â‹« DOES NOT CONTAIN AS NORMAL SUBGROUP
    'ntrianglerighteq': u'\u22ed', # â‹­ DOES NOT CONTAIN AS NORMAL SUBGROUP OR EQUAL
    'nvDash': u'\u22ad', # âŠ­ NOT TRUE
    'nvdash': u'\u22ac', # âŠ¬ DOES NOT PROVE
    'nwarrow': u'\u2196', # â†– NORTH WEST ARROW
    'owns': u'\u220b', # âˆ‹ CONTAINS AS MEMBER
    'parallel': u'\u2225', # âˆ¥ PARALLEL TO
    'perp': u'\u27c2', # âŸ‚ PERPENDICULAR
    'pitchfork': u'\u22d4', # â‹” PITCHFORK
    'prec': u'\u227a', # â‰º PRECEDES
    'precapprox': u'\u2ab7', # âª· PRECEDES ABOVE ALMOST EQUAL TO
    'preccurlyeq': u'\u227c', # â‰¼ PRECEDES OR EQUAL TO
    'preceq': u'\u2aaf', # âª¯ PRECEDES ABOVE SINGLE-LINE EQUALS SIGN
    'precnapprox': u'\u2ab9', # âª¹ PRECEDES ABOVE NOT ALMOST EQUAL TO
    'precnsim': u'\u22e8', # â‹¨ PRECEDES BUT NOT EQUIVALENT TO
    'precsim': u'\u227e', # â‰¾ PRECEDES OR EQUIVALENT TO
    'propto': u'\u221d', # âˆ PROPORTIONAL TO
    'restriction': u'\u21be', # â†¾ UPWARDS HARPOON WITH BARB RIGHTWARDS
    'rightarrow': u'\u2192', # â†’ RIGHTWARDS ARROW
    'rightarrowtail': u'\u21a3', # â†£ RIGHTWARDS ARROW WITH TAIL
    'rightarrowtriangle': u'\u21fe', # â‡¾ RIGHTWARDS OPEN-HEADED ARROW
    'rightbarharpoon': u'\u296c', # â¥¬ RIGHTWARDS HARPOON WITH BARB UP ABOVE LONG DASH
    'rightharpoondown': u'\u21c1', # â‡ RIGHTWARDS HARPOON WITH BARB DOWNWARDS
    'rightharpoonup': u'\u21c0', # â‡€ RIGHTWARDS HARPOON WITH BARB UPWARDS
    'rightleftarrows': u'\u21c4', # â‡„ RIGHTWARDS ARROW OVER LEFTWARDS ARROW
    'rightleftharpoon': u'\u294b', # â¥‹ LEFT BARB DOWN RIGHT BARB UP HARPOON
    'rightleftharpoons': u'\u21cc', # â‡Œ RIGHTWARDS HARPOON OVER LEFTWARDS HARPOON
    'rightrightarrows': u'\u21c9', # â‡‰ RIGHTWARDS PAIRED ARROWS
    'rightrightharpoons': u'\u2964', # â¥¤ RIGHTWARDS HARPOON WITH BARB UP ABOVE RIGHTWARDS HARPOON WITH BARB DOWN
    'rightslice': u'\u2aa7', # âª§ GREATER-THAN CLOSED BY CURVE
    'rightsquigarrow': u'\u21dd', # â‡ RIGHTWARDS SQUIGGLE ARROW
    'risingdotseq': u'\u2253', # â‰“ IMAGE OF OR APPROXIMATELY EQUAL TO
    'searrow': u'\u2198', # â†˜ SOUTH EAST ARROW
    'sim': u'\u223c', # âˆ¼ TILDE OPERATOR
    'simeq': u'\u2243', # â‰ƒ ASYMPTOTICALLY EQUAL TO
    'smallfrown': u'\u2322', # âŒ¢ FROWN
    'smallsmile': u'\u2323', # âŒ£ SMILE
    'smile': u'\u2323', # âŒ£ SMILE
    'sqsubset': u'\u228f', # âŠ SQUARE IMAGE OF
    'sqsubseteq': u'\u2291', # âŠ‘ SQUARE IMAGE OF OR EQUAL TO
    'sqsupset': u'\u2290', # âŠ SQUARE ORIGINAL OF
    'sqsupseteq': u'\u2292', # âŠ’ SQUARE ORIGINAL OF OR EQUAL TO
    'subset': u'\u2282', # âŠ‚ SUBSET OF
    'subseteq': u'\u2286', # âŠ† SUBSET OF OR EQUAL TO
    'subseteqq': u'\u2ac5', # â«… SUBSET OF ABOVE EQUALS SIGN
    'subsetneq': u'\u228a', # âŠŠ SUBSET OF WITH NOT EQUAL TO
    'subsetneqq': u'\u2acb', # â«‹ SUBSET OF ABOVE NOT EQUAL TO
    'succ': u'\u227b', # â‰» SUCCEEDS
    'succapprox': u'\u2ab8', # âª¸ SUCCEEDS ABOVE ALMOST EQUAL TO
    'succcurlyeq': u'\u227d', # â‰½ SUCCEEDS OR EQUAL TO
    'succeq': u'\u2ab0', # âª° SUCCEEDS ABOVE SINGLE-LINE EQUALS SIGN
    'succnapprox': u'\u2aba', # âªº SUCCEEDS ABOVE NOT ALMOST EQUAL TO
    'succnsim': u'\u22e9', # â‹© SUCCEEDS BUT NOT EQUIVALENT TO
    'succsim': u'\u227f', # â‰¿ SUCCEEDS OR EQUIVALENT TO
    'supset': u'\u2283', # âŠƒ SUPERSET OF
    'supseteq': u'\u2287', # âŠ‡ SUPERSET OF OR EQUAL TO
    'supseteqq': u'\u2ac6', # â«† SUPERSET OF ABOVE EQUALS SIGN
    'supsetneq': u'\u228b', # âŠ‹ SUPERSET OF WITH NOT EQUAL TO
    'supsetneqq': u'\u2acc', # â«Œ SUPERSET OF ABOVE NOT EQUAL TO
    'swarrow': u'\u2199', # â†™ SOUTH WEST ARROW
    'to': u'\u2192', # â†’ RIGHTWARDS ARROW
    'trianglelefteq': u'\u22b4', # âŠ´ NORMAL SUBGROUP OF OR EQUAL TO
    'triangleq': u'\u225c', # â‰œ DELTA EQUAL TO
    'trianglerighteq': u'\u22b5', # âŠµ CONTAINS AS NORMAL SUBGROUP OR EQUAL TO
    'twoheadleftarrow': u'\u219e', # â† LEFTWARDS TWO HEADED ARROW
    'twoheadrightarrow': u'\u21a0', # â†  RIGHTWARDS TWO HEADED ARROW
    'uparrow': u'\u2191', # â†‘ UPWARDS ARROW
    'updownarrow': u'\u2195', # â†• UP DOWN ARROW
    'updownarrows': u'\u21c5', # â‡… UPWARDS ARROW LEFTWARDS OF DOWNWARDS ARROW
    'updownharpoons': u'\u296e', # â¥® UPWARDS HARPOON WITH BARB LEFT BESIDE DOWNWARDS HARPOON WITH BARB RIGHT
    'upharpoonleft': u'\u21bf', # â†¿ UPWARDS HARPOON WITH BARB LEFTWARDS
    'upharpoonright': u'\u21be', # â†¾ UPWARDS HARPOON WITH BARB RIGHTWARDS
    'upuparrows': u'\u21c8', # â‡ˆ UPWARDS PAIRED ARROWS
    'upupharpoons': u'\u2963', # â¥£ UPWARDS HARPOON WITH BARB LEFT BESIDE UPWARDS HARPOON WITH BARB RIGHT
    'vDash': u'\u22a8', # âŠ¨ TRUE
    'varpropto': u'\u221d', # âˆ PROPORTIONAL TO
    'vartriangleleft': u'\u22b2', # âŠ² NORMAL SUBGROUP OF
    'vartriangleright': u'\u22b3', # âŠ³ CONTAINS AS NORMAL SUBGROUP
    'vdash': u'\u22a2', # âŠ¢ RIGHT TACK
    'vdots': u'\u22ee', # â‹® VERTICAL ELLIPSIS
    }
mathunder = {
    'underbrace': u'\u23df', # âŸ BOTTOM CURLY BRACKET
    }
space = {
    ':': u'\u205f', # âŸ MEDIUM MATHEMATICAL SPACE
    'medspace': u'\u205f', # âŸ MEDIUM MATHEMATICAL SPACE
    'quad': u'\u2001', # â€ EM QUAD
    }
                                                                                                                                                                                                                           usr/local/lib/python2.7/dist-packages/docutils/utils/math/tex2unichar.pyc                           0100644 0000000 0000062 00000044010 13077704402 025110  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   s~  i d  d 6d d 6d d 6d d 6d d	 6d
 d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d  d! 6d" d# 6d$ d% 6d& d' 6d( d) 6d d* 6d d+ 6d  d, 6Z  iC d- d. 6d/ d0 6d1 d2 6d3 d4 6d5 d6 6d7 d8 6d9 d: 6d; d< 6d= d> 6d? d@ 6dA dB 6dC dD 6dE dF 6dG dH 6dI dJ 6dK dL 6dM dN 6dO dP 6dQ dR 6dS dT 6dU dV 6dW dX 6dY dZ 6d[ d\ 6d] d^ 6d_ d` 6da db 6dc dd 6de df 6de dg 6dh di 6dj dk 6dl dm 6dn do 6dp dq 6dr ds 6dt du 6dv dw 6dx dy 6dz d{ 6d| d} 6d~ d 6d€ d 6d‚ dƒ 6d„ d… 6d† d‡ 6dˆ d‰ 6dŠ d‹ 6dŒ d 6d d 6d d‘ 6d’ d“ 6d” d• 6d– d— 6d˜ d™ 6dš d› 6dœ d 6d dŸ 6d  d¡ 6d¢ d£ 6d¤ d¥ 6d¦ d§ 6d¨ d© 6dª d« 6d¬ d­ 6d® d¯ 6d° d± 6Z iS d² d³ 6d´ dµ 6d¶ d· 6d¸ d¹ 6dº d» 6d¼ d½ 6d¾ d¿ 6dÀ dÁ 6dÂ dÃ 6dÄ dÅ 6dÆ dÇ 6dÈ dÉ 6dÊ dË 6dÌ dÍ 6dÎ dÏ 6dĞ dÑ 6dÒ dÓ 6dÔ dÕ 6dÖ d× 6dØ dÙ 6dÚ dÛ 6dÜ dİ 6dŞ dß 6dà dá 6dâ dã 6dä då 6dæ dç 6dè dé 6dê dë 6dì dí 6dî dï 6dğ dñ 6dò dó 6dô dõ 6dö d÷ 6dø dù 6dú dû 6dü dı 6dş dÿ 6d d6dd6dd6dd6dd	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6d d!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d>d?6d@dA6dBdC6dÄ dD6d0dE6d2dF6d4dG6dHdI6dÄ dJ6ddK6dLdM6ddN6dOdP6Z i dQdR6dSdT6dUdV6dQdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dXdh6Z i didj6dkdl6didm6Z i dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d|d}6d~d6d€d6d‚dƒ6d„d…6d†d‡6dˆd‰6dŠd‹6dŒd6dd6dd‘6d’d“6d”d•6d–d—6d˜d™6dšd›6dœd6ddŸ6Z i d d¡6d¢d£6d d¤6d¥d¦6d§d¨6d©dª6d«d¬6d­d®6d¯d°6d±d²6d³d´6dµd¶6d¥d·6Z i d¸d¹6dºd»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6dødù6dúdû6düdı6dşdÿ6d d6dd6dd6dd6dd	6d
d6dd6dÒd6dd¿ 6dd6dd6dd6dd6dd6d¾d6ddÉ 6dd6dd6d d!6dêd"6d#d$6d%d&6d'd(6d)d*6d+d,6d-d.6d/d06d1d26d3d46d5dñ 6d6d76d8d96d:d;6d<d=6d:d>6d?d@6dAdB6dCdD6dEdF6ddG6dHdI6dJdK6dLdM6dNdO6dŞdP6ddQ6dRdS6dTdU6dVdW6dàdX6dYdZ6d[d\6d/d]6dæd^6dèd_6d`da6dbdc6dêdd6dedf6dºdg6dhdi6dìdj6dkdl6dmdn6dodp6d`dq6dîdr6dsdt6dudv6dwdx6dydz6dğd{6d|d}6d~d6d€d6d‚dƒ6d1d„6d…d†6död‡6dødˆ6d‰dŠ6d‹dŒ6dd6dd-6dd‘6d’d“6d”d•6d–d—6d˜d™6ddš6d›dœ6dd6dşdŸ6d d¡6d¢d£6d¤d¥6d¦dF6d§dG6d¨d©6d dª6dCd«6d¬d­6d®d¯6d°d±6d d²6d³d´6Z i dµd¶6d·d¸6Z i d¹dº6d»d¼6d½d¾6Z	 iù d¿dÀ6dÁdÂ6dÃdÄ6dÅdÆ6dÇdÈ6dÉdÊ6dËdÌ6dÍdÎ6dÏdĞ6dÑdÒ6dÓdÔ6dÕdÖ6d×dØ6dÙdÚ6dÛdÜ6dİdŞ6dßdà6dádâ6dãdä6dådæ6dçdè6dédê6dëdì6dídî6dïdğ6dñdò6dódô6dõdö6d÷dø6dùdú6dûdü6dıdş6dÿd 6dd6dd6dd6dd6d	d
6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd 6dÁd!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d>d?6d@dA6dBdC6dBdD6dEdF6dGdH6dIdJ6dKdL6dMdN6dOdP6dQdR6dSdT6dUdV6dWdX6dYdZ6d[d\6d]d^6d_d`6dadb6dïdc6ddde6dfdg6dhdi6djdk6dËdl6dÓdm6dndo6dpdq6dIdr6dsdt6dudv6dwdx6dydz6d{d|6d}d~6dd€6dd‚6dƒd„6d…d†6d‡dˆ6d‰dŠ6d‹dŒ6dd6dd6dpd‘6d’d“6d”d•6d–d—6d˜d™6dšd›6dœd6ddŸ6dñd 6d¡d¢6d£d¤6d¥d¦6d§d¨6d©dª6d«d¬6d­d®6d¯d°6d±d²6d³d´6dµd¶6d·d¸6d¹dº6d»d¼6d½d¾6d¿dÀ6dÁdÂ6dÃdÄ6dÅdÆ6dÇdÈ6dÉdÊ6dËdÌ6dÍdÎ6dÏdĞ6dÑdÒ6dÓdÔ6dÕdÖ6d×dØ6dÕdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6dødù6dúdû6düdı6dşdÿ6d d6dd6dd6dd6dd	6d
d6dd6dd6dd6dŞd6dd6dd6dd6dd6dd6dd6dd 6d!d"6d#d$6d%d&6d'd(6d)d*6d+d,6d-d.6d/d06d1d26d3d46d5d66d7d86d9d:6d;d<6d=d>6d?d@6dAdB6dCdD6dEdF6dGdH6dId6dJdK6d@dL6dMdN6dMdO6dPdQ6dRdS6dTdU6dVdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dhdi6djdk6dldm6dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d+d|6d}d~6dd€6dd‚6dƒd„6d…d†6d‡dˆ6d‰dŠ6d‹dŒ6dd6dd6d)d‘6d’d“6d”d•6d–d—6d'd˜6d™dš6d›dœ6dd6dŸd 6Z
 i d¡d¢6Z i d£d¤6d£d¥6d¦d§6Z d¨S(©  u   Ìt   acuteu   Ì„t   baru   Ì†t   breveu   ÌŒt   checku   âƒœt   ddddotu   âƒ›t   dddotu   Ìˆt   ddotu   Ì‡t   dotu   Ì€t   graveu   Ì‚t   hatu   ÌŠt   mathringu   Ì¸t   notu   âƒ–t   overleftarrowu   âƒ¡t   overleftrightarrowu   Ì…t   overlineu   âƒ—t   overrightarrowu   Ìƒt   tildeu   Ì±t   underbaru   âƒ®t   underleftarrowu   Ì²t	   underlineu   âƒ¯t   underrightarrowt   vect   widehatt	   widetildeu   ğ•œt   Bbbku   Î”t   Deltau   Î“t   Gammau   â„‘t   Imu   Î›t   Lambdau   Î©t   Omegau   Î¦t   Phiu   Î t   Piu   Î¨t   Psiu   â„œt   Reu   Î£t   Sigmau   Î˜t   Thetau   Î¥t   Upsilonu   Ît   Xiu   â„µt   alephu   Î±t   alphau   Î²t   betau   â„¶t   bethu   Ï‡t   chiu   â„¸t   dalethu   Î´t   deltau   Ïœt   digammau   â„“t   ellu   Ïµt   epsilonu   Î·t   etau   Ã°t   ethu   Î³t   gammau   â„·t   gimelu   â„t   hbart   hslashu   Ä±t   imathu   Î¹t   iotau   È·t   jmathu   Îºt   kappau   Î»t   lambdau   Î¼t   muu   Î½t   nuu   Ï‰t   omegau   Ï•t   phiu   Ï€t   piu   Ïˆt   psiu   Ït   rhou   Ïƒt   sigmau   Ï„t   tauu   Î¸t   thetau   Ï…t   upsilonu   ğ›¥t   varDeltau   ğ›¤t   varGammau   ğ›¬t	   varLambdau   ğ›ºt   varOmegau   ğ›·t   varPhiu   ğ›±t   varPiu   ğ›¹t   varPsiu   ğ›´t   varSigmau   ğ›©t   varThetau   ğ›¶t
   varUpsilonu   ğ›¯t   varXiu   Îµt
   varepsilonu   ğœ˜t   varkappau   Ï†t   varphiu   Ï–t   varpiu   Ï±t   varrhou   Ï‚t   varsigmau   Ï‘t   varthetau   â„˜t   wpu   Î¾t   xiu   Î¶t   zetau   â‹’t   Capu   â—‹t   Circleu   â‹“t   Cupu   â—€t   LHDu   â–¶t   RHDu   â¨¿t   amalgu   âˆ—t   astu   âŠ¼t   barwedgeu   â–½t   bigtriangledownu   â–³t   bigtriangleupu   â…‹t   bindnasrepmau   â§«t   blacklozengeu   â–¾t   blacktriangledownu   â—‚t   blacktriangleleftu   â–¸t   blacktrianglerightu   â–´t   blacktriangleupu   â§†t   boxastu   â—«t   boxbaru   â§ˆt   boxboxu   â§…t	   boxbslashu   â§‡t	   boxcircleu   âŠ¡t   boxdotu   âŠŸt   boxminusu   âŠt   boxplusu   â§„t   boxslashu   âŠ t   boxtimesu   âˆ™t   bulletu   âˆ©t   capu   â‹…t   cdotu   âˆ˜t   circu   âŠ›t
   circledastu   âŠšt   circledcircu   âŠt   circleddashu   âˆªt   cupu   â‹t   curlyveeu   â‹t
   curlywedgeu   â€ t   daggeru   â€¡t   ddaggeru   â‹„t   diamondu   Ã·t   divu   â‹‡t   divideontimesu   âˆ”t   dotplusu   â©t   doublebarwedgeu   âŠºt   intercalu   â«´t
   interleaveu   âˆ§t   landu   â‹‹t   leftthreetimesu   â—t   lhdu   âˆ¨t   loru   â‹‰t   ltimesu   âˆ“t   mpu   âŠ™t   odotu   âŠ–t   ominusu   âŠ•t   oplusu   âŠ˜t   oslashu   âŠ—t   otimesu   Â±t   pmu   â–·t   rhdu   â‹Œt   rightthreetimesu   â‹Št   rtimesu   â§µt   setminusu   âˆ•t   slashu   âˆ–t   smallsetminusu   â–¿t   smalltriangledownu   â—ƒt   smalltriangleleftu   â–¹t   smalltrianglerightu   â–µt   smalltriangleupu   âŠ“t   sqcapu   âŠ”t   sqcupu   â«½t   sslashu   â‹†t   staru   â«¾t
   talloblongu   Ã—t   timest   trianglet   triangledownt   triangleleftt   trianglerightu   âŠt   uplust   vartrianglet   veeu   âŠ»t   veebart   wedgeu   â‰€t   wru   âŸ†t   Rbagu   âŒŸt   lrcorneru   âŸ©t   ranglet   rbagu   }t   rbraceu   ]t   rbracku   âŒ‰t   rceilu   âŒ‹t   rflooru   âŸ¯t   rgroupu   âŸ§t	   rrbracketu   â¦ˆt   rrparenthesisu   âŒt   urcornert   }u   â€–t   Vertu   |t   vertt   |u   â¨t   Joinu   â‹‚t   bigcapu   â‹ƒt   bigcupu   â«¼t   biginterleaveu   â¨€t   bigodotu   â¨t   bigoplusu   â¨‚t	   bigotimesu   â¨†t   bigsqcupu   â¨„t   biguplusu   â‹t   bigveeu   â‹€t   bigwedgeu   âˆt   coprodu   â¨Ÿt   fatsemiu   â¨t   fintu   â¨Œt   iiiintu   âˆ­t   iiintu   âˆ¬t   iintu   âˆ«t   intu   âˆ¯t   oiintu   âˆ®t   ointu   âˆ³t   ointctrclockwiseu   âˆt   produ   â¨–t   sqintu   âˆ‘t   sumu   âˆ²t   varointclockwiseu   âŸ…t   Lbagu   âŸ¨t   langlet   lbagu   {t   lbraceu   [t   lbracku   âŒˆt   lceilu   âŒŠt   lflooru   âŸ®t   lgroupu   âŸ¦t	   llbracketu   âŒt   llcorneru   â¦‡t   llparenthesisu   âŒœt   ulcornert   {u   #t   #u   $t   $u   %t   %u   &t   &u   âˆ¿t   ACu   ât
   APLcommentu   â—t   APLdownarrowboxu   ât   APLinputu   âŒ¹t   APLinvu   â‡t   APLleftarrowboxu   âŸt   APLlogu   âˆt   APLrightarrowboxu   ât   APLuparrowboxu   â™ˆt   Ariesu   â—t   CIRCLEu   â˜‘t
   CheckedBoxu   â—‡t   Diamondu   â„²t   Finvu   â…t   Gameu   â™Št   Geminiu   â™ƒt   Jupiteru   â—–t
   LEFTCIRCLEu   â—t
   LEFTcircleu   â™Œt   Leou   â™t   Librau   â™‚t   Marsu   â˜¿t   Mercuryu   â™†t   Neptuneu   â™‡t   Plutou   â——t   RIGHTCIRCLEu   â—‘t   RIGHTcircleu   â™„t   Saturnu   â™t   Scorpiou   â˜t   Squareu   â˜‰t   Sunu   â™‰t   Taurusu   â™…t   Uranusu   â™€t   Venusu   â˜’t   XBoxu   â…„t   Yupu   _t   _u   âˆ t   angleu   â™’t   aquariust   ariesu   *u   Ï¶t   backepsilonu   â€µt	   backprimeu   \t	   backslashu   âˆµt   becauseu   â˜…t   bigstart   binampersandu   â¬§u   â˜»t   blacksmileyu   â—¼t   blacksquareu   âŠ¥t   bott   boyu   â™‹t   canceru   â™‘t   capricornusu   â‹¯t   cdotsu   Â¢t   centu   â¬t	   centerdotu   âœ“t	   checkmarku   â†ºt   circlearrowleftu   â†»t   circlearrowrightu   Â®t   circledRu   â—u   â™£t   clubsuitu   âˆt
   complementu   â‡¢t	   dasharrowu   â‡ t   dashleftarrowt   dashrightarrowu   âŒ€t   diameteru   â™¢t   diamondsuitu   â™t   earthu   âˆƒt   existst   femaleu   â™­t   flatu   âˆ€t   forallu   â—t   fourthu   â˜¹t   frowniet   geminit   girlu   â™¡t	   heartsuitu   âˆt   inftyu   âŒt   invnegt   jupiteru   â€¦t   ldotsu   â˜¾t   leftmoont   leftturnt   leot   librau   Â¬t   lnotu   â—Št   lozenget   maleu   âœ t   malteset
   mathdollaru   âˆ¡t   measuredanglet   mercuryu   â„§t   mhou   âˆ‡t   nablau   â™®t   naturalt   negt   neptuneu   âˆ„t   nexistsu   â€t   notbackslashu   âˆ‚t   partialu   â™“t   piscest   plutou   Â£t   poundsu   â€²t   primeu   â™©t   quarternoteu   â˜½t	   rightmoont	   rightturnu   â™t   sagittariust   saturnt   scorpiou   â€³t   secondu   â™¯t   sharpu   ~t   simu   /u   â˜ºt   smileyu   â™ t	   spadesuitu   Â¨t   spddotu   ^t   sphatu   âˆ¢t   sphericalanglet   sptildeu   â—»t   squareu   â˜¼t   sunt   taurusu   âˆ´t	   thereforeu   â€´t   thirdu   âŠ¤t   topu   â—…u   â–»u   â™«t   twonotest   uranust   varEarthu   âˆ…t
   varnothingu   â™t   virgou   âŒ‘t   wasylozenget   wasythereforeu   Â¥t   yenu   ât	   overbraceu   âœt	   wideparenu   âˆšt   sqrtu   âˆ›s   sqrt[3]u   âˆœs   sqrt[4]u   â‰t   Bumpequ   â‰‘t   Dotequ   â‡“t	   Downarrowu   â‡t	   Leftarrowu   â‡”t   Leftrightarrowu   â‡št
   Lleftarrowu   âŸ¸t   Longleftarrowu   âŸºt   Longleftrightarrowu   âŸ½t   Longmapsfromu   âŸ¾t
   Longmapstou   âŸ¹t   Longrightarrowu   â†°t   Lshu   â¤†t   Mapsfromu   â¤‡t   Mapstou   â‡’t
   Rightarrowu   â‡›t   Rrightarrowu   â†±t   Rshu   â‹t   Subsetu   â‹‘t   Supsetu   â‡‘t   Uparrowu   â‡•t   Updownarrowu   âŠ«t   VDashu   âŠ©t   Vdashu   âŠªt   Vvdashu   â‰³t   apprgeu   â‰²t   apprleu   â‰ˆt   approxu   â‰Št   approxequ   â‰t   asympu   âˆ½t   backsimu   â‹t	   backsimequ   â‹¶t   barinu   â¥«t   barleftharpoonu   â¥­t   barrightharpoonu   â‰¬t   betweenu   â‹ˆt   bowtieu   â‰t   bumpequ   â‰—t   circequ   â‰”t   colonequ   â‰…t   congu   â‰™t   correspondsu   â‹t   curlyeqprecu   â‹Ÿt   curlyeqsuccu   â†¶t   curvearrowleftu   â†·t   curvearrowrightu   âŠ£t   dashvu   â‹±t   ddotsu   â†²t   dlshu   â‰t   doteqt   doteqdotu   â†“t	   downarrowu   â‡Št   downdownarrowsu   â¥¥t   downdownharpoonsu   â‡ƒt   downharpoonleftu   â‡‚t   downharpoonrightu   â‡µt   downuparrowsu   â¥¯t   downupharpoonsu   â†³t   drshu   â‰–t   eqcircu   â‰•t   eqcolonu   â‰‚t   eqsimu   âª–t
   eqslantgtru   âª•t   eqslantlessu   â‰¡t   equivu   â‰’t   fallingdotsequ   âŒ¢t   frownu   â‰¥t   get   gequ   â‰§t   geqqu   â©¾t   geqslantu   â†t   getsu   â‰«t   ggu   âª¼t   ggcurlyu   â‹™t   gggu   âªŠt   gnapproxu   âªˆt   gnequ   â‰©t   gneqqu   â‹§t   gnsimu   âª†t	   gtrapproxu   â‹—t   gtrdotu   â‹›t	   gtreqlessu   âªŒt
   gtreqqlessu   â‰·t   gtrlesst   gtrsimu   â‹•t   hashu   â†©t   hookleftarrowu   â†ªt   hookrightarrowu   â‹°t   iddotst	   impliedbyt   impliesu   âˆˆt   inu   â‰¤t   let	   leftarrowu   â†¢t   leftarrowtailu   â‡½t   leftarrowtriangleu   â¥ªt   leftbarharpoonu   â†½t   leftharpoondownu   â†¼t   leftharpoonupu   â‡‡t   leftleftarrowsu   â¥¢t   leftleftharpoonsu   â†”t   leftrightarrowu   â‡†t   leftrightarrowsu   â‡¿t   leftrightarrowtriangleu   â¥Št   leftrightharpoonu   â‡‹t   leftrightharpoonsu   â†­t   leftrightsquigarrowu   âª¦t	   leftsliceu   â‡œt   leftsquigarrowt   lequ   â‰¦t   leqqu   â©½t   leqslantu   âª…t
   lessapproxu   â‹–t   lessdotu   â‹št	   lesseqgtru   âª‹t
   lesseqqgtru   â‰¶t   lessgtrt   lesssimu   â†¯t	   lightningu   â‰ªt   llu   âª»t   llcurlyu   â‹˜t   lllu   âª‰t   lnapproxu   âª‡t   lnequ   â‰¨t   lneqqu   â‹¦t   lnsimu   âŸµt   longleftarrowu   âŸ·t   longleftrightarrowu   âŸ»t   longmapsfromu   âŸ¼t
   longmapstou   âŸ¶t   longrightarrowu   â†«t   looparrowleftu   â†¬t   looparrowrightu   â†¤t   mapsfromu   â†¦t   mapstou   âˆ£t   midu   âŠ§t   modelsu   âŠ¸t   multimapu   â‡t
   nLeftarrowu   â‡t   nLeftrightarrowu   â‡t   nRightarrowu   âŠ¯t   nVDashu   âŠ®t   nVdashu   â‰‡t   ncongu   â‰ t   neu   â†—t   nearrowt   nequ   â‰±t   ngequ   â‰¯t   ngtru   âˆ‹t   niu   â†št
   nleftarrowu   â†®t   nleftrightarrowu   â‰°t   nlequ   â‰®t   nlessu   âˆ¤t   nmidu   â‰­t   notasympu   âˆ‰t   notinu   âˆŒt   notowneru   âŒ¿t   notslashu   âˆ¦t	   nparallelu   âŠ€t   nprecu   â‹ t   nprecequ   â†›t   nrightarrowu   â‰t   nsimu   âŠˆt	   nsubsetequ   âŠt   nsuccu   â‹¡t   nsuccequ   âŠ‰t	   nsupsetequ   â‹ªt   ntriangleleftu   â‹¬t   ntriangleleftequ   â‹«t   ntrianglerightu   â‹­t   ntrianglerightequ   âŠ­t   nvDashu   âŠ¬t   nvdashu   â†–t   nwarrowt   ownsu   âˆ¥t   parallelu   âŸ‚t   perpu   â‹”t	   pitchforku   â‰ºt   precu   âª·t
   precapproxu   â‰¼t   preccurlyequ   âª¯t   precequ   âª¹t   precnapproxu   â‹¨t   precnsimu   â‰¾t   precsimu   âˆt   proptou   â†¾t   restrictionu   â†’t
   rightarrowu   â†£t   rightarrowtailu   â‡¾t   rightarrowtriangleu   â¥¬t   rightbarharpoonu   â‡t   rightharpoondownu   â‡€t   rightharpoonupu   â‡„t   rightleftarrowsu   â¥‹t   rightleftharpoonu   â‡Œt   rightleftharpoonsu   â‡‰t   rightrightarrowsu   â¥¤t   rightrightharpoonsu   âª§t
   rightsliceu   â‡t   rightsquigarrowu   â‰“t   risingdotsequ   â†˜t   searrowu   âˆ¼u   â‰ƒt   simeqt
   smallfrownu   âŒ£t
   smallsmilet   smileu   âŠt   sqsubsetu   âŠ‘t
   sqsubsetequ   âŠt   sqsupsetu   âŠ’t
   sqsupsetequ   âŠ‚t   subsetu   âŠ†t   subsetequ   â«…t	   subseteqqu   âŠŠt	   subsetnequ   â«‹t
   subsetneqqu   â‰»t   succu   âª¸t
   succapproxu   â‰½t   succcurlyequ   âª°t   succequ   âªºt   succnapproxu   â‹©t   succnsimu   â‰¿t   succsimu   âŠƒt   supsetu   âŠ‡t   supsetequ   â«†t	   supseteqqu   âŠ‹t	   supsetnequ   â«Œt
   supsetneqqu   â†™t   swarrowt   tou   âŠ´t   triangleleftequ   â‰œt	   trianglequ   âŠµt   trianglerightequ   â†t   twoheadleftarrowu   â† t   twoheadrightarrowu   â†‘t   uparrowu   â†•t   updownarrowu   â‡…t   updownarrowsu   â¥®t   updownharpoonsu   â†¿t   upharpoonleftt   upharpoonrightu   â‡ˆt
   upuparrowsu   â¥£t   upupharpoonsu   âŠ¨t   vDasht	   varproptou   âŠ²t   vartriangleleftu   âŠ³t   vartrianglerightu   âŠ¢t   vdashu   â‹®t   vdotsu   âŸt
   underbraceu   âŸt   :t   medspaceu   â€t   quadN(   t
   mathaccentt	   mathalphat   mathbint	   mathcloset	   mathfencet   mathopt   mathopent   mathordt   mathovert   mathradicalt   mathrelt	   mathundert   space(    (    (    sA   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/tex2unichar.pyt   <module>	   s   











                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        usr/local/lib/python2.7/dist-packages/docutils/utils/math/unichar2tex.py                            0100644 0000000 0000062 00000042266 13077704374 024770  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # LaTeX math to Unicode symbols translation table
# for use with the translate() method of unicode objects.
# Generated with ``write_unichar2tex.py`` from the data in
# http://milde.users.sourceforge.net/LUCR/Math/

# Includes commands from: standard LaTeX, amssymb, amsmath

uni2tex_table = {
160: u'~',
163: u'\\pounds ',
165: u'\\yen ',
172: u'\\neg ',
174: u'\\circledR ',
177: u'\\pm ',
215: u'\\times ',
240: u'\\eth ',
247: u'\\div ',
305: u'\\imath ',
567: u'\\jmath ',
915: u'\\Gamma ',
916: u'\\Delta ',
920: u'\\Theta ',
923: u'\\Lambda ',
926: u'\\Xi ',
928: u'\\Pi ',
931: u'\\Sigma ',
933: u'\\Upsilon ',
934: u'\\Phi ',
936: u'\\Psi ',
937: u'\\Omega ',
945: u'\\alpha ',
946: u'\\beta ',
947: u'\\gamma ',
948: u'\\delta ',
949: u'\\varepsilon ',
950: u'\\zeta ',
951: u'\\eta ',
952: u'\\theta ',
953: u'\\iota ',
954: u'\\kappa ',
955: u'\\lambda ',
956: u'\\mu ',
957: u'\\nu ',
958: u'\\xi ',
960: u'\\pi ',
961: u'\\rho ',
962: u'\\varsigma ',
963: u'\\sigma ',
964: u'\\tau ',
965: u'\\upsilon ',
966: u'\\varphi ',
967: u'\\chi ',
968: u'\\psi ',
969: u'\\omega ',
977: u'\\vartheta ',
981: u'\\phi ',
982: u'\\varpi ',
989: u'\\digamma ',
1014: u'\\backepsilon ',
8193: u'\\quad ',
8214: u'\\| ',
8224: u'\\dagger ',
8225: u'\\ddagger ',
8230: u'\\ldots ',
8242: u'\\prime ',
8245: u'\\backprime ',
8287: u'\\: ',
8450: u'\\mathbb{C}',
8459: u'\\mathcal{H}',
8460: u'\\mathfrak{H}',
8461: u'\\mathbb{H}',
8463: u'\\hslash ',
8464: u'\\mathcal{I}',
8465: u'\\Im ',
8466: u'\\mathcal{L}',
8467: u'\\ell ',
8469: u'\\mathbb{N}',
8472: u'\\wp ',
8473: u'\\mathbb{P}',
8474: u'\\mathbb{Q}',
8475: u'\\mathcal{R}',
8476: u'\\Re ',
8477: u'\\mathbb{R}',
8484: u'\\mathbb{Z}',
8487: u'\\mho ',
8488: u'\\mathfrak{Z}',
8492: u'\\mathcal{B}',
8493: u'\\mathfrak{C}',
8496: u'\\mathcal{E}',
8497: u'\\mathcal{F}',
8498: u'\\Finv ',
8499: u'\\mathcal{M}',
8501: u'\\aleph ',
8502: u'\\beth ',
8503: u'\\gimel ',
8504: u'\\daleth ',
8592: u'\\leftarrow ',
8593: u'\\uparrow ',
8594: u'\\rightarrow ',
8595: u'\\downarrow ',
8596: u'\\leftrightarrow ',
8597: u'\\updownarrow ',
8598: u'\\nwarrow ',
8599: u'\\nearrow ',
8600: u'\\searrow ',
8601: u'\\swarrow ',
8602: u'\\nleftarrow ',
8603: u'\\nrightarrow ',
8606: u'\\twoheadleftarrow ',
8608: u'\\twoheadrightarrow ',
8610: u'\\leftarrowtail ',
8611: u'\\rightarrowtail ',
8614: u'\\mapsto ',
8617: u'\\hookleftarrow ',
8618: u'\\hookrightarrow ',
8619: u'\\looparrowleft ',
8620: u'\\looparrowright ',
8621: u'\\leftrightsquigarrow ',
8622: u'\\nleftrightarrow ',
8624: u'\\Lsh ',
8625: u'\\Rsh ',
8630: u'\\curvearrowleft ',
8631: u'\\curvearrowright ',
8634: u'\\circlearrowleft ',
8635: u'\\circlearrowright ',
8636: u'\\leftharpoonup ',
8637: u'\\leftharpoondown ',
8638: u'\\upharpoonright ',
8639: u'\\upharpoonleft ',
8640: u'\\rightharpoonup ',
8641: u'\\rightharpoondown ',
8642: u'\\downharpoonright ',
8643: u'\\downharpoonleft ',
8644: u'\\rightleftarrows ',
8646: u'\\leftrightarrows ',
8647: u'\\leftleftarrows ',
8648: u'\\upuparrows ',
8649: u'\\rightrightarrows ',
8650: u'\\downdownarrows ',
8651: u'\\leftrightharpoons ',
8652: u'\\rightleftharpoons ',
8653: u'\\nLeftarrow ',
8654: u'\\nLeftrightarrow ',
8655: u'\\nRightarrow ',
8656: u'\\Leftarrow ',
8657: u'\\Uparrow ',
8658: u'\\Rightarrow ',
8659: u'\\Downarrow ',
8660: u'\\Leftrightarrow ',
8661: u'\\Updownarrow ',
8666: u'\\Lleftarrow ',
8667: u'\\Rrightarrow ',
8669: u'\\rightsquigarrow ',
8672: u'\\dashleftarrow ',
8674: u'\\dashrightarrow ',
8704: u'\\forall ',
8705: u'\\complement ',
8706: u'\\partial ',
8707: u'\\exists ',
8708: u'\\nexists ',
8709: u'\\varnothing ',
8711: u'\\nabla ',
8712: u'\\in ',
8713: u'\\notin ',
8715: u'\\ni ',
8719: u'\\prod ',
8720: u'\\coprod ',
8721: u'\\sum ',
8722: u'-',
8723: u'\\mp ',
8724: u'\\dotplus ',
8725: u'\\slash ',
8726: u'\\smallsetminus ',
8727: u'\\ast ',
8728: u'\\circ ',
8729: u'\\bullet ',
8730: u'\\sqrt ',
8731: u'\\sqrt[3] ',
8732: u'\\sqrt[4] ',
8733: u'\\propto ',
8734: u'\\infty ',
8736: u'\\angle ',
8737: u'\\measuredangle ',
8738: u'\\sphericalangle ',
8739: u'\\mid ',
8740: u'\\nmid ',
8741: u'\\parallel ',
8742: u'\\nparallel ',
8743: u'\\wedge ',
8744: u'\\vee ',
8745: u'\\cap ',
8746: u'\\cup ',
8747: u'\\int ',
8748: u'\\iint ',
8749: u'\\iiint ',
8750: u'\\oint ',
8756: u'\\therefore ',
8757: u'\\because ',
8758: u':',
8764: u'\\sim ',
8765: u'\\backsim ',
8768: u'\\wr ',
8769: u'\\nsim ',
8770: u'\\eqsim ',
8771: u'\\simeq ',
8773: u'\\cong ',
8775: u'\\ncong ',
8776: u'\\approx ',
8778: u'\\approxeq ',
8781: u'\\asymp ',
8782: u'\\Bumpeq ',
8783: u'\\bumpeq ',
8784: u'\\doteq ',
8785: u'\\Doteq ',
8786: u'\\fallingdotseq ',
8787: u'\\risingdotseq ',
8790: u'\\eqcirc ',
8791: u'\\circeq ',
8796: u'\\triangleq ',
8800: u'\\neq ',
8801: u'\\equiv ',
8804: u'\\leq ',
8805: u'\\geq ',
8806: u'\\leqq ',
8807: u'\\geqq ',
8808: u'\\lneqq ',
8809: u'\\gneqq ',
8810: u'\\ll ',
8811: u'\\gg ',
8812: u'\\between ',
8814: u'\\nless ',
8815: u'\\ngtr ',
8816: u'\\nleq ',
8817: u'\\ngeq ',
8818: u'\\lesssim ',
8819: u'\\gtrsim ',
8822: u'\\lessgtr ',
8823: u'\\gtrless ',
8826: u'\\prec ',
8827: u'\\succ ',
8828: u'\\preccurlyeq ',
8829: u'\\succcurlyeq ',
8830: u'\\precsim ',
8831: u'\\succsim ',
8832: u'\\nprec ',
8833: u'\\nsucc ',
8834: u'\\subset ',
8835: u'\\supset ',
8838: u'\\subseteq ',
8839: u'\\supseteq ',
8840: u'\\nsubseteq ',
8841: u'\\nsupseteq ',
8842: u'\\subsetneq ',
8843: u'\\supsetneq ',
8846: u'\\uplus ',
8847: u'\\sqsubset ',
8848: u'\\sqsupset ',
8849: u'\\sqsubseteq ',
8850: u'\\sqsupseteq ',
8851: u'\\sqcap ',
8852: u'\\sqcup ',
8853: u'\\oplus ',
8854: u'\\ominus ',
8855: u'\\otimes ',
8856: u'\\oslash ',
8857: u'\\odot ',
8858: u'\\circledcirc ',
8859: u'\\circledast ',
8861: u'\\circleddash ',
8862: u'\\boxplus ',
8863: u'\\boxminus ',
8864: u'\\boxtimes ',
8865: u'\\boxdot ',
8866: u'\\vdash ',
8867: u'\\dashv ',
8868: u'\\top ',
8869: u'\\bot ',
8871: u'\\models ',
8872: u'\\vDash ',
8873: u'\\Vdash ',
8874: u'\\Vvdash ',
8876: u'\\nvdash ',
8877: u'\\nvDash ',
8878: u'\\nVdash ',
8879: u'\\nVDash ',
8882: u'\\vartriangleleft ',
8883: u'\\vartriangleright ',
8884: u'\\trianglelefteq ',
8885: u'\\trianglerighteq ',
8888: u'\\multimap ',
8890: u'\\intercal ',
8891: u'\\veebar ',
8892: u'\\barwedge ',
8896: u'\\bigwedge ',
8897: u'\\bigvee ',
8898: u'\\bigcap ',
8899: u'\\bigcup ',
8900: u'\\diamond ',
8901: u'\\cdot ',
8902: u'\\star ',
8903: u'\\divideontimes ',
8904: u'\\bowtie ',
8905: u'\\ltimes ',
8906: u'\\rtimes ',
8907: u'\\leftthreetimes ',
8908: u'\\rightthreetimes ',
8909: u'\\backsimeq ',
8910: u'\\curlyvee ',
8911: u'\\curlywedge ',
8912: u'\\Subset ',
8913: u'\\Supset ',
8914: u'\\Cap ',
8915: u'\\Cup ',
8916: u'\\pitchfork ',
8918: u'\\lessdot ',
8919: u'\\gtrdot ',
8920: u'\\lll ',
8921: u'\\ggg ',
8922: u'\\lesseqgtr ',
8923: u'\\gtreqless ',
8926: u'\\curlyeqprec ',
8927: u'\\curlyeqsucc ',
8928: u'\\npreceq ',
8929: u'\\nsucceq ',
8934: u'\\lnsim ',
8935: u'\\gnsim ',
8936: u'\\precnsim ',
8937: u'\\succnsim ',
8938: u'\\ntriangleleft ',
8939: u'\\ntriangleright ',
8940: u'\\ntrianglelefteq ',
8941: u'\\ntrianglerighteq ',
8942: u'\\vdots ',
8943: u'\\cdots ',
8945: u'\\ddots ',
8968: u'\\lceil ',
8969: u'\\rceil ',
8970: u'\\lfloor ',
8971: u'\\rfloor ',
8988: u'\\ulcorner ',
8989: u'\\urcorner ',
8990: u'\\llcorner ',
8991: u'\\lrcorner ',
8994: u'\\frown ',
8995: u'\\smile ',
9182: u'\\overbrace ',
9183: u'\\underbrace ',
9651: u'\\bigtriangleup ',
9655: u'\\rhd ',
9661: u'\\bigtriangledown ',
9665: u'\\lhd ',
9671: u'\\Diamond ',
9674: u'\\lozenge ',
9723: u'\\square ',
9724: u'\\blacksquare ',
9733: u'\\bigstar ',
9824: u'\\spadesuit ',
9825: u'\\heartsuit ',
9826: u'\\diamondsuit ',
9827: u'\\clubsuit ',
9837: u'\\flat ',
9838: u'\\natural ',
9839: u'\\sharp ',
10003: u'\\checkmark ',
10016: u'\\maltese ',
10178: u'\\perp ',
10216: u'\\langle ',
10217: u'\\rangle ',
10222: u'\\lgroup ',
10223: u'\\rgroup ',
10229: u'\\longleftarrow ',
10230: u'\\longrightarrow ',
10231: u'\\longleftrightarrow ',
10232: u'\\Longleftarrow ',
10233: u'\\Longrightarrow ',
10234: u'\\Longleftrightarrow ',
10236: u'\\longmapsto ',
10731: u'\\blacklozenge ',
10741: u'\\setminus ',
10752: u'\\bigodot ',
10753: u'\\bigoplus ',
10754: u'\\bigotimes ',
10756: u'\\biguplus ',
10758: u'\\bigsqcup ',
10764: u'\\iiiint ',
10781: u'\\Join ',
10815: u'\\amalg ',
10846: u'\\doublebarwedge ',
10877: u'\\leqslant ',
10878: u'\\geqslant ',
10885: u'\\lessapprox ',
10886: u'\\gtrapprox ',
10887: u'\\lneq ',
10888: u'\\gneq ',
10889: u'\\lnapprox ',
10890: u'\\gnapprox ',
10891: u'\\lesseqqgtr ',
10892: u'\\gtreqqless ',
10901: u'\\eqslantless ',
10902: u'\\eqslantgtr ',
10927: u'\\preceq ',
10928: u'\\succeq ',
10935: u'\\precapprox ',
10936: u'\\succapprox ',
10937: u'\\precnapprox ',
10938: u'\\succnapprox ',
10949: u'\\subseteqq ',
10950: u'\\supseteqq ',
10955: u'\\subsetneqq ',
10956: u'\\supsetneqq ',
119808: u'\\mathbf{A}',
119809: u'\\mathbf{B}',
119810: u'\\mathbf{C}',
119811: u'\\mathbf{D}',
119812: u'\\mathbf{E}',
119813: u'\\mathbf{F}',
119814: u'\\mathbf{G}',
119815: u'\\mathbf{H}',
119816: u'\\mathbf{I}',
119817: u'\\mathbf{J}',
119818: u'\\mathbf{K}',
119819: u'\\mathbf{L}',
119820: u'\\mathbf{M}',
119821: u'\\mathbf{N}',
119822: u'\\mathbf{O}',
119823: u'\\mathbf{P}',
119824: u'\\mathbf{Q}',
119825: u'\\mathbf{R}',
119826: u'\\mathbf{S}',
119827: u'\\mathbf{T}',
119828: u'\\mathbf{U}',
119829: u'\\mathbf{V}',
119830: u'\\mathbf{W}',
119831: u'\\mathbf{X}',
119832: u'\\mathbf{Y}',
119833: u'\\mathbf{Z}',
119834: u'\\mathbf{a}',
119835: u'\\mathbf{b}',
119836: u'\\mathbf{c}',
119837: u'\\mathbf{d}',
119838: u'\\mathbf{e}',
119839: u'\\mathbf{f}',
119840: u'\\mathbf{g}',
119841: u'\\mathbf{h}',
119842: u'\\mathbf{i}',
119843: u'\\mathbf{j}',
119844: u'\\mathbf{k}',
119845: u'\\mathbf{l}',
119846: u'\\mathbf{m}',
119847: u'\\mathbf{n}',
119848: u'\\mathbf{o}',
119849: u'\\mathbf{p}',
119850: u'\\mathbf{q}',
119851: u'\\mathbf{r}',
119852: u'\\mathbf{s}',
119853: u'\\mathbf{t}',
119854: u'\\mathbf{u}',
119855: u'\\mathbf{v}',
119856: u'\\mathbf{w}',
119857: u'\\mathbf{x}',
119858: u'\\mathbf{y}',
119859: u'\\mathbf{z}',
119860: u'A',
119861: u'B',
119862: u'C',
119863: u'D',
119864: u'E',
119865: u'F',
119866: u'G',
119867: u'H',
119868: u'I',
119869: u'J',
119870: u'K',
119871: u'L',
119872: u'M',
119873: u'N',
119874: u'O',
119875: u'P',
119876: u'Q',
119877: u'R',
119878: u'S',
119879: u'T',
119880: u'U',
119881: u'V',
119882: u'W',
119883: u'X',
119884: u'Y',
119885: u'Z',
119886: u'a',
119887: u'b',
119888: u'c',
119889: u'd',
119890: u'e',
119891: u'f',
119892: u'g',
119894: u'i',
119895: u'j',
119896: u'k',
119897: u'l',
119898: u'm',
119899: u'n',
119900: u'o',
119901: u'p',
119902: u'q',
119903: u'r',
119904: u's',
119905: u't',
119906: u'u',
119907: u'v',
119908: u'w',
119909: u'x',
119910: u'y',
119911: u'z',
119964: u'\\mathcal{A}',
119966: u'\\mathcal{C}',
119967: u'\\mathcal{D}',
119970: u'\\mathcal{G}',
119973: u'\\mathcal{J}',
119974: u'\\mathcal{K}',
119977: u'\\mathcal{N}',
119978: u'\\mathcal{O}',
119979: u'\\mathcal{P}',
119980: u'\\mathcal{Q}',
119982: u'\\mathcal{S}',
119983: u'\\mathcal{T}',
119984: u'\\mathcal{U}',
119985: u'\\mathcal{V}',
119986: u'\\mathcal{W}',
119987: u'\\mathcal{X}',
119988: u'\\mathcal{Y}',
119989: u'\\mathcal{Z}',
120068: u'\\mathfrak{A}',
120069: u'\\mathfrak{B}',
120071: u'\\mathfrak{D}',
120072: u'\\mathfrak{E}',
120073: u'\\mathfrak{F}',
120074: u'\\mathfrak{G}',
120077: u'\\mathfrak{J}',
120078: u'\\mathfrak{K}',
120079: u'\\mathfrak{L}',
120080: u'\\mathfrak{M}',
120081: u'\\mathfrak{N}',
120082: u'\\mathfrak{O}',
120083: u'\\mathfrak{P}',
120084: u'\\mathfrak{Q}',
120086: u'\\mathfrak{S}',
120087: u'\\mathfrak{T}',
120088: u'\\mathfrak{U}',
120089: u'\\mathfrak{V}',
120090: u'\\mathfrak{W}',
120091: u'\\mathfrak{X}',
120092: u'\\mathfrak{Y}',
120094: u'\\mathfrak{a}',
120095: u'\\mathfrak{b}',
120096: u'\\mathfrak{c}',
120097: u'\\mathfrak{d}',
120098: u'\\mathfrak{e}',
120099: u'\\mathfrak{f}',
120100: u'\\mathfrak{g}',
120101: u'\\mathfrak{h}',
120102: u'\\mathfrak{i}',
120103: u'\\mathfrak{j}',
120104: u'\\mathfrak{k}',
120105: u'\\mathfrak{l}',
120106: u'\\mathfrak{m}',
120107: u'\\mathfrak{n}',
120108: u'\\mathfrak{o}',
120109: u'\\mathfrak{p}',
120110: u'\\mathfrak{q}',
120111: u'\\mathfrak{r}',
120112: u'\\mathfrak{s}',
120113: u'\\mathfrak{t}',
120114: u'\\mathfrak{u}',
120115: u'\\mathfrak{v}',
120116: u'\\mathfrak{w}',
120117: u'\\mathfrak{x}',
120118: u'\\mathfrak{y}',
120119: u'\\mathfrak{z}',
120120: u'\\mathbb{A}',
120121: u'\\mathbb{B}',
120123: u'\\mathbb{D}',
120124: u'\\mathbb{E}',
120125: u'\\mathbb{F}',
120126: u'\\mathbb{G}',
120128: u'\\mathbb{I}',
120129: u'\\mathbb{J}',
120130: u'\\mathbb{K}',
120131: u'\\mathbb{L}',
120132: u'\\mathbb{M}',
120134: u'\\mathbb{O}',
120138: u'\\mathbb{S}',
120139: u'\\mathbb{T}',
120140: u'\\mathbb{U}',
120141: u'\\mathbb{V}',
120142: u'\\mathbb{W}',
120143: u'\\mathbb{X}',
120144: u'\\mathbb{Y}',
120156: u'\\Bbbk ',
120224: u'\\mathsf{A}',
120225: u'\\mathsf{B}',
120226: u'\\mathsf{C}',
120227: u'\\mathsf{D}',
120228: u'\\mathsf{E}',
120229: u'\\mathsf{F}',
120230: u'\\mathsf{G}',
120231: u'\\mathsf{H}',
120232: u'\\mathsf{I}',
120233: u'\\mathsf{J}',
120234: u'\\mathsf{K}',
120235: u'\\mathsf{L}',
120236: u'\\mathsf{M}',
120237: u'\\mathsf{N}',
120238: u'\\mathsf{O}',
120239: u'\\mathsf{P}',
120240: u'\\mathsf{Q}',
120241: u'\\mathsf{R}',
120242: u'\\mathsf{S}',
120243: u'\\mathsf{T}',
120244: u'\\mathsf{U}',
120245: u'\\mathsf{V}',
120246: u'\\mathsf{W}',
120247: u'\\mathsf{X}',
120248: u'\\mathsf{Y}',
120249: u'\\mathsf{Z}',
120250: u'\\mathsf{a}',
120251: u'\\mathsf{b}',
120252: u'\\mathsf{c}',
120253: u'\\mathsf{d}',
120254: u'\\mathsf{e}',
120255: u'\\mathsf{f}',
120256: u'\\mathsf{g}',
120257: u'\\mathsf{h}',
120258: u'\\mathsf{i}',
120259: u'\\mathsf{j}',
120260: u'\\mathsf{k}',
120261: u'\\mathsf{l}',
120262: u'\\mathsf{m}',
120263: u'\\mathsf{n}',
120264: u'\\mathsf{o}',
120265: u'\\mathsf{p}',
120266: u'\\mathsf{q}',
120267: u'\\mathsf{r}',
120268: u'\\mathsf{s}',
120269: u'\\mathsf{t}',
120270: u'\\mathsf{u}',
120271: u'\\mathsf{v}',
120272: u'\\mathsf{w}',
120273: u'\\mathsf{x}',
120274: u'\\mathsf{y}',
120275: u'\\mathsf{z}',
120432: u'\\mathtt{A}',
120433: u'\\mathtt{B}',
120434: u'\\mathtt{C}',
120435: u'\\mathtt{D}',
120436: u'\\mathtt{E}',
120437: u'\\mathtt{F}',
120438: u'\\mathtt{G}',
120439: u'\\mathtt{H}',
120440: u'\\mathtt{I}',
120441: u'\\mathtt{J}',
120442: u'\\mathtt{K}',
120443: u'\\mathtt{L}',
120444: u'\\mathtt{M}',
120445: u'\\mathtt{N}',
120446: u'\\mathtt{O}',
120447: u'\\mathtt{P}',
120448: u'\\mathtt{Q}',
120449: u'\\mathtt{R}',
120450: u'\\mathtt{S}',
120451: u'\\mathtt{T}',
120452: u'\\mathtt{U}',
120453: u'\\mathtt{V}',
120454: u'\\mathtt{W}',
120455: u'\\mathtt{X}',
120456: u'\\mathtt{Y}',
120457: u'\\mathtt{Z}',
120458: u'\\mathtt{a}',
120459: u'\\mathtt{b}',
120460: u'\\mathtt{c}',
120461: u'\\mathtt{d}',
120462: u'\\mathtt{e}',
120463: u'\\mathtt{f}',
120464: u'\\mathtt{g}',
120465: u'\\mathtt{h}',
120466: u'\\mathtt{i}',
120467: u'\\mathtt{j}',
120468: u'\\mathtt{k}',
120469: u'\\mathtt{l}',
120470: u'\\mathtt{m}',
120471: u'\\mathtt{n}',
120472: u'\\mathtt{o}',
120473: u'\\mathtt{p}',
120474: u'\\mathtt{q}',
120475: u'\\mathtt{r}',
120476: u'\\mathtt{s}',
120477: u'\\mathtt{t}',
120478: u'\\mathtt{u}',
120479: u'\\mathtt{v}',
120480: u'\\mathtt{w}',
120481: u'\\mathtt{x}',
120482: u'\\mathtt{y}',
120483: u'\\mathtt{z}',
120484: u'\\imath ',
120485: u'\\jmath ',
120490: u'\\mathbf{\\Gamma}',
120491: u'\\mathbf{\\Delta}',
120495: u'\\mathbf{\\Theta}',
120498: u'\\mathbf{\\Lambda}',
120501: u'\\mathbf{\\Xi}',
120503: u'\\mathbf{\\Pi}',
120506: u'\\mathbf{\\Sigma}',
120508: u'\\mathbf{\\Upsilon}',
120509: u'\\mathbf{\\Phi}',
120511: u'\\mathbf{\\Psi}',
120512: u'\\mathbf{\\Omega}',
120548: u'\\mathit{\\Gamma}',
120549: u'\\mathit{\\Delta}',
120553: u'\\mathit{\\Theta}',
120556: u'\\mathit{\\Lambda}',
120559: u'\\mathit{\\Xi}',
120561: u'\\mathit{\\Pi}',
120564: u'\\mathit{\\Sigma}',
120566: u'\\mathit{\\Upsilon}',
120567: u'\\mathit{\\Phi}',
120569: u'\\mathit{\\Psi}',
120570: u'\\mathit{\\Omega}',
120572: u'\\alpha ',
120573: u'\\beta ',
120574: u'\\gamma ',
120575: u'\\delta ',
120576: u'\\varepsilon ',
120577: u'\\zeta ',
120578: u'\\eta ',
120579: u'\\theta ',
120580: u'\\iota ',
120581: u'\\kappa ',
120582: u'\\lambda ',
120583: u'\\mu ',
120584: u'\\nu ',
120585: u'\\xi ',
120587: u'\\pi ',
120588: u'\\rho ',
120589: u'\\varsigma ',
120590: u'\\sigma ',
120591: u'\\tau ',
120592: u'\\upsilon ',
120593: u'\\varphi ',
120594: u'\\chi ',
120595: u'\\psi ',
120596: u'\\omega ',
120597: u'\\partial ',
120598: u'\\epsilon ',
120599: u'\\vartheta ',
120600: u'\\varkappa ',
120601: u'\\phi ',
120602: u'\\varrho ',
120603: u'\\varpi ',
120782: u'\\mathbf{0}',
120783: u'\\mathbf{1}',
120784: u'\\mathbf{2}',
120785: u'\\mathbf{3}',
120786: u'\\mathbf{4}',
120787: u'\\mathbf{5}',
120788: u'\\mathbf{6}',
120789: u'\\mathbf{7}',
120790: u'\\mathbf{8}',
120791: u'\\mathbf{9}',
120802: u'\\mathsf{0}',
120803: u'\\mathsf{1}',
120804: u'\\mathsf{2}',
120805: u'\\mathsf{3}',
120806: u'\\mathsf{4}',
120807: u'\\mathsf{5}',
120808: u'\\mathsf{6}',
120809: u'\\mathsf{7}',
120810: u'\\mathsf{8}',
120811: u'\\mathsf{9}',
120822: u'\\mathtt{0}',
120823: u'\\mathtt{1}',
120824: u'\\mathtt{2}',
120825: u'\\mathtt{3}',
120826: u'\\mathtt{4}',
120827: u'\\mathtt{5}',
120828: u'\\mathtt{6}',
120829: u'\\mathtt{7}',
120830: u'\\mathtt{8}',
120831: u'\\mathtt{9}',
}
                                                                                                                                                                                                                                                                                                                                          usr/local/lib/python2.7/dist-packages/docutils/utils/math/unichar2tex.pyc                           0100644 0000000 0000062 00000052536 13077704402 025124  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   sW  id  d 6d d 6d d 6d d 6d d	 6d
 d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d  d! 6d" d# 6d$ d% 6d& d' 6d( d) 6d* d+ 6d, d- 6d. d/ 6d0 d1 6d2 d3 6d4 d5 6d6 d7 6d8 d9 6d: d; 6d< d= 6d> d? 6d@ dA 6dB dC 6dD dE 6dF dG 6dH dI 6dJ dK 6dL dM 6dN dO 6dP dQ 6dR dS 6dT dU 6dV dW 6dX dY 6dZ d[ 6d\ d] 6d^ d_ 6d` da 6db dc 6dd de 6df dg 6dh di 6dj dk 6dl dm 6dn do 6dp dq 6dr ds 6dt du 6dv dw 6dx dy 6dz d{ 6d| d} 6d~ d 6d€ d 6d‚ dƒ 6d„ d… 6d† d‡ 6dˆ d‰ 6dŠ d‹ 6dŒ d 6d d 6d d‘ 6d’ d“ 6d” d• 6d– d— 6d˜ d™ 6dš d› 6dœ d 6d dŸ 6d  d¡ 6d¢ d£ 6d¤ d¥ 6d¦ d§ 6d¨ d© 6dª d« 6d¬ d­ 6d® d¯ 6d° d± 6d² d³ 6d´ dµ 6d¶ d· 6d¸ d¹ 6dº d» 6d¼ d½ 6d¾ d¿ 6dÀ dÁ 6dÂ dÃ 6dÄ dÅ 6dÆ dÇ 6dÈ dÉ 6dÊ dË 6dÌ dÍ 6dÎ dÏ 6dĞ dÑ 6dÒ dÓ 6dÔ dÕ 6dÖ d× 6dØ dÙ 6dÚ dÛ 6dÜ dİ 6dŞ dß 6dà dá 6dâ dã 6dä då 6dæ dç 6dè dé 6dê dë 6dì dí 6dî dï 6dğ dñ 6dò dó 6dô dõ 6dö d÷ 6dø dù 6dú dû 6dü dı 6dş dÿ 6d d6dd6dd6dd6dd	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6d d!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d>d?6d@dA6dBdC6dDdE6dFdG6dHdI6dJdK6dLdM6dNdO6dPdQ6dRdS6dTdU6dVdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dhdi6djdk6dldm6dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d|d}6d~d6d€d6d‚dƒ6d„d…6d†d‡6dˆd‰6dŠd‹6dŒd6dd6dd‘6d’d“6d”d•6d–d—6d˜d™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¤d¥6d¦d§6d¨d©6dªd«6d¬d­6d®d¯6d°d±6d²d³6d´dµ6d¶d·6d¸d¹6dºd»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6dødù6dúdû6düdı6dşdÿ6d d6dd6dd6dd6dd	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6d d!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d>d?6d@dA6dBdC6dDdE6dFdG6dHdI6dJdK6dLdM6dNdO6dPdQ6dRdS6dTdU6dVdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dhdi6djdk6dldm6dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d|d}6d~d6d€d6d‚dƒ6d„d…6d†d‡6dˆd‰6dŠd‹6dŒd6dd6dd‘6d’d“6d”d•6d–d—6d˜d™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¤d¥6d¦d§6d¨d©6dªd«6d¬d­6d®d¯6d°d±6d²d³6d´dµ6d¶d·6d¸d¹6dºd»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6dødù6dúdû6düdı6dşdÿ6d d6dd6dd6dd6dd	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6d d!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d>d?6d@dA6dBdC6dDdE6dFdG6dHdI6dJdK6dLdM6dNdO6dPdQ6dRdS6dTdU6dVdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dhdi6djdk6dldm6dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d|d}6d~d6d€d6d‚dƒ6d„d…6d†d‡6dˆd‰6dŠd‹6dŒd6dd6dd‘6d’d“6d”d•6d–d—6d˜d™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¤d¥6d¦d§6d¨d©6dªd«6d¬d­6d®d¯6d°d±6d²d³6d´dµ6d¶d·6d¸d¹6dºd»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6dødù6dúdû6düdı6dşdÿ6d d6dd6dd6dd6dd	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6d d!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d>d?6d@dA6dBdC6dDdE6dFdG6dHdI6dJdK6dLdM6dNdO6dPdQ6dRdS6dTdU6dVdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dhdi6djdk6dldm6dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d|d}6d~d6d€d6d‚dƒ6d„d…6d†d‡6dˆd‰6dŠd‹6dŒd6dd6dd‘6d’d“6d”d•6d–d—6d˜d™6dšd›6dœd6ddŸ6d d¡6d¢d£6d¤d¥6d¦d§6d¨d©6dªd«6d¬d­6d®d¯6d°d±6d²d³6d´dµ6d¶d·6d¸d¹6dºd»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6dødù6dúdû6düdı6dşdÿ6d d6dd6dd6dd6dd	6d
d6dd6dd6dd6dd6dd6dd6dd6dd6dd6dd6d d!6d"d#6d$d%6d&d'6d(d)6d*d+6d,d-6d.d/6d0d16d2d36d4d56d6d76d8d96d:d;6d<d=6d>d?6d@dA6dBdC6dDdE6dFdG6dHdI6dJdK6dLdM6dNdO6dPdQ6dRdS6dTdU6dVdW6dXdY6dZd[6d\d]6d^d_6d`da6dbdc6ddde6dfdg6dhdi6djdk6d dl6d dm6dndo6dpdq6drds6dtdu6dvdw6dxdy6dzd{6d|d}6d~d6d€d6d‚dƒ6d„d…6d†d‡6dˆd‰6dŠd‹6dŒd6dd6dd‘6d’d“6d”d•6d–d—6d˜d™6d, dš6d. d›6d0 dœ6d2 d6d4 d6d6 dŸ6d8 d 6d: d¡6d< d¢6d> d£6d@ d¤6dB d¥6dD d¦6dF d§6dH d¨6dJ d©6dL dª6dN d«6dP d¬6dR d­6dT d®6dV d¯6dX d°6dZ d±6d*d²6d³d´6d\ dµ6d¶d·6d^ d¸6d¹dº6d` d»6d¼d½6d¾d¿6dÀdÁ6dÂdÃ6dÄdÅ6dÆdÇ6dÈdÉ6dÊdË6dÌdÍ6dÎdÏ6dĞdÑ6dÒdÓ6dÔdÕ6dÖd×6dØdÙ6dÚdÛ6dÜdİ6dŞdß6dàdá6dâdã6dädå6dædç6dèdé6dêdë6dìdí6dîdï6dğdñ6dòdó6dôdõ6död÷6Z  døS(ù  u   ~i    u   \pounds i£   u   \yen i¥   u   \neg i¬   u
   \circledR i®   u   \pm i±   u   \times i×   u   \eth iğ   u   \div i÷   u   \imath i1  u   \jmath i7  u   \Gamma i“  u   \Delta i”  u   \Theta i˜  u   \Lambda i›  u   \Xi i  u   \Pi i   u   \Sigma i£  u	   \Upsilon i¥  u   \Phi i¦  u   \Psi i¨  u   \Omega i©  u   \alpha i±  u   \beta i²  u   \gamma i³  u   \delta i´  u   \varepsilon iµ  u   \zeta i¶  u   \eta i·  u   \theta i¸  u   \iota i¹  u   \kappa iº  u   \lambda i»  u   \mu i¼  u   \nu i½  u   \xi i¾  u   \pi iÀ  u   \rho iÁ  u
   \varsigma iÂ  u   \sigma iÃ  u   \tau iÄ  u	   \upsilon iÅ  u   \varphi iÆ  u   \chi iÇ  u   \psi iÈ  u   \omega iÉ  u
   \vartheta iÑ  u   \phi iÕ  u   \varpi iÖ  u	   \digamma iİ  u   \backepsilon iö  u   \quad i   u   \| i   u   \dagger i    u	   \ddagger i!   u   \ldots i&   u   \prime i2   u   \backprime i5   u   \: i_   u
   \mathbb{C}i!  u   \mathcal{H}i!  u   \mathfrak{H}i!  u
   \mathbb{H}i!  u   \hslash i!  u   \mathcal{I}i!  u   \Im i!  u   \mathcal{L}i!  u   \ell i!  u
   \mathbb{N}i!  u   \wp i!  u
   \mathbb{P}i!  u
   \mathbb{Q}i!  u   \mathcal{R}i!  u   \Re i!  u
   \mathbb{R}i!  u
   \mathbb{Z}i$!  u   \mho i'!  u   \mathfrak{Z}i(!  u   \mathcal{B}i,!  u   \mathfrak{C}i-!  u   \mathcal{E}i0!  u   \mathcal{F}i1!  u   \Finv i2!  u   \mathcal{M}i3!  u   \aleph i5!  u   \beth i6!  u   \gimel i7!  u   \daleth i8!  u   \leftarrow i!  u	   \uparrow i‘!  u   \rightarrow i’!  u   \downarrow i“!  u   \leftrightarrow i”!  u   \updownarrow i•!  u	   \nwarrow i–!  u	   \nearrow i—!  u	   \searrow i˜!  u	   \swarrow i™!  u   \nleftarrow iš!  u   \nrightarrow i›!  u   \twoheadleftarrow i!  u   \twoheadrightarrow i !  u   \leftarrowtail i¢!  u   \rightarrowtail i£!  u   \mapsto i¦!  u   \hookleftarrow i©!  u   \hookrightarrow iª!  u   \looparrowleft i«!  u   \looparrowright i¬!  u   \leftrightsquigarrow i­!  u   \nleftrightarrow i®!  u   \Lsh i°!  u   \Rsh i±!  u   \curvearrowleft i¶!  u   \curvearrowright i·!  u   \circlearrowleft iº!  u   \circlearrowright i»!  u   \leftharpoonup i¼!  u   \leftharpoondown i½!  u   \upharpoonright i¾!  u   \upharpoonleft i¿!  u   \rightharpoonup iÀ!  u   \rightharpoondown iÁ!  u   \downharpoonright iÂ!  u   \downharpoonleft iÃ!  u   \rightleftarrows iÄ!  u   \leftrightarrows iÆ!  u   \leftleftarrows iÇ!  u   \upuparrows iÈ!  u   \rightrightarrows iÉ!  u   \downdownarrows iÊ!  u   \leftrightharpoons iË!  u   \rightleftharpoons iÌ!  u   \nLeftarrow iÍ!  u   \nLeftrightarrow iÎ!  u   \nRightarrow iÏ!  u   \Leftarrow iĞ!  u	   \Uparrow iÑ!  u   \Rightarrow iÒ!  u   \Downarrow iÓ!  u   \Leftrightarrow iÔ!  u   \Updownarrow iÕ!  u   \Lleftarrow iÚ!  u   \Rrightarrow iÛ!  u   \rightsquigarrow iİ!  u   \dashleftarrow ià!  u   \dashrightarrow iâ!  u   \forall i "  u   \complement i"  u	   \partial i"  u   \exists i"  u	   \nexists i"  u   \varnothing i"  u   \nabla i"  u   \in i"  u   \notin i	"  u   \ni i"  u   \prod i"  u   \coprod i"  u   \sum i"  u   -i"  u   \mp i"  u	   \dotplus i"  u   \slash i"  u   \smallsetminus i"  u   \ast i"  u   \circ i"  u   \bullet i"  u   \sqrt i"  u	   \sqrt[3] i"  u	   \sqrt[4] i"  u   \propto i"  u   \infty i"  u   \angle i "  u   \measuredangle i!"  u   \sphericalangle i""  u   \mid i#"  u   \nmid i$"  u
   \parallel i%"  u   \nparallel i&"  u   \wedge i'"  u   \vee i("  u   \cap i)"  u   \cup i*"  u   \int i+"  u   \iint i,"  u   \iiint i-"  u   \oint i."  u   \therefore i4"  u	   \because i5"  u   :i6"  u   \sim i<"  u	   \backsim i="  u   \wr i@"  u   \nsim iA"  u   \eqsim iB"  u   \simeq iC"  u   \cong iE"  u   \ncong iG"  u   \approx iH"  u
   \approxeq iJ"  u   \asymp iM"  u   \Bumpeq iN"  u   \bumpeq iO"  u   \doteq iP"  u   \Doteq iQ"  u   \fallingdotseq iR"  u   \risingdotseq iS"  u   \eqcirc iV"  u   \circeq iW"  u   \triangleq i\"  u   \neq i`"  u   \equiv ia"  u   \leq id"  u   \geq ie"  u   \leqq if"  u   \geqq ig"  u   \lneqq ih"  u   \gneqq ii"  u   \ll ij"  u   \gg ik"  u	   \between il"  u   \nless in"  u   \ngtr io"  u   \nleq ip"  u   \ngeq iq"  u	   \lesssim ir"  u   \gtrsim is"  u	   \lessgtr iv"  u	   \gtrless iw"  u   \prec iz"  u   \succ i{"  u   \preccurlyeq i|"  u   \succcurlyeq i}"  u	   \precsim i~"  u	   \succsim i"  u   \nprec i€"  u   \nsucc i"  u   \subset i‚"  u   \supset iƒ"  u
   \subseteq i†"  u
   \supseteq i‡"  u   \nsubseteq iˆ"  u   \nsupseteq i‰"  u   \subsetneq iŠ"  u   \supsetneq i‹"  u   \uplus i"  u
   \sqsubset i"  u
   \sqsupset i"  u   \sqsubseteq i‘"  u   \sqsupseteq i’"  u   \sqcap i“"  u   \sqcup i”"  u   \oplus i•"  u   \ominus i–"  u   \otimes i—"  u   \oslash i˜"  u   \odot i™"  u   \circledcirc iš"  u   \circledast i›"  u   \circleddash i"  u	   \boxplus i"  u
   \boxminus iŸ"  u
   \boxtimes i "  u   \boxdot i¡"  u   \vdash i¢"  u   \dashv i£"  u   \top i¤"  u   \bot i¥"  u   \models i§"  u   \vDash i¨"  u   \Vdash i©"  u   \Vvdash iª"  u   \nvdash i¬"  u   \nvDash i­"  u   \nVdash i®"  u   \nVDash i¯"  u   \vartriangleleft i²"  u   \vartriangleright i³"  u   \trianglelefteq i´"  u   \trianglerighteq iµ"  u
   \multimap i¸"  u
   \intercal iº"  u   \veebar i»"  u
   \barwedge i¼"  u
   \bigwedge iÀ"  u   \bigvee iÁ"  u   \bigcap iÂ"  u   \bigcup iÃ"  u	   \diamond iÄ"  u   \cdot iÅ"  u   \star iÆ"  u   \divideontimes iÇ"  u   \bowtie iÈ"  u   \ltimes iÉ"  u   \rtimes iÊ"  u   \leftthreetimes iË"  u   \rightthreetimes iÌ"  u   \backsimeq iÍ"  u
   \curlyvee iÎ"  u   \curlywedge iÏ"  u   \Subset iĞ"  u   \Supset iÑ"  u   \Cap iÒ"  u   \Cup iÓ"  u   \pitchfork iÔ"  u	   \lessdot iÖ"  u   \gtrdot i×"  u   \lll iØ"  u   \ggg iÙ"  u   \lesseqgtr iÚ"  u   \gtreqless iÛ"  u   \curlyeqprec iŞ"  u   \curlyeqsucc iß"  u	   \npreceq ià"  u	   \nsucceq iá"  u   \lnsim iæ"  u   \gnsim iç"  u
   \precnsim iè"  u
   \succnsim ié"  u   \ntriangleleft iê"  u   \ntriangleright ië"  u   \ntrianglelefteq iì"  u   \ntrianglerighteq ií"  u   \vdots iî"  u   \cdots iï"  u   \ddots iñ"  u   \lceil i#  u   \rceil i	#  u   \lfloor i
#  u   \rfloor i#  u
   \ulcorner i#  u
   \urcorner i#  u
   \llcorner i#  u
   \lrcorner i#  u   \frown i"#  u   \smile i##  u   \overbrace iŞ#  u   \underbrace iß#  u   \bigtriangleup i³%  u   \rhd i·%  u   \bigtriangledown i½%  u   \lhd iÁ%  u	   \Diamond iÇ%  u	   \lozenge iÊ%  u   \square iû%  u   \blacksquare iü%  u	   \bigstar i&  u   \spadesuit i`&  u   \heartsuit ia&  u   \diamondsuit ib&  u
   \clubsuit ic&  u   \flat im&  u	   \natural in&  u   \sharp io&  u   \checkmark i'  u	   \maltese i '  u   \perp iÂ'  u   \langle iè'  u   \rangle ié'  u   \lgroup iî'  u   \rgroup iï'  u   \longleftarrow iõ'  u   \longrightarrow iö'  u   \longleftrightarrow i÷'  u   \Longleftarrow iø'  u   \Longrightarrow iù'  u   \Longleftrightarrow iú'  u   \longmapsto iü'  u   \blacklozenge ië)  u
   \setminus iõ)  u	   \bigodot i *  u
   \bigoplus i*  u   \bigotimes i*  u
   \biguplus i*  u
   \bigsqcup i*  u   \iiiint i*  u   \Join i*  u   \amalg i?*  u   \doublebarwedge i^*  u
   \leqslant i}*  u
   \geqslant i~*  u   \lessapprox i…*  u   \gtrapprox i†*  u   \lneq i‡*  u   \gneq iˆ*  u
   \lnapprox i‰*  u
   \gnapprox iŠ*  u   \lesseqqgtr i‹*  u   \gtreqqless iŒ*  u   \eqslantless i•*  u   \eqslantgtr i–*  u   \preceq i¯*  u   \succeq i°*  u   \precapprox i·*  u   \succapprox i¸*  u   \precnapprox i¹*  u   \succnapprox iº*  u   \subseteqq iÅ*  u   \supseteqq iÆ*  u   \subsetneqq iË*  u   \supsetneqq iÌ*  u
   \mathbf{A}i Ô u
   \mathbf{B}iÔ u
   \mathbf{C}iÔ u
   \mathbf{D}iÔ u
   \mathbf{E}iÔ u
   \mathbf{F}iÔ u
   \mathbf{G}iÔ u
   \mathbf{H}iÔ u
   \mathbf{I}iÔ u
   \mathbf{J}i	Ô u
   \mathbf{K}i
Ô u
   \mathbf{L}iÔ u
   \mathbf{M}iÔ u
   \mathbf{N}iÔ u
   \mathbf{O}iÔ u
   \mathbf{P}iÔ u
   \mathbf{Q}iÔ u
   \mathbf{R}iÔ u
   \mathbf{S}iÔ u
   \mathbf{T}iÔ u
   \mathbf{U}iÔ u
   \mathbf{V}iÔ u
   \mathbf{W}iÔ u
   \mathbf{X}iÔ u
   \mathbf{Y}iÔ u
   \mathbf{Z}iÔ u
   \mathbf{a}iÔ u
   \mathbf{b}iÔ u
   \mathbf{c}iÔ u
   \mathbf{d}iÔ u
   \mathbf{e}iÔ u
   \mathbf{f}iÔ u
   \mathbf{g}i Ô u
   \mathbf{h}i!Ô u
   \mathbf{i}i"Ô u
   \mathbf{j}i#Ô u
   \mathbf{k}i$Ô u
   \mathbf{l}i%Ô u
   \mathbf{m}i&Ô u
   \mathbf{n}i'Ô u
   \mathbf{o}i(Ô u
   \mathbf{p}i)Ô u
   \mathbf{q}i*Ô u
   \mathbf{r}i+Ô u
   \mathbf{s}i,Ô u
   \mathbf{t}i-Ô u
   \mathbf{u}i.Ô u
   \mathbf{v}i/Ô u
   \mathbf{w}i0Ô u
   \mathbf{x}i1Ô u
   \mathbf{y}i2Ô u
   \mathbf{z}i3Ô u   Ai4Ô u   Bi5Ô u   Ci6Ô u   Di7Ô u   Ei8Ô u   Fi9Ô u   Gi:Ô u   Hi;Ô u   Ii<Ô u   Ji=Ô u   Ki>Ô u   Li?Ô u   Mi@Ô u   NiAÔ u   OiBÔ u   PiCÔ u   QiDÔ u   RiEÔ u   SiFÔ u   TiGÔ u   UiHÔ u   ViIÔ u   WiJÔ u   XiKÔ u   YiLÔ u   ZiMÔ u   aiNÔ u   biOÔ u   ciPÔ u   diQÔ u   eiRÔ u   fiSÔ u   giTÔ u   iiVÔ u   jiWÔ u   kiXÔ u   liYÔ u   miZÔ u   ni[Ô u   oi\Ô u   pi]Ô u   qi^Ô u   ri_Ô u   si`Ô u   tiaÔ u   uibÔ u   vicÔ u   widÔ u   xieÔ u   yifÔ u   zigÔ u   \mathcal{A}iœÔ u   \mathcal{C}iÔ u   \mathcal{D}iŸÔ u   \mathcal{G}i¢Ô u   \mathcal{J}i¥Ô u   \mathcal{K}i¦Ô u   \mathcal{N}i©Ô u   \mathcal{O}iªÔ u   \mathcal{P}i«Ô u   \mathcal{Q}i¬Ô u   \mathcal{S}i®Ô u   \mathcal{T}i¯Ô u   \mathcal{U}i°Ô u   \mathcal{V}i±Ô u   \mathcal{W}i²Ô u   \mathcal{X}i³Ô u   \mathcal{Y}i´Ô u   \mathcal{Z}iµÔ u   \mathfrak{A}iÕ u   \mathfrak{B}iÕ u   \mathfrak{D}iÕ u   \mathfrak{E}iÕ u   \mathfrak{F}i	Õ u   \mathfrak{G}i
Õ u   \mathfrak{J}iÕ u   \mathfrak{K}iÕ u   \mathfrak{L}iÕ u   \mathfrak{M}iÕ u   \mathfrak{N}iÕ u   \mathfrak{O}iÕ u   \mathfrak{P}iÕ u   \mathfrak{Q}iÕ u   \mathfrak{S}iÕ u   \mathfrak{T}iÕ u   \mathfrak{U}iÕ u   \mathfrak{V}iÕ u   \mathfrak{W}iÕ u   \mathfrak{X}iÕ u   \mathfrak{Y}iÕ u   \mathfrak{a}iÕ u   \mathfrak{b}iÕ u   \mathfrak{c}i Õ u   \mathfrak{d}i!Õ u   \mathfrak{e}i"Õ u   \mathfrak{f}i#Õ u   \mathfrak{g}i$Õ u   \mathfrak{h}i%Õ u   \mathfrak{i}i&Õ u   \mathfrak{j}i'Õ u   \mathfrak{k}i(Õ u   \mathfrak{l}i)Õ u   \mathfrak{m}i*Õ u   \mathfrak{n}i+Õ u   \mathfrak{o}i,Õ u   \mathfrak{p}i-Õ u   \mathfrak{q}i.Õ u   \mathfrak{r}i/Õ u   \mathfrak{s}i0Õ u   \mathfrak{t}i1Õ u   \mathfrak{u}i2Õ u   \mathfrak{v}i3Õ u   \mathfrak{w}i4Õ u   \mathfrak{x}i5Õ u   \mathfrak{y}i6Õ u   \mathfrak{z}i7Õ u
   \mathbb{A}i8Õ u
   \mathbb{B}i9Õ u
   \mathbb{D}i;Õ u
   \mathbb{E}i<Õ u
   \mathbb{F}i=Õ u
   \mathbb{G}i>Õ u
   \mathbb{I}i@Õ u
   \mathbb{J}iAÕ u
   \mathbb{K}iBÕ u
   \mathbb{L}iCÕ u
   \mathbb{M}iDÕ u
   \mathbb{O}iFÕ u
   \mathbb{S}iJÕ u
   \mathbb{T}iKÕ u
   \mathbb{U}iLÕ u
   \mathbb{V}iMÕ u
   \mathbb{W}iNÕ u
   \mathbb{X}iOÕ u
   \mathbb{Y}iPÕ u   \Bbbk i\Õ u
   \mathsf{A}i Õ u
   \mathsf{B}i¡Õ u
   \mathsf{C}i¢Õ u
   \mathsf{D}i£Õ u
   \mathsf{E}i¤Õ u
   \mathsf{F}i¥Õ u
   \mathsf{G}i¦Õ u
   \mathsf{H}i§Õ u
   \mathsf{I}i¨Õ u
   \mathsf{J}i©Õ u
   \mathsf{K}iªÕ u
   \mathsf{L}i«Õ u
   \mathsf{M}i¬Õ u
   \mathsf{N}i­Õ u
   \mathsf{O}i®Õ u
   \mathsf{P}i¯Õ u
   \mathsf{Q}i°Õ u
   \mathsf{R}i±Õ u
   \mathsf{S}i²Õ u
   \mathsf{T}i³Õ u
   \mathsf{U}i´Õ u
   \mathsf{V}iµÕ u
   \mathsf{W}i¶Õ u
   \mathsf{X}i·Õ u
   \mathsf{Y}i¸Õ u
   \mathsf{Z}i¹Õ u
   \mathsf{a}iºÕ u
   \mathsf{b}i»Õ u
   \mathsf{c}i¼Õ u
   \mathsf{d}i½Õ u
   \mathsf{e}i¾Õ u
   \mathsf{f}i¿Õ u
   \mathsf{g}iÀÕ u
   \mathsf{h}iÁÕ u
   \mathsf{i}iÂÕ u
   \mathsf{j}iÃÕ u
   \mathsf{k}iÄÕ u
   \mathsf{l}iÅÕ u
   \mathsf{m}iÆÕ u
   \mathsf{n}iÇÕ u
   \mathsf{o}iÈÕ u
   \mathsf{p}iÉÕ u
   \mathsf{q}iÊÕ u
   \mathsf{r}iËÕ u
   \mathsf{s}iÌÕ u
   \mathsf{t}iÍÕ u
   \mathsf{u}iÎÕ u
   \mathsf{v}iÏÕ u
   \mathsf{w}iĞÕ u
   \mathsf{x}iÑÕ u
   \mathsf{y}iÒÕ u
   \mathsf{z}iÓÕ u
   \mathtt{A}ipÖ u
   \mathtt{B}iqÖ u
   \mathtt{C}irÖ u
   \mathtt{D}isÖ u
   \mathtt{E}itÖ u
   \mathtt{F}iuÖ u
   \mathtt{G}ivÖ u
   \mathtt{H}iwÖ u
   \mathtt{I}ixÖ u
   \mathtt{J}iyÖ u
   \mathtt{K}izÖ u
   \mathtt{L}i{Ö u
   \mathtt{M}i|Ö u
   \mathtt{N}i}Ö u
   \mathtt{O}i~Ö u
   \mathtt{P}iÖ u
   \mathtt{Q}i€Ö u
   \mathtt{R}iÖ u
   \mathtt{S}i‚Ö u
   \mathtt{T}iƒÖ u
   \mathtt{U}i„Ö u
   \mathtt{V}i…Ö u
   \mathtt{W}i†Ö u
   \mathtt{X}i‡Ö u
   \mathtt{Y}iˆÖ u
   \mathtt{Z}i‰Ö u
   \mathtt{a}iŠÖ u
   \mathtt{b}i‹Ö u
   \mathtt{c}iŒÖ u
   \mathtt{d}iÖ u
   \mathtt{e}iÖ u
   \mathtt{f}iÖ u
   \mathtt{g}iÖ u
   \mathtt{h}i‘Ö u
   \mathtt{i}i’Ö u
   \mathtt{j}i“Ö u
   \mathtt{k}i”Ö u
   \mathtt{l}i•Ö u
   \mathtt{m}i–Ö u
   \mathtt{n}i—Ö u
   \mathtt{o}i˜Ö u
   \mathtt{p}i™Ö u
   \mathtt{q}išÖ u
   \mathtt{r}i›Ö u
   \mathtt{s}iœÖ u
   \mathtt{t}iÖ u
   \mathtt{u}iÖ u
   \mathtt{v}iŸÖ u
   \mathtt{w}i Ö u
   \mathtt{x}i¡Ö u
   \mathtt{y}i¢Ö u
   \mathtt{z}i£Ö i¤Ö i¥Ö u   \mathbf{\Gamma}iªÖ u   \mathbf{\Delta}i«Ö u   \mathbf{\Theta}i¯Ö u   \mathbf{\Lambda}i²Ö u   \mathbf{\Xi}iµÖ u   \mathbf{\Pi}i·Ö u   \mathbf{\Sigma}iºÖ u   \mathbf{\Upsilon}i¼Ö u   \mathbf{\Phi}i½Ö u   \mathbf{\Psi}i¿Ö u   \mathbf{\Omega}iÀÖ u   \mathit{\Gamma}iäÖ u   \mathit{\Delta}iåÖ u   \mathit{\Theta}iéÖ u   \mathit{\Lambda}iìÖ u   \mathit{\Xi}iïÖ u   \mathit{\Pi}iñÖ u   \mathit{\Sigma}iôÖ u   \mathit{\Upsilon}iöÖ u   \mathit{\Phi}i÷Ö u   \mathit{\Psi}iùÖ u   \mathit{\Omega}iúÖ iüÖ iıÖ işÖ iÿÖ i × i× i× i× i× i× i× i× i× i	× i× i× i× i× i× i× i× i× i× i× i× u	   \epsilon i× i× u
   \varkappa i× i× u   \varrho i× i× u
   \mathbf{0}iÎ× u
   \mathbf{1}iÏ× u
   \mathbf{2}iĞ× u
   \mathbf{3}iÑ× u
   \mathbf{4}iÒ× u
   \mathbf{5}iÓ× u
   \mathbf{6}iÔ× u
   \mathbf{7}iÕ× u
   \mathbf{8}iÖ× u
   \mathbf{9}i×× u
   \mathsf{0}iâ× u
   \mathsf{1}iã× u
   \mathsf{2}iä× u
   \mathsf{3}iå× u
   \mathsf{4}iæ× u
   \mathsf{5}iç× u
   \mathsf{6}iè× u
   \mathsf{7}ié× u
   \mathsf{8}iê× u
   \mathsf{9}ië× u
   \mathtt{0}iö× u
   \mathtt{1}i÷× u
   \mathtt{2}iø× u
   \mathtt{3}iù× u
   \mathtt{4}iú× u
   \mathtt{5}iû× u
   \mathtt{6}iü× u
   \mathtt{7}iı× u
   \mathtt{8}iş× u
   \mathtt{9}iÿ× N(   t   uni2tex_table(    (    (    sA   /tmp/pip-build-awuatQ/docutils/docutils/utils/math/unichar2tex.pyt   <module>   s                                                                                                                                                                    usr/local/lib/python2.7/dist-packages/docutils/utils/punctuation_chars.py                           0100644 0000000 0000062 00000034453 13077704374 025333  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        #!/usr/bin/env python
# -*- coding: utf-8 -*-
# :Copyright: Â© 2011 GÃ¼nter Milde.
# :License: Released under the terms of the `2-Clause BSD license`_, in short:
#
#    Copying and distribution of this file, with or without modification,
#    are permitted in any medium without royalty provided the copyright
#    notice and this notice are preserved.
#    This file is offered as-is, without any warranty.
#
# .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause

# :Id: $Id: punctuation_chars.py 7668 2013-06-04 12:46:30Z milde $

import sys, re
import unicodedata

# punctuation characters around inline markup
# ===========================================
#
# This module provides the lists of characters for the implementation of
# the `inline markup recognition rules`_ in the reStructuredText parser
# (states.py)
#
# .. _inline markup recognition rules:
#     ../../docs/ref/rst/restructuredtext.html#inline-markup

# Docutils punctuation category sample strings
# --------------------------------------------
#
# The sample strings are generated by punctuation_samples() and put here
# literal to avoid the time-consuming generation with every Docutils run.
# As the samples are used inside ``[ ]`` in regular expressions, hyphen and
# square brackets are escaped. ::

openers = (u'"\'(<\\[{\u0f3a\u0f3c\u169b\u2045\u207d\u208d\u2329\u2768'
           u'\u276a\u276c\u276e\u2770\u2772\u2774\u27c5\u27e6\u27e8\u27ea'
           u'\u27ec\u27ee\u2983\u2985\u2987\u2989\u298b\u298d\u298f\u2991'
           u'\u2993\u2995\u2997\u29d8\u29da\u29fc\u2e22\u2e24\u2e26\u2e28'
           u'\u3008\u300a\u300c\u300e\u3010\u3014\u3016\u3018\u301a\u301d'
           u'\u301d\ufd3e\ufe17\ufe35\ufe37\ufe39\ufe3b\ufe3d\ufe3f\ufe41'
           u'\ufe43\ufe47\ufe59\ufe5b\ufe5d\uff08\uff3b\uff5b\uff5f\uff62'
           u'\xab\u2018\u201c\u2039\u2e02\u2e04\u2e09\u2e0c\u2e1c\u2e20'
           u'\u201a\u201e\xbb\u2019\u201d\u203a\u2e03\u2e05\u2e0a\u2e0d'
           u'\u2e1d\u2e21\u201b\u201f')
closers = (u'"\')>\\]}\u0f3b\u0f3d\u169c\u2046\u207e\u208e\u232a\u2769'
           u'\u276b\u276d\u276f\u2771\u2773\u2775\u27c6\u27e7\u27e9\u27eb'
           u'\u27ed\u27ef\u2984\u2986\u2988\u298a\u298c\u298e\u2990\u2992'
           u'\u2994\u2996\u2998\u29d9\u29db\u29fd\u2e23\u2e25\u2e27\u2e29'
           u'\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e'
           u'\u301f\ufd3f\ufe18\ufe36\ufe38\ufe3a\ufe3c\ufe3e\ufe40\ufe42'
           u'\ufe44\ufe48\ufe5a\ufe5c\ufe5e\uff09\uff3d\uff5d\uff60\uff63'
           u'\xbb\u2019\u201d\u203a\u2e03\u2e05\u2e0a\u2e0d\u2e1d\u2e21'
           u'\u201b\u201f\xab\u2018\u201c\u2039\u2e02\u2e04\u2e09\u2e0c'
           u'\u2e1c\u2e20\u201a\u201e')
delimiters = (u'\\-/:\u058a\xa1\xb7\xbf\u037e\u0387\u055a-\u055f\u0589'
              u'\u05be\u05c0\u05c3\u05c6\u05f3\u05f4\u0609\u060a\u060c'
              u'\u060d\u061b\u061e\u061f\u066a-\u066d\u06d4\u0700-\u070d'
              u'\u07f7-\u07f9\u0830-\u083e\u0964\u0965\u0970\u0df4\u0e4f'
              u'\u0e5a\u0e5b\u0f04-\u0f12\u0f85\u0fd0-\u0fd4\u104a-\u104f'
              u'\u10fb\u1361-\u1368\u1400\u166d\u166e\u16eb-\u16ed\u1735'
              u'\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944\u1945'
              u'\u19de\u19df\u1a1e\u1a1f\u1aa0-\u1aa6\u1aa8-\u1aad\u1b5a-'
              u'\u1b60\u1c3b-\u1c3f\u1c7e\u1c7f\u1cd3\u2010-\u2017\u2020-'
              u'\u2027\u2030-\u2038\u203b-\u203e\u2041-\u2043\u2047-'
              u'\u2051\u2053\u2055-\u205e\u2cf9-\u2cfc\u2cfe\u2cff\u2e00'
              u'\u2e01\u2e06-\u2e08\u2e0b\u2e0e-\u2e1b\u2e1e\u2e1f\u2e2a-'
              u'\u2e2e\u2e30\u2e31\u3001-\u3003\u301c\u3030\u303d\u30a0'
              u'\u30fb\ua4fe\ua4ff\ua60d-\ua60f\ua673\ua67e\ua6f2-\ua6f7'
              u'\ua874-\ua877\ua8ce\ua8cf\ua8f8-\ua8fa\ua92e\ua92f\ua95f'
              u'\ua9c1-\ua9cd\ua9de\ua9df\uaa5c-\uaa5f\uaade\uaadf\uabeb'
              u'\ufe10-\ufe16\ufe19\ufe30-\ufe32\ufe45\ufe46\ufe49-\ufe4c'
              u'\ufe50-\ufe52\ufe54-\ufe58\ufe5f-\ufe61\ufe63\ufe68\ufe6a'
              u'\ufe6b\uff01-\uff03\uff05-\uff07\uff0a\uff0c-\uff0f\uff1a'
              u'\uff1b\uff1f\uff20\uff3c\uff61\uff64\uff65')
if sys.maxunicode >= 0x10FFFF: # "wide" build
    delimiters += (u'\U00010100\U00010101\U0001039f\U000103d0\U00010857'
                   u'\U0001091f\U0001093f\U00010a50-\U00010a58\U00010a7f'
                   u'\U00010b39-\U00010b3f\U000110bb\U000110bc\U000110be-'
                   u'\U000110c1\U00012470-\U00012473')
closing_delimiters = u'\\\\.,;!?'


# Matching open/close quotes
# --------------------------

# Rule (5) requires determination of matching open/close pairs. However,
# the pairing of open/close quotes is ambigue due to  different typographic
# conventions in different languages.

quote_pairs = {u'\xbb': u'\xbb', # Swedish
            u'\u2018': u'\u201a', # Greek
            u'\u2019': u'\u2019', # Swedish
            u'\u201a': u'\u2018\u2019', # German, Polish
            u'\u201c': u'\u201e', # German
            u'\u201e': u'\u201c\u201d',
            u'\u201d': u'\u201d', # Swedish
            u'\u203a': u'\u203a', # Swedish
            }

def match_chars(c1, c2):
    try:
        i = openers.index(c1)
    except ValueError:  # c1 not in openers
        return False
    return c2 == closers[i] or c2 in quote_pairs.get(c1, '')


# Running this file as a standalone module checks the definitions against a
# re-calculation::

if __name__ == '__main__':


# Unicode punctuation character categories
# ----------------------------------------

    unicode_punctuation_categories = {
        # 'Pc': 'Connector', # not used in Docutils inline markup recognition
        'Pd': 'Dash',
        'Ps': 'Open',
        'Pe': 'Close',
        'Pi': 'Initial quote', # may behave like Ps or Pe depending on usage
        'Pf': 'Final quote', # may behave like Ps or Pe depending on usage
        'Po': 'Other'
        }
    """Unicode character categories for punctuation"""


# generate character pattern strings
# ==================================

    def unicode_charlists(categories, cp_min=0, cp_max=None):
        """Return dictionary of Unicode character lists.

        For each of the `catagories`, an item contains a list with all Unicode
        characters with `cp_min` <= code-point <= `cp_max` that belong to
        the category.

        The default values check every code-point supported by Python
        (`sys.maxint` is 0x10FFFF in a "wide" build and 0xFFFF in a "narrow"
        build, i.e. ucs4 and ucs2 respectively).
        """
        # Determine highest code point with one of the given categories
        # (may shorten the search time considerably if there are many
        # categories with not too high characters):
        if cp_max is None:
            cp_max = max(x for x in xrange(sys.maxunicode+1)
                        if unicodedata.category(unichr(x)) in categories)
            # print cp_max # => 74867 for unicode_punctuation_categories
        charlists = {}
        for cat in categories:
            charlists[cat] = [unichr(x) for x in xrange(cp_min, cp_max+1)
                              if unicodedata.category(unichr(x)) == cat]
        return charlists


# Character categories in Docutils
# --------------------------------

    def punctuation_samples():

        """Docutils punctuation category sample strings.

        Return list of sample strings for the categories "Open", "Close",
        "Delimiters" and "Closing-Delimiters" used in the `inline markup
        recognition rules`_.
        """

        # Lists with characters in Unicode punctuation character categories
        cp_min = 160 # ASCII chars have special rules for backwards compatibility
        ucharlists = unicode_charlists(unicode_punctuation_categories, cp_min)

        # match opening/closing characters
        # --------------------------------
        # Rearange the lists to ensure matching characters at the same
        # index position.

        # low quotation marks are also used as closers (e.g. in Greek)
        # move them to category Pi:
        ucharlists['Ps'].remove(u'â€š') # 201A  SINGLE LOW-9 QUOTATION MARK
        ucharlists['Ps'].remove(u'â€') # 201E  DOUBLE LOW-9 QUOTATION MARK
        ucharlists['Pi'] += [u'â€š', u'â€']

        ucharlists['Pi'].remove(u'â€›') # 201B  SINGLE HIGH-REVERSED-9 QUOTATION MARK
        ucharlists['Pi'].remove(u'â€Ÿ') # 201F  DOUBLE HIGH-REVERSED-9 QUOTATION MARK
        ucharlists['Pf'] += [u'â€›', u'â€Ÿ']

        # 301F  LOW DOUBLE PRIME QUOTATION MARK misses the opening pendant:
        ucharlists['Ps'].insert(ucharlists['Pe'].index(u'\u301f'), u'\u301d')

        # print u''.join(ucharlists['Ps']).encode('utf8')
        # print u''.join(ucharlists['Pe']).encode('utf8')
        # print u''.join(ucharlists['Pi']).encode('utf8')
        # print u''.join(ucharlists['Pf']).encode('utf8')

        # The Docutils character categories
        # ---------------------------------
        #
        # The categorization of ASCII chars is non-standard to reduce
        # both false positives and need for escaping. (see `inline markup
        # recognition rules`_)

        # allowed before markup if there is a matching closer
        openers = [u'"\'(<\\[{']
        for cat in ('Ps', 'Pi', 'Pf'):
            openers.extend(ucharlists[cat])

        # allowed after markup if there is a matching opener
        closers = [u'"\')>\\]}']
        for cat in ('Pe', 'Pf', 'Pi'):
            closers.extend(ucharlists[cat])

        # non-matching, allowed on both sides
        delimiters = [u'\\-/:']
        for cat in ('Pd', 'Po'):
            delimiters.extend(ucharlists[cat])

        # non-matching, after markup
        closing_delimiters = [r'\\.,;!?']

        # # Test open/close matching:
        # for i in range(min(len(openers),len(closers))):
        #     print '%4d    %s    %s' % (i, openers[i].encode('utf8'),
        #                                closers[i].encode('utf8'))

        return [u''.join(chars) for chars in (openers, closers, delimiters,
                                              closing_delimiters)]

    def separate_wide_chars(s):
        """Return (s1,s2) with characters above 0xFFFF in s2"""
        maxunicode_narrow = 0xFFFF
        l1 = [ch for ch in s if ord(ch) <= maxunicode_narrow]
        l2 = [ch for ch in s if ord(ch) > maxunicode_narrow]
        return ''.join(l1), ''.join(l2)

    def mark_intervals(s):
        """Return s with shortcut notation for runs of consecutive characters

        Sort string and replace 'cdef' by 'c-f' and similar.
        """
        l =[]
        s = [ord(ch) for ch in s]
        s.sort()
        for n in s:
            try:
                if l[-1][-1]+1 == n:
                    l[-1].append(n)
                else:
                    l.append([n])
            except IndexError:
                l.append([n])

        l2 = []
        for i in l:
            i = [unichr(n) for n in i]
            if len(i) > 2:
                i = i[0], u'-', i[-1]
            l2.extend(i)

        return ''.join(l2)

    def wrap_string(s, startstring= "(",
                       endstring = ")", wrap=65):
        """Line-wrap a unicode string literal definition."""
        c = len(startstring)
        contstring = "'\n" + ' ' * len(startstring) + "u'"
        l = [startstring]
        for ch in s:
            c += 1
            if ch == '\\' and c > wrap:
                c = len(startstring)
                ch = contstring + ch
            l.append(ch)
        l.append(endstring)
        return ''.join(l)


# print results
# =============

# (re) create and compare the samples:

    (o, c, d, cd) = punctuation_samples()
    o, o_wide = separate_wide_chars(o)
    c, c_wide = separate_wide_chars(c)
    d, d_wide = separate_wide_chars(d)
    d = d[:5] + mark_intervals(d[5:])
    d_wide = mark_intervals(d_wide)
    if sys.maxunicode >= 0x10FFFF: # "wide" build
        d += d_wide
    if o != openers:
        print '- openers = ur"""%s"""' % openers.encode('utf8')
        print '+ openers = ur"""%s"""' % o.encode('utf8')
    if o_wide:
        print '+ openers-wide = ur"""%s"""' % o_wide.encode('utf8')
    if c != closers:
        print '- closers = ur"""%s"""' % closers.encode('utf8')
        print '+ closers = ur"""%s"""' % c.encode('utf8')
    if c_wide:
        print '+ closers-wide = ur"""%s"""' % c_wide.encode('utf8')
    if d != delimiters:
        print '- delimiters = ur"%s"' % delimiters.encode('utf8')
        print '+ delimiters = ur"%s"' % d.encode('utf8')
    if cd != closing_delimiters:
        print '- closing_delimiters = ur"%s"' % closing_delimiters.encode('utf8')
        print '+ closing_delimiters = ur"%s"' % cd.encode('utf8')
    # closing_delimiters are all ASCII characters

# Print literal code to define the character sets:

    # `openers` and `closers` must be verbose and keep order because they are
    # also used in `match_chars()`.
    print wrap_string(repr(o), startstring='openers = (')
    print wrap_string(repr(c), startstring='closers = (')
    # delimiters: sort and use shortcut for intervals (saves ~150 characters):
    print wrap_string(repr(d), startstring='delimiters = (')
    # add characters in the upper plane only in a "wide" build:
    print 'if sys.maxunicode >= 0x10FFFF: # "wide" build'
    print wrap_string(repr(d_wide), startstring='    delimiters += (')
    print 'closing_delimiters =', repr(cd)

# test prints

    # print "wide" Unicode characters:
    # ucharlists = unicode_charlists(unicode_punctuation_categories)
    # for key in ucharlists:
    #     if key.endswith('wide'):
    #         print key, ucharlists[key]

    # print 'openers = ', repr(openers)
    # print 'closers = ', repr(closers)
    # print 'delimiters = ', repr(delimiters)
    # print 'closing_delimiters = ', repr(closing_delimiters)

    # ucharlists = unicode_charlists(unicode_punctuation_categories)
    # for cat, chars in ucharlists.items():
    #     # print cat, chars
    #     # compact output (visible with a comprehensive font):
    #     print (u":%s: %s" % (cat, u''.join(chars))).encode('utf8')

# verbose print

    # print 'openers:'
    # for ch in openers:
    #     print ch.encode('utf8'), unicodedata.name(ch)
    # print 'closers:'
    # for ch in closers:
    #     print ch.encode('utf8'), unicodedata.name(ch)
    # print 'delimiters:'
    # for ch in delimiters:
    #     print ch.encode('utf8'), unicodedata.name(ch)
    # print 'closing_delimiters:'
    # for ch in closing_delimiters:
    #     print ch.encode('utf8'), unicodedata.name(ch)
                                                                                                                                                                                                                     usr/local/lib/python2.7/dist-packages/docutils/utils/punctuation_chars.pyc                          0100644 0000000 0000062 00000016412 13077704402 025461  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   s  d  d l  Z  d  d l Z d  d l Z d Z d Z d Z e  j d k rR e d 7Z n  d Z i d d 6d	 d
 6d d 6d d	 6d d 6d d 6d d 6d d 6Z d „  Z	 e
 d k ri d d 6d d 6d d 6d d 6d d 6d d 6Z d  d d! „ Z d" „  Z d# „  Z d$ „  Z d% d& d' d( „ Z e ƒ  \ Z Z Z Z e e ƒ \ Z Z e e ƒ \ Z Z e e ƒ \ Z Z e d)  e e d) ƒ Z e e ƒ Z e  j d k r¢e e 7Z n  e e k rÕd* e j d+ ƒ GHd, e j d+ ƒ GHn  e rğd- e j d+ ƒ GHn  e e k r#d. e j d+ ƒ GHd/ e j d+ ƒ GHn  e r>d0 e j d+ ƒ GHn  e e k rqd1 e j d+ ƒ GHd2 e j d+ ƒ GHn  e e k r¤d3 e j d+ ƒ GHd4 e j d+ ƒ GHn  e e e ƒ d5 d6 ƒGHe e e ƒ d5 d7 ƒGHe e e ƒ d5 d8 ƒGHd9 GHe e e ƒ d5 d: ƒGHd; Ge e ƒ GHn  d S(<   iÿÿÿÿNu  "'(<\[{à¼ºà¼¼áš›â…â½â‚âŒ©â¨âªâ¬â®â°â²â´âŸ…âŸ¦âŸ¨âŸªâŸ¬âŸ®â¦ƒâ¦…â¦‡â¦‰â¦‹â¦â¦â¦‘â¦“â¦•â¦—â§˜â§šâ§¼â¸¢â¸¤â¸¦â¸¨ã€ˆã€Šã€Œã€ã€ã€”ã€–ã€˜ã€šã€ã€ï´¾ï¸—ï¸µï¸·ï¸¹ï¸»ï¸½ï¸¿ï¹ï¹ƒï¹‡ï¹™ï¹›ï¹ï¼ˆï¼»ï½›ï½Ÿï½¢Â«â€˜â€œâ€¹â¸‚â¸„â¸‰â¸Œâ¸œâ¸ â€šâ€Â»â€™â€â€ºâ¸ƒâ¸…â¸Šâ¸â¸â¸¡â€›â€Ÿu  "')>\]}à¼»à¼½ášœâ†â¾â‚âŒªâ©â«â­â¯â±â³âµâŸ†âŸ§âŸ©âŸ«âŸ­âŸ¯â¦„â¦†â¦ˆâ¦Šâ¦Œâ¦â¦â¦’â¦”â¦–â¦˜â§™â§›â§½â¸£â¸¥â¸§â¸©ã€‰ã€‹ã€ã€ã€‘ã€•ã€—ã€™ã€›ã€ã€Ÿï´¿ï¸˜ï¸¶ï¸¸ï¸ºï¸¼ï¸¾ï¹€ï¹‚ï¹„ï¹ˆï¹šï¹œï¹ï¼‰ï¼½ï½ï½ ï½£Â»â€™â€â€ºâ¸ƒâ¸…â¸Šâ¸â¸â¸¡â€›â€ŸÂ«â€˜â€œâ€¹â¸‚â¸„â¸‰â¸Œâ¸œâ¸ â€šâ€u&  \-/:ÖŠÂ¡Â·Â¿Í¾Î‡Õš-ÕŸÖ‰Ö¾×€×ƒ×†×³×´Ø‰ØŠØŒØØ›ØØŸÙª-Ù­Û”Ü€-Üß·-ß¹à °-à ¾à¥¤à¥¥à¥°à·´à¹à¹šà¹›à¼„-à¼’à¾…à¿-à¿”áŠ-ááƒ»á¡-á¨á€á™­á™®á›«-á›­áœµáœ¶áŸ”-áŸ–áŸ˜-áŸšá €-á Šá¥„á¥…á§á§Ÿá¨á¨Ÿáª -áª¦áª¨-áª­á­š-á­ á°»-á°¿á±¾á±¿á³“â€-â€—â€ -â€§â€°-â€¸â€»-â€¾â-âƒâ‡-â‘â“â•-ââ³¹-â³¼â³¾â³¿â¸€â¸â¸†-â¸ˆâ¸‹â¸-â¸›â¸â¸Ÿâ¸ª-â¸®â¸°â¸±ã€-ã€ƒã€œã€°ã€½ã‚ ãƒ»ê“¾ê“¿ê˜-ê˜ê™³ê™¾ê›²-ê›·ê¡´-ê¡·ê£ê£ê£¸-ê£ºê¤®ê¤¯ê¥Ÿê§-ê§ê§ê§Ÿê©œ-ê©Ÿê«ê«Ÿê¯«ï¸-ï¸–ï¸™ï¸°-ï¸²ï¹…ï¹†ï¹‰-ï¹Œï¹-ï¹’ï¹”-ï¹˜ï¹Ÿ-ï¹¡ï¹£ï¹¨ï¹ªï¹«ï¼-ï¼ƒï¼…-ï¼‡ï¼Šï¼Œ-ï¼ï¼šï¼›ï¼Ÿï¼ ï¼¼ï½¡ï½¤ï½¥iÿÿ uL   ğ„€ğ„ğŸğğ¡—ğ¤Ÿğ¤¿ğ©-ğ©˜ğ©¿ğ¬¹-ğ¬¿ğ‘‚»ğ‘‚¼ğ‘‚¾-ğ‘ƒğ’‘°-ğ’‘³u   \\.,;!?u   Â»u   â€šu   â€˜u   â€™u   â€˜â€™u   â€u   â€œu   â€œâ€u   â€u   â€ºc         C   sN   y t  j |  ƒ } Wn t k
 r' t SX| t | k pM | t j |  d ƒ k S(   Nt    (   t   openerst   indext
   ValueErrort   Falset   closerst   quote_pairst   get(   t   c1t   c2t   i(    (    sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pyt   match_charse   s
    t   __main__t   Dasht   Pdt   Opent   Pst   Closet   Pes   Initial quotet   Pis   Final quotet   Pft   Othert   Poi    c            s   | d k r8 t ‡  f d †  t t j d ƒ Dƒ ƒ } n  i  } xY ˆ  D]Q } g  t | | d ƒ D]- } t j t | ƒ ƒ | k r_ t | ƒ ^ q_ | | <qE W| S(   s«  Return dictionary of Unicode character lists.

        For each of the `catagories`, an item contains a list with all Unicode
        characters with `cp_min` <= code-point <= `cp_max` that belong to
        the category.

        The default values check every code-point supported by Python
        (`sys.maxint` is 0x10FFFF in a "wide" build and 0xFFFF in a "narrow"
        build, i.e. ucs4 and ucs2 respectively).
        c         3   s0   |  ]& } t  j t | ƒ ƒ ˆ  k r | Vq d  S(   N(   t   unicodedatat   categoryt   unichr(   t   .0t   x(   t
   categories(    sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pys	   <genexpr>”   s    i   N(   t   Nonet   maxt   xranget   syst
   maxunicodeR   R   R   (   R   t   cp_mint   cp_maxt	   charlistst   catR   (    (   R   sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pyt   unicode_charlists…   s    ,5c          C   s\  d }  t  t |  ƒ } | d j d ƒ | d j d ƒ | d c d d g 7<| d j d ƒ | d j d ƒ | d c d d g 7<| d j | d	 j d
 ƒ d ƒ d g } x d D] } | j | | ƒ q¶ Wd g } x d D] } | j | | ƒ qá Wd g } x d D] } | j | | ƒ qWd g } g  | | | | f D] } d j | ƒ ^ qCS(   sç   Docutils punctuation category sample strings.

        Return list of sample strings for the categories "Open", "Close",
        "Delimiters" and "Closing-Delimiters" used in the `inline markup
        recognition rules`_.
        i    R   u   â€šu   â€R   u   â€›u   â€ŸR   R   u   ã€Ÿu   ã€u   "'(<\[{u   "')>\]}u   \-/:R   R   s   \\.,;!?u    (   R   s   PiR   (   R   R   s   Pi(   R   R   (   R&   t   unicode_punctuation_categoriest   removet   insertR   t   extendt   join(   R"   t
   ucharlistsR   R%   R   t
   delimiterst   closing_delimiterst   chars(    (    sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pyt   punctuation_samples¡   s*    
	!				c         C   sx   d } g  |  D] } t  | ƒ | k r | ^ q } g  |  D] } t  | ƒ | k r8 | ^ q8 } d j | ƒ d j | ƒ f S(   s1   Return (s1,s2) with characters above 0xFFFF in s2iÿÿ  R    (   t   ordR+   (   t   st   maxunicode_narrowt   cht   l1t   l2(    (    sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pyt   separate_wide_charsæ   s    ++c         C   s   g  } g  |  D] } t  | ƒ ^ q }  |  j ƒ  xr |  D]j } y@ | d d d | k rk | d j | ƒ n | j | g ƒ Wq6 t k
 rŸ | j | g ƒ q6 Xq6 Wg  } xf | D]^ } g  | D] } t | ƒ ^ q¾ } t | ƒ d k r| d d | d f } n  | j | ƒ q± Wd j | ƒ S(   s‰   Return s with shortcut notation for runs of consecutive characters

        Sort string and replace 'cdef' by 'c-f' and similar.
        iÿÿÿÿi   i   i    u   -R    (   R1   t   sortt   appendt
   IndexErrorR   t   lenR*   R+   (   R2   t   lR4   t   nR6   R
   (    (    sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pyt   mark_intervalsí   s"    
t   (t   )iA   c         C   s    t  | ƒ } d d t  | ƒ d } | g } xV |  D]N } | d 7} | d k ru | | k ru t  | ƒ } | | } n  | j | ƒ q4 W| j | ƒ d j | ƒ S(   s.   Line-wrap a unicode string literal definition.s   '
t    s   u'i   s   \R    (   R;   R9   R+   (   R2   t   startstringt	   endstringt   wrapt   ct
   contstringR<   R4   (    (    sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pyt   wrap_string  s    	
i   s   - openers = ur"""%s"""t   utf8s   + openers = ur"""%s"""s   + openers-wide = ur"""%s"""s   - closers = ur"""%s"""s   + closers = ur"""%s"""s   + closers-wide = ur"""%s"""s   - delimiters = ur"%s"s   + delimiters = ur"%s"s   - closing_delimiters = ur"%s"s   + closing_delimiters = ur"%s"RB   s   openers = (s   closers = (s   delimiters = (s-   if sys.maxunicode >= 0x10FFFF: # "wide" builds       delimiters += (s   closing_delimiters =(   R    t   reR   R   R   R-   R!   R.   R   R   t   __name__R'   R   R&   R0   R7   R>   RG   t   oRE   t   dt   cdt   o_widet   c_widet   d_widet   encodet   repr(    (    (    sB   /tmp/pip-build-awuatQ/docutils/docutils/utils/punctuation_chars.pyt   <module>   sx   




	
	E		                                                                                                                                                                                                                                                      usr/local/lib/python2.7/dist-packages/docutils/utils/roman.py                                       0100644 0000000 0000062 00000005177 13077704374 022717  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        """Convert to and from Roman numerals"""

__author__ = "Mark Pilgrim (f8dy@diveintopython.org)"
__version__ = "1.4"
__date__ = "8 August 2001"
__copyright__ = """Copyright (c) 2001 Mark Pilgrim

This program is part of "Dive Into Python", a free Python tutorial for
experienced programmers.  Visit http://diveintopython.org/ for the
latest version.

This program is free software; you can redistribute it and/or modify
it under the terms of the Python 2.1.1 license, available at
http://www.python.org/2.1.1/license.html
"""

import re

#Define exceptions
class RomanError(Exception): pass
class OutOfRangeError(RomanError): pass
class NotIntegerError(RomanError): pass
class InvalidRomanNumeralError(RomanError): pass

#Define digit mapping
romanNumeralMap = (('M',  1000),
                   ('CM', 900),
                   ('D',  500),
                   ('CD', 400),
                   ('C',  100),
                   ('XC', 90),
                   ('L',  50),
                   ('XL', 40),
                   ('X',  10),
                   ('IX', 9),
                   ('V',  5),
                   ('IV', 4),
                   ('I',  1))

def toRoman(n):
    """convert integer to Roman numeral"""
    if not (0 < n < 5000):
        raise OutOfRangeError, "number out of range (must be 1..4999)"
    if int(n) != n:
        raise NotIntegerError, "decimals can not be converted"

    result = ""
    for numeral, integer in romanNumeralMap:
        while n >= integer:
            result += numeral
            n -= integer
    return result

#Define pattern to detect valid Roman numerals
romanNumeralPattern = re.compile("""
    ^                   # beginning of string
    M{0,4}              # thousands - 0 to 4 M's
    (CM|CD|D?C{0,3})    # hundreds - 900 (CM), 400 (CD), 0-300 (0 to 3 C's),
                        #            or 500-800 (D, followed by 0 to 3 C's)
    (XC|XL|L?X{0,3})    # tens - 90 (XC), 40 (XL), 0-30 (0 to 3 X's),
                        #        or 50-80 (L, followed by 0 to 3 X's)
    (IX|IV|V?I{0,3})    # ones - 9 (IX), 4 (IV), 0-3 (0 to 3 I's),
                        #        or 5-8 (V, followed by 0 to 3 I's)
    $                   # end of string
    """ ,re.VERBOSE)

def fromRoman(s):
    """convert Roman numeral to integer"""
    if not s:
        raise InvalidRomanNumeralError, 'Input can not be blank'
    if not romanNumeralPattern.search(s):
        raise InvalidRomanNumeralError, 'Invalid Roman numeral: %s' % s

    result = 0
    index = 0
    for numeral, integer in romanNumeralMap:
        while s[index:index+len(numeral)] == numeral:
            result += integer
            index += len(numeral)
    return result

                                                                                                                                                                                                                                                                                                                                                                                                 usr/local/lib/python2.7/dist-packages/docutils/utils/roman.pyc                                      0100644 0000000 0000062 00000007022 13077704402 023041  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   sÚ   d  Z  d Z d Z d Z d Z d d l Z d e f d „  ƒ  YZ d	 e f d
 „  ƒ  YZ d e f d „  ƒ  YZ	 d e f d „  ƒ  YZ
 d, d- d. d/ d0 d1 d2 d3 d4 d5 d6 d7 d8 f Z d) „  Z e j d* e j ƒ Z d+ „  Z d S(9   s"   Convert to and from Roman numeralss&   Mark Pilgrim (f8dy@diveintopython.org)s   1.4s   8 August 2001sg  Copyright (c) 2001 Mark Pilgrim

This program is part of "Dive Into Python", a free Python tutorial for
experienced programmers.  Visit http://diveintopython.org/ for the
latest version.

This program is free software; you can redistribute it and/or modify
it under the terms of the Python 2.1.1 license, available at
http://www.python.org/2.1.1/license.html
iÿÿÿÿNt
   RomanErrorc           B   s   e  Z RS(    (   t   __name__t
   __module__(    (    (    s6   /tmp/pip-build-awuatQ/docutils/docutils/utils/roman.pyR       s    t   OutOfRangeErrorc           B   s   e  Z RS(    (   R   R   (    (    (    s6   /tmp/pip-build-awuatQ/docutils/docutils/utils/roman.pyR      s    t   NotIntegerErrorc           B   s   e  Z RS(    (   R   R   (    (    (    s6   /tmp/pip-build-awuatQ/docutils/docutils/utils/roman.pyR      s    t   InvalidRomanNumeralErrorc           B   s   e  Z RS(    (   R   R   (    (    (    s6   /tmp/pip-build-awuatQ/docutils/docutils/utils/roman.pyR      s    t   Miè  t   CMi„  t   Diô  t   CDi  t   Cid   t   XCiZ   t   Li2   t   XLi(   t   Xi
   t   IXi	   t   Vi   t   IVi   t   Ii   c         C   s   d |  k  o d k  n s( t  d ‚ n  t |  ƒ |  k rF t d ‚ n  d } x; t D]3 \ } } x$ |  | k r… | | 7} |  | 8}  qb WqS W| S(   s    convert integer to Roman numerali    iˆ  s%   number out of range (must be 1..4999)s   decimals can not be convertedt    (   R   t   intR   t   romanNumeralMap(   t   nt   resultt   numeralt   integer(    (    s6   /tmp/pip-build-awuatQ/docutils/docutils/utils/roman.pyt   toRoman(   s    
s8  
    ^                   # beginning of string
    M{0,4}              # thousands - 0 to 4 M's
    (CM|CD|D?C{0,3})    # hundreds - 900 (CM), 400 (CD), 0-300 (0 to 3 C's),
                        #            or 500-800 (D, followed by 0 to 3 C's)
    (XC|XL|L?X{0,3})    # tens - 90 (XC), 40 (XL), 0-30 (0 to 3 X's),
                        #        or 50-80 (L, followed by 0 to 3 X's)
    (IX|IV|V?I{0,3})    # ones - 9 (IX), 4 (IV), 0-3 (0 to 3 I's),
                        #        or 5-8 (V, followed by 0 to 3 I's)
    $                   # end of string
    c         C   s–   |  s t  d ‚ n  t j |  ƒ s1 t  d |  ‚ n  d } d } xR t D]J \ } } x; |  | | t | ƒ !| k r | | 7} | t | ƒ 7} qS WqD W| S(   s    convert Roman numeral to integers   Input can not be blanks   Invalid Roman numeral: %si    (   R   t   romanNumeralPatternt   searchR   t   len(   t   sR   t   indexR   R   (    (    s6   /tmp/pip-build-awuatQ/docutils/docutils/utils/roman.pyt	   fromRomanC   s     
(   R   iè  (   R   i„  (   R   iô  (   R	   i  (   R
   id   (   R   iZ   (   R   i2   (   R   i(   (   R   i
   (   R   i	   (   R   i   (   R   i   (   R   i   (   t   __doc__t
   __author__t   __version__t   __date__t   __copyright__t   ret	   ExceptionR    R   R   R   R   R   t   compilet   VERBOSER   R    (    (    (    s6   /tmp/pip-build-awuatQ/docutils/docutils/utils/roman.pyt   <module>   s4   
		
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              usr/local/lib/python2.7/dist-packages/docutils/utils/smartquotes.py                                 0100644 0000000 0000062 00000101152 13077704374 024160  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        #!/usr/bin/python
# -*- coding: utf-8 -*-

# :Id: $Id: smartquotes.py 7933 2016-01-13 21:09:13Z milde $
# :Copyright: Â© 2010 GÃ¼nter Milde,
#             original `SmartyPants`_: Â© 2003 John Gruber
#             smartypants.py:          Â© 2004, 2007 Chad Miller
# :Maintainer: docutils-develop@lists.sourceforge.net
# :License: Released under the terms of the `2-Clause BSD license`_, in short:
#
#    Copying and distribution of this file, with or without modification,
#    are permitted in any medium without royalty provided the copyright
#    notices and this notice are preserved.
#    This file is offered as-is, without any warranty.
#
# .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause


r"""
========================
SmartyPants for Docutils
========================

Synopsis
========

Smart-quotes for Docutils.

The original "SmartyPants" is a free web publishing plug-in for Movable Type,
Blosxom, and BBEdit that easily translates plain ASCII punctuation characters
into "smart" typographic punctuation characters.

`smartypants.py`, endeavours to be a functional port of
SmartyPants to Python, for use with Pyblosxom_.

`smartquotes.py` is an adaption of Smartypants to Docutils_. By using Unicode
characters instead of HTML entities for typographic quotes, it works for any
output format that supports Unicode.

Authors
=======

`John Gruber`_ did all of the hard work of writing this software in Perl for
`Movable Type`_ and almost all of this useful documentation.  `Chad Miller`_
ported it to Python to use with Pyblosxom_.
Adapted to Docutils_ by GÃ¼nter Milde.

Additional Credits
==================

Portions of the SmartyPants original work are based on Brad Choate's nifty
MTRegex plug-in.  `Brad Choate`_ also contributed a few bits of source code to
this plug-in.  Brad Choate is a fine hacker indeed.

`Jeremy Hedley`_ and `Charles Wiltgen`_ deserve mention for exemplary beta
testing of the original SmartyPants.

`Rael Dornfest`_ ported SmartyPants to Blosxom.

.. _Brad Choate: http://bradchoate.com/
.. _Jeremy Hedley: http://antipixel.com/
.. _Charles Wiltgen: http://playbacktime.com/
.. _Rael Dornfest: http://raelity.org/


Copyright and License
=====================

SmartyPants_ license (3-Clause BSD license):

  Copyright (c) 2003 John Gruber (http://daringfireball.net/)
  All rights reserved.

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

  * Neither the name "SmartyPants" nor the names of its contributors
    may be used to endorse or promote products derived from this
    software without specific prior written permission.

  This software is provided by the copyright holders and contributors
  "as is" and any express or implied warranties, including, but not
  limited to, the implied warranties of merchantability and fitness for
  a particular purpose are disclaimed. In no event shall the copyright
  owner or contributors be liable for any direct, indirect, incidental,
  special, exemplary, or consequential damages (including, but not
  limited to, procurement of substitute goods or services; loss of use,
  data, or profits; or business interruption) however caused and on any
  theory of liability, whether in contract, strict liability, or tort
  (including negligence or otherwise) arising in any way out of the use
  of this software, even if advised of the possibility of such damage.

smartypants.py license (2-Clause BSD license):

  smartypants.py is a derivative work of SmartyPants.

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

  This software is provided by the copyright holders and contributors
  "as is" and any express or implied warranties, including, but not
  limited to, the implied warranties of merchantability and fitness for
  a particular purpose are disclaimed. In no event shall the copyright
  owner or contributors be liable for any direct, indirect, incidental,
  special, exemplary, or consequential damages (including, but not
  limited to, procurement of substitute goods or services; loss of use,
  data, or profits; or business interruption) however caused and on any
  theory of liability, whether in contract, strict liability, or tort
  (including negligence or otherwise) arising in any way out of the use
  of this software, even if advised of the possibility of such damage.

.. _John Gruber: http://daringfireball.net/
.. _Chad Miller: http://web.chad.org/

.. _Pyblosxom: http://pyblosxom.bluesock.org/
.. _SmartyPants: http://daringfireball.net/projects/smartypants/
.. _Movable Type: http://www.movabletype.org/
.. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
.. _Docutils: http://docutils.sf.net/

Description
===========

SmartyPants can perform the following transformations:

- Straight quotes ( " and ' ) into "curly" quote characters
- Backticks-style quotes (\`\`like this'') into "curly" quote characters
- Dashes (``--`` and ``---``) into en- and em-dash entities
- Three consecutive dots (``...`` or ``. . .``) into an ellipsis entity

This means you can write, edit, and save your posts using plain old
ASCII straight quotes, plain dashes, and plain dots, but your published
posts (and final HTML output) will appear with smart quotes, em-dashes,
and proper ellipses.

SmartyPants does not modify characters within ``<pre>``, ``<code>``, ``<kbd>``,
``<math>`` or ``<script>`` tag blocks. Typically, these tags are used to
display text where smart quotes and other "smart punctuation" would not be
appropriate, such as source code or example markup.


Backslash Escapes
=================

If you need to use literal straight quotes (or plain hyphens and
periods), SmartyPants accepts the following backslash escape sequences
to force non-smart punctuation. It does so by transforming the escape
sequence into a character:

========  =====  =========
Escape    Value  Character
========  =====  =========
``\\\\``  &#92;  \\
\\"       &#34;  "
\\'       &#39;  '
\\.       &#46;  .
\\-       &#45;  \-
\\`       &#96;  \`
========  =====  =========

This is useful, for example, when you want to use straight quotes as
foot and inch marks: 6\\'2\\" tall; a 17\\" iMac.

Options
=======

For Pyblosxom users, the ``smartypants_attributes`` attribute is where you
specify configuration options.

Numeric values are the easiest way to configure SmartyPants' behavior:

"0"
        Suppress all transformations. (Do nothing.)
"1"
        Performs default SmartyPants transformations: quotes (including
        \`\`backticks'' -style), em-dashes, and ellipses. "``--``" (dash dash)
        is used to signify an em-dash; there is no support for en-dashes.

"2"
        Same as smarty_pants="1", except that it uses the old-school typewriter
        shorthand for dashes:  "``--``" (dash dash) for en-dashes, "``---``"
        (dash dash dash)
        for em-dashes.

"3"
        Same as smarty_pants="2", but inverts the shorthand for dashes:
        "``--``" (dash dash) for em-dashes, and "``---``" (dash dash dash) for
        en-dashes.

"-1"
        Stupefy mode. Reverses the SmartyPants transformation process, turning
        the characters produced by SmartyPants into their ASCII equivalents.
        E.g.  "â€œ" is turned into a simple double-quote (\"), "â€”" is
        turned into two dashes, etc.


The following single-character attribute values can be combined to toggle
individual transformations from within the smarty_pants attribute. For
example, to educate normal quotes and em-dashes, but not ellipses or
\`\`backticks'' -style quotes:

``py['smartypants_attributes'] = "1"``

"q"
        Educates normal quote characters: (") and (').

"b"
        Educates \`\`backticks'' -style double quotes.

"B"
        Educates \`\`backticks'' -style double quotes and \`single' quotes.

"d"
        Educates em-dashes.

"D"
        Educates em-dashes and en-dashes, using old-school typewriter shorthand:
        (dash dash) for en-dashes, (dash dash dash) for em-dashes.

"i"
        Educates em-dashes and en-dashes, using inverted old-school typewriter
        shorthand: (dash dash) for em-dashes, (dash dash dash) for en-dashes.

"e"
        Educates ellipses.

"w"
        Translates any instance of ``&quot;`` into a normal double-quote character.
        This should be of no interest to most people, but of particular interest
        to anyone who writes their posts using Dreamweaver, as Dreamweaver
        inexplicably uses this entity to represent a literal double-quote
        character. SmartyPants only educates normal quotes, not entities (because
        ordinarily, entities are used for the explicit purpose of representing the
        specific character they represent). The "w" option must be used in
        conjunction with one (or both) of the other quote options ("q" or "b").
        Thus, if you wish to apply all SmartyPants transformations (quotes, en-
        and em-dashes, and ellipses) and also translate ``&quot;`` entities into
        regular quotes so SmartyPants can educate them, you should pass the
        following to the smarty_pants attribute:


Caveats
=======

Why You Might Not Want to Use Smart Quotes in Your Weblog
---------------------------------------------------------

For one thing, you might not care.

Most normal, mentally stable individuals do not take notice of proper
typographic punctuation. Many design and typography nerds, however, break
out in a nasty rash when they encounter, say, a restaurant sign that uses
a straight apostrophe to spell "Joe's".

If you're the sort of person who just doesn't care, you might well want to
continue not caring. Using straight quotes -- and sticking to the 7-bit
ASCII character set in general -- is certainly a simpler way to live.

Even if you I *do* care about accurate typography, you still might want to
think twice before educating the quote characters in your weblog. One side
effect of publishing curly quote characters is that it makes your
weblog a bit harder for others to quote from using copy-and-paste. What
happens is that when someone copies text from your blog, the copied text
contains the 8-bit curly quote characters (as well as the 8-bit characters
for em-dashes and ellipses, if you use these options). These characters
are not standard across different text encoding methods, which is why they
need to be encoded as characters.

People copying text from your weblog, however, may not notice that you're
using curly quotes, and they'll go ahead and paste the unencoded 8-bit
characters copied from their browser into an email message or their own
weblog. When pasted as raw "smart quotes", these characters are likely to
get mangled beyond recognition.

That said, my own opinion is that any decent text editor or email client
makes it easy to stupefy smart quote characters into their 7-bit
equivalents, and I don't consider it my problem if you're using an
indecent text editor or email client.


Algorithmic Shortcomings
------------------------

One situation in which quotes will get curled the wrong way is when
apostrophes are used at the start of leading contractions. For example:

``'Twas the night before Christmas.``

In the case above, SmartyPants will turn the apostrophe into an opening
single-quote, when in fact it should be a closing one. I don't think
this problem can be solved in the general case -- every word processor
I've tried gets this wrong as well. In such cases, it's best to use the
proper character for closing single-quotes (``â€™``) by hand.


Version History
===============

1.7     2012-11-19
        - Internationalization: language-dependent quotes.

1.6.1:  2012-11-06
        - Refactor code, code cleanup,
        - `educate_tokens()` generator as interface for Docutils.

1.6:    2010-08-26
        - Adaption to Docutils:
          - Use Unicode instead of HTML entities,
          - Remove code special to pyblosxom.

1.5_1.6: Fri, 27 Jul 2007 07:06:40 -0400
        - Fixed bug where blocks of precious unalterable text was instead
          interpreted.  Thanks to Le Roux and Dirk van Oosterbosch.

1.5_1.5: Sat, 13 Aug 2005 15:50:24 -0400
        - Fix bogus magical quotation when there is no hint that the
          user wants it, e.g., in "21st century".  Thanks to Nathan Hamblen.
        - Be smarter about quotes before terminating numbers in an en-dash'ed
          range.

1.5_1.4: Thu, 10 Feb 2005 20:24:36 -0500
        - Fix a date-processing bug, as reported by jacob childress.
        - Begin a test-suite for ensuring correct output.
        - Removed import of "string", since I didn't really need it.
          (This was my first every Python program.  Sue me!)

1.5_1.3: Wed, 15 Sep 2004 18:25:58 -0400
        - Abort processing if the flavour is in forbidden-list.  Default of
          [ "rss" ]   (Idea of Wolfgang SCHNERRING.)
        - Remove stray virgules from en-dashes.  Patch by Wolfgang SCHNERRING.

1.5_1.2: Mon, 24 May 2004 08:14:54 -0400
        - Some single quotes weren't replaced properly.  Diff-tesuji played
          by Benjamin GEIGER.

1.5_1.1: Sun, 14 Mar 2004 14:38:28 -0500
        - Support upcoming pyblosxom 0.9 plugin verification feature.

1.5_1.0: Tue, 09 Mar 2004 08:08:35 -0500
        - Initial release
"""

default_smartypants_attr = "1"


import re

class smartchars(object):
    """Smart quotes and dashes
    """

    endash   = u'â€“' # "&#8211;" EN DASH
    emdash   = u'â€”' # "&#8212;" EM DASH
    ellipsis = u'â€¦' # "&#8230;" HORIZONTAL ELLIPSIS

    # quote characters (language-specific, set in __init__())
    #
    # English smart quotes (open primary, close primary, open secondary, close
    # secondary) are:
    #   opquote  = u'â€œ' # "&#8220;" LEFT DOUBLE QUOTATION MARK
    #   cpquote  = u'â€' # "&#8221;" RIGHT DOUBLE QUOTATION MARK
    #   osquote  = u'â€˜' # "&#8216;" LEFT SINGLE QUOTATION MARK
    #   csquote  = u'â€™' # "&#8217;" RIGHT SINGLE QUOTATION MARK
    # For other languages see:
    # http://en.wikipedia.org/wiki/Non-English_usage_of_quotation_marks
    # http://de.wikipedia.org/wiki/Anf%C3%BChrungszeichen#Andere_Sprachen
    quotes = {'af':           u'â€œâ€â€˜â€™',
              'af-x-altquot': u'â€â€â€šâ€™',
              'ca':           u'Â«Â»â€œâ€',
              'ca-x-altquot': u'â€œâ€â€˜â€™',
              'cs':           u'â€â€œâ€šâ€˜',
              'cs-x-altquot': u'Â»Â«â€ºâ€¹',
              'da':           u'Â»Â«â€˜â€™',
              'da-x-altquot': u'â€â€œâ€šâ€˜',
              'de':           u'â€â€œâ€šâ€˜',
              'de-x-altquot': u'Â»Â«â€ºâ€¹',
              'de-CH':        u'Â«Â»â€¹â€º',
              'el':           u'Â«Â»â€œâ€',
              'en':           u'â€œâ€â€˜â€™',
              'en-UK':        u'â€˜â€™â€œâ€',
              'eo':           u'â€œâ€â€˜â€™',
              'es':           u'Â«Â»â€œâ€',
              'et':           u'â€â€œâ€šâ€˜', # no secondary quote listed in
              'et-x-altquot': u'Â»Â«â€ºâ€¹', # the sources above (wikipedia.org)
              'eu':           u'Â«Â»â€¹â€º',
              'es-x-altquot': u'â€œâ€â€˜â€™',
              'fi':           u'â€â€â€™â€™',
              'fi-x-altquot': u'Â»Â»â€™â€™',
              'fr':           (u'Â«â€¯',  u'â€¯Â»', u'â€¹â€¯', u'â€¯â€º'), # with narrow no-break space
              'fr-x-altquot': u'Â«Â»â€¹â€º', # for use with manually set spaces
              # 'fr-x-altquot': (u'â€œâ€¯',  u'â€¯â€', u'â€˜â€¯', u'â€¯â€™'), # rarely used
              'fr-CH':        u'Â«Â»â€¹â€º',
              'gl':           u'Â«Â»â€œâ€',
              'he':           u'â€â€œÂ»Â«',
              'he-x-altquot': u'â€â€â€šâ€™',
              'it':           u'Â«Â»â€œâ€',
              'it-CH':        u'Â«Â»â€¹â€º',
              'it-x-altquot': u'â€œâ€â€˜â€™',
              'ja':           u'ã€Œã€ã€ã€',
              'lt':           u'â€â€œâ€šâ€˜',
              'nl':           u'â€œâ€â€˜â€™',
              'nl-x-altquot': u'â€â€â€šâ€™',
              'pl':           u'â€â€Â«Â»',
              'pl-x-altquot': u'Â«Â»â€œâ€',
              'pt':           u'Â«Â»â€œâ€',
              'pt-BR':        u'â€œâ€â€˜â€™',
              'ro':           u'â€â€Â«Â»',
              'ro-x-altquot': u'Â«Â»â€â€',
              'ru':           u'Â«Â»â€â€œ',
              'sk':           u'â€â€œâ€šâ€˜',
              'sk-x-altquot': u'Â»Â«â€ºâ€¹',
              'sv':           u'â€â€œâ€šâ€˜',
              'sv-x-altquot': u'Â»Â«â€ºâ€¹',
              'zh-CN':        u'â€œâ€â€˜â€™',
              'it':           u'Â«Â»â€œâ€',
              'zh-TW':        u'ã€Œã€ã€ã€',
             }

    def __init__(self, language='en'):
        self.language = language
        try:
            (self.opquote, self.cpquote,
             self.osquote, self.csquote) = self.quotes[language]
        except KeyError:
            self.opquote, self.cpquote, self.osquote, self.csquote = u'""\'\''


def smartyPants(text, attr=default_smartypants_attr, language='en'):
    """Main function for "traditional" use."""

    return "".join([t for t in educate_tokens(tokenize(text),
                                              attr, language)])


def educate_tokens(text_tokens, attr=default_smartypants_attr, language='en'):
    """Return iterator that "educates" the items of `text_tokens`.
    """

    # Parse attributes:
    # 0 : do nothing
    # 1 : set all
    # 2 : set all, using old school en- and em- dash shortcuts
    # 3 : set all, using inverted old school en and em- dash shortcuts
    #
    # q : quotes
    # b : backtick quotes (``double'' only)
    # B : backtick quotes (``double'' and `single')
    # d : dashes
    # D : old school dashes
    # i : inverted old school dashes
    # e : ellipses
    # w : convert &quot; entities to " for Dreamweaver users

    convert_quot = False  # translate &quot; entities into normal quotes?
    do_dashes = False
    do_backticks = False
    do_quotes = False
    do_ellipses = False
    do_stupefy = False

    if attr == "0": # Do nothing.
        yield text
    elif attr == "1": # Do everything, turn all options on.
        do_quotes    = True
        do_backticks = True
        do_dashes    = 1
        do_ellipses  = True
    elif attr == "2":
        # Do everything, turn all options on, use old school dash shorthand.
        do_quotes    = True
        do_backticks = True
        do_dashes    = 2
        do_ellipses  = True
    elif attr == "3":
        # Do everything, use inverted old school dash shorthand.
        do_quotes    = True
        do_backticks = True
        do_dashes    = 3
        do_ellipses  = True
    elif attr == "-1": # Special "stupefy" mode.
        do_stupefy   = True
    else:
        if "q" in attr: do_quotes = True
        if "b" in attr: do_backticks = True
        if "B" in attr: do_backticks = 2
        if "d" in attr: do_dashes = 1
        if "D" in attr: do_dashes = 2
        if "i" in attr: do_dashes = 3
        if "e" in attr: do_ellipses = True
        if "w" in attr: convert_quot = True

    prev_token_last_char = " "
    # Last character of the previous text token. Used as
    # context to curl leading quote characters correctly.

    for (ttype, text) in text_tokens:

        # skip HTML and/or XML tags as well as emtpy text tokens
        # without updating the last character
        if ttype == 'tag' or not text:
            yield text
            continue

        # skip literal text (math, literal, raw, ...)
        if ttype == 'literal':
            prev_token_last_char = text[-1:]
            yield text
            continue

        last_char = text[-1:] # Remember last char before processing.

        text = processEscapes(text)

        if convert_quot:
            text = re.sub('&quot;', '"', text)

        if do_dashes == 1:
            text = educateDashes(text)
        elif do_dashes == 2:
            text = educateDashesOldSchool(text)
        elif do_dashes == 3:
            text = educateDashesOldSchoolInverted(text)

        if do_ellipses:
            text = educateEllipses(text)

        # Note: backticks need to be processed before quotes.
        if do_backticks:
            text = educateBackticks(text, language)

        if do_backticks == 2:
            text = educateSingleBackticks(text, language)

        if do_quotes:
            text = educateQuotes(prev_token_last_char+text, language)[1:]

        if do_stupefy:
            text = stupefyEntities(text, language)

        # Remember last char as context for the next token
        prev_token_last_char = last_char

        text = processEscapes(text, restore=True)

        yield text



def educateQuotes(text, language='en'):
    """
    Parameter:  - text string (unicode or bytes).
                - language (`BCP 47` language tag.)
    Returns:    The `text`, with "educated" curly quote characters.

    Example input:  "Isn't this fun?"
    Example output: â€œIsnâ€™t this fun?â€œ;
    """

    smart = smartchars(language)

    # oldtext = text
    punct_class = r"""[!"#\$\%'()*+,-.\/:;<=>?\@\[\\\]\^_`{|}~]"""

    # Special case if the very first character is a quote
    # followed by punctuation at a non-word-break.
    # Close the quotes by brute force:
    text = re.sub(r"""^'(?=%s\\B)""" % (punct_class,), smart.csquote, text)
    text = re.sub(r"""^"(?=%s\\B)""" % (punct_class,), smart.cpquote, text)

    # Special case for double sets of quotes, e.g.:
    #   <p>He said, "'Quoted' words in a larger quote."</p>
    text = re.sub(r""""'(?=\w)""", smart.opquote+smart.osquote, text)
    text = re.sub(r"""'"(?=\w)""", smart.osquote+smart.opquote, text)

    # Special case for decade abbreviations (the '80s):
    text = re.sub(r"""\b'(?=\d{2}s)""", smart.csquote, text)

    close_class = r"""[^\ \t\r\n\[\{\(\-]"""
    dec_dashes = r"""&#8211;|&#8212;"""

    # Get most opening single quotes:
    opening_single_quotes_regex = re.compile(r"""
                    (
                            \s          |   # a whitespace char, or
                            &nbsp;      |   # a non-breaking space entity, or
                            --          |   # dashes, or
                            &[mn]dash;  |   # named dash entities
                            %s          |   # or decimal entities
                            &\#x201[34];    # or hex
                    )
                    '                 # the quote
                    (?=\w)            # followed by a word character
                    """ % (dec_dashes,), re.VERBOSE)
    text = opening_single_quotes_regex.sub(r'\1'+smart.osquote, text)

    closing_single_quotes_regex = re.compile(r"""
                    (%s)
                    '
                    (?!\s | s\b | \d)
                    """ % (close_class,), re.VERBOSE)
    text = closing_single_quotes_regex.sub(r'\1'+smart.csquote, text)

    closing_single_quotes_regex = re.compile(r"""
                    (%s)
                    '
                    (\s | s\b)
                    """ % (close_class,), re.VERBOSE)
    text = closing_single_quotes_regex.sub(r'\1%s\2' % smart.csquote, text)

    # Any remaining single quotes should be opening ones:
    text = re.sub(r"""'""", smart.osquote, text)

    # Get most opening double quotes:
    opening_double_quotes_regex = re.compile(r"""
                    (
                            \s          |   # a whitespace char, or
                            &nbsp;      |   # a non-breaking space entity, or
                            --          |   # dashes, or
                            &[mn]dash;  |   # named dash entities
                            %s          |   # or decimal entities
                            &\#x201[34];    # or hex
                    )
                    "                 # the quote
                    (?=\w)            # followed by a word character
                    """ % (dec_dashes,), re.VERBOSE)
    text = opening_double_quotes_regex.sub(r'\1'+smart.opquote, text)

    # Double closing quotes:
    closing_double_quotes_regex = re.compile(r"""
                    #(%s)?   # character that indicates the quote should be closing
                    "
                    (?=\s)
                    """ % (close_class,), re.VERBOSE)
    text = closing_double_quotes_regex.sub(smart.cpquote, text)

    closing_double_quotes_regex = re.compile(r"""
                    (%s)   # character that indicates the quote should be closing
                    "
                    """ % (close_class,), re.VERBOSE)
    text = closing_double_quotes_regex.sub(r'\1'+smart.cpquote, text)

    # Any remaining quotes should be opening ones.
    text = re.sub(r'"', smart.opquote, text)

    return text


def educateBackticks(text, language='en'):
    """
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with ``backticks'' -style double quotes
                translated into HTML curly quote entities.
    Example input:  ``Isn't this fun?''
    Example output: â€œIsn't this fun?â€œ;
    """
    smart = smartchars(language)

    text = re.sub(r"""``""", smart.opquote, text)
    text = re.sub(r"""''""", smart.cpquote, text)
    return text


def educateSingleBackticks(text, language='en'):
    """
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with `backticks' -style single quotes
                translated into HTML curly quote entities.

    Example input:  `Isn't this fun?'
    Example output: â€˜Isnâ€™t this fun?â€™
    """
    smart = smartchars(language)

    text = re.sub(r"""`""", smart.osquote, text)
    text = re.sub(r"""'""", smart.csquote, text)
    return text


def educateDashes(text):
    """
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "--" translated to
                an em-dash character.
    """

    text = re.sub(r"""---""", smartchars.endash, text) # en  (yes, backwards)
    text = re.sub(r"""--""", smartchars.emdash, text) # em (yes, backwards)
    return text


def educateDashesOldSchool(text):
    """
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "--" translated to
                an en-dash character, and each "---" translated to
                an em-dash character.
    """

    text = re.sub(r"""---""", smartchars.emdash, text)
    text = re.sub(r"""--""", smartchars.endash, text)
    return text


def educateDashesOldSchoolInverted(text):
    """
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "--" translated to
                an em-dash character, and each "---" translated to
                an en-dash character. Two reasons why: First, unlike the
                en- and em-dash syntax supported by
                EducateDashesOldSchool(), it's compatible with existing
                entries written before SmartyPants 1.1, back when "--" was
                only used for em-dashes.  Second, em-dashes are more
                common than en-dashes, and so it sort of makes sense that
                the shortcut should be shorter to type. (Thanks to Aaron
                Swartz for the idea.)
    """
    text = re.sub(r"""---""", smartchars.endash, text)    # em
    text = re.sub(r"""--""", smartchars.emdash, text)    # en
    return text



def educateEllipses(text):
    """
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "..." translated to
                an ellipsis character.

    Example input:  Huh...?
    Example output: Huh&#8230;?
    """

    text = re.sub(r"""\.\.\.""", smartchars.ellipsis, text)
    text = re.sub(r"""\. \. \.""", smartchars.ellipsis, text)
    return text


def stupefyEntities(text, language='en'):
    """
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each SmartyPants character translated to
                its ASCII counterpart.

    Example input:  â€œHello â€” world.â€
    Example output: "Hello -- world."
    """
    smart = smartchars(language)

    text = re.sub(smart.endash, "-", text)  # en-dash
    text = re.sub(smart.emdash, "--", text) # em-dash

    text = re.sub(smart.osquote, "'", text)  # open single quote
    text = re.sub(smart.csquote, "'", text)  # close single quote

    text = re.sub(smart.opquote, '"', text)  # open double quote
    text = re.sub(smart.cpquote, '"', text)  # close double quote

    text = re.sub(smart.ellipsis, '...', text)# ellipsis

    return text


def processEscapes(text, restore=False):
    r"""
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with after processing the following backslash
                escape sequences. This is useful if you want to force a "dumb"
                quote or other character to appear.

                Escape  Value
                ------  -----
                \\      &#92;
                \"      &#34;
                \'      &#39;
                \.      &#46;
                \-      &#45;
                \`      &#96;
    """
    replacements = ((r'\\', r'&#92;'),
                    (r'\"', r'&#34;'),
                    (r"\'", r'&#39;'),
                    (r'\.', r'&#46;'),
                    (r'\-', r'&#45;'),
                    (r'\`', r'&#96;'))
    if restore:
        for (ch, rep) in replacements:
            text = text.replace(rep, ch[1])
    else:
        for (ch, rep) in replacements:
            text = text.replace(ch, rep)

    return text


def tokenize(text):
    """
    Parameter:  String containing HTML markup.
    Returns:    An iterator that yields the tokens comprising the input
                string. Each token is either a tag (possibly with nested,
                tags contained therein, such as <a href="<MTFoo>">, or a
                run of text between tags. Each yielded element is a
                two-element tuple; the first is either 'tag' or 'text';
                the second is the actual value.

    Based on the _tokenize() subroutine from Brad Choate's MTRegex plugin.
        <http://www.bradchoate.com/past/mtregex.php>
    """

    pos = 0
    length = len(text)
    # tokens = []

    depth = 6
    nested_tags = "|".join(['(?:<(?:[^<>]',] * depth) + (')*>)' * depth)
    #match = r"""(?: <! ( -- .*? -- \s* )+ > ) |  # comments
    #               (?: <\? .*? \?> ) |  # directives
    #               %s  # nested tags       """ % (nested_tags,)
    tag_soup = re.compile(r"""([^<]*)(<[^>]*>)""")

    token_match = tag_soup.search(text)

    previous_end = 0
    while token_match is not None:
        if token_match.group(1):
            yield ('text', token_match.group(1))

        yield ('tag', token_match.group(2))

        previous_end = token_match.end()
        token_match = tag_soup.search(text, token_match.end())

    if previous_end < len(text):
        yield ('text', text[previous_end:])



if __name__ == "__main__":

    import locale

    try:
        locale.setlocale(locale.LC_ALL, '')
    except:
        pass

    from docutils.core import publish_string
    docstring_html = publish_string(__doc__, writer_name='html')

    print docstring_html


    # Unit test output goes out stderr.
    import unittest
    sp = smartyPants

    class TestSmartypantsAllAttributes(unittest.TestCase):
        # the default attribute is "1", which means "all".

        def test_dates(self):
            self.assertEqual(sp("1440-80's"), u"1440-80â€™s")
            self.assertEqual(sp("1440-'80s"), u"1440-â€˜80s")
            self.assertEqual(sp("1440---'80s"), u"1440â€“â€˜80s")
            self.assertEqual(sp("1960s"), "1960s")  # no effect.
            self.assertEqual(sp("1960's"), u"1960â€™s")
            self.assertEqual(sp("one two '60s"), u"one two â€˜60s")
            self.assertEqual(sp("'60s"), u"â€˜60s")

        def test_ordinal_numbers(self):
            self.assertEqual(sp("21st century"), "21st century")  # no effect.
            self.assertEqual(sp("3rd"), "3rd")  # no effect.

        def test_educated_quotes(self):
            self.assertEqual(sp('''"Isn't this fun?"'''), u'â€œIsnâ€™t this fun?â€')

        def test_html_tags(self):
            text = '<a src="foo">more</a>'
            self.assertEqual(sp(text), text)

    unittest.main()




__author__ = "Chad Miller <smartypantspy@chad.org>"
__version__ = "1.5_1.6: Fri, 27 Jul 2007 07:06:40 -0400"
__url__ = "http://wiki.chad.org/SmartyPantsPy"
__description__ = "Smart-quotes, smart-ellipses, and smart-dashes for weblog entries in pyblosxom"
                                                                                                                                                                                                                                                                                                                                                                                                                      usr/local/lib/python2.7/dist-packages/docutils/utils/smartquotes.pyc                                0100644 0000000 0000062 00000071213 13077704402 024317  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   si  d  Z  d Z d d l Z d e f d „  ƒ  YZ e d d „ Z e d d „ Z d d	 „ Z d d
 „ Z d d „ Z	 d „  Z
 d „  Z d „  Z d „  Z d d „ Z e d „ Z d „  Z e d k rMd d l Z y e j e j d ƒ Wn n Xd d l m Z e e  d d ƒZ e GHd d l Z e Z d e j f d „  ƒ  YZ e j ƒ  n  d Z d Z d Z  d Z! d S(   sR4  
========================
SmartyPants for Docutils
========================

Synopsis
========

Smart-quotes for Docutils.

The original "SmartyPants" is a free web publishing plug-in for Movable Type,
Blosxom, and BBEdit that easily translates plain ASCII punctuation characters
into "smart" typographic punctuation characters.

`smartypants.py`, endeavours to be a functional port of
SmartyPants to Python, for use with Pyblosxom_.

`smartquotes.py` is an adaption of Smartypants to Docutils_. By using Unicode
characters instead of HTML entities for typographic quotes, it works for any
output format that supports Unicode.

Authors
=======

`John Gruber`_ did all of the hard work of writing this software in Perl for
`Movable Type`_ and almost all of this useful documentation.  `Chad Miller`_
ported it to Python to use with Pyblosxom_.
Adapted to Docutils_ by GÃ¼nter Milde.

Additional Credits
==================

Portions of the SmartyPants original work are based on Brad Choate's nifty
MTRegex plug-in.  `Brad Choate`_ also contributed a few bits of source code to
this plug-in.  Brad Choate is a fine hacker indeed.

`Jeremy Hedley`_ and `Charles Wiltgen`_ deserve mention for exemplary beta
testing of the original SmartyPants.

`Rael Dornfest`_ ported SmartyPants to Blosxom.

.. _Brad Choate: http://bradchoate.com/
.. _Jeremy Hedley: http://antipixel.com/
.. _Charles Wiltgen: http://playbacktime.com/
.. _Rael Dornfest: http://raelity.org/


Copyright and License
=====================

SmartyPants_ license (3-Clause BSD license):

  Copyright (c) 2003 John Gruber (http://daringfireball.net/)
  All rights reserved.

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

  * Neither the name "SmartyPants" nor the names of its contributors
    may be used to endorse or promote products derived from this
    software without specific prior written permission.

  This software is provided by the copyright holders and contributors
  "as is" and any express or implied warranties, including, but not
  limited to, the implied warranties of merchantability and fitness for
  a particular purpose are disclaimed. In no event shall the copyright
  owner or contributors be liable for any direct, indirect, incidental,
  special, exemplary, or consequential damages (including, but not
  limited to, procurement of substitute goods or services; loss of use,
  data, or profits; or business interruption) however caused and on any
  theory of liability, whether in contract, strict liability, or tort
  (including negligence or otherwise) arising in any way out of the use
  of this software, even if advised of the possibility of such damage.

smartypants.py license (2-Clause BSD license):

  smartypants.py is a derivative work of SmartyPants.

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

  This software is provided by the copyright holders and contributors
  "as is" and any express or implied warranties, including, but not
  limited to, the implied warranties of merchantability and fitness for
  a particular purpose are disclaimed. In no event shall the copyright
  owner or contributors be liable for any direct, indirect, incidental,
  special, exemplary, or consequential damages (including, but not
  limited to, procurement of substitute goods or services; loss of use,
  data, or profits; or business interruption) however caused and on any
  theory of liability, whether in contract, strict liability, or tort
  (including negligence or otherwise) arising in any way out of the use
  of this software, even if advised of the possibility of such damage.

.. _John Gruber: http://daringfireball.net/
.. _Chad Miller: http://web.chad.org/

.. _Pyblosxom: http://pyblosxom.bluesock.org/
.. _SmartyPants: http://daringfireball.net/projects/smartypants/
.. _Movable Type: http://www.movabletype.org/
.. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
.. _Docutils: http://docutils.sf.net/

Description
===========

SmartyPants can perform the following transformations:

- Straight quotes ( " and ' ) into "curly" quote characters
- Backticks-style quotes (\`\`like this'') into "curly" quote characters
- Dashes (``--`` and ``---``) into en- and em-dash entities
- Three consecutive dots (``...`` or ``. . .``) into an ellipsis entity

This means you can write, edit, and save your posts using plain old
ASCII straight quotes, plain dashes, and plain dots, but your published
posts (and final HTML output) will appear with smart quotes, em-dashes,
and proper ellipses.

SmartyPants does not modify characters within ``<pre>``, ``<code>``, ``<kbd>``,
``<math>`` or ``<script>`` tag blocks. Typically, these tags are used to
display text where smart quotes and other "smart punctuation" would not be
appropriate, such as source code or example markup.


Backslash Escapes
=================

If you need to use literal straight quotes (or plain hyphens and
periods), SmartyPants accepts the following backslash escape sequences
to force non-smart punctuation. It does so by transforming the escape
sequence into a character:

========  =====  =========
Escape    Value  Character
========  =====  =========
``\\\\``  &#92;  \\
\\"       &#34;  "
\\'       &#39;  '
\\.       &#46;  .
\\-       &#45;  \-
\\`       &#96;  \`
========  =====  =========

This is useful, for example, when you want to use straight quotes as
foot and inch marks: 6\\'2\\" tall; a 17\\" iMac.

Options
=======

For Pyblosxom users, the ``smartypants_attributes`` attribute is where you
specify configuration options.

Numeric values are the easiest way to configure SmartyPants' behavior:

"0"
        Suppress all transformations. (Do nothing.)
"1"
        Performs default SmartyPants transformations: quotes (including
        \`\`backticks'' -style), em-dashes, and ellipses. "``--``" (dash dash)
        is used to signify an em-dash; there is no support for en-dashes.

"2"
        Same as smarty_pants="1", except that it uses the old-school typewriter
        shorthand for dashes:  "``--``" (dash dash) for en-dashes, "``---``"
        (dash dash dash)
        for em-dashes.

"3"
        Same as smarty_pants="2", but inverts the shorthand for dashes:
        "``--``" (dash dash) for em-dashes, and "``---``" (dash dash dash) for
        en-dashes.

"-1"
        Stupefy mode. Reverses the SmartyPants transformation process, turning
        the characters produced by SmartyPants into their ASCII equivalents.
        E.g.  "â€œ" is turned into a simple double-quote (\"), "â€”" is
        turned into two dashes, etc.


The following single-character attribute values can be combined to toggle
individual transformations from within the smarty_pants attribute. For
example, to educate normal quotes and em-dashes, but not ellipses or
\`\`backticks'' -style quotes:

``py['smartypants_attributes'] = "1"``

"q"
        Educates normal quote characters: (") and (').

"b"
        Educates \`\`backticks'' -style double quotes.

"B"
        Educates \`\`backticks'' -style double quotes and \`single' quotes.

"d"
        Educates em-dashes.

"D"
        Educates em-dashes and en-dashes, using old-school typewriter shorthand:
        (dash dash) for en-dashes, (dash dash dash) for em-dashes.

"i"
        Educates em-dashes and en-dashes, using inverted old-school typewriter
        shorthand: (dash dash) for em-dashes, (dash dash dash) for en-dashes.

"e"
        Educates ellipses.

"w"
        Translates any instance of ``&quot;`` into a normal double-quote character.
        This should be of no interest to most people, but of particular interest
        to anyone who writes their posts using Dreamweaver, as Dreamweaver
        inexplicably uses this entity to represent a literal double-quote
        character. SmartyPants only educates normal quotes, not entities (because
        ordinarily, entities are used for the explicit purpose of representing the
        specific character they represent). The "w" option must be used in
        conjunction with one (or both) of the other quote options ("q" or "b").
        Thus, if you wish to apply all SmartyPants transformations (quotes, en-
        and em-dashes, and ellipses) and also translate ``&quot;`` entities into
        regular quotes so SmartyPants can educate them, you should pass the
        following to the smarty_pants attribute:


Caveats
=======

Why You Might Not Want to Use Smart Quotes in Your Weblog
---------------------------------------------------------

For one thing, you might not care.

Most normal, mentally stable individuals do not take notice of proper
typographic punctuation. Many design and typography nerds, however, break
out in a nasty rash when they encounter, say, a restaurant sign that uses
a straight apostrophe to spell "Joe's".

If you're the sort of person who just doesn't care, you might well want to
continue not caring. Using straight quotes -- and sticking to the 7-bit
ASCII character set in general -- is certainly a simpler way to live.

Even if you I *do* care about accurate typography, you still might want to
think twice before educating the quote characters in your weblog. One side
effect of publishing curly quote characters is that it makes your
weblog a bit harder for others to quote from using copy-and-paste. What
happens is that when someone copies text from your blog, the copied text
contains the 8-bit curly quote characters (as well as the 8-bit characters
for em-dashes and ellipses, if you use these options). These characters
are not standard across different text encoding methods, which is why they
need to be encoded as characters.

People copying text from your weblog, however, may not notice that you're
using curly quotes, and they'll go ahead and paste the unencoded 8-bit
characters copied from their browser into an email message or their own
weblog. When pasted as raw "smart quotes", these characters are likely to
get mangled beyond recognition.

That said, my own opinion is that any decent text editor or email client
makes it easy to stupefy smart quote characters into their 7-bit
equivalents, and I don't consider it my problem if you're using an
indecent text editor or email client.


Algorithmic Shortcomings
------------------------

One situation in which quotes will get curled the wrong way is when
apostrophes are used at the start of leading contractions. For example:

``'Twas the night before Christmas.``

In the case above, SmartyPants will turn the apostrophe into an opening
single-quote, when in fact it should be a closing one. I don't think
this problem can be solved in the general case -- every word processor
I've tried gets this wrong as well. In such cases, it's best to use the
proper character for closing single-quotes (``â€™``) by hand.


Version History
===============

1.7     2012-11-19
        - Internationalization: language-dependent quotes.

1.6.1:  2012-11-06
        - Refactor code, code cleanup,
        - `educate_tokens()` generator as interface for Docutils.

1.6:    2010-08-26
        - Adaption to Docutils:
          - Use Unicode instead of HTML entities,
          - Remove code special to pyblosxom.

1.5_1.6: Fri, 27 Jul 2007 07:06:40 -0400
        - Fixed bug where blocks of precious unalterable text was instead
          interpreted.  Thanks to Le Roux and Dirk van Oosterbosch.

1.5_1.5: Sat, 13 Aug 2005 15:50:24 -0400
        - Fix bogus magical quotation when there is no hint that the
          user wants it, e.g., in "21st century".  Thanks to Nathan Hamblen.
        - Be smarter about quotes before terminating numbers in an en-dash'ed
          range.

1.5_1.4: Thu, 10 Feb 2005 20:24:36 -0500
        - Fix a date-processing bug, as reported by jacob childress.
        - Begin a test-suite for ensuring correct output.
        - Removed import of "string", since I didn't really need it.
          (This was my first every Python program.  Sue me!)

1.5_1.3: Wed, 15 Sep 2004 18:25:58 -0400
        - Abort processing if the flavour is in forbidden-list.  Default of
          [ "rss" ]   (Idea of Wolfgang SCHNERRING.)
        - Remove stray virgules from en-dashes.  Patch by Wolfgang SCHNERRING.

1.5_1.2: Mon, 24 May 2004 08:14:54 -0400
        - Some single quotes weren't replaced properly.  Diff-tesuji played
          by Benjamin GEIGER.

1.5_1.1: Sun, 14 Mar 2004 14:38:28 -0500
        - Support upcoming pyblosxom 0.9 plugin verification feature.

1.5_1.0: Tue, 09 Mar 2004 08:08:35 -0500
        - Initial release
t   1iÿÿÿÿNt
   smartcharsc           B   s‰  e  Z d  Z d Z d Z d Z i1 d d 6d d 6d d	 6d d
 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d  d! 6d" d# 6dH d( 6d d) 6d d* 6d d+ 6d, d- 6d d. 6d d/ 6d d0 6d d1 6d2 d3 6d d4 6d d5 6d d6 6d7 d8 6d d9 6d d: 6d d; 6d7 d< 6d= d> 6d? d@ 6d dA 6d dB 6d dC 6d dD 6d dE 6d d/ 6d2 dF 6Z d dG „ Z RS(I   s   Smart quotes and dashes
    u   â€“u   â€”u   â€¦u   â€œâ€â€˜â€™t   afu   â€â€â€šâ€™s   af-x-altquotu
   Â«Â»â€œâ€t   cas   ca-x-altquotu   â€â€œâ€šâ€˜t   csu
   Â»Â«â€ºâ€¹s   cs-x-altquotu
   Â»Â«â€˜â€™t   das   da-x-altquott   des   de-x-altquotu
   Â«Â»â€¹â€ºs   de-CHt   elt   enu   â€˜â€™â€œâ€s   en-UKt   eot   est   ets   et-x-altquott   eus   es-x-altquotu   â€â€â€™â€™t   fiu
   Â»Â»â€™â€™s   fi-x-altquotu   Â«â€¯u   â€¯Â»u   â€¹â€¯u   â€¯â€ºt   frs   fr-x-altquots   fr-CHt   glu
   â€â€œÂ»Â«t   hes   he-x-altquott   its   it-CHs   it-x-altquotu   ã€Œã€ã€ã€t   jat   ltt   nls   nl-x-altquotu
   â€â€Â«Â»t   pls   pl-x-altquott   pts   pt-BRt   rou
   Â«Â»â€â€s   ro-x-altquotu
   Â«Â»â€â€œt   rut   sks   sk-x-altquott   svs   sv-x-altquots   zh-CNs   zh-TWc         C   sh   | |  _  y) |  j | \ |  _ |  _ |  _ |  _ Wn/ t k
 rc d \ |  _ |  _ |  _ |  _ n Xd  S(   Nu   ""''(   t   languaget   quotest   opquotet   cpquotet   osquotet   csquotet   KeyError(   t   selfR   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyt   __init__µ  s
    	)(   u   Â«â€¯u   â€¯Â»u   â€¹â€¯u   â€¯â€º(   t   __name__t
   __module__t   __doc__t   endasht   emdasht   ellipsisR   R#   (    (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyR   n  sl   

R   c         C   s2   d j  g  t t |  ƒ | | ƒ D] } | ^ q ƒ S(   s$   Main function for "traditional" use.t    (   t   joint   educate_tokenst   tokenize(   t   textt   attrR   t   t(    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyt   smartyPants¾  s    c         c   sï  t  } t  } t  } t  } t  } t  } | d k r8 |	 Vn2| d k r_ t } t } d } t } n| d k r† t } t } d } t } nä | d k r­ t } t } d } t } n½ | d k rÂ t } n¨ d	 | k r× t } n  d
 | k rì t } n  d | k rd } n  d | k rd } n  d | k r+d } n  d | k r@d } n  d | k rUt } n  d | k rjt } n  d }
 xx|  D]p\ } }	 | d k s–|	 r¡|	 Vqwn  | d k rÂ|	 d }
 |	 Vqwn  |	 d } t |	 ƒ }	 | röt j d d |	 ƒ }	 n  | d k rt |	 ƒ }	 n6 | d k r,t |	 ƒ }	 n | d k rGt |	 ƒ }	 n  | r\t |	 ƒ }	 n  | rtt	 |	 | ƒ }	 n  | d k r’t
 |	 | ƒ }	 n  | r²t |
 |	 | ƒ d }	 n  | rÊt |	 | ƒ }	 n  | }
 t |	 d t ƒ}	 |	 VqwWd S(   s@   Return iterator that "educates" the items of `text_tokens`.
    t   0R    i   t   2i   t   3i   s   -1t   qt   bt   Bt   dt   Dt   it   et   wt    t   tagt   literaliÿÿÿÿs   &quot;t   "t   restoreN(   t   Falset   Truet   processEscapest   ret   subt   educateDashest   educateDashesOldSchoolt   educateDashesOldSchoolInvertedt   educateEllipsest   educateBacktickst   educateSingleBacktickst   educateQuotest   stupefyEntities(   t   text_tokensR/   R   t   convert_quott	   do_dashest   do_backtickst	   do_quotest   do_ellipsest
   do_stupefyR.   t   prev_token_last_chart   ttypet	   last_char(    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyR,   Å  s’    				 	 	 	 	 	 	 	 	

c   
      C   s   t  | ƒ } d } t j d | f | j |  ƒ }  t j d | f | j |  ƒ }  t j d | j | j |  ƒ }  t j d | j | j |  ƒ }  t j d | j |  ƒ }  d } d } t j d	 | f t j ƒ } | j d
 | j |  ƒ }  t j d | f t j ƒ } | j d
 | j |  ƒ }  t j d | f t j ƒ } | j d | j |  ƒ }  t j d | j |  ƒ }  t j d | f t j ƒ } | j d
 | j |  ƒ }  t j d | f t j ƒ }	 |	 j | j |  ƒ }  t j d | f t j ƒ }	 |	 j d
 | j |  ƒ }  t j d | j |  ƒ }  |  S(   s  
    Parameter:  - text string (unicode or bytes).
                - language (`BCP 47` language tag.)
    Returns:    The `text`, with "educated" curly quote characters.

    Example input:  "Isn't this fun?"
    Example output: â€œIsnâ€™t this fun?â€œ;
    s)   [!"#\$\%'()*+,-.\/:;<=>?\@\[\\\]\^_`{|}~]s   ^'(?=%s\\B)s   ^"(?=%s\\B)s   "'(?=\w)s   '"(?=\w)s   \b'(?=\d{2}s)s   [^\ \t\r\n\[\{\(\-]s   &#8211;|&#8212;s<  
                    (
                            \s          |   # a whitespace char, or
                            &nbsp;      |   # a non-breaking space entity, or
                            --          |   # dashes, or
                            &[mn]dash;  |   # named dash entities
                            %s          |   # or decimal entities
                            &\#x201[34];    # or hex
                    )
                    '                 # the quote
                    (?=\w)            # followed by a word character
                    s   \1sj   
                    (%s)
                    '
                    (?!\s | s\b | \d)
                    sc   
                    (%s)
                    '
                    (\s | s\b)
                    s   \1%s\2t   's<  
                    (
                            \s          |   # a whitespace char, or
                            &nbsp;      |   # a non-breaking space entity, or
                            --          |   # dashes, or
                            &[mn]dash;  |   # named dash entities
                            %s          |   # or decimal entities
                            &\#x201[34];    # or hex
                    )
                    "                 # the quote
                    (?=\w)            # followed by a word character
                    sš   
                    #(%s)?   # character that indicates the quote should be closing
                    "
                    (?=\s)
                    s}   
                    (%s)   # character that indicates the quote should be closing
                    "
                    R@   (	   R   RE   RF   R    R   R   R   t   compilet   VERBOSE(
   R.   R   t   smartt   punct_classt   close_classt
   dec_dashest   opening_single_quotes_regext   closing_single_quotes_regext   opening_double_quotes_regext   closing_double_quotes_regex(    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRM   7  s<    
c         C   s@   t  | ƒ } t j d | j |  ƒ }  t j d | j |  ƒ }  |  S(   s  
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with ``backticks'' -style double quotes
                translated into HTML curly quote entities.
    Example input:  ``Isn't this fun?''
    Example output: â€œIsn't this fun?â€œ;
    s   ``s   ''(   R   RE   RF   R   R   (   R.   R   R\   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRK   š  s    c         C   s@   t  | ƒ } t j d | j |  ƒ }  t j d | j |  ƒ }  |  S(   s   
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with `backticks' -style single quotes
                translated into HTML curly quote entities.

    Example input:  `Isn't this fun?'
    Example output: â€˜Isnâ€™t this fun?â€™
    t   `RY   (   R   RE   RF   R   R    (   R.   R   R\   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRL   ©  s    	c         C   s4   t  j d t j |  ƒ }  t  j d t j |  ƒ }  |  S(   s›   
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "--" translated to
                an em-dash character.
    s   ---s   --(   RE   RF   R   R'   R(   (   R.   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRG   ¹  s    c         C   s4   t  j d t j |  ƒ }  t  j d t j |  ƒ }  |  S(   sŞ   
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "--" translated to
                an en-dash character, and each "---" translated to
                an em-dash character.
    s   ---s   --(   RE   RF   R   R(   R'   (   R.   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRH   Å  s    c         C   s4   t  j d t j |  ƒ }  t  j d t j |  ƒ }  |  S(   sÆ  
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "--" translated to
                an em-dash character, and each "---" translated to
                an en-dash character. Two reasons why: First, unlike the
                en- and em-dash syntax supported by
                EducateDashesOldSchool(), it's compatible with existing
                entries written before SmartyPants 1.1, back when "--" was
                only used for em-dashes.  Second, em-dashes are more
                common than en-dashes, and so it sort of makes sense that
                the shortcut should be shorter to type. (Thanks to Aaron
                Swartz for the idea.)
    s   ---s   --(   RE   RF   R   R'   R(   (   R.   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRI   Ò  s    c         C   s4   t  j d t j |  ƒ }  t  j d t j |  ƒ }  |  S(   sÚ   
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each instance of "..." translated to
                an ellipsis character.

    Example input:  Huh...?
    Example output: Huh&#8230;?
    s   \.\.\.s   \. \. \.(   RE   RF   R   R)   (   R.   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRJ   æ  s    
c         C   s¸   t  | ƒ } t j | j d |  ƒ }  t j | j d |  ƒ }  t j | j d |  ƒ }  t j | j d |  ƒ }  t j | j d |  ƒ }  t j | j d |  ƒ }  t j | j	 d |  ƒ }  |  S(   só   
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with each SmartyPants character translated to
                its ASCII counterpart.

    Example input:  â€œHello â€” world.â€
    Example output: "Hello -- world."
    t   -s   --RY   R@   s   ...(
   R   RE   RF   R'   R(   R   R    R   R   R)   (   R.   R   R\   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRN   õ  s    	c         C   s{   d d d d d d f } | rN xV | D]" \ } } |  j  | | d ƒ }  q% Wn) x& | D] \ } } |  j  | | ƒ }  qU W|  S(   sî  
    Parameter:  String (unicode or bytes).
    Returns:    The `text`, with after processing the following backslash
                escape sequences. This is useful if you want to force a "dumb"
                quote or other character to appear.

                Escape  Value
                ------  -----
                \\      &#92;
                \"      &#34;
                \'      &#39;
                \.      &#46;
                \-      &#45;
                \`      &#96;
    s   \\s   &#92;s   \"s   &#34;s   \'s   &#39;s   \.s   &#46;s   \-s   &#45;s   \`s   &#96;i   (   s   \\s   &#92;(   s   \"s   &#34;(   s   \'s   &#39;(   s   \.s   &#46;(   s   \-s   &#45;(   s   \`s   &#96;(   t   replace(   R.   RA   t   replacementst   cht   rep(    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyRD     s    	c         c   só   d } t  |  ƒ } d } d j d g | ƒ d | } t j d ƒ } | j |  ƒ } d } xn | d k	 rÊ | j d ƒ r d | j d ƒ f Vn  d	 | j d
 ƒ f V| j ƒ  } | j |  | j ƒ  ƒ } q] W| t  |  ƒ k  rï d |  | f Vn  d S(   sL  
    Parameter:  String containing HTML markup.
    Returns:    An iterator that yields the tokens comprising the input
                string. Each token is either a tag (possibly with nested,
                tags contained therein, such as <a href="<MTFoo>">, or a
                run of text between tags. Each yielded element is a
                two-element tuple; the first is either 'tag' or 'text';
                the second is the actual value.

    Based on the _tokenize() subroutine from Brad Choate's MTRegex plugin.
        <http://www.bradchoate.com/past/mtregex.php>
    i    i   t   |s   (?:<(?:[^<>]s   )*>)s   ([^<]*)(<[^>]*>)i   R.   R>   i   N(   t   lenR+   RE   RZ   t   searcht   Nonet   groupt   end(   R.   t   post   lengtht   deptht   nested_tagst   tag_soupt   token_matcht   previous_end(    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyR-   .  s    t   __main__R*   (   t   publish_stringt   writer_namet   htmlt   TestSmartypantsAllAttributesc           B   s,   e  Z d  „  Z d „  Z d „  Z d „  Z RS(   c         C   s   |  j  t d ƒ d ƒ |  j  t d ƒ d ƒ |  j  t d ƒ d ƒ |  j  t d ƒ d ƒ |  j  t d ƒ d	 ƒ |  j  t d
 ƒ d ƒ |  j  t d ƒ d ƒ d  S(   Ns	   1440-80'su   1440-80â€™ss	   1440-'80su   1440-â€˜80ss   1440---'80su   1440â€“â€˜80st   1960ss   1960'su   1960â€™ss   one two '60su   one two â€˜60ss   '60su   â€˜60s(   t   assertEqualt   sp(   R"   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyt
   test_datesn  s    c         C   s0   |  j  t d ƒ d ƒ |  j  t d ƒ d ƒ d  S(   Ns   21st centuryt   3rd(   R}   R~   (   R"   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyt   test_ordinal_numbersw  s    c         C   s   |  j  t d ƒ d ƒ d  S(   Ns   "Isn't this fun?"u   â€œIsnâ€™t this fun?â€(   R}   R~   (   R"   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyt   test_educated_quotes{  s    c         C   s    d } |  j  t | ƒ | ƒ d  S(   Ns   <a src="foo">more</a>(   R}   R~   (   R"   R.   (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyt   test_html_tags~  s    (   R$   R%   R   R   R‚   Rƒ   (    (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyR{   k  s   				s$   Chad Miller <smartypantspy@chad.org>s(   1.5_1.6: Fri, 27 Jul 2007 07:06:40 -0400s"   http://wiki.chad.org/SmartyPantsPysN   Smart-quotes, smart-ellipses, and smart-dashes for weblog entries in pyblosxom("   R&   t   default_smartypants_attrRE   t   objectR   R1   R,   RM   RK   RL   RG   RH   RI   RJ   RN   RB   RD   R-   R$   t   localet	   setlocalet   LC_ALLt   docutils.coreRx   t   docstring_htmlt   unittestR~   t   TestCaseR{   t   maint
   __author__t   __version__t   __url__t   __description__(    (    (    s<   /tmp/pip-build-awuatQ/docutils/docutils/utils/smartquotes.pyt   <module>g  s@   Prc				 	*                                                                                                                                                                                                                                                                                                                                                                                     usr/local/lib/python2.7/dist-packages/docutils/utils/urischemes.py                                  0100644 0000000 0000062 00000014203 13077704374 023740  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # $Id: urischemes.py 7922 2015-09-22 15:28:09Z milde $
# Author: David Goodger <goodger@python.org>
# Copyright: This module has been placed in the public domain.

"""
`schemes` is a dictionary with lowercase URI addressing schemes as
keys and descriptions as values. It was compiled from the index at
http://www.iana.org/assignments/uri-schemes (revised 2005-11-28)
and an older list at http://www.w3.org/Addressing/schemes.html.
"""

# Many values are blank and should be filled in with useful descriptions.

schemes = {
      'about': 'provides information on Navigator',
      'acap': 'Application Configuration Access Protocol; RFC 2244',
      'addbook': "To add vCard entries to Communicator's Address Book",
      'afp': 'Apple Filing Protocol',
      'afs': 'Andrew File System global file names',
      'aim': 'AOL Instant Messenger',
      'callto': 'for NetMeeting links',
      'castanet': 'Castanet Tuner URLs for Netcaster',
      'chttp': 'cached HTTP supported by RealPlayer',
      'cid': 'content identifier; RFC 2392',
      'crid': 'TV-Anytime Content Reference Identifier; RFC 4078',
      'data': ('allows inclusion of small data items as "immediate" data; '
               'RFC 2397'),
      'dav': 'Distributed Authoring and Versioning Protocol; RFC 2518',
      'dict': 'dictionary service protocol; RFC 2229',
      'dns': 'Domain Name System resources',
      'eid': ('External ID; non-URL data; general escape mechanism to allow '
              'access to information for applications that are too '
              'specialized to justify their own schemes'),
      'fax': ('a connection to a terminal that can handle telefaxes '
              '(facsimiles); RFC 2806'),
      'feed' : 'NetNewsWire feed',
      'file': 'Host-specific file names; RFC 1738',
      'finger': '',
      'freenet': '',
      'ftp': 'File Transfer Protocol; RFC 1738',
      'go': 'go; RFC 3368',
      'gopher': 'The Gopher Protocol',
      'gsm-sms': ('Global System for Mobile Communications Short Message '
                  'Service'),
      'h323': ('video (audiovisual) communication on local area networks; '
               'RFC 3508'),
      'h324': ('video and audio communications over low bitrate connections '
               'such as POTS modem connections'),
      'hdl': 'CNRI handle system',
      'hnews': 'an HTTP-tunneling variant of the NNTP news protocol',
      'http': 'Hypertext Transfer Protocol; RFC 2616',
      'https': 'HTTP over SSL; RFC 2818',
      'hydra': 'SubEthaEdit URI.  See http://www.codingmonkeys.de/subethaedit.',
      'iioploc': 'Internet Inter-ORB Protocol Location?',
      'ilu': 'Inter-Language Unification',
      'im': 'Instant Messaging; RFC 3860',
      'imap': 'Internet Message Access Protocol; RFC 2192',
      'info': 'Information Assets with Identifiers in Public Namespaces',
      'ior': 'CORBA interoperable object reference',
      'ipp': 'Internet Printing Protocol; RFC 3510',
      'irc': 'Internet Relay Chat',
      'iris.beep': 'iris.beep; RFC 3983',
      'iseek' : 'See www.ambrosiasw.com;  a little util for OS X.',
      'jar': 'Java archive',
      'javascript': ('JavaScript code; evaluates the expression after the '
                     'colon'),
      'jdbc': 'JDBC connection URI.',
      'ldap': 'Lightweight Directory Access Protocol',
      'lifn': '',
      'livescript': '',
      'lrq': '',
      'mailbox': 'Mail folder access',
      'mailserver': 'Access to data available from mail servers',
      'mailto': 'Electronic mail address; RFC 2368',
      'md5': '',
      'mid': 'message identifier; RFC 2392',
      'mocha': '',
      'modem': ('a connection to a terminal that can handle incoming data '
                'calls; RFC 2806'),
      'mtqp': 'Message Tracking Query Protocol; RFC 3887',
      'mupdate': 'Mailbox Update (MUPDATE) Protocol; RFC 3656',
      'news': 'USENET news; RFC 1738',
      'nfs': 'Network File System protocol; RFC 2224',
      'nntp': 'USENET news using NNTP access; RFC 1738',
      'opaquelocktoken': 'RFC 2518',
      'phone': '',
      'pop': 'Post Office Protocol; RFC 2384',
      'pop3': 'Post Office Protocol v3',
      'pres': 'Presence; RFC 3859',
      'printer': '',
      'prospero': 'Prospero Directory Service; RFC 4157',
      'rdar' : ('URLs found in Darwin source '
                '(http://www.opensource.apple.com/darwinsource/).'),
      'res': '',
      'rtsp': 'real time streaming protocol; RFC 2326',
      'rvp': '',
      'rwhois': '',
      'rx': 'Remote Execution',
      'sdp': '',
      'service': 'service location; RFC 2609',
      'shttp': 'secure hypertext transfer protocol',
      'sip': 'Session Initiation Protocol; RFC 3261',
      'sips': 'secure session intitiaion protocol; RFC 3261',
      'smb': 'SAMBA filesystems.',
      'snews': 'For NNTP postings via SSL',
      'snmp': 'Simple Network Management Protocol; RFC 4088',
      'soap.beep': 'RFC 3288',
      'soap.beeps': 'RFC 3288',
      'ssh': 'Reference to interactive sessions via ssh.',
      't120': 'real time data conferencing (audiographics)',
      'tag': 'RFC 4151',
      'tcp': '',
      'tel': ('a connection to a terminal that handles normal voice '
              'telephone calls, a voice mailbox or another voice messaging '
              'system or a service that can be operated using DTMF tones; '
              'RFC 3966.'),
      'telephone': 'telephone',
      'telnet': 'Reference to interactive sessions; RFC 4248',
      'tftp': 'Trivial File Transfer Protocol; RFC 3617',
      'tip': 'Transaction Internet Protocol; RFC 2371',
      'tn3270': 'Interactive 3270 emulation sessions',
      'tv': '',
      'urn': 'Uniform Resource Name; RFC 2141',
      'uuid': '',
      'vemmi': 'versatile multimedia interface; RFC 2122',
      'videotex': '',
      'view-source': 'displays HTML code that was generated with JavaScript',
      'wais': 'Wide Area Information Servers; RFC 4156',
      'whodp': '',
      'whois++': 'Distributed directory service.',
      'x-man-page': ('Opens man page in Terminal.app on OS X '
                     '(see macosxhints.com)'),
      'xmlrpc.beep': 'RFC 3529',
      'xmlrpc.beeps': 'RFC 3529',
      'z39.50r': 'Z39.50 Retrieval; RFC 2056',
      'z39.50s': 'Z39.50 Session; RFC 2056',}
                                                                                                                                                                                                                                                                                                                                                                                             usr/local/lib/python2.7/dist-packages/docutils/utils/urischemes.pyc                                 0100644 0000000 0000062 00000014273 13077704402 024102  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   s  d  Z  il d d 6d d 6d d 6d d 6d	 d
 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d  6d! d" 6d# d$ 6d% d& 6d' d( 6d' d) 6d* d+ 6d, d- 6d. d/ 6d0 d1 6d2 d3 6d4 d5 6d6 d7 6d8 d9 6d: d; 6d< d= 6d> d? 6d@ dA 6dB dC 6dD dE 6dF dG 6dH dI 6dJ dK 6dL dM 6dN dO 6dP dQ 6dR dS 6dT dU 6dV dW 6dX dY 6dZ d[ 6d' d\ 6d' d] 6d' d^ 6d_ d` 6da db 6dc dd 6d' de 6df dg 6d' dh 6di dj 6dk dl 6dm dn 6do dp 6dq dr 6ds dt 6du dv 6d' dw 6dx dy 6dz d{ 6d| d} 6d' d~ 6d d€ 6d d‚ 6d' dƒ 6d„ d… 6d' d† 6d' d‡ 6dˆ d‰ 6d' dŠ 6d‹ dŒ 6d d 6d d 6d‘ d’ 6d“ d” 6d• d– 6d— d˜ 6d™ dš 6d™ d› 6dœ d 6d dŸ 6d  d¡ 6d' d¢ 6d£ d¤ 6d¥ d¥ 6d¦ d§ 6d¨ d© 6dª d« 6d¬ d­ 6d' d® 6d¯ d° 6d' d± 6d² d³ 6d' d´ 6dµ d¶ 6d· d¸ 6d' d¹ 6dº d» 6d¼ d½ 6d¾ d¿ 6d¾ dÀ 6dÁ dÂ 6dÃ dÄ 6Z dÅ S(Æ   s  
`schemes` is a dictionary with lowercase URI addressing schemes as
keys and descriptions as values. It was compiled from the index at
http://www.iana.org/assignments/uri-schemes (revised 2005-11-28)
and an older list at http://www.w3.org/Addressing/schemes.html.
s!   provides information on Navigatort   abouts3   Application Configuration Access Protocol; RFC 2244t   acaps3   To add vCard entries to Communicator's Address Bookt   addbooks   Apple Filing Protocolt   afps$   Andrew File System global file namest   afss   AOL Instant Messengert   aims   for NetMeeting linkst   calltos!   Castanet Tuner URLs for Netcastert   castanets#   cached HTTP supported by RealPlayert   chttps   content identifier; RFC 2392t   cids1   TV-Anytime Content Reference Identifier; RFC 4078t   cridsB   allows inclusion of small data items as "immediate" data; RFC 2397t   datas7   Distributed Authoring and Versioning Protocol; RFC 2518t   davs%   dictionary service protocol; RFC 2229t   dicts   Domain Name System resourcest   dnss™   External ID; non-URL data; general escape mechanism to allow access to information for applications that are too specialized to justify their own schemest   eidsK   a connection to a terminal that can handle telefaxes (facsimiles); RFC 2806t   faxs   NetNewsWire feedt   feeds"   Host-specific file names; RFC 1738t   filet    t   fingert   freenets    File Transfer Protocol; RFC 1738t   ftps   go; RFC 3368t   gos   The Gopher Protocolt   gophers=   Global System for Mobile Communications Short Message Services   gsm-smssB   video (audiovisual) communication on local area networks; RFC 3508t   h323sZ   video and audio communications over low bitrate connections such as POTS modem connectionst   h324s   CNRI handle systemt   hdls3   an HTTP-tunneling variant of the NNTP news protocolt   hnewss%   Hypertext Transfer Protocol; RFC 2616t   https   HTTP over SSL; RFC 2818t   httpss>   SubEthaEdit URI.  See http://www.codingmonkeys.de/subethaedit.t   hydras%   Internet Inter-ORB Protocol Location?t   iioplocs   Inter-Language Unificationt   ilus   Instant Messaging; RFC 3860t   ims*   Internet Message Access Protocol; RFC 2192t   imaps8   Information Assets with Identifiers in Public Namespacest   infos$   CORBA interoperable object referencet   iors$   Internet Printing Protocol; RFC 3510t   ipps   Internet Relay Chatt   ircs   iris.beep; RFC 3983s	   iris.beeps0   See www.ambrosiasw.com;  a little util for OS X.t   iseeks   Java archivet   jars9   JavaScript code; evaluates the expression after the colont
   javascripts   JDBC connection URI.t   jdbcs%   Lightweight Directory Access Protocolt   ldapt   lifnt
   livescriptt   lrqs   Mail folder accesst   mailboxs*   Access to data available from mail serverst
   mailservers!   Electronic mail address; RFC 2368t   mailtot   md5s   message identifier; RFC 2392t   midt   mochasH   a connection to a terminal that can handle incoming data calls; RFC 2806t   modems)   Message Tracking Query Protocol; RFC 3887t   mtqps+   Mailbox Update (MUPDATE) Protocol; RFC 3656t   mupdates   USENET news; RFC 1738t   newss&   Network File System protocol; RFC 2224t   nfss'   USENET news using NNTP access; RFC 1738t   nntps   RFC 2518t   opaquelocktokent   phones   Post Office Protocol; RFC 2384t   pops   Post Office Protocol v3t   pop3s   Presence; RFC 3859t   prest   printers$   Prospero Directory Service; RFC 4157t   prosperosL   URLs found in Darwin source (http://www.opensource.apple.com/darwinsource/).t   rdart   ress&   real time streaming protocol; RFC 2326t   rtspt   rvpt   rwhoiss   Remote Executiont   rxt   sdps   service location; RFC 2609t   services"   secure hypertext transfer protocolt   shttps%   Session Initiation Protocol; RFC 3261t   sips,   secure session intitiaion protocol; RFC 3261t   sipss   SAMBA filesystems.t   smbs   For NNTP postings via SSLt   snewss,   Simple Network Management Protocol; RFC 4088t   snmps   RFC 3288s	   soap.beeps
   soap.beepss*   Reference to interactive sessions via ssh.t   sshs+   real time data conferencing (audiographics)t   t120s   RFC 4151t   tagt   tcpsµ   a connection to a terminal that handles normal voice telephone calls, a voice mailbox or another voice messaging system or a service that can be operated using DTMF tones; RFC 3966.t   telt	   telephones+   Reference to interactive sessions; RFC 4248t   telnets(   Trivial File Transfer Protocol; RFC 3617t   tftps'   Transaction Internet Protocol; RFC 2371t   tips#   Interactive 3270 emulation sessionst   tn3270t   tvs   Uniform Resource Name; RFC 2141t   urnt   uuids(   versatile multimedia interface; RFC 2122t   vemmit   videotexs5   displays HTML code that was generated with JavaScripts   view-sources'   Wide Area Information Servers; RFC 4156t   waist   whodps   Distributed directory service.s   whois++s<   Opens man page in Terminal.app on OS X (see macosxhints.com)s
   x-man-pages   RFC 3529s   xmlrpc.beeps   xmlrpc.beepss   Z39.50 Retrieval; RFC 2056s   z39.50rs   Z39.50 Session; RFC 2056s   z39.50sN(   t   __doc__t   schemes(    (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/utils/urischemes.pyt   <module>
   sÚ                                                                                                                                                                                                                                                                                                                                        usr/local/lib/python2.7/dist-packages/docutils/writers/                                             0042755 0000000 0000062 00000000000 13077704402 021553  5                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        usr/local/lib/python2.7/dist-packages/docutils/writers/__init__.py                                  0100644 0000000 0000062 00000011072 13077704374 023670  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # $Id: __init__.py 7969 2016-08-18 21:40:00Z milde $
# Author: David Goodger <goodger@python.org>
# Copyright: This module has been placed in the public domain.

"""
This package contains Docutils Writer modules.
"""

__docformat__ = 'reStructuredText'

import os.path
import sys

import docutils
from docutils import languages, Component
from docutils.transforms import universal
if sys.version_info < (2,5):
    from docutils._compat import __import__


class Writer(Component):

    """
    Abstract base class for docutils Writers.

    Each writer module or package must export a subclass also called 'Writer'.
    Each writer must support all standard node types listed in
    `docutils.nodes.node_class_names`.

    The `write()` method is the main entry point.
    """

    component_type = 'writer'
    config_section = 'writers'

    def get_transforms(self):
        return Component.get_transforms(self) + [
            universal.Messages,
            universal.FilterMessages,
            universal.StripClassesAndElements,]

    document = None
    """The document to write (Docutils doctree); set by `write`."""

    output = None
    """Final translated form of `document` (Unicode string for text, binary
    string for other forms); set by `translate`."""

    language = None
    """Language module for the document; set by `write`."""

    destination = None
    """`docutils.io` Output object; where to write the document.
    Set by `write`."""

    def __init__(self):

        # Used by HTML and LaTeX writer for output fragments:
        self.parts = {}
        """Mapping of document part names to fragments of `self.output`.
        Values are Unicode strings; encoding is up to the client.  The 'whole'
        key should contain the entire document output.
        """

    def write(self, document, destination):
        """
        Process a document into its final form.

        Translate `document` (a Docutils document tree) into the Writer's
        native format, and write it out to its `destination` (a
        `docutils.io.Output` subclass object).

        Normally not overridden or extended in subclasses.
        """
        self.document = document
        self.language = languages.get_language(
            document.settings.language_code,
            document.reporter)
        self.destination = destination
        self.translate()
        output = self.destination.write(self.output)
        return output

    def translate(self):
        """
        Do final translation of `self.document` into `self.output`.  Called
        from `write`.  Override in subclasses.

        Usually done with a `docutils.nodes.NodeVisitor` subclass, in
        combination with a call to `docutils.nodes.Node.walk()` or
        `docutils.nodes.Node.walkabout()`.  The ``NodeVisitor`` subclass must
        support all standard elements (listed in
        `docutils.nodes.node_class_names`) and possibly non-standard elements
        used by the current Reader as well.
        """
        raise NotImplementedError('subclass must override this method')

    def assemble_parts(self):
        """Assemble the `self.parts` dictionary.  Extend in subclasses."""
        self.parts['whole'] = self.output
        self.parts['encoding'] = self.document.settings.output_encoding
        self.parts['version'] = docutils.__version__


class UnfilteredWriter(Writer):

    """
    A writer that passes the document tree on unchanged (e.g. a
    serializer.)

    Documents written by UnfilteredWriters are typically reused at a
    later date using a subclass of `readers.ReReader`.
    """

    def get_transforms(self):
        # Do not add any transforms.  When the document is reused
        # later, the then-used writer will add the appropriate
        # transforms.
        return Component.get_transforms(self)


_writer_aliases = {
      'html': 'html4css1',  # may change to html5 some day
      'html4': 'html4css1',
      'html5': 'html5_polyglot',
      'latex': 'latex2e',
      'pprint': 'pseudoxml',
      'pformat': 'pseudoxml',
      'pdf': 'rlpdf',
      's5': 's5_html',
      'xelatex': 'xetex',
      'xhtml': 'html5_polyglot',
      'xhtml10': 'html4css1',
      'xml': 'docutils_xml'}

def get_writer_class(writer_name):
    """Return the Writer class from the `writer_name` module."""
    writer_name = writer_name.lower()
    if writer_name in _writer_aliases:
        writer_name = _writer_aliases[writer_name]
    try:
        module = __import__(writer_name, globals(), locals(), level=1)
    except ImportError:
        module = __import__(writer_name, globals(), locals(), level=0)
    return module.Writer
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      usr/local/lib/python2.7/dist-packages/docutils/writers/__init__.pyc                                 0100644 0000000 0000062 00000011602 13077704402 024022  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   s  d  Z  d Z d d l Z d d l Z d d l Z d d l m Z m Z d d l m	 Z	 e j
 d" k  rx d d l m Z n  d	 e f d
 „  ƒ  YZ d e f d „  ƒ  YZ i d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d 6d d  6Z d! „  Z d S(#   s0   
This package contains Docutils Writer modules.
t   reStructuredTextiÿÿÿÿN(   t	   languagest	   Component(   t	   universali   i   (   t
   __import__t   Writerc           B   s_   e  Z d  Z d Z d Z d „  Z d Z d Z d Z	 d Z
 d „  Z d „  Z d „  Z d „  Z RS(	   s  
    Abstract base class for docutils Writers.

    Each writer module or package must export a subclass also called 'Writer'.
    Each writer must support all standard node types listed in
    `docutils.nodes.node_class_names`.

    The `write()` method is the main entry point.
    t   writert   writersc         C   s#   t  j |  ƒ t j t j t j g S(   N(   R   t   get_transformsR   t   Messagest   FilterMessagest   StripClassesAndElements(   t   self(    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyR   $   s    c         C   s   i  |  _  d  S(   N(   t   parts(   R   (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyt   __init__8   s    	c         C   sS   | |  _  t j | j j | j ƒ |  _ | |  _ |  j ƒ  |  j j	 |  j
 ƒ } | S(   s/  
        Process a document into its final form.

        Translate `document` (a Docutils document tree) into the Writer's
        native format, and write it out to its `destination` (a
        `docutils.io.Output` subclass object).

        Normally not overridden or extended in subclasses.
        (   t   documentR   t   get_languaget   settingst   language_codet   reportert   languaget   destinationt	   translatet   writet   output(   R   R   R   R   (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyR   A   s    
			
c         C   s   t  d ƒ ‚ d S(   s  
        Do final translation of `self.document` into `self.output`.  Called
        from `write`.  Override in subclasses.

        Usually done with a `docutils.nodes.NodeVisitor` subclass, in
        combination with a call to `docutils.nodes.Node.walk()` or
        `docutils.nodes.Node.walkabout()`.  The ``NodeVisitor`` subclass must
        support all standard elements (listed in
        `docutils.nodes.node_class_names`) and possibly non-standard elements
        used by the current Reader as well.
        s"   subclass must override this methodN(   t   NotImplementedError(   R   (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyR   T   s    c         C   s:   |  j  |  j d <|  j j j |  j d <t j |  j d <d S(   s<   Assemble the `self.parts` dictionary.  Extend in subclasses.t   wholet   encodingt   versionN(   R   R   R   R   t   output_encodingt   docutilst   __version__(   R   (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyt   assemble_partsb   s    N(   t   __name__t
   __module__t   __doc__t   component_typet   config_sectionR   t   NoneR   R   R   R   R   R   R   R    (    (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyR      s   
					t   UnfilteredWriterc           B   s   e  Z d  Z d „  Z RS(   sÓ   
    A writer that passes the document tree on unchanged (e.g. a
    serializer.)

    Documents written by UnfilteredWriters are typically reused at a
    later date using a subclass of `readers.ReReader`.
    c         C   s   t  j |  ƒ S(   N(   R   R   (   R   (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyR   s   s    (   R!   R"   R#   R   (    (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyR'   i   s   t	   html4css1t   htmlt   html4t   html5_polyglott   html5t   latex2et   latext	   pseudoxmlt   pprintt   pformatt   rlpdft   pdft   s5_htmlt   s5t   xetext   xelatext   xhtmlt   xhtml10t   docutils_xmlt   xmlc         C   s€   |  j  ƒ  }  |  t k r% t |  }  n  y" t |  t ƒ  t ƒ  d d ƒ} Wn/ t k
 rx t |  t ƒ  t ƒ  d d ƒ} n X| j S(   s6   Return the Writer class from the `writer_name` module.t   leveli   i    (   t   lowert   _writer_aliasesR   t   globalst   localst   ImportErrorR   (   t   writer_namet   module(    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyt   get_writer_classˆ   s    ""(   i   i   (   R#   t   __docformat__t   os.patht   ost   sysR   R   R   t   docutils.transformsR   t   version_infot   docutils._compatR   R   R'   R>   RD   (    (    (    s;   /tmp/pip-build-awuatQ/docutils/docutils/writers/__init__.pyt   <module>   s0   T
                                                                                                                              usr/local/lib/python2.7/dist-packages/docutils/writers/_html_base.py                                0100644 0000000 0000062 00000167562 13077704374 024246  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        #!/usr/bin/env python
# -*- coding: utf8 -*-
# :Author: David Goodger, GÃ¼nter Milde
#          Based on the html4css1 writer by David Goodger.
# :Maintainer: docutils-develop@lists.sourceforge.net
# :Revision: $Revision: 7977 $
# :Date: $Date: 2005-06-28$
# :Copyright: Â© 2016 David Goodger, GÃ¼nter Milde
# :License: Released under the terms of the `2-Clause BSD license`_, in short:
#
#    Copying and distribution of this file, with or without modification,
#    are permitted in any medium without royalty provided the copyright
#    notice and this notice are preserved.
#    This file is offered as-is, without any warranty.
#
# .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause


# _html_base.py:  common definitions for Docutils HTML writers
# ============================================================

import sys
import os.path
import re
import urllib
try: # check for the Python Imaging Library
    import PIL.Image
except ImportError:
    try:  # sometimes PIL modules are put in PYTHONPATH's root
        import Image
        class PIL(object): pass  # dummy wrapper
        PIL.Image = Image
    except ImportError:
        PIL = None
import docutils
from docutils import nodes, utils, writers, languages, io
from docutils.utils.error_reporting import SafeString
from docutils.transforms import writer_aux
from docutils.utils.math import (unichar2tex, pick_math_environment,
                                 math2html, latex2mathml, tex2mathml_extern)


class Writer(writers.Writer):

    supported = ('html', 'xhtml') # update in subclass
    """Formats this writer supports."""

    # default_stylesheets = [] # set in subclass!
    # default_stylesheet_dirs = ['.'] # set in subclass!
    default_template = 'template.txt'
    # default_template_path = ... # set in subclass!
    # settings_spec = ... # set in subclass!

    settings_defaults = {'output_encoding_error_handler': 'xmlcharrefreplace'}

    # config_section = ... # set in subclass!
    config_section_dependencies = ('writers',)

    visitor_attributes = (
        'head_prefix', 'head', 'stylesheet', 'body_prefix',
        'body_pre_docinfo', 'docinfo', 'body', 'body_suffix',
        'title', 'subtitle', 'header', 'footer', 'meta', 'fragment',
        'html_prolog', 'html_head', 'html_title', 'html_subtitle',
        'html_body')

    def get_transforms(self):
        return writers.Writer.get_transforms(self) + [writer_aux.Admonitions]

    def translate(self):
        self.visitor = visitor = self.translator_class(self.document)
        self.document.walkabout(visitor)
        for attr in self.visitor_attributes:
            setattr(self, attr, getattr(visitor, attr))
        self.output = self.apply_template()

    def apply_template(self):
        template_file = open(self.document.settings.template, 'rb')
        template = unicode(template_file.read(), 'utf-8')
        template_file.close()
        subs = self.interpolation_dict()
        return template % subs

    def interpolation_dict(self):
        subs = {}
        settings = self.document.settings
        for attr in self.visitor_attributes:
            subs[attr] = ''.join(getattr(self, attr)).rstrip('\n')
        subs['encoding'] = settings.output_encoding
        subs['version'] = docutils.__version__
        return subs

    def assemble_parts(self):
        writers.Writer.assemble_parts(self)
        for part in self.visitor_attributes:
            self.parts[part] = ''.join(getattr(self, part))



class HTMLTranslator(nodes.NodeVisitor):

    """Generic Docutils to HTML translator.

    See the html4css1 and html5_polyglott for writers for full featured HTML
    writers. """

    xml_declaration = '<?xml version="1.0" encoding="%s" ?>\n'
    doctype = '<!DOCTYPE html>\n'
    doctype_mathml = doctype

    head_prefix_template = ('<html xmlns="http://www.w3.org/1999/xhtml"'
                            ' xml:lang="%(lang)s" lang="%(lang)s">\n<head>\n')
    content_type = ('<meta charset="%s"/>\n')
    generator = ('<meta name="generator" content="Docutils %s: '
                 'http://docutils.sourceforge.net/" />\n')

    # Template for the MathJax script in the header:
    mathjax_script = '<script type="text/javascript" src="%s"></script>\n'
    # The latest version of MathJax from the distributed server:
    # avaliable to the public under the `MathJax CDN Terms of Service`__
    # __http://www.mathjax.org/download/mathjax-cdn-terms-of-service/
    # may be overwritten by custom URL appended to "mathjax"
    mathjax_url = ('https://cdn.mathjax.org/mathjax/latest/MathJax.js?'
                   'config=TeX-AMS_CHTML')

    stylesheet_link = '<link rel="stylesheet" href="%s" type="text/css" />\n'
    embedded_stylesheet = '<style type="text/css">\n\n%s\n</style>\n'
    words_and_spaces = re.compile(r'\S+| +|\n')
    sollbruchstelle = re.compile(r'.+\W\W.+|[-?].+', re.U) # wrap point inside word
    lang_attribute = 'lang' # name changes to 'xml:lang' in XHTML 1.1

    special_characters = {ord('&'): u'&amp;',
                          ord('<'): u'&lt;',
                          ord('"'): u'&quot;',
                          ord('>'): u'&gt;',
                          ord('@'): u'&#64;', # may thwart address harvesters
                         }
    """Character references for characters with a special meaning in HTML."""

    def __init__(self, document):
        nodes.NodeVisitor.__init__(self, document)
        self.settings = settings = document.settings
        lcode = settings.language_code
        self.language = languages.get_language(lcode, document.reporter)
        self.meta = [self.generator % docutils.__version__]
        self.head_prefix = []
        self.html_prolog = []
        if settings.xml_declaration:
            self.head_prefix.append(self.xml_declaration
                                    % settings.output_encoding)
            # self.content_type = ""
            # encoding not interpolated:
            self.html_prolog.append(self.xml_declaration)
        self.head = self.meta[:]
        self.stylesheet = [self.stylesheet_call(path)
                           for path in utils.get_stylesheet_list(settings)]
        self.body_prefix = ['</head>\n<body>\n']
        # document title, subtitle display
        self.body_pre_docinfo = []
        # author, date, etc.
        self.docinfo = []
        self.body = []
        self.fragment = []
        self.body_suffix = ['</body>\n</html>\n']
        self.section_level = 0
        self.initial_header_level = int(settings.initial_header_level)

        self.math_output = settings.math_output.split()
        self.math_output_options = self.math_output[1:]
        self.math_output = self.math_output[0].lower()

        # A heterogenous stack used in conjunction with the tree traversal.
        # Make sure that the pops correspond to the pushes:
        self.context = []

        self.topic_classes = [] # TODO: replace with self_in_contents
        self.colspecs = []
        self.compact_p = True
        self.compact_simple = False
        self.compact_field_list = False
        self.in_docinfo = False
        self.in_sidebar = False
        self.in_footnote_list = False
        self.title = []
        self.subtitle = []
        self.header = []
        self.footer = []
        self.html_head = [self.content_type] # charset not interpolated
        self.html_title = []
        self.html_subtitle = []
        self.html_body = []
        self.in_document_title = 0   # len(self.body) or 0
        self.in_mailto = False
        self.author_in_authors = False # for html4css1
        self.math_header = []

    def astext(self):
        return ''.join(self.head_prefix + self.head
                       + self.stylesheet + self.body_prefix
                       + self.body_pre_docinfo + self.docinfo
                       + self.body + self.body_suffix)

    def encode(self, text):
        """Encode special characters in `text` & return."""
        # Use only named entities known in both XML and HTML
        # other characters are automatically encoded "by number" if required.
        # @@@ A codec to do these and all other HTML entities would be nice.
        text = unicode(text)
        return text.translate(self.special_characters)

    def cloak_mailto(self, uri):
        """Try to hide a mailto: URL from harvesters."""
        # Encode "@" using a URL octet reference (see RFC 1738).
        # Further cloaking with HTML entities will be done in the
        # `attval` function.
        return uri.replace('@', '%40')

    def cloak_email(self, addr):
        """Try to hide the link text of a email link from harversters."""
        # Surround at-signs and periods with <span> tags.  ("@" has
        # already been encoded to "&#64;" by the `encode` method.)
        addr = addr.replace('&#64;', '<span>&#64;</span>')
        addr = addr.replace('.', '<span>&#46;</span>')
        return addr

    def attval(self, text,
               whitespace=re.compile('[\n\r\t\v\f]')):
        """Cleanse, HTML encode, and return attribute value text."""
        encoded = self.encode(whitespace.sub(' ', text))
        if self.in_mailto and self.settings.cloak_email_addresses:
            # Cloak at-signs ("%40") and periods with HTML entities.
            encoded = encoded.replace('%40', '&#37;&#52;&#48;')
            encoded = encoded.replace('.', '&#46;')
        return encoded

    def stylesheet_call(self, path):
        """Return code to reference or embed stylesheet file `path`"""
        if self.settings.embed_stylesheet:
            try:
                content = io.FileInput(source_path=path,
                                       encoding='utf-8').read()
                self.settings.record_dependencies.add(path)
            except IOError, err:
                msg = u"Cannot embed stylesheet '%s': %s." % (
                                path, SafeString(err.strerror))
                self.document.reporter.error(msg)
                return '<--- %s --->\n' % msg
            return self.embedded_stylesheet % content
        # else link to style file:
        if self.settings.stylesheet_path:
            # adapt path relative to output (cf. config.html#stylesheet-path)
            path = utils.relative_path(self.settings._destination, path)
        return self.stylesheet_link % self.encode(path)

    def starttag(self, node, tagname, suffix='\n', empty=False, **attributes):
        """
        Construct and return a start tag given a node (id & class attributes
        are extracted), tag name, and optional attributes.
        """
        tagname = tagname.lower()
        prefix = []
        atts = {}
        ids = []
        for (name, value) in attributes.items():
            atts[name.lower()] = value
        classes = []
        languages = []
        # unify class arguments and move language specification
        for cls in node.get('classes', []) + atts.pop('class', '').split() :
            if cls.startswith('language-'):
                languages.append(cls[9:])
            elif cls.strip() and cls not in classes:
                classes.append(cls)
        if languages:
            # attribute name is 'lang' in XHTML 1.0 but 'xml:lang' in 1.1
            atts[self.lang_attribute] = languages[0]
        if classes:
            atts['class'] = ' '.join(classes)
        assert 'id' not in atts
        ids.extend(node.get('ids', []))
        if 'ids' in atts:
            ids.extend(atts['ids'])
            del atts['ids']
        if ids:
            atts['id'] = ids[0]
            for id in ids[1:]:
                # Add empty "span" elements for additional IDs.  Note
                # that we cannot use empty "a" elements because there
                # may be targets inside of references, but nested "a"
                # elements aren't allowed in XHTML (even if they do
                # not all have a "href" attribute).
                if empty or isinstance(node,
                            (nodes.bullet_list, nodes.enumerated_list,
                             nodes.definition_list, nodes.field_list,
                             nodes.option_list, nodes.docinfo)):
                    # Insert target right in front of element.
                    prefix.append('<span id="%s"></span>' % id)
                else:
                    # Non-empty tag.  Place the auxiliary <span> tag
                    # *inside* the element, as the first child.
                    suffix += '<span id="%s"></span>' % id
        attlist = atts.items()
        attlist.sort()
        parts = [tagname]
        for name, value in attlist:
            # value=None was used for boolean attributes without
            # value, but this isn't supported by XHTML.
            assert value is not None
            if isinstance(value, list):
                values = [unicode(v) for v in value]
                parts.append('%s="%s"' % (name.lower(),
                                          self.attval(' '.join(values))))
            else:
                parts.append('%s="%s"' % (name.lower(),
                                          self.attval(unicode(value))))
        if empty:
            infix = ' /'
        else:
            infix = ''
        return ''.join(prefix) + '<%s%s>' % (' '.join(parts), infix) + suffix

    def emptytag(self, node, tagname, suffix='\n', **attributes):
        """Construct and return an XML-compatible empty tag."""
        return self.starttag(node, tagname, suffix, empty=True, **attributes)

    def set_class_on_child(self, node, class_, index=0):
        """
        Set class `class_` on the visible child no. index of `node`.
        Do nothing if node has fewer children than `index`.
        """
        children = [n for n in node if not isinstance(n, nodes.Invisible)]
        try:
            child = children[index]
        except IndexError:
            return
        child['classes'].append(class_)

    def visit_Text(self, node):
        text = node.astext()
        encoded = self.encode(text)
        if self.in_mailto and self.settings.cloak_email_addresses:
            encoded = self.cloak_email(encoded)
        self.body.append(encoded)

    def depart_Text(self, node):
        pass

    def visit_abbreviation(self, node):
        # @@@ implementation incomplete ("title" attribute)
        self.body.append(self.starttag(node, 'abbr', ''))

    def depart_abbreviation(self, node):
        self.body.append('</abbr>')

    def visit_acronym(self, node):
        # @@@ implementation incomplete ("title" attribute)
        self.body.append(self.starttag(node, 'acronym', ''))

    def depart_acronym(self, node):
        self.body.append('</acronym>')

    def visit_address(self, node):
        self.visit_docinfo_item(node, 'address', meta=False)
        self.body.append(self.starttag(node, 'pre', 
                                       suffix= '', CLASS='address'))

    def depart_address(self, node):
        self.body.append('\n</pre>\n')
        self.depart_docinfo_item()

    def visit_admonition(self, node):
        node['classes'].insert(0, 'admonition')
        self.body.append(self.starttag(node, 'div'))

    def depart_admonition(self, node=None):
        self.body.append('</div>\n')

    attribution_formats = {'dash': (u'\u2014', ''),
                           'parentheses': ('(', ')'),
                           'parens': ('(', ')'),
                           'none': ('', '')}

    def visit_attribution(self, node):
        prefix, suffix = self.attribution_formats[self.settings.attribution]
        self.context.append(suffix)
        self.body.append(
            self.starttag(node, 'p', prefix, CLASS='attribution'))

    def depart_attribution(self, node):
        self.body.append(self.context.pop() + '</p>\n')

    def visit_author(self, node):
        if not(isinstance(node.parent, nodes.authors)):
            self.visit_docinfo_item(node, 'author')
        self.body.append('<p>')

    def depart_author(self, node):
        self.body.append('</p>')
        if isinstance(node.parent, nodes.authors):
            self.body.append('\n')
        else:
            self.depart_docinfo_item()

    def visit_authors(self, node):
        self.visit_docinfo_item(node, 'authors')

    def depart_authors(self, node):
        self.depart_docinfo_item()

    def visit_block_quote(self, node):
        self.body.append(self.starttag(node, 'blockquote'))

    def depart_block_quote(self, node):
        self.body.append('</blockquote>\n')

    def check_simple_list(self, node):
        """Check for a simple list that can be rendered compactly."""
        visitor = SimpleListChecker(self.document)
        try:
            node.walk(visitor)
        except nodes.NodeFound:
            return False
        else:
            return True

    # Compact lists
    # ------------
    # Include definition lists and field lists (in addition to ordered
    # and unordered lists) in the test if a list is "simple"  (cf. the
    # html4css1.HTMLTranslator docstring and the SimpleListChecker class at
    # the end of this file).

    def is_compactable(self, node):
        # print "is_compactable %s ?" % node.__class__,
        # explicite class arguments have precedence
        if 'compact' in node['classes']:
            return True
        if 'open' in node['classes']:
            return False
        # check config setting:
        if (isinstance(node, (nodes.field_list, nodes.definition_list))
            and not self.settings.compact_field_lists):
            # print "`compact-field-lists` is False"
            return False
        if (isinstance(node, (nodes.enumerated_list, nodes.bullet_list))
            and not self.settings.compact_lists):
            # print "`compact-lists` is False"
            return False
        # more special cases:
        if (self.topic_classes == ['contents']): # TODO: self.in_contents
            return True
        # check the list items:
        return self.check_simple_list(node)

    def visit_bullet_list(self, node):
        atts = {}
        old_compact_simple = self.compact_simple
        self.context.append((self.compact_simple, self.compact_p))
        self.compact_p = None
        self.compact_simple = self.is_compactable(node)
        if self.compact_simple and not old_compact_simple:
            atts['class'] = 'simple'
        self.body.append(self.starttag(node, 'ul', **atts))

    def depart_bullet_list(self, node):
        self.compact_simple, self.compact_p = self.context.pop()
        self.body.append('</ul>\n')

    def visit_caption(self, node):
        self.body.append(self.starttag(node, 'p', '', CLASS='caption'))

    def depart_caption(self, node):
        self.body.append('</p>\n')

    # citations
    # ---------
    # Use definition list instead of table for bibliographic references.
    # Join adjacent citation entries.

    def visit_citation(self, node):
        if not self.in_footnote_list:
            self.body.append('<dl class="citation">\n')
            self.in_footnote_list = True

    def depart_citation(self, node):
        self.body.append('</dd>\n')
        if not isinstance(node.next_node(descend=False, siblings=True),
                          nodes.citation):
            self.body.append('</dl>\n')
            self.in_footnote_list = False

    def visit_citation_reference(self, node):
        href = '#'
        if 'refid' in node:
            href += node['refid']
        elif 'refname' in node:
            href += self.document.nameids[node['refname']]
        # else: # TODO system message (or already in the transform)?
        # 'Citation reference missing.'
        self.body.append(self.starttag(
            node, 'a', '[', CLASS='citation-reference', href=href))

    def depart_citation_reference(self, node):
        self.body.append(']</a>')

     # classifier
    # ----------
    # don't insert classifier-delimiter here (done by CSS)

    def visit_classifier(self, node):
        self.body.append(self.starttag(node, 'span', '', CLASS='classifier'))

    def depart_classifier(self, node):
        self.body.append('</span>')

    def visit_colspec(self, node):
        self.colspecs.append(node)
        # "stubs" list is an attribute of the tgroup element:
        node.parent.stubs.append(node.attributes.get('stub'))

    def depart_colspec(self, node):
        # write out <colgroup> when all colspecs are processed
        if isinstance(node.next_node(descend=False, siblings=True),
                      nodes.colspec):
            return
        if 'colwidths-auto' in node.parent.parent['classes'] or (
            'colwidths-auto' in self.settings.table_style and
            ('colwidths-given' not in node.parent.parent['classes'])):
            return
        total_width = sum(node['colwidth'] for node in self.colspecs)
        self.body.append(self.starttag(node, 'colgroup'))
        for node in self.colspecs:
            colwidth = int(node['colwidth'] * 100.0 / total_width + 0.5)
            self.body.append(self.emptytag(node, 'col',
                                           style='width: %i%%' % colwidth))
        self.body.append('</colgroup>\n')

    def visit_comment(self, node,
                      sub=re.compile('-(?=-)').sub):
        """Escape double-dashes in comment text."""
        self.body.append('<!-- %s -->\n' % sub('- ', node.astext()))
        # Content already processed:
        raise nodes.SkipNode

    def visit_compound(self, node):
        self.body.append(self.starttag(node, 'div', CLASS='compound'))
        if len(node) > 1:
            node[0]['classes'].append('compound-first')
            node[-1]['classes'].append('compound-last')
            for child in node[1:-1]:
                child['classes'].append('compound-middle')

    def depart_compound(self, node):
        self.body.append('</div>\n')

    def visit_container(self, node):
        self.body.append(self.starttag(node, 'div', CLASS='docutils container'))

    def depart_container(self, node):
        self.body.append('</div>\n')

    def visit_contact(self, node):
        self.visit_docinfo_item(node, 'contact', meta=False)

    def depart_contact(self, node):
        self.depart_docinfo_item()

    def visit_copyright(self, node):
        self.visit_docinfo_item(node, 'copyright')

    def depart_copyright(self, node):
        self.depart_docinfo_item()

    def visit_date(self, node):
        self.visit_docinfo_item(node, 'date')

    def depart_date(self, node):
        self.depart_docinfo_item()

    def visit_decoration(self, node):
        pass

    def depart_decoration(self, node):
        pass

    def visit_definition(self, node):
        self.body.append('</dt>\n')
        self.body.append(self.starttag(node, 'dd', ''))

    def depart_definition(self, node):
        self.body.append('</dd>\n')

    def visit_definition_list(self, node):
        classes = node.setdefault('classes', [])
        if self.is_compactable(node):
            classes.append('simple')
        self.body.append(self.starttag(node, 'dl'))

    def depart_definition_list(self, node):
        self.body.append('</dl>\n')

    def visit_definition_list_item(self, node):
        # pass class arguments, ids and names to definition term:
        node.children[0]['classes'] = (
            node.get('classes', []) + node.children[0].get('classes', []))
        node.children[0]['ids'] = (
            node.get('ids', []) + node.children[0].get('ids', []))
        node.children[0]['names'] = (
            node.get('names', []) + node.children[0].get('names', []))

    def depart_definition_list_item(self, node):
        pass

    def visit_description(self, node):
        self.body.append(self.starttag(node, 'dd', ''))

    def depart_description(self, node):
        self.body.append('</dd>\n')

    def visit_docinfo(self, node):
        classes = 'docinfo'
        if (self.is_compactable(node)):
            classes += ' simple'
        self.body.append(self.starttag(node, 'dl', CLASS=classes))

    def depart_docinfo(self, node):
        self.body.append('</dl>\n')

    def visit_docinfo_item(self, node, name, meta=True):
        if meta:
            meta_tag = '<meta name="%s" content="%s" />\n' \
                       % (name, self.attval(node.astext()))
            self.add_meta(meta_tag)
        self.body.append('<dt class="%s">%s</dt>\n'
                         % (name, self.language.labels[name]))
        self.body.append(self.starttag(node, 'dd', '', CLASS=name))

    def depart_docinfo_item(self):
        self.body.append('</dd>\n')

    def visit_doctest_block(self, node):
        self.body.append(self.starttag(node, 'pre', suffix='',
                                       CLASS='code python doctest'))

    def depart_doctest_block(self, node):
        self.body.append('\n</pre>\n')

    def visit_document(self, node):
        self.head.append('<title>%s</title>\n'
                         % self.encode(node.get('title', '')))

    def depart_document(self, node):
        self.head_prefix.extend([self.doctype,
                                 self.head_prefix_template %
                                 {'lang': self.settings.language_code}])
        self.html_prolog.append(self.doctype)
        self.meta.insert(0, self.content_type % self.settings.output_encoding)
        self.head.insert(0, self.content_type % self.settings.output_encoding)
        if self.math_header:
            if self.math_output == 'mathjax':
                self.head.extend(self.math_header)
            else:
                self.stylesheet.extend(self.math_header)
        # skip content-type meta tag with interpolated charset value:
        self.html_head.extend(self.head[1:])
        self.body_prefix.append(self.starttag(node, 'div', CLASS='document'))
        self.body_suffix.insert(0, '</div>\n')
        self.fragment.extend(self.body) # self.fragment is the "naked" body
        self.html_body.extend(self.body_prefix[1:] + self.body_pre_docinfo
                              + self.docinfo + self.body
                              + self.body_suffix[:-1])
        assert not self.context, 'len(context) = %s' % len(self.context)

    def visit_emphasis(self, node):
        self.body.append(self.starttag(node, 'em', ''))

    def depart_emphasis(self, node):
        self.body.append('</em>')

    def visit_entry(self, node):
        atts = {'class': []}
        if isinstance(node.parent.parent, nodes.thead):
            atts['class'].append('head')
        if node.parent.parent.parent.stubs[node.parent.column]:
            # "stubs" list is an attribute of the tgroup element
            atts['class'].append('stub')
        if atts['class']:
            tagname = 'th'
            atts['class'] = ' '.join(atts['class'])
        else:
            tagname = 'td'
            del atts['class']
        node.parent.column += 1
        if 'morerows' in node:
            atts['rowspan'] = node['morerows'] + 1
        if 'morecols' in node:
            atts['colspan'] = node['morecols'] + 1
            node.parent.column += node['morecols']
        self.body.append(self.starttag(node, tagname, '', **atts))
        self.context.append('</%s>\n' % tagname.lower())
        # TODO: why does the html4css1 writer insert an NBSP into empty cells?
        # if len(node) == 0:              # empty cell
        #     self.body.append('&#0160;') # no-break space

    def depart_entry(self, node):
        self.body.append(self.context.pop())

    def visit_enumerated_list(self, node):
        atts = {}
        if 'start' in node:
            atts['start'] = node['start']
        if 'enumtype' in node:
            atts['class'] = node['enumtype']
        if self.is_compactable(node):
            atts['class'] = (atts.get('class', '') + ' simple').strip()
        self.body.append(self.starttag(node, 'ol', **atts))

    def depart_enumerated_list(self, node):
        self.body.append('</ol>\n')

    def visit_field_list(self, node):
        # Keep simple paragraphs in the field_body to enable CSS
        # rule to start body on new line if the label is too long
        classes = 'field-list'
        if (self.is_compactable(node)):
            classes += ' simple'
        self.body.append(self.starttag(node, 'dl', CLASS=classes))

    def depart_field_list(self, node):
        self.body.append('</dl>\n')

    def visit_field(self, node):
        pass

    def depart_field(self, node):
        pass

    # as field is ignored, pass class arguments to field-name and field-body:

    def visit_field_name(self, node):
        self.body.append(self.starttag(node, 'dt', '',
                                       CLASS=''.join(node.parent['classes'])))

    def depart_field_name(self, node):
        self.body.append('</dt>\n')

    def visit_field_body(self, node):
        self.body.append(self.starttag(node, 'dd', '',
                                       CLASS=''.join(node.parent['classes'])))
        # prevent misalignment of following content if the field is empty:
        if not node.children:
            self.body.append('<p></p>')

    def depart_field_body(self, node):
        self.body.append('</dd>\n')

    def visit_figure(self, node):
        atts = {'class': 'figure'}
        if node.get('width'):
            atts['style'] = 'width: %s' % node['width']
        if node.get('align'):
            atts['class'] += " align-" + node['align']
        self.body.append(self.starttag(node, 'div', **atts))

    def depart_figure(self, node):
        self.body.append('</div>\n')

    # use HTML 5 <footer> element?
    def visit_footer(self, node):
        self.context.append(len(self.body))

    def depart_footer(self, node):
        start = self.context.pop()
        footer = [self.starttag(node, 'div', CLASS='footer'),
                  '<hr class="footer" />\n']
        footer.extend(self.body[start:])
        footer.append('\n</div>\n')
        self.footer.extend(footer)
        self.body_suffix[:0] = footer
        del self.body[start:]

    # footnotes
    # ---------
    # use definition list instead of table for footnote text

    # TODO: use the new HTML5 element <aside>? (Also for footnote text)
    def visit_footnote(self, node):
        if not self.in_footnote_list:
            classes = 'footnote ' + self.settings.footnote_references
            self.body.append('<dl class="%s">\n'%classes)
            self.in_footnote_list = True

    def depart_footnote(self, node):
        self.body.append('</dd>\n')
        if not isinstance(node.next_node(descend=False, siblings=True),
                          nodes.footnote):
            self.body.append('</dl>\n')
            self.in_footnote_list = False

    def visit_footnote_reference(self, node):
        href = '#' + node['refid']
        classes = 'footnote-reference ' + self.settings.footnote_references
        self.body.append(self.starttag(node, 'a', '', #suffix,
                                       CLASS=classes, href=href))

    def depart_footnote_reference(self, node):
        self.body.append('</a>')

    # Docutils-generated text: put section numbers in a span for CSS styling:
    def visit_generated(self, node):
        if 'sectnum' in node['classes']:
            # get section number (strip trailing no-break-spaces)
            sectnum = node.astext().rstrip(u'Â ')
            # print sectnum.encode('utf-8')
            self.body.append('<span class="sectnum">%s</span> '
                                    % self.encode(sectnum))
            # Content already processed:
            raise nodes.SkipNode

    def depart_generated(self, node):
        pass

    def visit_header(self, node):
        self.context.append(len(self.body))

    def depart_header(self, node):
        start = self.context.pop()
        header = [self.starttag(node, 'div', CLASS='header')]
        header.extend(self.body[start:])
        header.append('\n<hr class="header"/>\n</div>\n')
        self.body_prefix.extend(header)
        self.header.extend(header)
        del self.body[start:]

    # Image types to place in an <object> element
    object_image_types = {'.swf': 'application/x-shockwave-flash'}

    def visit_image(self, node):
        atts = {}
        uri = node['uri']
        ext = os.path.splitext(uri)[1].lower()
        if ext in self.object_image_types:
            atts['data'] = uri
            atts['type'] = self.object_image_types[ext]
        else:
            atts['src'] = uri
            atts['alt'] = node.get('alt', uri)
        # image size
        if 'width' in node:
            atts['width'] = node['width']
        if 'height' in node:
            atts['height'] = node['height']
        if 'scale' in node:
            if (PIL and not ('width' in node and 'height' in node)
                and self.settings.file_insertion_enabled):
                imagepath = urllib.url2pathname(uri)
                try:
                    img = PIL.Image.open(
                            imagepath.encode(sys.getfilesystemencoding()))
                except (IOError, UnicodeEncodeError):
                    pass # TODO: warn?
                else:
                    self.settings.record_dependencies.add(
                        imagepath.replace('\\', '/'))
                    if 'width' not in atts:
                        atts['width'] = '%dpx' % img.size[0]
                    if 'height' not in atts:
                        atts['height'] = '%dpx' % img.size[1]
                    del img
            for att_name in 'width', 'height':
                if att_name in atts:
                    match = re.match(r'([0-9.]+)(\S*)$', atts[att_name])
                    assert match
                    atts[att_name] = '%s%s' % (
                        float(match.group(1)) * (float(node['scale']) / 100),
                        match.group(2))
        style = []
        for att_name in 'width', 'height':
            if att_name in atts:
                if re.match(r'^[0-9.]+$', atts[att_name]):
                    # Interpret unitless values as pixels.
                    atts[att_name] += 'px'
                style.append('%s: %s;' % (att_name, atts[att_name]))
                del atts[att_name]
        if style:
            atts['style'] = ' '.join(style)
        if (isinstance(node.parent, nodes.TextElement) or
            (isinstance(node.parent, nodes.reference) and
             not isinstance(node.parent.parent, nodes.TextElement))):
            # Inline context or surrounded by <a>...</a>.
            suffix = ''
        else:
            suffix = '\n'
        if 'align' in node:
            atts['class'] = 'align-%s' % node['align']
        if ext in self.object_image_types:
            # do NOT use an empty tag: incorrect rendering in browsers
            self.body.append(self.starttag(node, 'object', suffix, **atts) +
                             node.get('alt', uri) + '</object>' + suffix)
        else:
            self.body.append(self.emptytag(node, 'img', suffix, **atts))

    def depart_image(self, node):
        # self.body.append(self.context.pop())
        pass

    def visit_inline(self, node):
        self.body.append(self.starttag(node, 'span', ''))

    def depart_inline(self, node):
        self.body.append('</span>')

    # footnote and citation labels:
    def visit_label(self, node):
        if (isinstance(node.parent, nodes.footnote)):
            classes = self.settings.footnote_references
        else:
            classes = 'brackets'
        # pass parent node to get id into starttag:
        self.body.append(self.starttag(node.parent, 'dt', '', CLASS='label'))
        self.body.append(self.starttag(node, 'span', '', CLASS=classes))
        # footnote/citation backrefs:
        if self.settings.footnote_backlinks:
            backrefs = node.parent['backrefs']
            if len(backrefs) == 1:
                self.body.append('<a class="fn-backref" href="#%s">'
                                 % backrefs[0])

    def depart_label(self, node):
        if self.settings.footnote_backlinks:
            backrefs = node.parent['backrefs']
            if len(backrefs) == 1:
                self.body.append('</a>')
        self.body.append('</span>')
        if self.settings.footnote_backlinks and len(backrefs) > 1:
            # Python 2.4 fails with enumerate(backrefs, 1)
            backlinks = ['<a href="#%s">%s</a>' % (ref, i+1)
                            for (i, ref) in enumerate(backrefs)]
            self.body.append('<span class="fn-backref">(%s)</span>'
                                % ','.join(backlinks))
        self.body.append('</dt>\n<dd>')

    def visit_legend(self, node):
        self.body.append(self.starttag(node, 'div', CLASS='legend'))

    def depart_legend(self, node):
        self.body.append('</div>\n')

    def visit_line(self, node):
        self.body.append(self.starttag(node, 'div', suffix='', CLASS='line'))
        if not len(node):
            self.body.append('<br />')

    def depart_line(self, node):
        self.body.append('</div>\n')

    def visit_line_block(self, node):
        self.body.append(self.starttag(node, 'div', CLASS='line-block'))

    def depart_line_block(self, node):
        self.body.append('</div>\n')

    def visit_list_item(self, node):
        self.body.append(self.starttag(node, 'li', ''))

    def depart_list_item(self, node):
        self.body.append('</li>\n')

    # inline literal
    def visit_literal(self, node):
        # special case: "code" role
        classes = node.get('classes', [])
        if 'code' in classes:
            # filter 'code' from class arguments
            node['classes'] = [cls for cls in classes if cls != 'code']
            self.body.append(self.starttag(node, 'code', ''))
            return
        self.body.append(
            self.starttag(node, 'span', '', CLASS='docutils literal'))
        text = node.astext()
        # remove hard line breaks (except if in a parsed-literal block)
        if not isinstance(node.parent, nodes.literal_block):
            text = text.replace('\n', ' ')
        # Protect text like ``--an-option`` and the regular expression
        # ``[+]?(\d+(\.\d*)?|\.\d+)`` from bad line wrapping
        for token in self.words_and_spaces.findall(text):
            if token.strip() and self.sollbruchstelle.search(token):
                self.body.append('<span class="pre">%s</span>'
                                    % self.encode(token))
            else:
                self.body.append(self.encode(token))
        self.body.append('</span>')
        # Content already processed:
        raise nodes.SkipNode

    def depart_literal(self, node):
        # skipped unless literal element is from "code" role:
        self.body.append('</code>')

    def visit_literal_block(self, node):
        self.body.append(self.starttag(node, 'pre', '', CLASS='literal-block'))
        if 'code' in node.get('classes', []):
            self.body.append('<code>')

    def depart_literal_block(self, node):
        if 'code' in node.get('classes', []):
            self.body.append('</code>')
        self.body.append('</pre>\n')

    # Mathematics:
    # As there is no native HTML math support, we provide alternatives
    # for the math-output: LaTeX and MathJax simply wrap the content,
    # HTML and MathML also convert the math_code.
    # HTML container
    math_tags = {# math_output: (block, inline, class-arguments)
                 'mathml':      ('div', '', ''),
                 'html':        ('div', 'span', 'formula'),
                 'mathjax':     ('div', 'span', 'math'),
                 'latex':       ('pre', 'tt',   'math'),
                }

    def visit_math(self, node, math_env=''):
        # If the method is called from visit_math_block(), math_env != ''.

        if self.math_output not in self.math_tags:
            self.document.reporter.error(
                'math-output format "%s" not supported '
                'falling back to "latex"'% self.math_output)
            self.math_output = 'latex'
        tag = self.math_tags[self.math_output][math_env == '']
        clsarg = self.math_tags[self.math_output][2]
        # LaTeX container
        wrappers = {# math_mode: (inline, block)
                    'mathml':  ('$%s$',   u'\\begin{%s}\n%s\n\\end{%s}'),
                    'html':    ('$%s$',   u'\\begin{%s}\n%s\n\\end{%s}'),
                    'mathjax': ('\(%s\)', u'\\begin{%s}\n%s\n\\end{%s}'),
                    'latex':   (None,     None),
                   }
        wrapper = wrappers[self.math_output][math_env != '']
        if self.math_output == 'mathml' and (not self.math_output_options or
                                self.math_output_options[0] == 'blahtexml'):
            wrapper = None
        # get and wrap content
        math_code = node.astext().translate(unichar2tex.uni2tex_table)
        if wrapper:
            try: # wrapper with three "%s"
                math_code = wrapper % (math_env, math_code, math_env)
            except TypeError: # wrapper with one "%s"
                math_code = wrapper % math_code
        # settings and conversion
        if self.math_output in ('latex', 'mathjax'):
            math_code = self.encode(math_code)
        if self.math_output == 'mathjax' and not self.math_header:
            if self.math_output_options:
                self.mathjax_url = self.math_output_options[0]
            self.math_header = [self.mathjax_script % self.mathjax_url]
        elif self.math_output == 'html':
            if self.math_output_options and not self.math_header:
                self.math_header = [self.stylesheet_call(
                    utils.find_file_in_dirs(s, self.settings.stylesheet_dirs))
                    for s in self.math_output_options[0].split(',')]
            # TODO: fix display mode in matrices and fractions
            math2html.DocumentParameters.displaymode = (math_env != '')
            math_code = math2html.math2html(math_code)
        elif self.math_output == 'mathml':
            if  'XHTML 1' in self.doctype:
                self.doctype = self.doctype_mathml
                self.content_type = self.content_type_mathml
            converter = ' '.join(self.math_output_options).lower()
            try:
                if converter == 'latexml':
                    math_code = tex2mathml_extern.latexml(math_code,
                                                    self.document.reporter)
                elif converter == 'ttm':
                    math_code = tex2mathml_extern.ttm(math_code,
                                                    self.document.reporter)
                elif converter == 'blahtexml':
                    math_code = tex2mathml_extern.blahtexml(math_code,
                        inline=not(math_env),
                        reporter=self.document.reporter)
                elif not converter:
                    math_code = latex2mathml.tex2mathml(math_code,
                                                        inline=not(math_env))
                else:
                    self.document.reporter.error('option "%s" not supported '
                    'with math-output "MathML"')
            except OSError:
                    raise OSError('is "latexmlmath" in your PATH?')
            except SyntaxError, err:
                err_node = self.document.reporter.error(err, base_node=node)
                self.visit_system_message(err_node)
                self.body.append(self.starttag(node, 'p'))
                self.body.append(u','.join(err.args))
                self.body.append('</p>\n')
                self.body.append(self.starttag(node, 'pre',
                                               CLASS='literal-block'))
                self.body.append(self.encode(math_code))
                self.body.append('\n</pre>\n')
                self.depart_system_message(err_node)
                raise nodes.SkipNode
        # append to document body
        if tag:
            self.body.append(self.starttag(node, tag,
                                           suffix='\n'*bool(math_env),
                                           CLASS=clsarg))
        self.body.append(math_code)
        if math_env: # block mode (equation, display)
            self.body.append('\n')
        if tag:
            self.body.append('</%s>' % tag)
        if math_env:
            self.body.append('\n')
        # Content already processed:
        raise nodes.SkipNode

    def depart_math(self, node):
        pass # never reached

    def visit_math_block(self, node):
        # print node.astext().encode('utf8')
        math_env = pick_math_environment(node.astext())
        self.visit_math(node, math_env=math_env)

    def depart_math_block(self, node):
        pass # never reached

    # Meta tags: 'lang' attribute replaced by 'xml:lang' in XHTML 1.1
    # HTML5/polyglot recommends using both
    def visit_meta(self, node):
        meta = self.emptytag(node, 'meta', **node.non_default_attributes())
        self.add_meta(meta)

    def depart_meta(self, node):
        pass

    def add_meta(self, tag):
        self.meta.append(tag)
        self.head.append(tag)

    def visit_option(self, node):
        self.body.append(self.starttag(node, 'span', '', CLASS='option'))

    def depart_option(self, node):
        self.body.append('</span>')
        if isinstance(node.next_node(descend=False, siblings=True),
                      nodes.option):
            self.body.append(', ')

    def visit_option_argument(self, node):
        self.body.append(node.get('delimiter', ' '))
        self.body.append(self.starttag(node, 'var', ''))

    def depart_option_argument(self, node):
        self.body.append('</var>')

    def visit_option_group(self, node):
        self.body.append(self.starttag(node, 'dt', ''))
        self.body.append('<kbd>')

    def depart_option_group(self, node):
        self.body.append('</kbd></dt>\n')

    def visit_option_list(self, node):
        self.body.append(
            self.starttag(node, 'dl', CLASS='option-list'))

    def depart_option_list(self, node):
        self.body.append('</dl>\n')

    def visit_option_list_item(self, node):
        pass

    def depart_option_list_item(self, node):
        pass

    def visit_option_string(self, node):
        pass

    def depart_option_string(self, node):
        pass

    def visit_organization(self, node):
        self.visit_docinfo_item(node, 'organization')

    def depart_organization(self, node):
        self.depart_docinfo_item()

    # Do not omit <p> tags
    # --------------------
    #
    # The HTML4CSS1 writer does this to "produce
    # visually compact lists (less vertical whitespace)". This writer
    # relies on CSS rules for"visual compactness".
    #
    # * In XHTML 1.1, e.g. a <blockquote> element may not contain
    #   character data, so you cannot drop the <p> tags.
    # * Keeping simple paragraphs in the field_body enables a CSS
    #   rule to start the field-body on a new line if the label is too long
    # * it makes the code simpler.
    #
    # TODO: omit paragraph tags in simple table cells?

    def visit_paragraph(self, node):
        self.body.append(self.starttag(node, 'p', ''))

    def depart_paragraph(self, node):
        self.body.append('</p>')
        if not (isinstance(node.parent, (nodes.list_item, nodes.entry)) and
                (len(node.parent) == 1)):
            self.body.append('\n')

    def visit_problematic(self, node):
        if node.hasattr('refid'):
            self.body.append('<a href="#%s">' % node['refid'])
            self.context.append('</a>')
        else:
            self.context.append('')
        self.body.append(self.starttag(node, 'span', '', CLASS='problematic'))

    def depart_problematic(self, node):
        self.body.append('</span>')
        self.body.append(self.context.pop())

    def visit_raw(self, node):
        if 'html' in node.get('format', '').split():
            t = isinstance(node.parent, nodes.TextElement) and 'span' or 'div'
            if node['classes']:
                self.body.append(self.starttag(node, t, suffix=''))
            self.body.append(node.astext())
            if node['classes']:
                self.body.append('</%s>' % t)
        # Keep non-HTML raw text out of output:
        raise nodes.SkipNode

    def visit_reference(self, node):
        atts = {'class': 'reference'}
        if 'refuri' in node:
            atts['href'] = node['refuri']
            if ( self.settings.cloak_email_addresses
                 and atts['href'].startswith('mailto:')):
                atts['href'] = self.cloak_mailto(atts['href'])
                self.in_mailto = True
            atts['class'] += ' external'
        else:
            assert 'refid' in node, \
                   'References must have "refuri" or "refid" attribute.'
            atts['href'] = '#' + node['refid']
            atts['class'] += ' internal'
        if not isinstance(node.parent, nodes.TextElement):
            assert len(node) == 1 and isinstance(node[0], nodes.image)
            atts['class'] += ' image-reference'
        self.body.append(self.starttag(node, 'a', '', **atts))

    def depart_reference(self, node):
        self.body.append('</a>')
        if not isinstance(node.parent, nodes.TextElement):
            self.body.append('\n')
        self.in_mailto = False

    def visit_revision(self, node):
        self.visit_docinfo_item(node, 'revision', meta=False)

    def depart_revision(self, node):
        self.depart_docinfo_item()

    def visit_row(self, node):
        self.body.append(self.starttag(node, 'tr', ''))
        node.column = 0

    def depart_row(self, node):
        self.body.append('</tr>\n')

    def visit_rubric(self, node):
        self.body.append(self.starttag(node, 'p', '', CLASS='rubric'))

    def depart_rubric(self, node):
        self.body.append('</p>\n')

    # TODO: use the new HTML 5 element <section>?
    def visit_section(self, node):
        self.section_level += 1
        self.body.append(
            self.starttag(node, 'div', CLASS='section'))

    def depart_section(self, node):
        self.section_level -= 1
        self.body.append('</div>\n')

    # TODO: use the new HTML5 element <aside>? (Also for footnote text)
    def visit_sidebar(self, node):
        self.body.append(
            self.starttag(node, 'div', CLASS='sidebar'))
        self.in_sidebar = True

    def depart_sidebar(self, node):
        self.body.append('</div>\n')
        self.in_sidebar = False

    def visit_status(self, node):
        self.visit_docinfo_item(node, 'status', meta=False)

    def depart_status(self, node):
        self.depart_docinfo_item()

    def visit_strong(self, node):
        self.body.append(self.starttag(node, 'strong', ''))

    def depart_strong(self, node):
        self.body.append('</strong>')

    def visit_subscript(self, node):
        self.body.append(self.starttag(node, 'sub', ''))

    def depart_subscript(self, node):
        self.body.append('</sub>')

    def visit_substitution_definition(self, node):
        """Internal only."""
        raise nodes.SkipNode

    def visit_substitution_reference(self, node):
        self.unimplemented_visit(node)

    # h1â€“h6 elements must not be used to markup subheadings, subtitles,
    # alternative titles and taglines unless intended to be the heading for a
    # new section or subsection.
    # -- http://www.w3.org/TR/html/sections.html#headings-and-sections
    def visit_subtitle(self, node):
        if isinstance(node.parent, nodes.sidebar):
            classes = 'sidebar-subtitle'
        elif isinstance(node.parent, nodes.document):
            classes = 'subtitle'
            self.in_document_title = len(self.body)
        elif isinstance(node.parent, nodes.section):
            classes = 'section-subtitle'
        self.body.append(self.starttag(node, 'p', '', CLASS=classes))

    def depart_subtitle(self, node):
        self.body.append('</p>\n')
        if self.in_document_title:
            self.subtitle = self.body[self.in_document_title:-1]
            self.in_document_title = 0
            self.body_pre_docinfo.extend(self.body)
            self.html_subtitle.extend(self.body)
            del self.body[:]

    def visit_superscript(self, node):
        self.body.append(self.starttag(node, 'sup', ''))

    def depart_superscript(self, node):
        self.body.append('</sup>')

    def visit_system_message(self, node):
        self.body.append(self.starttag(node, 'div', CLASS='system-message'))
        self.body.append('<p class="system-message-title">')
        backref_text = ''
        if len(node['backrefs']):
            backrefs = node['backrefs']
            if len(backrefs) == 1:
                backref_text = ('; <em><a href="#%s">backlink</a></em>'
                                % backrefs[0])
            else:
                i = 1
                backlinks = []
                for backref in backrefs:
                    backlinks.append('<a href="#%s">%s</a>' % (backref, i))
                    i += 1
                backref_text = ('; <em>backlinks: %s</em>'
                                % ', '.join(backlinks))
        if node.hasattr('line'):
            line = ', line %s' % node['line']
        else:
            line = ''
        self.body.append('System Message: %s/%s '
                         '(<span class="docutils literal">%s</span>%s)%s</p>\n'
                         % (node['type'], node['level'],
                            self.encode(node['source']), line, backref_text))

    def depart_system_message(self, node):
        self.body.append('</div>\n')

    # tables
    # ------
    # no hard-coded border setting in the table head::

    def visit_table(self, node):
        classes = [cls.strip(u' \t\n')
                   for cls in self.settings.table_style.split(',')]
        if 'align' in node:
            classes.append('align-%s' % node['align'])
        tag = self.starttag(node, 'table', CLASS=' '.join(classes))
        self.body.append(tag)

    def depart_table(self, node):
        self.body.append('</table>\n')

    def visit_target(self, node):
        if not ('refuri' in node or 'refid' in node
                or 'refname' in node):
            self.body.append(self.starttag(node, 'span', '', CLASS='target'))
            self.context.append('</span>')
        else:
            self.context.append('')

    def depart_target(self, node):
        self.body.append(self.context.pop())

    # no hard-coded vertical alignment in table body
    def visit_tbody(self, node):
        self.body.append(self.starttag(node, 'tbody'))

    def depart_tbody(self, node):
        self.body.append('</tbody>\n')

    def visit_term(self, node):
        self.body.append(self.starttag(node, 'dt', ''))

    def depart_term(self, node):
        """
        Leave the end tag to `self.visit_definition()`, in case there's a
        classifier.
        """
        pass

    def visit_tgroup(self, node):
        self.colspecs = []
        node.stubs = []

    def depart_tgroup(self, node):
        pass

    def visit_thead(self, node):
        self.body.append(self.starttag(node, 'thead'))

    def depart_thead(self, node):
        self.body.append('</thead>\n')

    def visit_title(self, node):
        """Only 6 section levels are supported by HTML."""
        check_id = 0  # TODO: is this a bool (False) or a counter?
        close_tag = '</p>\n'
        if isinstance(node.parent, nodes.topic):
            self.body.append(
                  self.starttag(node, 'p', '', CLASS='topic-title first'))
        elif isinstance(node.parent, nodes.sidebar):
            self.body.append(
                  self.starttag(node, 'p', '', CLASS='sidebar-title'))
        elif isinstance(node.parent, nodes.Admonition):
            self.body.append(
                  self.starttag(node, 'p', '', CLASS='admonition-title'))
        elif isinstance(node.parent, nodes.table):
            self.body.append(
                  self.starttag(node, 'caption', ''))
            close_tag = '</caption>\n'
        elif isinstance(node.parent, nodes.document):
            self.body.append(self.starttag(node, 'h1', '', CLASS='title'))
            close_tag = '</h1>\n'
            self.in_document_title = len(self.body)
        else:
            assert isinstance(node.parent, nodes.section)
            h_level = self.section_level + self.initial_header_level - 1
            atts = {}
            if (len(node.parent) >= 2 and
                isinstance(node.parent[1], nodes.subtitle)):
                atts['CLASS'] = 'with-subtitle'
            self.body.append(
                  self.starttag(node, 'h%s' % h_level, '', **atts))
            atts = {}
            if node.hasattr('refid'):
                atts['class'] = 'toc-backref'
                atts['href'] = '#' + node['refid']
            if atts:
                self.body.append(self.starttag({}, 'a', '', **atts))
                close_tag = '</a></h%s>\n' % (h_level)
            else:
                close_tag = '</h%s>\n' % (h_level)
        self.context.append(close_tag)

    def depart_title(self, node):
        self.body.append(self.context.pop())
        if self.in_document_title:
            self.title = self.body[self.in_document_title:-1]
            self.in_document_title = 0
            self.body_pre_docinfo.extend(self.body)
            self.html_title.extend(self.body)
            del self.body[:]

    def visit_title_reference(self, node):
        self.body.append(self.starttag(node, 'cite', ''))

    def depart_title_reference(self, node):
        self.body.append('</cite>')

    # TODO: use the new HTML5 element <aside>? (Also for footnote text)
    def visit_topic(self, node):
        self.body.append(self.starttag(node, 'div', CLASS='topic'))
        self.topic_classes = node['classes']
        # TODO: replace with ::
        #   self.in_contents = 'contents' in node['classes']

    def depart_topic(self, node):
        self.body.append('</div>\n')
        self.topic_classes = []
        # TODO self.in_contents = False

    def visit_transition(self, node):
        self.body.append(self.emptytag(node, 'hr', CLASS='docutils'))

    def depart_transition(self, node):
        pass

    def visit_version(self, node):
        self.visit_docinfo_item(node, 'version', meta=False)

    def depart_version(self, node):
        self.depart_docinfo_item()

    def unimplemented_visit(self, node):
        raise NotImplementedError('visiting unimplemented node type: %s'
                                  % node.__class__.__name__)


class SimpleListChecker(nodes.GenericNodeVisitor):

    """
    Raise `nodes.NodeFound` if non-simple list item is encountered.

    Here "simple" means a list item containing nothing other than a single
    paragraph, a simple list, or a paragraph followed by a simple list.

    This version also checks for simple field lists and docinfo.
    """

    def default_visit(self, node):
        raise nodes.NodeFound

    def visit_list_item(self, node):
        # print "visiting list item", node.__class__
        children = [child for child in node.children
                    if not isinstance(child, nodes.Invisible)]
        # print "has %s visible children" % len(children)
        if (children and isinstance(children[0], nodes.paragraph)
            and (isinstance(children[-1], nodes.bullet_list) or
                 isinstance(children[-1], nodes.enumerated_list) or
                 isinstance(children[-1], nodes.field_list))):
            children.pop()
        # print "%s children remain" % len(children)
        if len(children) <= 1:
            return
        else:
            # print "found", child.__class__, "in", node.__class__
            raise nodes.NodeFound

    def pass_node(self, node):
        pass

    def ignore_node(self, node):
        # ignore nodes that are never complex (can contain only inline nodes)
        raise nodes.SkipNode

    # Paragraphs and text
    visit_Text = ignore_node
    visit_paragraph = ignore_node

    # Lists
    visit_bullet_list = pass_node
    visit_enumerated_list = pass_node
    visit_docinfo = pass_node

    # Docinfo nodes:
    visit_author = ignore_node
    visit_authors = visit_list_item
    visit_address = visit_list_item
    visit_contact = pass_node
    visit_copyright = ignore_node
    visit_date = ignore_node
    visit_organization = ignore_node
    visit_status = ignore_node
    visit_version = visit_list_item

    # Definition list:
    visit_definition_list = pass_node
    visit_definition_list_item = pass_node
    visit_term = ignore_node
    visit_classifier = pass_node
    visit_definition = visit_list_item

    # Field list:
    visit_field_list = pass_node
    visit_field = pass_node
    # the field body corresponds to a list item
    visit_field_body = visit_list_item
    visit_field_name = ignore_node

    # Invisible nodes should be ignored.
    visit_comment = ignore_node
    visit_substitution_definition = ignore_node
    visit_target = ignore_node
    visit_pending = ignore_node
                                                                                                                                              usr/local/lib/python2.7/dist-packages/docutils/writers/_html_base.pyc                               0100644 0000000 0000062 00000206632 13077704402 024371  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   sh  d  d l  Z  d  d l Z d  d l Z d  d l Z y d  d l Z WnZ e k
 rœ y/ d  d l Z d e	 f d „  ƒ  YZ e e _ Wn e k
 r˜ e
 Z n Xn Xd  d l Z d  d l m Z m Z m Z m Z m Z d  d l m Z d  d l m Z d  d l m Z m Z m Z m Z m Z d e j f d	 „  ƒ  YZ d
 e j f d „  ƒ  YZ d e j f d „  ƒ  YZ d S(   iÿÿÿÿNt   PILc           B   s   e  Z RS(    (   t   __name__t
   __module__(    (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR       s    (   t   nodest   utilst   writerst	   languagest   io(   t
   SafeString(   t
   writer_aux(   t   unichar2text   pick_math_environmentt	   math2htmlt   latex2mathmlt   tex2mathml_externt   Writerc           B   sZ   e  Z d Z d Z i d d 6Z d Z d  Z d „  Z d „  Z d „  Z	 d „  Z
 d „  Z RS(!   t   htmlt   xhtmls   template.txtt   xmlcharrefreplacet   output_encoding_error_handlerR   t   head_prefixt   headt
   stylesheett   body_prefixt   body_pre_docinfot   docinfot   bodyt   body_suffixt   titlet   subtitlet   headert   footert   metat   fragmentt   html_prologt	   html_headt
   html_titlet   html_subtitlet	   html_bodyc         C   s   t  j j |  ƒ t j g S(   N(   R   R   t   get_transformsR	   t   Admonitions(   t   self(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR'   B   s    c         C   si   |  j  |  j ƒ |  _ } |  j j | ƒ x* |  j D] } t |  | t | | ƒ ƒ q3 W|  j ƒ  |  _ d  S(   N(	   t   translator_classt   documentt   visitort	   walkaboutt   visitor_attributest   setattrt   getattrt   apply_templatet   output(   R)   R,   t   attr(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt	   translateE   s
    c         C   sK   t  |  j j j d ƒ } t | j ƒ  d ƒ } | j ƒ  |  j ƒ  } | | S(   Nt   rbs   utf-8(   t   openR+   t   settingst   templatet   unicodet   readt   closet   interpolation_dict(   R)   t   template_fileR8   t   subs(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR1   L   s
    
c         C   si   i  } |  j  j } x6 |  j D]+ } d j t |  | ƒ ƒ j d ƒ | | <q W| j | d <t j | d <| S(   Nt    s   
t   encodingt   version(	   R+   R7   R.   t   joinR0   t   rstript   output_encodingt   docutilst   __version__(   R)   R>   R7   R3   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR<   S   s    )c         C   sG   t  j j |  ƒ x0 |  j D]% } d j t |  | ƒ ƒ |  j | <q Wd  S(   NR?   (   R   R   t   assemble_partsR.   RB   R0   t   parts(   R)   t   part(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRG   \   s    (   s   htmlR   (   s   writers(   s   head_prefixs   heads
   stylesheets   body_prefixs   body_pre_docinfos   docinfos   bodys   body_suffixs   titles   subtitles   headers   footers   metas   fragments   html_prologs	   html_heads
   html_titles   html_subtitles	   html_body(   R   R   t	   supportedt   default_templatet   settings_defaultst   config_section_dependenciesR.   R'   R4   R1   R<   RG   (    (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR   +   s       					t   HTMLTranslatorc           B   sê  e  Z d  Z d Z d Z e Z d Z d Z d Z d Z	 d Z
 d Z d	 Z e j d
 ƒ Z e j d e j ƒ Z d Z i d e d ƒ 6d e d ƒ 6d e d ƒ 6d e d ƒ 6d e d ƒ 6Z d „  Z d „  Z d „  Z d „  Z d „  Z e j d ƒ d „ Z d „  Z d e d  „ Z d d! „ Z d" d# „ Z d$ „  Z  d% „  Z! d& „  Z" d' „  Z# d( „  Z$ d) „  Z% d* „  Z& d+ „  Z' d, „  Z( dí d- „ Z* i dî d0 6dï d3 6dğ d4 6dñ d5 6Z+ d6 „  Z, d7 „  Z- d8 „  Z. d9 „  Z/ d: „  Z0 d; „  Z1 d< „  Z2 d= „  Z3 d> „  Z4 d? „  Z5 d@ „  Z6 dA „  Z7 dB „  Z8 dC „  Z9 dD „  Z: dE „  Z; dF „  Z< dG „  Z= dH „  Z> dI „  Z? dJ „  Z@ dK „  ZA e j dL ƒ jB dM „ ZC dN „  ZD dO „  ZE dP „  ZF dQ „  ZG dR „  ZH dS „  ZI dT „  ZJ dU „  ZK dV „  ZL dW „  ZM dX „  ZN dY „  ZO dZ „  ZP d[ „  ZQ d\ „  ZR d] „  ZS d^ „  ZT d_ „  ZU d` „  ZV da „  ZW db „  ZX dc „  ZY eZ dd „ Z[ de „  Z\ df „  Z] dg „  Z^ dh „  Z_ di „  Z` dj „  Za dk „  Zb dl „  Zc dm „  Zd dn „  Ze do „  Zf dp „  Zg dq „  Zh dr „  Zi ds „  Zj dt „  Zk du „  Zl dv „  Zm dw „  Zn dx „  Zo dy „  Zp dz „  Zq d{ „  Zr d| „  Zs d} „  Zt d~ „  Zu d „  Zv d€ „  Zw d „  Zx d‚ „  Zy dƒ „  Zz i d„ d… 6Z{ d† „  Z| d‡ „  Z} dˆ „  Z~ d‰ „  Z dŠ „  Z€ d‹ „  Z dŒ „  Z‚ d „  Zƒ d „  Z„ d „  Z… d „  Z† d‘ „  Z‡ d’ „  Zˆ d“ „  Z‰ d” „  ZŠ d• „  Z‹ d– „  ZŒ d— „  Z i dò d™ 6dó dœ 6dô d 6dõ d¡ 6Z d/ d¢ „ Z d£ „  Z d¤ „  Z‘ d¥ „  Z’ d¦ „  Z“ d§ „  Z” d¨ „  Z• d© „  Z– dª „  Z— d« „  Z˜ d¬ „  Z™ d­ „  Zš d® „  Z› d¯ „  Zœ d° „  Z d± „  Z d² „  ZŸ d³ „  Z  d´ „  Z¡ dµ „  Z¢ d¶ „  Z£ d· „  Z¤ d¸ „  Z¥ d¹ „  Z¦ dº „  Z§ d» „  Z¨ d¼ „  Z© d½ „  Zª d¾ „  Z« d¿ „  Z¬ dÀ „  Z­ dÁ „  Z® dÂ „  Z¯ dÃ „  Z° dÄ „  Z± dÅ „  Z² dÆ „  Z³ dÇ „  Z´ dÈ „  Zµ dÉ „  Z¶ dÊ „  Z· dË „  Z¸ dÌ „  Z¹ dÍ „  Zº dÎ „  Z» dÏ „  Z¼ dĞ „  Z½ dÑ „  Z¾ dÒ „  Z¿ dÓ „  ZÀ dÔ „  ZÁ dÕ „  ZÂ dÖ „  ZÃ d× „  ZÄ dØ „  ZÅ dÙ „  ZÆ dÚ „  ZÇ dÛ „  ZÈ dÜ „  ZÉ dİ „  ZÊ dŞ „  ZË dß „  ZÌ dà „  ZÍ dá „  ZÎ dâ „  ZÏ dã „  ZĞ dä „  ZÑ då „  ZÒ dæ „  ZÓ dç „  ZÔ dè „  ZÕ dé „  ZÖ dê „  Z× dë „  ZØ dì „  ZÙ RS(ö   s€   Generic Docutils to HTML translator.

    See the html4css1 and html5_polyglott for writers for full featured HTML
    writers. s%   <?xml version="1.0" encoding="%s" ?>
s   <!DOCTYPE html>
sW   <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="%(lang)s" lang="%(lang)s">
<head>
s   <meta charset="%s"/>
sR   <meta name="generator" content="Docutils %s: http://docutils.sourceforge.net/" />
s2   <script type="text/javascript" src="%s"></script>
sF   https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTMLs4   <link rel="stylesheet" href="%s" type="text/css" />
s%   <style type="text/css">

%s
</style>
s	   \S+| +|\ns   .+\W\W.+|[-?].+t   langu   &amp;t   &u   &lt;t   <u   &quot;t   "u   &gt;t   >u   &#64;t   @c         C   s6  t  j j |  | ƒ | j |  _ } | j } t j | | j ƒ |  _ |  j	 t
 j g |  _ g  |  _ g  |  _ | j r¥ |  j j |  j | j ƒ |  j j |  j ƒ n  |  j |  _ g  t j | ƒ D] } |  j | ƒ ^ qÂ |  _ d g |  _ g  |  _ g  |  _ g  |  _ g  |  _ d g |  _ d |  _ t | j ƒ |  _ | j  j! ƒ  |  _  |  j  d |  _" |  j  d j# ƒ  |  _  g  |  _$ g  |  _% g  |  _& t' |  _( t) |  _* t) |  _+ t) |  _, t) |  _- t) |  _. g  |  _/ g  |  _0 g  |  _1 g  |  _2 |  j3 g |  _4 g  |  _5 g  |  _6 g  |  _7 d |  _8 t) |  _9 t) |  _: g  |  _; d  S(   Ns   </head>
<body>
s   </body>
</html>
i    i   (<   R   t   NodeVisitort   __init__R7   t   language_codeR   t   get_languaget   reportert   languaget	   generatorRE   RF   R    R   R"   t   xml_declarationt   appendRD   R   R   t   get_stylesheet_listt   stylesheet_callR   R   R   R   R   R!   R   t   section_levelt   intt   initial_header_levelt   math_outputt   splitt   math_output_optionst   lowert   contextt   topic_classest   colspecst   Truet	   compact_pt   Falset   compact_simplet   compact_field_listt
   in_docinfot
   in_sidebart   in_footnote_listR   R   R   R   t   content_typeR#   R$   R%   R&   t   in_document_titlet	   in_mailtot   author_in_authorst   math_header(   R)   R+   R7   t   lcodet   path(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRV   ‹   s\    				+																								c         C   sA   d j  |  j |  j |  j |  j |  j |  j |  j |  j ƒ S(   NR?   (	   RB   R   R   R   R   R   R   R   R   (   R)   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   astextÄ   s    c         C   s   t  | ƒ } | j |  j ƒ S(   s-   Encode special characters in `text` & return.(   R9   R4   t   special_characters(   R)   t   text(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   encodeÊ   s    c         C   s   | j  d d ƒ S(   s*   Try to hide a mailto: URL from harvesters.RT   s   %40(   t   replace(   R)   t   uri(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   cloak_mailtoÒ   s    c         C   s(   | j  d d ƒ } | j  d d ƒ } | S(   s;   Try to hide the link text of a email link from harversters.s   &#64;s   <span>&#64;</span>t   .s   <span>&#46;</span>(   R}   (   R)   t   addr(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   cloak_emailÙ   s    s   [
	]c         C   s[   |  j  | j d | ƒ ƒ } |  j rW |  j j rW | j d d ƒ } | j d d ƒ } n  | S(   s6   Cleanse, HTML encode, and return attribute value text.t    s   %40s   &#37;&#52;&#48;R€   s   &#46;(   R|   t   subRt   R7   t   cloak_email_addressesR}   (   R)   R{   t
   whitespacet   encoded(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   attvalá   s
    c         C   sÎ   |  j  j r“ y5 t j d | d d ƒ j ƒ  } |  j  j j | ƒ WnD t k
 r‡ } d | t | j	 ƒ f } |  j
 j j | ƒ d | SX|  j | S|  j  j rº t j |  j  j | ƒ } n  |  j |  j | ƒ S(   s8   Return code to reference or embed stylesheet file `path`t   source_pathR@   s   utf-8u!   Cannot embed stylesheet '%s': %s.s   <--- %s --->
(   R7   t   embed_stylesheetR   t	   FileInputR:   t   record_dependenciest   addt   IOErrorR   t   strerrorR+   RY   t   errort   embedded_stylesheett   stylesheet_pathR   t   relative_patht   _destinationt   stylesheet_linkR|   (   R)   Rx   t   contentt   errt   msg(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR_   ë   s    	s   
c      	   K   sõ  | j  ƒ  } g  } i  } g  } x* | j ƒ  D] \ }	 }
 |
 | |	 j  ƒ  <q+ Wg  } g  } x{ | j d g  ƒ | j d d ƒ j ƒ  D]Q } | j d ƒ r© | j | d ƒ q€ | j ƒ  r€ | | k r€ | j | ƒ q€ q€ W| rï | d | |  j <n  | rd j	 | ƒ | d <n  d | k st
 ‚ | j | j d	 g  ƒ ƒ d	 | k r]| j | d	 ƒ | d	 =n  | rä| d | d <xp | d
 D]a } | s»t | t j t j t j t j t j t j f ƒ rÏ| j d | ƒ q|| d | 7} q|Wn  | j ƒ  } | j ƒ  | g } x² | D]ª \ }	 }
 |
 d k	 s(t
 ‚ t |
 t ƒ rˆg  |
 D] } t | ƒ ^ q>} | j d |	 j  ƒ  |  j d j	 | ƒ ƒ f ƒ q
| j d |	 j  ƒ  |  j t |
 ƒ ƒ f ƒ q
W| rÇd } n d } d j	 | ƒ d d j	 | ƒ | f | S(   s‘   
        Construct and return a start tag given a node (id & class attributes
        are extracted), tag name, and optional attributes.
        t   classest   classR?   s	   language-i	   i    Rƒ   t   idt   idsi   s   <span id="%s"></span>s   %s="%s"s    /s   <%s%s>N(   Rf   t   itemst   gett   popRd   t
   startswithR]   t   stript   lang_attributeRB   t   AssertionErrort   extendt
   isinstanceR   t   bullet_listt   enumerated_listt   definition_listt
   field_listt   option_listR   t   sortt   Nonet   listR9   Rˆ   (   R)   t   nodet   tagnamet   suffixt   emptyt
   attributest   prefixt   attsRœ   t   namet   valueR™   R   t   clsR›   t   attlistRH   t   vt   valuest   infix(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   starttagş   s\    /

	 	c         K   s   |  j  | | | d t | S(   s1   Construct and return an XML-compatible empty tag.R±   (   R¼   Rj   (   R)   R®   R¯   R°   R²   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   emptytagA  s    i    c         C   sc   g  | D] } t  | t j ƒ s | ^ q } y | | } Wn t k
 rM d SX| d j | ƒ d S(   sŠ   
        Set class `class_` on the visible child no. index of `node`.
        Do nothing if node has fewer children than `index`.
        NR™   (   R¥   R   t	   Invisiblet
   IndexErrorR]   (   R)   R®   t   class_t   indext   nt   childrent   child(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   set_class_on_childE  s    +c         C   sV   | j  ƒ  } |  j | ƒ } |  j rB |  j j rB |  j | ƒ } n  |  j j | ƒ d  S(   N(   Ry   R|   Rt   R7   R…   R‚   R   R]   (   R)   R®   R{   R‡   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt
   visit_TextQ  s
    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_TextX  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   abbrR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_abbreviation[  s    c         C   s   |  j  j d ƒ d  S(   Ns   </abbr>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_abbreviation_  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   acronymR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_acronymb  s    c         C   s   |  j  j d ƒ d  S(   Ns
   </acronym>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_acronymf  s    c         C   sB   |  j  | d d t ƒ|  j j |  j | d d d d d ƒƒ d  S(   Nt   addressR    t   preR°   R?   t   CLASS(   t   visit_docinfo_itemRl   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_addressi  s    c         C   s   |  j  j d ƒ |  j ƒ  d  S(   Ns   
</pre>
(   R   R]   t   depart_docinfo_item(   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_addressn  s    c         C   s4   | d j  d d ƒ |  j j |  j | d ƒ ƒ d  S(   NR™   i    t
   admonitiont   div(   t   insertR   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_admonitionr  s    c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_admonitionv  s    u   â€”R?   t   dasht   (t   )t   parenthesest   parenst   nonec         C   sR   |  j  |  j j \ } } |  j j | ƒ |  j j |  j | d | d d ƒƒ d  S(   Nt   pRĞ   t   attribution(   t   attribution_formatsR7   Rá   Rg   R]   R   R¼   (   R)   R®   R³   R°   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_attribution~  s    	c         C   s!   |  j  j |  j j ƒ  d ƒ d  S(   Ns   </p>
(   R   R]   Rg   RŸ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_attribution„  s    c         C   s<   t  | j t j ƒ s( |  j | d ƒ n  |  j j d ƒ d  S(   Nt   authors   <p>(   R¥   t   parentR   t   authorsRÑ   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_author‡  s    c         C   sF   |  j  j d ƒ t | j t j ƒ r8 |  j  j d ƒ n
 |  j ƒ  d  S(   Ns   </p>s   
(   R   R]   R¥   Ræ   R   Rç   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_authorŒ  s    c         C   s   |  j  | d ƒ d  S(   NRç   (   RÑ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_authors“  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_authors–  s    c         C   s    |  j  j |  j | d ƒ ƒ d  S(   Nt
   blockquote(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_block_quote™  s    c         C   s   |  j  j d ƒ d  S(   Ns   </blockquote>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_block_quoteœ  s    c         C   s@   t  |  j ƒ } y | j | ƒ Wn t j k
 r7 t SXt Sd S(   s7   Check for a simple list that can be rendered compactly.N(   t   SimpleListCheckerR+   t   walkR   t	   NodeFoundRl   Rj   (   R)   R®   R,   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   check_simple_listŸ  s    c         C   s£   d | d k r t  Sd | d k r( t St | t j t j f ƒ rT |  j j rT t St | t j t j	 f ƒ r€ |  j j
 r€ t S|  j d g k r– t  S|  j | ƒ S(   Nt   compactR™   R6   t   contents(   Rj   Rl   R¥   R   R©   R¨   R7   t   compact_field_listsR§   R¦   t   compact_listsRh   Rò   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   is_compactable°  s    c         C   s†   i  } |  j  } |  j j |  j  |  j f ƒ d  |  _ |  j | ƒ |  _  |  j  rc | rc d | d <n  |  j j |  j | d |  ƒ d  S(   Nt   simpleRš   t   ul(   Rm   Rg   R]   Rk   R¬   R÷   R   R¼   (   R)   R®   R´   t   old_compact_simple(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_bullet_listÆ  s    		c         C   s/   |  j  j ƒ  \ |  _ |  _ |  j j d ƒ d  S(   Ns   </ul>
(   Rg   RŸ   Rm   Rk   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_bullet_listĞ  s    c         C   s)   |  j  j |  j | d d d d ƒƒ d  S(   NRà   R?   RĞ   t   caption(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_captionÔ  s    c         C   s   |  j  j d ƒ d  S(   Ns   </p>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_caption×  s    c         C   s)   |  j  s% |  j j d ƒ t |  _  n  d  S(   Ns   <dl class="citation">
(   Rq   R   R]   Rj   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_citationß  s    	c         C   sT   |  j  j d ƒ t | j d t d t ƒ t j ƒ sP |  j  j d ƒ t |  _ n  d  S(   Ns   </dd>
t   descendt   siblingss   </dl>
(	   R   R]   R¥   t	   next_nodeRl   Rj   R   t   citationRq   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_citationä  s
    c      	   C   sy   d } d | k r# | | d 7} n' d | k rJ | |  j  j | d 7} n  |  j j |  j | d d d d d | ƒƒ d  S(	   Nt   #t   refidt   refnamet   at   [RĞ   s   citation-referencet   href(   R+   t   nameidsR   R]   R¼   (   R)   R®   R  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_citation_referenceë  s    c         C   s   |  j  j d ƒ d  S(   Ns   ]</a>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_citation_referenceö  s    c         C   s)   |  j  j |  j | d d d d ƒƒ d  S(   Nt   spanR?   RĞ   t
   classifier(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_classifierı  s    c         C   s   |  j  j d ƒ d  S(   Ns   </span>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_classifier   s    c         C   s3   |  j  j | ƒ | j j j | j j d ƒ ƒ d  S(   Nt   stub(   Ri   R]   Ræ   t   stubsR²   R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_colspec  s    c         C   s	  t  | j d t d t ƒ t j ƒ r( d  Sd | j j d k sf d |  j j k rj d | j j d k rj d  St	 d „  |  j
 Dƒ ƒ } |  j j |  j | d ƒ ƒ xS |  j
 D]H } t | d d	 | d
 ƒ } |  j j |  j | d d d | ƒƒ q© W|  j j d ƒ d  S(   NR  R  s   colwidths-autoR™   s   colwidths-givenc         s   s   |  ] } | d  Vq d S(   t   colwidthN(    (   t   .0R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pys	   <genexpr>  s    t   colgroupR  g      Y@g      à?t   colt   styles   width: %i%%s   </colgroup>
(   R¥   R  Rl   Rj   R   t   colspecRæ   R7   t   table_stylet   sumRi   R   R]   R¼   Ra   R½   (   R)   R®   t   total_widthR  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_colspec  s    s   -(?=-)c         C   s0   |  j  j d | d | j ƒ  ƒ ƒ t j ‚ d S(   s%   Escape double-dashes in comment text.s   <!-- %s -->
s   - N(   R   R]   Ry   R   t   SkipNode(   R)   R®   R„   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_comment  s    #c         C   s   |  j  j |  j | d d d ƒƒ t | ƒ d k rŠ | d d j d ƒ | d d j d	 ƒ x) | d d !D] } | d j d
 ƒ ql Wn  d  S(   NRÖ   RĞ   t   compoundi   i    R™   s   compound-firstiÿÿÿÿs   compound-lasts   compound-middle(   R   R]   R¼   t   len(   R)   R®   RÄ   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_compound   s    "c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_compound(  s    c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   NRÖ   RĞ   s   docutils container(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_container+  s    c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_container.  s    c         C   s   |  j  | d d t ƒd  S(   Nt   contactR    (   RÑ   Rl   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_contact1  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_contact4  s    c         C   s   |  j  | d ƒ d  S(   Nt	   copyright(   RÑ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_copyright7  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_copyright:  s    c         C   s   |  j  | d ƒ d  S(   Nt   date(   RÑ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt
   visit_date=  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_date@  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_decorationC  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_decorationF  s    c         C   s3   |  j  j d ƒ |  j  j |  j | d d ƒ ƒ d  S(   Ns   </dt>
t   ddR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_definitionI  s    c         C   s   |  j  j d ƒ d  S(   Ns   </dd>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_definitionM  s    c         C   sQ   | j  d g  ƒ } |  j | ƒ r1 | j d ƒ n  |  j j |  j | d ƒ ƒ d  S(   NR™   Rø   t   dl(   t
   setdefaultR÷   R]   R   R¼   (   R)   R®   R™   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_definition_listP  s    c         C   s   |  j  j d ƒ d  S(   Ns   </dl>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_definition_listV  s    c         C   s    | j  d g  ƒ | j d j  d g  ƒ | j d d <| j  d g  ƒ | j d j  d g  ƒ | j d d <| j  d g  ƒ | j d j  d g  ƒ | j d d <d  S(   NR™   i    Rœ   t   names(   R   RÃ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_definition_list_itemY  s    44c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_definition_list_itemb  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   NR3  R?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_descriptione  s    c         C   s   |  j  j d ƒ d  S(   Ns   </dd>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_descriptionh  s    c         C   sH   d } |  j  | ƒ r" | d 7} n  |  j j |  j | d d | ƒƒ d  S(   NR   s    simpleR6  RĞ   (   R÷   R   R]   R¼   (   R)   R®   R™   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_docinfok  s    c         C   s   |  j  j d ƒ d  S(   Ns   </dl>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_docinfoq  s    c         C   s‚   | r5 d | |  j  | j ƒ  ƒ f } |  j | ƒ n  |  j j d | |  j j | f ƒ |  j j |  j | d d d | ƒƒ d  S(   Ns    <meta name="%s" content="%s" />
s   <dt class="%s">%s</dt>
R3  R?   RĞ   (   Rˆ   Ry   t   add_metaR   R]   RZ   t   labelsR¼   (   R)   R®   Rµ   R    t   meta_tag(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRÑ   t  s    c         C   s   |  j  j d ƒ d  S(   Ns   </dd>
(   R   R]   (   R)   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRÓ   }  s    c         C   s,   |  j  j |  j | d d d d d ƒƒ d  S(   NRÏ   R°   R?   RĞ   s   code python doctest(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_doctest_block€  s    c         C   s   |  j  j d ƒ d  S(   Ns   
</pre>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_doctest_block„  s    c         C   s-   |  j  j d |  j | j d d ƒ ƒ ƒ d  S(   Ns   <title>%s</title>
R   R?   (   R   R]   R|   R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_document‡  s    c         C   s  |  j  j |  j |  j i |  j j d 6g ƒ |  j j |  j ƒ |  j j	 d |  j
 |  j j ƒ |  j j	 d |  j
 |  j j ƒ |  j rÄ |  j d k r® |  j j |  j ƒ qÄ |  j j |  j ƒ n  |  j j |  j d ƒ |  j j |  j | d d d ƒƒ |  j j	 d d ƒ |  j j |  j ƒ |  j j |  j d |  j |  j |  j |  j d	  ƒ |  j s}t d
 t |  j ƒ ƒ ‚ d  S(   NRO   i    t   mathjaxi   RÖ   RĞ   R+   s   </div>
iÿÿÿÿs   len(context) = %s(   R   R¤   t   doctypet   head_prefix_templateR7   RW   R"   R]   R    R×   Rr   RD   R   Rv   Rc   R   R#   R   R¼   R   R!   R   R&   R   R   Rg   R£   R#  (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_document‹  s"      	"	.c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   emR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_emphasis¡  s    c         C   s   |  j  j d ƒ d  S(   Ns   </em>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_emphasis¤  s    c         C   sJ  i g  d 6} t  | j j t j ƒ r9 | d j d ƒ n  | j j j j | j j ri | d j d ƒ n  | d r“ d } d j | d ƒ | d <n d } | d =| j j d 7_ d | k rÓ | d d | d	 <n  d
 | k r
| d
 d | d <| j j | d
 7_ n  |  j j |  j	 | | d |  ƒ |  j
 j d | j ƒ  ƒ d  S(   NRš   R   R  t   thRƒ   t   tdi   t   morerowst   rowspant   morecolst   colspanR?   s   </%s>
(   R¥   Ræ   R   t   theadR]   R  t   columnRB   R   R¼   Rg   Rf   (   R)   R®   R´   R¯   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_entry§  s$    
"c         C   s   |  j  j |  j j ƒ  ƒ d  S(   N(   R   R]   Rg   RŸ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_entryÀ  s    c         C   s•   i  } d | k r# | d | d <n  d | k r@ | d | d <n  |  j  | ƒ rr | j d d ƒ d j ƒ  | d <n  |  j j |  j | d |  ƒ d  S(   Nt   startt   enumtypeRš   R?   s    simplet   ol(   R÷   R   R¡   R   R]   R¼   (   R)   R®   R´   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_enumerated_listÃ  s    #c         C   s   |  j  j d ƒ d  S(   Ns   </ol>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_enumerated_listÍ  s    c         C   sH   d } |  j  | ƒ r" | d 7} n  |  j j |  j | d d | ƒƒ d  S(   Ns
   field-lists    simpleR6  RĞ   (   R÷   R   R]   R¼   (   R)   R®   R™   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_field_listĞ  s    c         C   s   |  j  j d ƒ d  S(   Ns   </dl>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_field_listØ  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_fieldÛ  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_fieldŞ  s    c      	   C   s9   |  j  j |  j | d d d d j | j d ƒ ƒƒ d  S(   Nt   dtR?   RĞ   R™   (   R   R]   R¼   RB   Ræ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_field_nameã  s    c         C   s   |  j  j d ƒ d  S(   Ns   </dt>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_field_nameç  s    c      	   C   sU   |  j  j |  j | d d d d j | j d ƒ ƒƒ | j sQ |  j  j d ƒ n  d  S(   NR3  R?   RĞ   R™   s   <p></p>(   R   R]   R¼   RB   Ræ   RÃ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_field_bodyê  s    	c         C   s   |  j  j d ƒ d  S(   Ns   </dd>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_field_bodyñ  s    c         C   s~   i d d 6} | j  d ƒ r1 d | d | d <n  | j  d ƒ r[ | d c d | d 7<n  |  j j |  j | d |  ƒ d  S(	   Nt   figureRš   t   widths	   width: %sR  t   aligns    align-RÖ   (   R   R   R]   R¼   (   R)   R®   R´   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_figureô  s    c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_figureü  s    c         C   s   |  j  j t |  j ƒ ƒ d  S(   N(   Rg   R]   R#  R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_footer   s    c         C   sy   |  j  j ƒ  } |  j | d d d ƒd g } | j |  j | ƒ | j d ƒ |  j j | ƒ | |  j d *|  j | 3d  S(   NRÖ   RĞ   R   s   <hr class="footer" />
s   
</div>
i    (   Rg   RŸ   R¼   R¤   R   R]   R   R   (   R)   R®   RX  R   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_footer  s    	c         C   s=   |  j  s9 d |  j j } |  j j d | ƒ t |  _  n  d  S(   Ns	   footnote s   <dl class="%s">
(   Rq   R7   t   footnote_referencesR   R]   Rj   (   R)   R®   R™   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_footnote  s    	c         C   sT   |  j  j d ƒ t | j d t d t ƒ t j ƒ sP |  j  j d ƒ t |  _ n  d  S(   Ns   </dd>
R  R  s   </dl>
(	   R   R]   R¥   R  Rl   Rj   R   t   footnoteRq   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_footnote  s
    c      	   C   sM   d | d } d |  j  j } |  j j |  j | d d d | d | ƒƒ d  S(   NR  R  s   footnote-reference R	  R?   RĞ   R  (   R7   Rm  R   R]   R¼   (   R)   R®   R  R™   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_footnote_reference  s    c         C   s   |  j  j d ƒ d  S(   Ns   </a>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_footnote_reference%  s    c         C   sR   d | d k rN | j  ƒ  j d ƒ } |  j j d |  j | ƒ ƒ t j ‚ n  d  S(   Nt   sectnumR™   u   Â s    <span class="sectnum">%s</span> (   Ry   RC   R   R]   R|   R   R   (   R)   R®   Rs  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_generated)  s
    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_generated3  s    c         C   s   |  j  j t |  j ƒ ƒ d  S(   N(   Rg   R]   R#  R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_header6  s    c         C   sy   |  j  j ƒ  } |  j | d d d ƒg } | j |  j | ƒ | j d ƒ |  j j | ƒ |  j j | ƒ |  j | 3d  S(   NRÖ   RĞ   R   s   
<hr class="header"/>
</div>
(   Rg   RŸ   R¼   R¤   R   R]   R   R   (   R)   R®   RX  R   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_header9  s    s   application/x-shockwave-flashs   .swfc         C   sš  i  } | d } t  j j | ƒ d j ƒ  } | |  j k rY | | d <|  j | | d <n  | | d <| j d | ƒ | d <d | k r– | d | d <n  d | k r³ | d | d <n  d	 | k r(t r¥d | k oÚ d | k r¥|  j j r¥t	 j
 | ƒ } y% t j j | j t j ƒ  ƒ ƒ } Wn t t f k
 r7q¥X|  j j j | j d
 d ƒ ƒ d | k r{d | j d | d <n  d | k rŸd | j d | d <n  ~ n  x€ d D]u } | | k r¬t j d | | ƒ } | sàt ‚ d t | j d ƒ ƒ t | d	 ƒ d | j d ƒ f | | <q¬q¬Wn  g  }	 xh d  D]` } | | k r5t j d | | ƒ rp| | c d 7<n  |	 j d | | | f ƒ | | =q5q5W|	 rµd j |	 ƒ | d <n  t | j t j  ƒ søt | j t j! ƒ rt | j j t j  ƒ rd }
 n d }
 d | k r(d | d | d <n  | |  j k rt|  j" j |  j# | d |
 |  | j d | ƒ d |
 ƒ n" |  j" j |  j$ | d |
 |  ƒ d  S(!   NR~   i   t   datat   typet   srct   altRg  t   heightt   scales   \t   /s   %dpxi    s   ([0-9.]+)(\S*)$s   %s%sid   i   s	   ^[0-9.]+$t   pxs   %s: %s;Rƒ   R  R?   s   
Rh  s   align-%sRš   t   objects	   </object>t   img(   s   widths   height(   s   widths   height(%   t   osRx   t   splitextRf   t   object_image_typesR   R    R7   t   file_insertion_enabledt   urllibt   url2pathnamet   ImageR6   R|   t   syst   getfilesystemencodingR   t   UnicodeEncodeErrorRŒ   R   R}   t   sizet   ret   matchR£   t   floatt   groupR]   RB   R¥   Ræ   R   t   TextElementt	   referenceR   R¼   R½   (   R)   R®   R´   R~   t   extt	   imagepathR  t   att_nameR  R  R°   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_imageE  sn    


	$!		4c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_image†  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   NR  R?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_inlineŠ  s    c         C   s   |  j  j d ƒ d  S(   Ns   </span>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_inline  s    c         C   sÄ   t  | j t j ƒ r$ |  j j } n d } |  j j |  j | j d d d d ƒƒ |  j j |  j | d d d | ƒƒ |  j j	 rÀ | j d } t
 | ƒ d k rÀ |  j j d	 | d
 ƒ qÀ n  d  S(   Nt   bracketsRa  R?   RĞ   t   labelR  t   backrefsi   s!   <a class="fn-backref" href="#%s">i    (   R¥   Ræ   R   Ro  R7   Rm  R   R]   R¼   t   footnote_backlinksR#  (   R)   R®   R™   Rœ  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_label‘  s    (%c         C   sÖ   |  j  j rA | j d } t | ƒ d k rA |  j j d ƒ qA n  |  j j d ƒ |  j  j rÂ t | ƒ d k rÂ g  t | ƒ D]  \ } } d | | d f ^ q| } |  j j d d j | ƒ ƒ n  |  j j d ƒ d  S(	   NRœ  i   s   </a>s   </span>s   <a href="#%s">%s</a>s$   <span class="fn-backref">(%s)</span>t   ,s
   </dt>
<dd>(   R7   R  Ræ   R#  R   R]   t	   enumerateRB   (   R)   R®   Rœ  t   it   reft	   backlinks(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_label   s    0c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   NRÖ   RĞ   t   legend(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_legend®  s    c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_legend±  s    c         C   sK   |  j  j |  j | d d d d d ƒƒ t | ƒ sG |  j  j d ƒ n  d  S(   NRÖ   R°   R?   RĞ   t   lines   <br />(   R   R]   R¼   R#  (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt
   visit_line´  s    (c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_line¹  s    c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   NRÖ   RĞ   s
   line-block(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_line_block¼  s    c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_line_block¿  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   liR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_list_itemÂ  s    c         C   s   |  j  j d ƒ d  S(   Ns   </li>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_list_itemÅ  s    c         C   sV  | j  d g  ƒ } d | k rj g  | D] } | d k r% | ^ q% | d <|  j j |  j | d d ƒ ƒ d  S|  j j |  j | d d d d ƒƒ | j ƒ  } t | j t j ƒ sÅ | j	 d d ƒ } n  xq |  j
 j | ƒ D]] } | j ƒ  r|  j j | ƒ r|  j j d	 |  j | ƒ ƒ qØ |  j j |  j | ƒ ƒ qØ W|  j j d
 ƒ t j ‚ d  S(   NR™   t   codeR?   R  RĞ   s   docutils literals   
Rƒ   s   <span class="pre">%s</span>s   </span>(   R   R   R]   R¼   Ry   R¥   Ræ   R   t   literal_blockR}   t   words_and_spacest   findallR¡   t   sollbruchstellet   searchR|   R   (   R)   R®   R™   R·   R{   t   token(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_literalÉ  s"    )	c         C   s   |  j  j d ƒ d  S(   Ns   </code>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_literalã  s    c         C   sT   |  j  j |  j | d d d d ƒƒ d | j d g  ƒ k rP |  j  j d ƒ n  d  S(   NRÏ   R?   RĞ   s   literal-blockR°  R™   s   <code>(   R   R]   R¼   R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_literal_blockç  s    %c         C   s?   d | j  d g  ƒ k r+ |  j j d ƒ n  |  j j d ƒ d  S(   NR°  R™   s   </code>s   </pre>
(   R   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_literal_blockì  s    RÖ   t   mathmlR  t   formulaR   t   mathRG  RÏ   t   ttt   latexc         C   sÜ  |  j  |  j k r8 |  j j j d |  j  ƒ d |  _  n  |  j |  j  | d k } |  j |  j  d } i d! d 6d" d 6d# d
 6d$ d 6} | |  j  | d k } |  j  d k rÔ |  j sË |  j d d k rÔ d  } n  | j ƒ  j t	 j
 ƒ } | r*y | | | | f } Wq*t k
 r&| | } q*Xn  |  j  d% k rK|  j | ƒ } n  |  j  d
 k r™|  j r™|  j r€|  j d |  _ n  |  j |  j g |  _ nœ|  j  d k r)|  j r|  j rg  |  j d j d ƒ D]' } |  j t j | |  j j ƒ ƒ ^ qÒ|  _ n  | d k t j _ t j | ƒ } n|  j  d k r5d |  j k rb|  j |  _ |  j |  _ n  d j |  j ƒ j ƒ  }	 yµ |	 d k r¤t j  | |  j j ƒ } nŠ |	 d k rËt j! | |  j j ƒ } nc |	 d k rüt j" | d | d |  j j ƒ} n2 |	 st# j$ | d | ƒ} n |  j j j d ƒ Wq5t% k
 rNt% d ƒ ‚ q5t& k
 r1}
 |  j j j |
 d | ƒ} |  j' | ƒ |  j( j) |  j* | d ƒ ƒ |  j( j) d j |
 j+ ƒ ƒ |  j( j) d ƒ |  j( j) |  j* | d d d ƒƒ |  j( j) |  j | ƒ ƒ |  j( j) d ƒ |  j, | ƒ t- j. ‚ q5Xn  | rp|  j( j) |  j* | | d d t/ | ƒ d | ƒƒ n  |  j( j) | ƒ | r™|  j( j) d ƒ n  | r¶|  j( j) d  | ƒ n  | rÏ|  j( j) d ƒ n  t- j. ‚ d  S(&   Ns=   math-output format "%s" not supported falling back to "latex"R¿  R?   i   s   $%s$u   \begin{%s}
%s
\end{%s}R»  R   s   \(%s\)RG  i    t	   blahtexmlRŸ  s   XHTML 1Rƒ   t   latexmlt   ttmt   inlineRY   s3   option "%s" not supported with math-output "MathML"s   is "latexmlmath" in your PATH?t	   base_nodeRà   u   ,s   </p>
RÏ   RĞ   s   literal-blocks   
</pre>
R°   s   
s   </%s>(   s   $%s$u   \begin{%s}
%s
\end{%s}(   s   $%s$u   \begin{%s}
%s
\end{%s}(   s   \(%s\)u   \begin{%s}
%s
\end{%s}(   NN(   R¿  s   mathjax(0   Rc   t	   math_tagsR+   RY   R   R¬   Re   Ry   R4   R
   t   uni2tex_tablet	   TypeErrorR|   Rv   t   mathjax_urlt   mathjax_scriptRd   R_   R   t   find_file_in_dirsR7   t   stylesheet_dirsR   t   DocumentParameterst   displaymodeRH  t   doctype_mathmlt   content_type_mathmlRr   RB   Rf   R   RÁ  RÂ  RÀ  R   t
   tex2mathmlt   OSErrort   SyntaxErrort   visit_system_messageR   R]   R¼   t   argst   depart_system_messageR   R   t   bool(   R)   R®   t   math_envt   tagt   clsargt   wrapperst   wrappert	   math_codet   st	   converterR—   t   err_node(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt
   visit_mathı  s     
		G		
c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_math[  s    c         C   s)   t  | j ƒ  ƒ } |  j | d | ƒd  S(   NR×  (   R   Ry   Rà  (   R)   R®   R×  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_math_block^  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_math_blockc  s    c         C   s,   |  j  | d | j ƒ   } |  j | ƒ d  S(   NR    (   R½   t   non_default_attributesRA  (   R)   R®   R    (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt
   visit_metah  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_metal  s    c         C   s$   |  j  j | ƒ |  j j | ƒ d  S(   N(   R    R]   R   (   R)   RØ  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRA  o  s    c         C   s)   |  j  j |  j | d d d d ƒƒ d  S(   NR  R?   RĞ   t   option(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_options  s    c         C   sK   |  j  j d ƒ t | j d t d t ƒ t j ƒ rG |  j  j d ƒ n  d  S(   Ns   </span>R  R  s   , (   R   R]   R¥   R  Rl   Rj   R   Rç  (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_optionv  s    c         C   s?   |  j  j | j d d ƒ ƒ |  j  j |  j | d d ƒ ƒ d  S(   Nt	   delimiterRƒ   t   varR?   (   R   R]   R   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_option_argument|  s    c         C   s   |  j  j d ƒ d  S(   Ns   </var>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_option_argument€  s    c         C   s3   |  j  j |  j | d d ƒ ƒ |  j  j d ƒ d  S(   NRa  R?   s   <kbd>(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_option_groupƒ  s    c         C   s   |  j  j d ƒ d  S(   Ns   </kbd></dt>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_option_group‡  s    c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   NR6  RĞ   s   option-list(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_option_listŠ  s    	c         C   s   |  j  j d ƒ d  S(   Ns   </dl>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_option_list  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_option_list_item‘  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_option_list_item”  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_option_string—  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_option_stringš  s    c         C   s   |  j  | d ƒ d  S(   Nt   organization(   RÑ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_organization  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_organization   s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   NRà   R?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_paragraph²  s    c         C   sZ   |  j  j d ƒ t | j t j t j f ƒ o@ t | j ƒ d k sV |  j  j d ƒ n  d  S(   Ns   </p>i   s   
(   R   R]   R¥   Ræ   R   t	   list_itemt   entryR#  (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_paragraphµ  s    c         C   ss   | j  d ƒ r: |  j j d | d ƒ |  j j d ƒ n |  j j d ƒ |  j j |  j | d d d d ƒƒ d  S(   NR  s   <a href="#%s">s   </a>R?   R  RĞ   t   problematic(   t   hasattrR   R]   Rg   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_problematic»  s
    c         C   s-   |  j  j d ƒ |  j  j |  j j ƒ  ƒ d  S(   Ns   </span>(   R   R]   Rg   RŸ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_problematicÃ  s    c         C   sµ   d | j  d d ƒ j ƒ  k r¨ t | j t j ƒ r9 d p< d } | d rn |  j j |  j | | d d ƒƒ n  |  j j | j	 ƒ  ƒ | d r¨ |  j j d | ƒ q¨ n  t j
 ‚ d  S(	   NR   t   formatR?   R  RÖ   R™   R°   s   </%s>(   R   Rd   R¥   Ræ   R   R‘  R   R]   R¼   Ry   R   (   R)   R®   t   t(    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt	   visit_rawÇ  s    !
%
c         C   s2  i d d 6} d | k r| | d | d <|  j  j ri | d j d ƒ ri |  j | d ƒ | d <t |  _ n  | d c d 7<n: d | k s” t d ƒ ‚ d	 | d | d <| d c d
 7<t | j t	 j
 ƒ st | ƒ d k ró t | d t	 j ƒ sù t ‚ | d c d 7<n  |  j j |  j | d d |  ƒ d  S(   NR’  Rš   t   refuriR  s   mailto:s	    externalR  s3   References must have "refuri" or "refid" attribute.R  s	    internali   i    s    image-referenceR	  R?   (   R7   R…   R    R   Rj   Rt   R£   R¥   Ræ   R   R‘  R#  t   imageR   R]   R¼   (   R)   R®   R´   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_referenceÒ  s     	.c         C   sE   |  j  j d ƒ t | j t j ƒ s8 |  j  j d ƒ n  t |  _ d  S(   Ns   </a>s   
(   R   R]   R¥   Ræ   R   R‘  Rl   Rt   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_referenceå  s    c         C   s   |  j  | d d t ƒd  S(   Nt   revisionR    (   RÑ   Rl   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_revisionë  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_revisionî  s    c         C   s,   |  j  j |  j | d d ƒ ƒ d | _ d  S(   Nt   trR?   i    (   R   R]   R¼   RU  (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt	   visit_rowñ  s    c         C   s   |  j  j d ƒ d  S(   Ns   </tr>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt
   depart_rowõ  s    c         C   s)   |  j  j |  j | d d d d ƒƒ d  S(   NRà   R?   RĞ   t   rubric(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_rubricø  s    c         C   s   |  j  j d ƒ d  S(   Ns   </p>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_rubricû  s    c         C   s5   |  j  d 7_  |  j j |  j | d d d ƒƒ d  S(   Ni   RÖ   RĞ   t   section(   R`   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_sectionÿ  s    	c         C   s#   |  j  d 8_  |  j j d ƒ d  S(   Ni   s   </div>
(   R`   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_section  s    c         C   s/   |  j  j |  j | d d d ƒƒ t |  _ d  S(   NRÖ   RĞ   t   sidebar(   R   R]   R¼   Rj   Rp   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_sidebar	  s    	c         C   s   |  j  j d ƒ t |  _ d  S(   Ns   </div>
(   R   R]   Rl   Rp   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_sidebar  s    c         C   s   |  j  | d d t ƒd  S(   Nt   statusR    (   RÑ   Rl   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_status  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_status  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   strongR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_strong  s    c         C   s   |  j  j d ƒ d  S(   Ns	   </strong>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_strong  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   NR„   R?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_subscript  s    c         C   s   |  j  j d ƒ d  S(   Ns   </sub>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_subscript!  s    c         C   s   t  j ‚ d S(   s   Internal only.N(   R   R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_substitution_definition$  s    c         C   s   |  j  | ƒ d  S(   N(   t   unimplemented_visit(   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_substitution_reference(  s    c         C   s•   t  | j t j ƒ r d } nN t  | j t j ƒ rN d } t |  j ƒ |  _ n t  | j t j ƒ rl d } n  |  j j	 |  j
 | d d d | ƒƒ d  S(   Ns   sidebar-subtitleR   s   section-subtitleRà   R?   RĞ   (   R¥   Ræ   R   R  R+   R#  R   Rs   R  R]   R¼   (   R)   R®   R™   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_subtitle/  s    		c         C   sl   |  j  j d ƒ |  j rh |  j  |  j d !|  _ d |  _ |  j j |  j  ƒ |  j j |  j  ƒ |  j  2n  d  S(   Ns   </p>
iÿÿÿÿi    (   R   R]   Rs   R   R   R¤   R%   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_subtitle9  s    		c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   supR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_superscriptB  s    c         C   s   |  j  j d ƒ d  S(   Ns   </sup>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_superscriptE  s    c         C   s+  |  j  j |  j | d d d ƒƒ |  j  j d ƒ d } t | d ƒ rÉ | d } t | ƒ d k ru d | d	 } qÉ d } g  } x/ | D]' } | j d
 | | f ƒ | d 7} qˆ Wd d j | ƒ } n  | j d ƒ ré d | d } n d } |  j  j d | d | d |  j | d ƒ | | f ƒ d  S(   NRÖ   RĞ   s   system-messages    <p class="system-message-title">R?   Rœ  i   s%   ; <em><a href="#%s">backlink</a></em>i    s   <a href="#%s">%s</a>s   ; <em>backlinks: %s</em>s   , R¨  s	   , line %ssI   System Message: %s/%s (<span class="docutils literal">%s</span>%s)%s</p>
Ry  t   levelt   source(   R   R]   R¼   R#  RB   Rş  R|   (   R)   R®   t   backref_textRœ  R¡  R£  t   backrefR¨  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRÓ  H  s*    "
c         C   s   |  j  j d ƒ d  S(   Ns   </div>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRÕ  b  s    c         C   sŠ   g  |  j  j j d ƒ D] } | j d ƒ ^ q } d | k rU | j d | d ƒ n  |  j | d d d j | ƒ ƒ} |  j j | ƒ d  S(   NRŸ  u    	
Rh  s   align-%st   tableRĞ   Rƒ   (   R7   R  Rd   R¡   R]   R¼   RB   R   (   R)   R®   R·   R™   RØ  (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_tablei  s    .!c         C   s   |  j  j d ƒ d  S(   Ns	   </table>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_tableq  s    c         C   sp   d | k p! d | k p! d | k s\ |  j  j |  j | d d d d ƒƒ |  j j d ƒ n |  j j d ƒ d  S(	   NR  R  R  R  R?   RĞ   t   targets   </span>(   R   R]   R¼   Rg   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_targett  s
    %c         C   s   |  j  j |  j j ƒ  ƒ d  S(   N(   R   R]   Rg   RŸ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_target|  s    c         C   s    |  j  j |  j | d ƒ ƒ d  S(   Nt   tbody(   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_tbody€  s    c         C   s   |  j  j d ƒ d  S(   Ns	   </tbody>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_tbodyƒ  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   NRa  R?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt
   visit_term†  s    c         C   s   d S(   sg   
        Leave the end tag to `self.visit_definition()`, in case there's a
        classifier.
        N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_term‰  s    c         C   s   g  |  _  g  | _ d  S(   N(   Ri   R  (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_tgroup  s    	c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_tgroup”  s    c         C   s    |  j  j |  j | d ƒ ƒ d  S(   NRT  (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_thead—  s    c         C   s   |  j  j d ƒ d  S(   Ns	   </thead>
(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_theadš  s    c         C   sr  d } d } t  | j t j ƒ rI |  j j |  j | d d d d ƒƒ nt  | j t j ƒ r† |  j j |  j | d d d d ƒƒ nØt  | j t j ƒ rÃ |  j j |  j | d d d d ƒƒ n›t  | j t j	 ƒ r |  j j |  j | d	 d ƒ ƒ d
 } n^t  | j t j
 ƒ rU|  j j |  j | d d d d ƒƒ d } t |  j ƒ |  _ n	t  | j t j ƒ spt ‚ |  j |  j d } i  } t | j ƒ d k rÅt  | j d t j ƒ rÅd | d <n  |  j j |  j | d | d |  ƒ i  } | j d ƒ rd | d <d | d | d <n  | rT|  j j |  j i  d d |  ƒ d | } n
 d | } |  j j | ƒ d S(   s,   Only 6 section levels are supported by HTML.i    s   </p>
Rà   R?   RĞ   s   topic-title firsts   sidebar-titles   admonition-titleRı   s   </caption>
t   h1R   s   </h1>
i   i   s   with-subtitles   h%sR  s   toc-backrefRš   R  R  R	  s   </a></h%s>
s   </h%s>
N(   R¥   Ræ   R   t   topicR   R]   R¼   R  t
   AdmonitionR+  R+   R#  Rs   R  R£   R`   Rb   R   Rş  Rg   (   R)   R®   t   check_idt	   close_tagt   h_levelR´   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_title  sH    					%	
"
c         C   su   |  j  j |  j j ƒ  ƒ |  j rq |  j  |  j d !|  _ d |  _ |  j j |  j  ƒ |  j j |  j  ƒ |  j  2n  d  S(   Niÿÿÿÿi    (	   R   R]   Rg   RŸ   Rs   R   R   R¤   R$   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_titleÆ  s    		c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   citeR?   (   R   R]   R¼   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_title_referenceÏ  s    c         C   s   |  j  j d ƒ d  S(   Ns   </cite>(   R   R]   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_title_referenceÒ  s    c         C   s3   |  j  j |  j | d d d ƒƒ | d |  _ d  S(   NRÖ   RĞ   R;  R™   (   R   R]   R¼   Rh   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_topicÖ  s    "c         C   s   |  j  j d ƒ g  |  _ d  S(   Ns   </div>
(   R   R]   Rh   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_topicÜ  s    c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   Nt   hrRĞ   RE   (   R   R]   R½   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_transitioná  s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_transitionä  s    c         C   s   |  j  | d d t ƒd  S(   NRA   R    (   RÑ   Rl   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   visit_versionç  s    c         C   s   |  j  ƒ  d  S(   N(   RÓ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   depart_versionê  s    c         C   s   t  d | j j ƒ ‚ d  S(   Ns$   visiting unimplemented node type: %s(   t   NotImplementedErrort	   __class__R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR   í  s    N(   u   â€”R?   (   RÛ   RÜ   (   RÛ   RÜ   (   R?   R?   (   s   divR?   R?   (   s   divs   spanR¼  (   s   divs   spans   math(   s   pres   tts   math(Ú   R   R   t   __doc__R\   RH  RÎ  RI  Rr   R[   RÉ  RÈ  R•   R‘   R  t   compileR²  t   UR´  R¢   t   ordRz   RV   Ry   R|   R   R‚   Rˆ   R_   Rl   R¼   R½   RÅ   RÆ   RÇ   RÉ   RÊ   RÌ   RÍ   RÒ   RÔ   RØ   R¬   RÙ   Râ   Rã   Rä   Rè   Ré   Rê   Rë   Rí   Rî   Rò   R÷   Rû   Rü   Rş   Rÿ   R   R  R  R  R  R  R  R  R„   R!  R$  R%  R&  R'  R)  R*  R,  R-  R/  R0  R1  R2  R4  R5  R8  R9  R;  R<  R=  R>  R?  R@  Rj   RÑ   RÓ   RD  RE  RF  RJ  RL  RM  RV  RW  R[  R\  R]  R^  R_  R`  Rb  Rc  Rd  Re  Ri  Rj  Rk  Rl  Rn  Rp  Rq  Rr  Rt  Ru  Rv  Rw  R„  R–  R—  R˜  R™  R  R¤  R¦  R§  R©  Rª  R«  R¬  R®  R¯  R·  R¸  R¹  Rº  RÅ  Rà  Rá  Râ  Rã  Rå  Ræ  RA  Rè  Ré  Rì  Rí  Rî  Rï  Rğ  Rñ  Rò  Ró  Rô  Rõ  R÷  Rø  Rù  Rü  Rÿ  R   R  R  R  R	  R
  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R!  R"  R#  R%  R&  RÓ  RÕ  R,  R-  R/  R0  R2  R3  R4  R5  R6  R7  R8  R9  R@  RA  RC  RD  RE  RF  RH  RI  RJ  RK  R   (    (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRN   c   s¶  	9							C									

											
																																													
																		
			
	A																	

^																																														
																			)										Rï   c           B   sÔ   e  Z d  Z d „  Z d „  Z d „  Z d „  Z e Z e Z e Z	 e Z
 e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z e Z  e Z! RS(   s  
    Raise `nodes.NodeFound` if non-simple list item is encountered.

    Here "simple" means a list item containing nothing other than a single
    paragraph, a simple list, or a paragraph followed by a simple list.

    This version also checks for simple field lists and docinfo.
    c         C   s   t  j ‚ d  S(   N(   R   Rñ   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   default_visitı  s    c         C   s¼   g  | j  D] } t | t j ƒ s
 | ^ q
 } | r™ t | d t j ƒ r™ t | d t j ƒ sŒ t | d t j ƒ sŒ t | d t j ƒ r™ | j ƒ  n  t	 | ƒ d k r¯ d  St j
 ‚ d  S(   Ni    iÿÿÿÿi   (   RÃ   R¥   R   R¾   t	   paragraphR¦   R§   R©   RŸ   R#  Rñ   (   R)   R®   RÄ   RÃ   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyR®     s    c         C   s   d  S(   N(    (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt	   pass_node  s    c         C   s   t  j ‚ d  S(   N(   R   R   (   R)   R®   (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   ignore_node  s    ("   R   R   RN  RR  R®  RT  RU  RÆ   Rù  Rû   R[  R?  Rè   Rê   RÒ   R)  R,  R/  R÷  R  RJ  R8  R;  R4  R  R4  R]  R_  Rd  Rb  R!  R  R/  t   visit_pending(    (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyRï   ò  s@   					(    R‰  t   os.pathR‚  R  R†  t	   PIL.ImageR    t   ImportErrorRˆ  R€  R¬   RE   R   R   R   R   R   t   docutils.utils.error_reportingR   t   docutils.transformsR	   t   docutils.utils.mathR
   R   R   R   R   R   RU   RN   t   GenericNodeVisitorRï   (    (    (    s=   /tmp/pip-build-awuatQ/docutils/docutils/writers/_html_base.pyt   <module>   s2   ((8ÿ ÿ ÿ ÿ ÿ ”                                                                                                      usr/local/lib/python2.7/dist-packages/docutils/writers/docutils_xml.py                              0100644 0000000 0000062 00000017007 13077704374 024643  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # $Id: docutils_xml.py 7966 2016-08-18 13:06:09Z milde $
# Author: David Goodger, Paul Tremblay, Guenter Milde
# Maintainer: docutils-develop@lists.sourceforge.net
# Copyright: This module has been placed in the public domain.

"""
Simple document tree Writer, writes Docutils XML according to
http://docutils.sourceforge.net/docs/ref/docutils.dtd.
"""

__docformat__ = 'reStructuredText'

import sys

# Work around broken PyXML and obsolete python stdlib behaviour. (The stdlib
# replaces its own xml module with PyXML if the latter is installed. However,
# PyXML is no longer maintained and partially incompatible/buggy.) Reverse
# the order in which xml module and submodules are searched to import stdlib
# modules if they exist and PyXML modules if they do not exist in the stdlib.
#
# See http://sourceforge.net/tracker/index.php?func=detail&aid=3552403&group_id=38414&atid=422030
# and http://lists.fedoraproject.org/pipermail/python-devel/2012-July/000406.html
import xml
if "_xmlplus" in xml.__path__[0]: # PyXML sub-module
    xml.__path__.reverse() # If both are available, prefer stdlib over PyXML

import xml.sax.saxutils
from StringIO import StringIO

import docutils
from docutils import frontend, writers, nodes


class RawXmlError(docutils.ApplicationError): pass


class Writer(writers.Writer):

    supported = ('xml',)
    """Formats this writer supports."""

    settings_spec = (
        '"Docutils XML" Writer Options',
        None,
        (('Generate XML with newlines before and after tags.',
          ['--newlines'],
          {'action': 'store_true', 'validator': frontend.validate_boolean}),
         ('Generate XML with indents and newlines.',
          ['--indents'], #@ TODO use integer value for number of spaces?
          {'action': 'store_true', 'validator': frontend.validate_boolean}),
         ('Omit the XML declaration.  Use with caution.',
          ['--no-xml-declaration'],
          {'dest': 'xml_declaration', 'default': 1, 'action': 'store_false',
           'validator': frontend.validate_boolean}),
         ('Omit the DOCTYPE declaration.',
          ['--no-doctype'],
          {'dest': 'doctype_declaration', 'default': 1,
           'action': 'store_false', 'validator': frontend.validate_boolean}),))

    settings_defaults = {'output_encoding_error_handler': 'xmlcharrefreplace'}

    config_section = 'docutils_xml writer'
    config_section_dependencies = ('writers',)

    output = None
    """Final translated form of `document`."""

    def __init__(self):
        writers.Writer.__init__(self)
        self.translator_class = XMLTranslator

    def translate(self):
        self.visitor = visitor = self.translator_class(self.document)
        self.document.walkabout(visitor)
        self.output = ''.join(visitor.output)


class XMLTranslator(nodes.GenericNodeVisitor):

    xml_declaration = '<?xml version="1.0" encoding="%s"?>\n'
    # TODO: add stylesheet options similar to HTML and LaTeX writers?
    #xml_stylesheet = '<?xml-stylesheet type="text/xsl" href="%s"?>\n'
    doctype = (
        '<!DOCTYPE document PUBLIC'
        ' "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML"'
        ' "http://docutils.sourceforge.net/docs/ref/docutils.dtd">\n')
    generator = '<!-- Generated by Docutils %s -->\n'

    xmlparser = xml.sax.make_parser()
    """SAX parser instance to check/exctract raw XML."""
    xmlparser.setFeature(
        "http://xml.org/sax/features/external-general-entities", True)

    def __init__(self, document):
        nodes.NodeVisitor.__init__(self, document)

        # Reporter
        self.warn = self.document.reporter.warning
        self.error = self.document.reporter.error

        # Settings
        self.settings = settings = document.settings
        self.indent = self.newline = ''
        if settings.newlines:
            self.newline = '\n'
        if settings.indents:
            self.newline = '\n'
            self.indent = '    ' #@ TODO make this configurable?
        self.level = 0  # indentation level
        self.in_simple = 0 # level of nesting inside mixed-content elements
        self.fixed_text = 0 # level of nesting inside FixedText elements

        # Output
        self.output = []
        if settings.xml_declaration:
            self.output.append(
                self.xml_declaration % settings.output_encoding)
        if settings.doctype_declaration:
            self.output.append(self.doctype)
        self.output.append(self.generator % docutils.__version__)

        # initialize XML parser
        self.the_handle=TestXml()
        self.xmlparser.setContentHandler(self.the_handle)

    # generic visit and depart methods
    # --------------------------------

    simple_nodes = (nodes.TextElement,
                    nodes.image, nodes.colspec, nodes.transition) # empty elements

    def default_visit(self, node):
        """Default node visit method."""
        if not self.in_simple:
            self.output.append(self.indent*self.level)
        self.output.append(node.starttag(xml.sax.saxutils.quoteattr))
        self.level += 1
        # @@ make nodes.literal an instance of FixedTextElement?
        if isinstance(node, (nodes.FixedTextElement, nodes.literal)):
            self.fixed_text += 1
        if isinstance(node, self.simple_nodes):
            self.in_simple += 1
        if not self.in_simple:
            self.output.append(self.newline)

    def default_departure(self, node):
        """Default node depart method."""
        self.level -= 1
        if not self.in_simple:
            self.output.append(self.indent*self.level)
        self.output.append(node.endtag())
        if isinstance(node, (nodes.FixedTextElement, nodes.literal)):
            self.fixed_text -= 1
        if isinstance(node, self.simple_nodes):
            self.in_simple -= 1
        if not self.in_simple:
            self.output.append(self.newline)


    # specific visit and depart methods
    # ---------------------------------

    def visit_Text(self, node):
        text = xml.sax.saxutils.escape(node.astext())
        # indent text if we are not in a FixedText element:
        if not self.fixed_text:
            text = text.replace('\n', '\n'+self.indent*self.level)
        self.output.append(text)

    def depart_Text(self, node):
        pass

    def visit_raw(self, node):
        if 'xml' not in node.get('format', '').split():
            # skip other raw content?
            # raise nodes.SkipNode
            self.default_visit(node)
            return
        # wrap in <raw> element
        self.default_visit(node)      # or not?
        xml_string = node.astext()
        self.output.append(xml_string)
        self.default_departure(node)  # or not?
        # Check validity of raw XML:
        if isinstance(xml_string, unicode) and sys.version_info < (3,):
            xml_string = xml_string.encode('utf8')
        try:
            self.xmlparser.parse(StringIO(xml_string))
        except xml.sax._exceptions.SAXParseException, error:
            col_num = self.the_handle.locator.getColumnNumber()
            line_num =  self.the_handle.locator.getLineNumber()
            srcline = node.line
            if not isinstance(node.parent, nodes.TextElement):
                srcline += 2 # directive content start line
            msg = 'Invalid raw XML in column %d, line offset %d:\n%s' % (
                   col_num, line_num, node.astext())
            self.warn(msg, source=node.source, line=srcline+line_num-1)
        raise nodes.SkipNode # content already processed


class TestXml(xml.sax.ContentHandler):

    def setDocumentLocator(self, locator):
        self.locator = locator
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         usr/local/lib/python2.7/dist-packages/docutils/writers/docutils_xml.pyc                             0100644 0000000 0000062 00000016034 13077704402 024775  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   sö   d  Z  d Z d d l Z d d l Z d e j d k rG e j j ƒ  n  d d l Z d d l m Z d d l Z d d l m	 Z	 m
 Z
 m Z d e j f d	 „  ƒ  YZ d
 e
 j f d „  ƒ  YZ d e j f d „  ƒ  YZ d e j j f d „  ƒ  YZ d S(   sv   
Simple document tree Writer, writes Docutils XML according to
http://docutils.sourceforge.net/docs/ref/docutils.dtd.
t   reStructuredTextiÿÿÿÿNt   _xmlplusi    (   t   StringIO(   t   frontendt   writerst   nodest   RawXmlErrorc           B   s   e  Z RS(    (   t   __name__t
   __module__(    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyR   "   s    t   Writerc        
   B   sê   e  Z d Z d d d d g i d d 6e j d 6f d d g i d d 6e j d 6f d	 d
 g i d d 6d d 6d d 6e j d 6f d d g i d d 6d d 6d d 6e j d 6f f f Z i d d 6Z d Z d Z	 d Z
 d „  Z d „  Z RS(   t   xmls   "Docutils XML" Writer Optionss1   Generate XML with newlines before and after tags.s
   --newlinest
   store_truet   actiont	   validators'   Generate XML with indents and newlines.s	   --indentss,   Omit the XML declaration.  Use with caution.s   --no-xml-declarationt   xml_declarationt   desti   t   defaultt   store_falses   Omit the DOCTYPE declaration.s   --no-doctypet   doctype_declarationt   xmlcharrefreplacet   output_encoding_error_handlers   docutils_xml writerR   c         C   s   t  j j |  ƒ t |  _ d  S(   N(   R   R	   t   __init__t   XMLTranslatort   translator_class(   t   self(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyR   D   s    c         C   sB   |  j  |  j ƒ |  _ } |  j j | ƒ d j | j ƒ |  _ d  S(   Nt    (   R   t   documentt   visitort	   walkaboutt   joint   output(   R   R   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt	   translateH   s    (   s   xmlN(   s   writers(   R   R   t	   supportedt   NoneR   t   validate_booleant   settings_spect   settings_defaultst   config_sectiont   config_section_dependenciesR   R   R   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyR	   %   s.   	R   c           B   s   e  Z d  Z d Z d Z e j j ƒ  Z e j	 d e
 ƒ d „  Z e j e j e j e j f Z d „  Z d „  Z d „  Z d „  Z d	 „  Z RS(
   s$   <?xml version="1.0" encoding="%s"?>
s”   <!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
s"   <!-- Generated by Docutils %s -->
s5   http://xml.org/sax/features/external-general-entitiesc         C   s0  t  j j |  | ƒ |  j j j |  _ |  j j j |  _ | j |  _ } d |  _	 |  _
 | j rl d |  _
 n  | j rŠ d |  _
 d |  _	 n  d |  _ d |  _ d |  _ g  |  _ | j rÔ |  j j |  j | j ƒ n  | j ró |  j j |  j ƒ n  |  j j |  j t j ƒ t ƒ  |  _ |  j j |  j ƒ d  S(   NR   s   
s       i    (   R   t   NodeVisitorR   R   t   reportert   warningt   warnt   errort   settingst   indentt   newlinet   newlinest   indentst   levelt	   in_simplet
   fixed_textR   R   t   appendt   output_encodingR   t   doctypet	   generatort   docutilst   __version__t   TestXmlt
   the_handlet	   xmlparsert   setContentHandler(   R   R   R,   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyR   ^   s,    										c         C   sË   |  j  s& |  j j |  j |  j ƒ n  |  j j | j t j j j	 ƒ ƒ |  j d 7_ t
 | t j t j f ƒ r„ |  j d 7_ n  t
 | |  j ƒ r¨ |  j  d 7_  n  |  j  sÇ |  j j |  j ƒ n  d S(   s   Default node visit method.i   N(   R2   R   R4   R-   R1   t   starttagR
   t   saxt   saxutilst	   quoteattrt
   isinstanceR   t   FixedTextElementt   literalR3   t   simple_nodesR.   (   R   t   node(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt   default_visit„   s    	"	c         C   s¿   |  j  d 8_  |  j s5 |  j j |  j |  j  ƒ n  |  j j | j ƒ  ƒ t | t j t j	 f ƒ rx |  j
 d 8_
 n  t | |  j ƒ rœ |  j d 8_ n  |  j s» |  j j |  j ƒ n  d S(   s   Default node depart method.i   N(   R1   R2   R   R4   R-   t   endtagRB   R   RC   RD   R3   RE   R.   (   R   RF   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt   default_departure’   s    		c         C   s[   t  j j j | j ƒ  ƒ } |  j sG | j d d |  j |  j ƒ } n  |  j	 j
 | ƒ d  S(   Ns   
(   R
   R?   R@   t   escapet   astextR3   t   replaceR-   R1   R   R4   (   R   RF   t   text(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt
   visit_Text£   s    	#c         C   s   d  S(   N(    (   R   RF   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt   depart_Textª   s    c         C   sg  d | j  d d ƒ j ƒ  k r/ |  j | ƒ d  S|  j | ƒ | j ƒ  } |  j j | ƒ |  j | ƒ t | t ƒ r• t	 j
 d k  r• | j d ƒ } n  y |  j j t | ƒ ƒ Wn¨ t j j j k
 rY} |  j j j ƒ  } |  j j j ƒ  } | j } t | j t j ƒ s| d 7} n  d | | | j ƒ  f } |  j | d | j d	 | | d
 ƒn Xt j ‚ d  S(   NR
   t   formatR   i   t   utf8i   s0   Invalid raw XML in column %d, line offset %d:
%st   sourcet   linei   (   i   (   t   gett   splitRG   RK   R   R4   RI   RB   t   unicodet   syst   version_infot   encodeR<   t   parseR   R
   R?   t   _exceptionst   SAXParseExceptionR;   t   locatort   getColumnNumbert   getLineNumberRS   t   parentR   t   TextElementR*   RR   t   SkipNode(   R   RF   t
   xml_stringR+   t   col_numt   line_numt   srclinet   msg(    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt	   visit_raw­   s*    	((   R   R   R   R6   R7   R
   R?   t   make_parserR<   t
   setFeaturet   TrueR   R   Ra   t   imaget   colspect
   transitionRE   RG   RI   RN   RO   Rh   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyR   N   s   
	#				R:   c           B   s   e  Z d  „  Z RS(   c         C   s   | |  _  d  S(   N(   R]   (   R   R]   (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt   setDocumentLocatorË   s    (   R   R   Ro   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyR:   É   s   (   t   __doc__t   __docformat__RW   R
   t   __path__t   reverset   xml.sax.saxutilsR   R8   R   R   R   t   ApplicationErrorR   R	   t   GenericNodeVisitorR   R?   t   ContentHandlerR:   (    (    (    s?   /tmp/pip-build-awuatQ/docutils/docutils/writers/docutils_xml.pyt   <module>	   s   
){                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    usr/local/lib/python2.7/dist-packages/docutils/writers/html4css1/                                   0042755 0000000 0000062 00000000000 13077704402 023375  5                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        usr/local/lib/python2.7/dist-packages/docutils/writers/html4css1/__init__.py                        0100644 0000000 0000062 00000101514 13077704374 025513  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # $Id: __init__.py 7977 2016-11-29 12:00:39Z milde $
# Author: David Goodger
# Maintainer: docutils-develop@lists.sourceforge.net
# Copyright: This module has been placed in the public domain.

"""
Simple HyperText Markup Language document tree Writer.

The output conforms to the XHTML version 1.0 Transitional DTD
(*almost* strict).  The output contains a minimum of formatting
information.  The cascading style sheet "html4css1.css" is required
for proper viewing with a modern graphical browser.
"""

__docformat__ = 'reStructuredText'

import os.path
import docutils
from docutils import frontend, nodes, writers, io
from docutils.transforms import writer_aux
from docutils.writers import _html_base

class Writer(writers._html_base.Writer):

    supported = ('html', 'html4', 'html4css1', 'xhtml', 'xhtml10')
    """Formats this writer supports."""

    default_stylesheets = ['html4css1.css']
    default_stylesheet_dirs = ['.',
        os.path.abspath(os.path.dirname(__file__)),
        # for math.css
        os.path.abspath(os.path.join(
            os.path.dirname(os.path.dirname(__file__)), 'html5_polyglot'))
       ]

    default_template = 'template.txt'
    default_template_path = os.path.join(
        os.path.dirname(os.path.abspath(__file__)), default_template)

    settings_spec = (
        'HTML-Specific Options',
        None,
        (('Specify the template file (UTF-8 encoded).  Default is "%s".'
          % default_template_path,
          ['--template'],
          {'default': default_template_path, 'metavar': '<file>'}),
         ('Comma separated list of stylesheet URLs. '
          'Overrides previous --stylesheet and --stylesheet-path settings.',
          ['--stylesheet'],
          {'metavar': '<URL[,URL,...]>', 'overrides': 'stylesheet_path',
           'validator': frontend.validate_comma_separated_list}),
         ('Comma separated list of stylesheet paths. '
          'Relative paths are expanded if a matching file is found in '
          'the --stylesheet-dirs. With --link-stylesheet, '
          'the path is rewritten relative to the output HTML file. '
          'Default: "%s"' % ','.join(default_stylesheets),
          ['--stylesheet-path'],
          {'metavar': '<file[,file,...]>', 'overrides': 'stylesheet',
           'validator': frontend.validate_comma_separated_list,
           'default': default_stylesheets}),
         ('Embed the stylesheet(s) in the output HTML file.  The stylesheet '
          'files must be accessible during processing. This is the default.',
          ['--embed-stylesheet'],
          {'default': 1, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Link to the stylesheet(s) in the output HTML file. '
          'Default: embed stylesheets.',
          ['--link-stylesheet'],
          {'dest': 'embed_stylesheet', 'action': 'store_false'}),
         ('Comma-separated list of directories where stylesheets are found. '
          'Used by --stylesheet-path when expanding relative path arguments. '
          'Default: "%s"' % default_stylesheet_dirs,
          ['--stylesheet-dirs'],
          {'metavar': '<dir[,dir,...]>',
           'validator': frontend.validate_comma_separated_list,
           'default': default_stylesheet_dirs}),
         ('Specify the initial header level.  Default is 1 for "<h1>".  '
          'Does not affect document title & subtitle (see --no-doc-title).',
          ['--initial-header-level'],
          {'choices': '1 2 3 4 5 6'.split(), 'default': '1',
           'metavar': '<level>'}),
         ('Specify the maximum width (in characters) for one-column field '
          'names.  Longer field names will span an entire row of the table '
          'used to render the field list.  Default is 14 characters.  '
          'Use 0 for "no limit".',
          ['--field-name-limit'],
          {'default': 14, 'metavar': '<level>',
           'validator': frontend.validate_nonnegative_int}),
         ('Specify the maximum width (in characters) for options in option '
          'lists.  Longer options will span an entire row of the table used '
          'to render the option list.  Default is 14 characters.  '
          'Use 0 for "no limit".',
          ['--option-limit'],
          {'default': 14, 'metavar': '<level>',
           'validator': frontend.validate_nonnegative_int}),
         ('Format for footnote references: one of "superscript" or '
          '"brackets".  Default is "brackets".',
          ['--footnote-references'],
          {'choices': ['superscript', 'brackets'], 'default': 'brackets',
           'metavar': '<format>',
           'overrides': 'trim_footnote_reference_space'}),
         ('Format for block quote attributions: one of "dash" (em-dash '
          'prefix), "parentheses"/"parens", or "none".  Default is "dash".',
          ['--attribution'],
          {'choices': ['dash', 'parentheses', 'parens', 'none'],
           'default': 'dash', 'metavar': '<format>'}),
         ('Remove extra vertical whitespace between items of "simple" bullet '
          'lists and enumerated lists.  Default: enabled.',
          ['--compact-lists'],
          {'default': 1, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Disable compact simple bullet and enumerated lists.',
          ['--no-compact-lists'],
          {'dest': 'compact_lists', 'action': 'store_false'}),
         ('Remove extra vertical whitespace between items of simple field '
          'lists.  Default: enabled.',
          ['--compact-field-lists'],
          {'default': 1, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Disable compact simple field lists.',
          ['--no-compact-field-lists'],
          {'dest': 'compact_field_lists', 'action': 'store_false'}),
         ('Added to standard table classes. '
          'Defined styles: "borderless". Default: ""',
          ['--table-style'],
          {'default': ''}),
         ('Math output format, one of "MathML", "HTML", "MathJax" '
          'or "LaTeX". Default: "HTML math.css"',
          ['--math-output'],
          {'default': 'HTML math.css'}),
         ('Omit the XML declaration.  Use with caution.',
          ['--no-xml-declaration'],
          {'dest': 'xml_declaration', 'default': 1, 'action': 'store_false',
           'validator': frontend.validate_boolean}),
         ('Obfuscate email addresses to confuse harvesters while still '
          'keeping email links usable with standards-compliant browsers.',
          ['--cloak-email-addresses'],
          {'action': 'store_true', 'validator': frontend.validate_boolean}),))

    config_section = 'html4css1 writer'

    def __init__(self):
        self.parts = {}
        self.translator_class = HTMLTranslator


class HTMLTranslator(writers._html_base.HTMLTranslator):
    """
    The html4css1 writer has been optimized to produce visually compact
    lists (less vertical whitespace).  HTML's mixed content models
    allow list items to contain "<li><p>body elements</p></li>" or
    "<li>just text</li>" or even "<li>text<p>and body
    elements</p>combined</li>", each with different effects.  It would
    be best to stick with strict body elements in list items, but they
    affect vertical spacing in older browsers (although they really
    shouldn't).
    The html5_polyglot writer solves this using CSS2.

    Here is an outline of the optimization:

    - Check for and omit <p> tags in "simple" lists: list items
      contain either a single paragraph, a nested simple list, or a
      paragraph followed by a nested simple list.  This means that
      this list can be compact:

          - Item 1.
          - Item 2.

      But this list cannot be compact:

          - Item 1.

            This second paragraph forces space between list items.

          - Item 2.

    - In non-list contexts, omit <p> tags on a paragraph if that
      paragraph is the only child of its parent (footnotes & citations
      are allowed a label first).

    - Regardless of the above, in definitions, table cells, field bodies,
      option descriptions, and list items, mark the first child with
      'class="first"' and the last child with 'class="last"'.  The stylesheet
      sets the margins (top & bottom respectively) to 0 for these elements.

    The ``no_compact_lists`` setting (``--no-compact-lists`` command-line
    option) disables list whitespace optimization.
    """

    # The following definitions are required for display in browsers limited
    # to CSS1 or backwards compatible behaviour of the writer:

    doctype = (
        '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"'
        ' "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n')

    content_type = ('<meta http-equiv="Content-Type"'
                    ' content="text/html; charset=%s" />\n')
    content_type_mathml = ('<meta http-equiv="Content-Type"'
                           ' content="application/xhtml+xml; charset=%s" />\n')

    # encode also non-breaking space
    special_characters = dict(_html_base.HTMLTranslator.special_characters)
    special_characters[0xa0] = u'&nbsp;'

    # use character reference for dash (not valid in HTML5)
    attribution_formats = {'dash': ('&mdash;', ''),
                           'parentheses': ('(', ')'),
                           'parens': ('(', ')'),
                           'none': ('', '')}

    # ersatz for first/last pseudo-classes missing in CSS1
    def set_first_last(self, node):
        self.set_class_on_child(node, 'first', 0)
        self.set_class_on_child(node, 'last', -1)

    # add newline after opening tag
    def visit_address(self, node):
        self.visit_docinfo_item(node, 'address', meta=False)
        self.body.append(self.starttag(node, 'pre', CLASS='address'))


    # ersatz for first/last pseudo-classes
    def visit_admonition(self, node):
        node['classes'].insert(0, 'admonition')
        self.body.append(self.starttag(node, 'div'))
        self.set_first_last(node)

    # author, authors: use <br> instead of paragraphs
    def visit_author(self, node):
        if isinstance(node.parent, nodes.authors):
            if self.author_in_authors:
                self.body.append('\n<br />')
        else:
            self.visit_docinfo_item(node, 'author')

    def depart_author(self, node):
        if isinstance(node.parent, nodes.authors):
            self.author_in_authors = True
        else:
            self.depart_docinfo_item()

    def visit_authors(self, node):
        self.visit_docinfo_item(node, 'authors')
        self.author_in_authors = False  # initialize

    def depart_authors(self, node):
        self.depart_docinfo_item()

    # Compact lists:
    # exclude definition lists and field lists (non-compact by default)

    def is_compactable(self, node):
        return ('compact' in node['classes']
                or (self.settings.compact_lists
                    and 'open' not in node['classes']
                    and (self.compact_simple
                         or self.topic_classes == ['contents']
                         # TODO: self.in_contents
                         or self.check_simple_list(node))))

    # citations: Use table for bibliographic references.
    def visit_citation(self, node):
        self.body.append(self.starttag(node, 'table',
                                       CLASS='docutils citation',
                                       frame="void", rules="none"))
        self.body.append('<colgroup><col class="label" /><col /></colgroup>\n'
                         '<tbody valign="top">\n'
                         '<tr>')
        self.footnote_backrefs(node)

    def depart_citation(self, node):
        self.body.append('</td></tr>\n'
                         '</tbody>\n</table>\n')

    # insert classifier-delimiter (not required with CSS2)
    def visit_classifier(self, node):
        self.body.append(' <span class="classifier-delimiter">:</span> ')
        self.body.append(self.starttag(node, 'span', '', CLASS='classifier'))

    # rewritten in _html_base (support for "auto" width)
    def depart_colspec(self, node):
        pass

    def write_colspecs(self):
        width = 0
        for node in self.colspecs:
            width += node['colwidth']
        for node in self.colspecs:
            colwidth = int(node['colwidth'] * 100.0 / width + 0.5)
            self.body.append(self.emptytag(node, 'col',
                                           width='%i%%' % colwidth))
        self.colspecs = []

    # ersatz for first/last pseudo-classes
    def visit_definition(self, node):
        self.body.append('</dt>\n')
        self.body.append(self.starttag(node, 'dd', ''))
        self.set_first_last(node)

    # don't add "simple" class value
    def visit_definition_list(self, node):
        self.body.append(self.starttag(node, 'dl', CLASS='docutils'))

    # use a table for description lists
    def visit_description(self, node):
        self.body.append(self.starttag(node, 'td', ''))
        self.set_first_last(node)

    def depart_description(self, node):
        self.body.append('</td>')

    # use table for docinfo
    def visit_docinfo(self, node):
        self.context.append(len(self.body))
        self.body.append(self.starttag(node, 'table',
                                       CLASS='docinfo',
                                       frame="void", rules="none"))
        self.body.append('<col class="docinfo-name" />\n'
                         '<col class="docinfo-content" />\n'
                         '<tbody valign="top">\n')
        self.in_docinfo = True

    def depart_docinfo(self, node):
        self.body.append('</tbody>\n</table>\n')
        self.in_docinfo = False
        start = self.context.pop()
        self.docinfo = self.body[start:]
        self.body = []

    def visit_docinfo_item(self, node, name, meta=True):
        if meta:
            meta_tag = '<meta name="%s" content="%s" />\n' \
                       % (name, self.attval(node.astext()))
            self.add_meta(meta_tag)
        self.body.append(self.starttag(node, 'tr', ''))
        self.body.append('<th class="docinfo-name">%s:</th>\n<td>'
                         % self.language.labels[name])
        if len(node):
            if isinstance(node[0], nodes.Element):
                node[0]['classes'].append('first')
            if isinstance(node[-1], nodes.Element):
                node[-1]['classes'].append('last')

    def depart_docinfo_item(self):
        self.body.append('</td></tr>\n')

    # add newline after opening tag
    def visit_doctest_block(self, node):
        self.body.append(self.starttag(node, 'pre', CLASS='doctest-block'))

    # insert an NBSP into empty cells, ersatz for first/last
    def visit_entry(self, node):
        writers._html_base.HTMLTranslator.visit_entry(self, node)
        if len(node) == 0:              # empty cell
            self.body.append('&nbsp;')
        self.set_first_last(node)

    # ersatz for first/last pseudo-classes
    def visit_enumerated_list(self, node):
        """
        The 'start' attribute does not conform to HTML 4.01's strict.dtd, but
        cannot be emulated in CSS1 (HTML 5 reincludes it).
        """
        atts = {}
        if 'start' in node:
            atts['start'] = node['start']
        if 'enumtype' in node:
            atts['class'] = node['enumtype']
        # @@@ To do: prefix, suffix. How? Change prefix/suffix to a
        # single "format" attribute? Use CSS2?
        old_compact_simple = self.compact_simple
        self.context.append((self.compact_simple, self.compact_p))
        self.compact_p = None
        self.compact_simple = self.is_compactable(node)
        if self.compact_simple and not old_compact_simple:
            atts['class'] = (atts.get('class', '') + ' simple').strip()
        self.body.append(self.starttag(node, 'ol', **atts))

    def depart_enumerated_list(self, node):
        self.compact_simple, self.compact_p = self.context.pop()
        self.body.append('</ol>\n')

    # use table for field-list:
    def visit_field(self, node):
        self.body.append(self.starttag(node, 'tr', '', CLASS='field'))

    def depart_field(self, node):
        self.body.append('</tr>\n')

    def visit_field_body(self, node):
        self.body.append(self.starttag(node, 'td', '', CLASS='field-body'))
        self.set_class_on_child(node, 'first', 0)
        field = node.parent
        if (self.compact_field_list or
            isinstance(field.parent, nodes.docinfo) or
            field.parent.index(field) == len(field.parent) - 1):
            # If we are in a compact list, the docinfo, or if this is
            # the last field of the field list, do not add vertical
            # space after last element.
            self.set_class_on_child(node, 'last', -1)

    def depart_field_body(self, node):
        self.body.append('</td>\n')

    def visit_field_list(self, node):
        self.context.append((self.compact_field_list, self.compact_p))
        self.compact_p = None
        if 'compact' in node['classes']:
            self.compact_field_list = True
        elif (self.settings.compact_field_lists
              and 'open' not in node['classes']):
            self.compact_field_list = True
        if self.compact_field_list:
            for field in node:
                field_body = field[-1]
                assert isinstance(field_body, nodes.field_body)
                children = [n for n in field_body
                            if not isinstance(n, nodes.Invisible)]
                if not (len(children) == 0 or
                        len(children) == 1 and
                        isinstance(children[0],
                                   (nodes.paragraph, nodes.line_block))):
                    self.compact_field_list = False
                    break
        self.body.append(self.starttag(node, 'table', frame='void',
                                       rules='none',
                                       CLASS='docutils field-list'))
        self.body.append('<col class="field-name" />\n'
                         '<col class="field-body" />\n'
                         '<tbody valign="top">\n')

    def depart_field_list(self, node):
        self.body.append('</tbody>\n</table>\n')
        self.compact_field_list, self.compact_p = self.context.pop()

    def visit_field_name(self, node):
        atts = {}
        if self.in_docinfo:
            atts['class'] = 'docinfo-name'
        else:
            atts['class'] = 'field-name'
        if ( self.settings.field_name_limit
             and len(node.astext()) > self.settings.field_name_limit):
            atts['colspan'] = 2
            self.context.append('</tr>\n'
                                + self.starttag(node.parent, 'tr', '',
                                                CLASS='field')
                                + '<td>&nbsp;</td>')
        else:
            self.context.append('')
        self.body.append(self.starttag(node, 'th', '', **atts))

    def depart_field_name(self, node):
        self.body.append(':</th>')
        self.body.append(self.context.pop())

    # use table for footnote text
    def visit_footnote(self, node):
        self.body.append(self.starttag(node, 'table',
                                       CLASS='docutils footnote',
                                       frame="void", rules="none"))
        self.body.append('<colgroup><col class="label" /><col /></colgroup>\n'
                         '<tbody valign="top">\n'
                         '<tr>')
        self.footnote_backrefs(node)

    def footnote_backrefs(self, node):
        backlinks = []
        backrefs = node['backrefs']
        if self.settings.footnote_backlinks and backrefs:
            if len(backrefs) == 1:
                self.context.append('')
                self.context.append('</a>')
                self.context.append('<a class="fn-backref" href="#%s">'
                                    % backrefs[0])
            else:
                # Python 2.4 fails with enumerate(backrefs, 1)
                for (i, backref) in enumerate(backrefs):
                    backlinks.append('<a class="fn-backref" href="#%s">%s</a>'
                                     % (backref, i+1))
                self.context.append('<em>(%s)</em> ' % ', '.join(backlinks))
                self.context += ['', '']
        else:
            self.context.append('')
            self.context += ['', '']
        # If the node does not only consist of a label.
        if len(node) > 1:
            # If there are preceding backlinks, we do not set class
            # 'first', because we need to retain the top-margin.
            if not backlinks:
                node[1]['classes'].append('first')
            node[-1]['classes'].append('last')

    def depart_footnote(self, node):
        self.body.append('</td></tr>\n'
                         '</tbody>\n</table>\n')

    # insert markers in text as pseudo-classes are not supported in CSS1:
    def visit_footnote_reference(self, node):
        href = '#' + node['refid']
        format = self.settings.footnote_references
        if format == 'brackets':
            suffix = '['
            self.context.append(']')
        else:
            assert format == 'superscript'
            suffix = '<sup>'
            self.context.append('</sup>')
        self.body.append(self.starttag(node, 'a', suffix,
                                       CLASS='footnote-reference', href=href))

    def depart_footnote_reference(self, node):
        self.body.append(self.context.pop() + '</a>')

    # just pass on generated text
    def visit_generated(self, node):
        pass

    # Image types to place in an <object> element
    # SVG not supported by IE up to version 8
    # (html4css1 strives for IE6 compatibility)
    object_image_types = {'.svg': 'image/svg+xml',
                         '.swf': 'application/x-shockwave-flash'}

    # use table for footnote text,
    # context added in footnote_backrefs.
    def visit_label(self, node):
        self.body.append(self.starttag(node, 'td', '%s[' % self.context.pop(),
                                       CLASS='label'))

    def depart_label(self, node):
        self.body.append(']%s</td><td>%s' % (self.context.pop(), self.context.pop()))


    # ersatz for first/last pseudo-classes
    def visit_list_item(self, node):
        self.body.append(self.starttag(node, 'li', ''))
        if len(node):
            node[0]['classes'].append('first')

    # use <tt> (not supported by HTML5),
    # cater for limited styling options in CSS1 using hard-coded NBSPs
    def visit_literal(self, node):
        # special case: "code" role
        classes = node.get('classes', [])
        if 'code' in classes:
            # filter 'code' from class arguments
            node['classes'] = [cls for cls in classes if cls != 'code']
            self.body.append(self.starttag(node, 'code', ''))
            return
        self.body.append(
            self.starttag(node, 'tt', '', CLASS='docutils literal'))
        text = node.astext()
        for token in self.words_and_spaces.findall(text):
            if token.strip():
                # Protect text like "--an-option" and the regular expression
                # ``[+]?(\d+(\.\d*)?|\.\d+)`` from bad line wrapping
                if self.sollbruchstelle.search(token):
                    self.body.append('<span class="pre">%s</span>'
                                     % self.encode(token))
                else:
                    self.body.append(self.encode(token))
            elif token in ('\n', ' '):
                # Allow breaks at whitespace:
                self.body.append(token)
            else:
                # Protect runs of multiple spaces; the last space can wrap:
                self.body.append('&nbsp;' * (len(token) - 1) + ' ')
        self.body.append('</tt>')
        # Content already processed:
        raise nodes.SkipNode

    # add newline after opening tag, don't use <code> for code
    def visit_literal_block(self, node):
        self.body.append(self.starttag(node, 'pre', CLASS='literal-block'))

    # add newline
    def depart_literal_block(self, node):
        self.body.append('\n</pre>\n')

    # use table for option list
    def visit_option_group(self, node):
        atts = {}
        if ( self.settings.option_limit
             and len(node.astext()) > self.settings.option_limit):
            atts['colspan'] = 2
            self.context.append('</tr>\n<tr><td>&nbsp;</td>')
        else:
            self.context.append('')
        self.body.append(
            self.starttag(node, 'td', CLASS='option-group', **atts))
        self.body.append('<kbd>')
        self.context.append(0)          # count number of options

    def depart_option_group(self, node):
        self.context.pop()
        self.body.append('</kbd></td>\n')
        self.body.append(self.context.pop())

    def visit_option_list(self, node):
        self.body.append(
              self.starttag(node, 'table', CLASS='docutils option-list',
                            frame="void", rules="none"))
        self.body.append('<col class="option" />\n'
                         '<col class="description" />\n'
                         '<tbody valign="top">\n')

    def depart_option_list(self, node):
        self.body.append('</tbody>\n</table>\n')

    def visit_option_list_item(self, node):
        self.body.append(self.starttag(node, 'tr', ''))

    def depart_option_list_item(self, node):
        self.body.append('</tr>\n')

    # Omit <p> tags to produce visually compact lists (less vertical
    # whitespace) as CSS styling requires CSS2.
    def should_be_compact_paragraph(self, node):
        """
        Determine if the <p> tags around paragraph ``node`` can be omitted.
        """
        if (isinstance(node.parent, nodes.document) or
            isinstance(node.parent, nodes.compound)):
            # Never compact paragraphs in document or compound.
            return False
        for key, value in node.attlist():
            if (node.is_not_default(key) and
                not (key == 'classes' and value in
                     ([], ['first'], ['last'], ['first', 'last']))):
                # Attribute which needs to survive.
                return False
        first = isinstance(node.parent[0], nodes.label) # skip label
        for child in node.parent.children[first:]:
            # only first paragraph can be compact
            if isinstance(child, nodes.Invisible):
                continue
            if child is node:
                break
            return False
        parent_length = len([n for n in node.parent if not isinstance(
            n, (nodes.Invisible, nodes.label))])
        if ( self.compact_simple
             or self.compact_field_list
             or self.compact_p and parent_length == 1):
            return True
        return False

    def visit_paragraph(self, node):
        if self.should_be_compact_paragraph(node):
            self.context.append('')
        else:
            self.body.append(self.starttag(node, 'p', ''))
            self.context.append('</p>\n')

    def depart_paragraph(self, node):
        self.body.append(self.context.pop())

    # ersatz for first/last pseudo-classes
    def visit_sidebar(self, node):
        self.body.append(
            self.starttag(node, 'div', CLASS='sidebar'))
        self.set_first_last(node)
        self.in_sidebar = True

    # <sub> not allowed in <pre>
    def visit_subscript(self, node):
        if isinstance(node.parent, nodes.literal_block):
            self.body.append(self.starttag(node, 'span', '',
                                           CLASS='subscript'))
        else:
            self.body.append(self.starttag(node, 'sub', ''))

    def depart_subscript(self, node):
        if isinstance(node.parent, nodes.literal_block):
            self.body.append('</span>')
        else:
            self.body.append('</sub>')

    # Use <h*> for subtitles (deprecated in HTML 5)
    def visit_subtitle(self, node):
        if isinstance(node.parent, nodes.sidebar):
            self.body.append(self.starttag(node, 'p', '',
                                           CLASS='sidebar-subtitle'))
            self.context.append('</p>\n')
        elif isinstance(node.parent, nodes.document):
            self.body.append(self.starttag(node, 'h2', '', CLASS='subtitle'))
            self.context.append('</h2>\n')
            self.in_document_title = len(self.body)
        elif isinstance(node.parent, nodes.section):
            tag = 'h%s' % (self.section_level + self.initial_header_level - 1)
            self.body.append(
                self.starttag(node, tag, '', CLASS='section-subtitle') +
                self.starttag({}, 'span', '', CLASS='section-subtitle'))
            self.context.append('</span></%s>\n' % tag)

    def depart_subtitle(self, node):
        self.body.append(self.context.pop())
        if self.in_document_title:
            self.subtitle = self.body[self.in_document_title:-1]
            self.in_document_title = 0
            self.body_pre_docinfo.extend(self.body)
            self.html_subtitle.extend(self.body)
            del self.body[:]

    # <sup> not allowed in <pre> in HTML 4
    def visit_superscript(self, node):
        if isinstance(node.parent, nodes.literal_block):
            self.body.append(self.starttag(node, 'span', '',
                                           CLASS='superscript'))
        else:
            self.body.append(self.starttag(node, 'sup', ''))

    def depart_superscript(self, node):
        if isinstance(node.parent, nodes.literal_block):
            self.body.append('</span>')
        else:
            self.body.append('</sup>')

    # <tt> element deprecated in HTML 5
    def visit_system_message(self, node):
        self.body.append(self.starttag(node, 'div', CLASS='system-message'))
        self.body.append('<p class="system-message-title">')
        backref_text = ''
        if len(node['backrefs']):
            backrefs = node['backrefs']
            if len(backrefs) == 1:
                backref_text = ('; <em><a href="#%s">backlink</a></em>'
                                % backrefs[0])
            else:
                i = 1
                backlinks = []
                for backref in backrefs:
                    backlinks.append('<a href="#%s">%s</a>' % (backref, i))
                    i += 1
                backref_text = ('; <em>backlinks: %s</em>'
                                % ', '.join(backlinks))
        if node.hasattr('line'):
            line = ', line %s' % node['line']
        else:
            line = ''
        self.body.append('System Message: %s/%s '
                         '(<tt class="docutils">%s</tt>%s)%s</p>\n'
                         % (node['type'], node['level'],
                            self.encode(node['source']), line, backref_text))

    # "hard coded" border setting
    def visit_table(self, node):
        self.context.append(self.compact_p)
        self.compact_p = True
        classes = ['docutils', self.settings.table_style]
        if 'align' in node:
            classes.append('align-%s' % node['align'])
        self.body.append(
            self.starttag(node, 'table', CLASS=' '.join(classes), border="1"))

    def depart_table(self, node):
        self.compact_p = self.context.pop()
        self.body.append('</table>\n')

    # hard-coded vertical alignment
    def visit_tbody(self, node):
        self.write_colspecs()
        self.body.append(self.context.pop()) # '</colgroup>\n' or ''
        self.body.append(self.starttag(node, 'tbody', valign='top'))

    # rewritten in _html_base
    def visit_tgroup(self, node):
        self.body.append(self.starttag(node, 'colgroup'))
        # Appended by thead or tbody:
        self.context.append('</colgroup>\n')
        node.stubs = []

    # rewritten in _html_base
    def visit_thead(self, node):
        self.write_colspecs()
        self.body.append(self.context.pop()) # '</colgroup>\n'
        # There may or may not be a <thead>; this is for <tbody> to use:
        self.context.append('')
        self.body.append(self.starttag(node, 'thead', valign='bottom'))


class SimpleListChecker(writers._html_base.SimpleListChecker):

    """
    Raise `nodes.NodeFound` if non-simple list item is encountered.

    Here "simple" means a list item containing nothing other than a single
    paragraph, a simple list, or a paragraph followed by a simple list.
    """

    def visit_list_item(self, node):
        children = []
        for child in node.children:
            if not isinstance(child, nodes.Invisible):
                children.append(child)
        if (children and isinstance(children[0], nodes.paragraph)
            and (isinstance(children[-1], nodes.bullet_list)
                 or isinstance(children[-1], nodes.enumerated_list))):
            children.pop()
        if len(children) <= 1:
            return
        else:
            raise nodes.NodeFound

    # def visit_bullet_list(self, node):
    #     pass

    # def visit_enumerated_list(self, node):
    #     pass

    # def visit_paragraph(self, node):
    #     raise nodes.SkipNode

    def visit_definition_list(self, node):
        raise nodes.NodeFound

    def visit_docinfo(self, node):
        raise nodes.NodeFound

    def visit_definition_list(self, node):
        raise nodes.NodeFound
                                                                                                                                                                                    usr/local/lib/python2.7/dist-packages/docutils/writers/html4css1/__init__.pyc                       0100644 0000000 0000062 00000104125 13077704402 025647  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   s¾   d  Z  d Z d d l Z d d l Z d d l m Z m Z m Z m Z d d l	 m
 Z
 d d l m Z d e j j f d „  ƒ  YZ d	 e j j f d
 „  ƒ  YZ d e j j f d „  ƒ  YZ d S(   s/  
Simple HyperText Markup Language document tree Writer.

The output conforms to the XHTML version 1.0 Transitional DTD
(*almost* strict).  The output contains a minimum of formatting
information.  The cascading style sheet "html4css1.css" is required
for proper viewing with a modern graphical browser.
t   reStructuredTextiÿÿÿÿN(   t   frontendt   nodest   writerst   io(   t
   writer_aux(   t
   _html_baset   Writerc           B   s  e  Z dU Z d g Z d e j j e j j e ƒ ƒ e j j e j j	 e j j e j j e ƒ ƒ d ƒ ƒ g Z
 d Z e j j	 e j j e j j e ƒ ƒ e ƒ Z d	 dV d
 e d g i e d 6d d 6f d d g i d d 6d d 6e j d 6f d d j	 e ƒ d g i d d 6d d 6e j d 6e d 6f d d g i d d 6d d 6e j d 6f d d  g i d! d" 6d# d 6f d$ e
 d% g i d& d 6e j d 6e
 d 6f d' d( g i d) j ƒ  d* 6d+ d 6d, d 6f d- d. g i d/ d 6d, d 6e j d 6f d0 d1 g i d/ d 6d, d 6e j d 6f d2 d3 g i d4 d5 g d* 6d5 d 6d6 d 6d7 d 6f d8 d9 g i d: d; d< d= g d* 6d: d 6d6 d 6f d> d? g i d d 6d d 6e j d 6f d@ dA g i dB d" 6d# d 6f dC dD g i d d 6d d 6e j d 6f dE dF g i dG d" 6d# d 6f dH dI g i dJ d 6f dK dL g i dM d 6f dN dO g i dP d" 6d d 6d# d 6e j d 6f dQ dR g i d d 6e j d 6f f f Z dS Z dT „  Z RS(W   t   htmlt   html4t	   html4css1t   xhtmlt   xhtml10s   html4css1.csst   .t   html5_polyglots   template.txts   HTML-Specific Optionss<   Specify the template file (UTF-8 encoded).  Default is "%s".s
   --templatet   defaults   <file>t   metavarsh   Comma separated list of stylesheet URLs. Overrides previous --stylesheet and --stylesheet-path settings.s   --stylesheets   <URL[,URL,...]>t   stylesheet_patht	   overridest	   validatorsÙ   Comma separated list of stylesheet paths. Relative paths are expanded if a matching file is found in the --stylesheet-dirs. With --link-stylesheet, the path is rewritten relative to the output HTML file. Default: "%s"t   ,s   --stylesheet-paths   <file[,file,...]>t
   stylesheets   Embed the stylesheet(s) in the output HTML file.  The stylesheet files must be accessible during processing. This is the default.s   --embed-stylesheeti   t
   store_truet   actionsN   Link to the stylesheet(s) in the output HTML file. Default: embed stylesheets.s   --link-stylesheett   embed_stylesheett   destt   store_falses   Comma-separated list of directories where stylesheets are found. Used by --stylesheet-path when expanding relative path arguments. Default: "%s"s   --stylesheet-dirss   <dir[,dir,...]>s|   Specify the initial header level.  Default is 1 for "<h1>".  Does not affect document title & subtitle (see --no-doc-title).s   --initial-header-levels   1 2 3 4 5 6t   choicest   1s   <level>sÏ   Specify the maximum width (in characters) for one-column field names.  Longer field names will span an entire row of the table used to render the field list.  Default is 14 characters.  Use 0 for "no limit".s   --field-name-limiti   sÍ   Specify the maximum width (in characters) for options in option lists.  Longer options will span an entire row of the table used to render the option list.  Default is 14 characters.  Use 0 for "no limit".s   --option-limits[   Format for footnote references: one of "superscript" or "brackets".  Default is "brackets".s   --footnote-referencest   superscriptt   bracketss   <format>t   trim_footnote_reference_spaces{   Format for block quote attributions: one of "dash" (em-dash prefix), "parentheses"/"parens", or "none".  Default is "dash".s   --attributiont   dasht   parenthesest   parenst   nonesp   Remove extra vertical whitespace between items of "simple" bullet lists and enumerated lists.  Default: enabled.s   --compact-listss3   Disable compact simple bullet and enumerated lists.s   --no-compact-listst   compact_listssX   Remove extra vertical whitespace between items of simple field lists.  Default: enabled.s   --compact-field-listss#   Disable compact simple field lists.s   --no-compact-field-listst   compact_field_listssJ   Added to standard table classes. Defined styles: "borderless". Default: ""s   --table-stylet    s[   Math output format, one of "MathML", "HTML", "MathJax" or "LaTeX". Default: "HTML math.css"s   --math-outputs   HTML math.csss,   Omit the XML declaration.  Use with caution.s   --no-xml-declarationt   xml_declarationsy   Obfuscate email addresses to confuse harvesters while still keeping email links usable with standards-compliant browsers.s   --cloak-email-addressess   html4css1 writerc         C   s   i  |  _  t |  _ d  S(   N(   t   partst   HTMLTranslatort   translator_class(   t   self(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   __init__   s    	(   s   htmlR	   R
   R   R   N(   t   __name__t
   __module__t	   supportedt   default_stylesheetst   ost   patht   abspatht   dirnamet   __file__t   joint   default_stylesheet_dirst   default_templatet   default_template_patht   NoneR   t   validate_comma_separated_listt   validate_booleant   splitt   validate_nonnegative_intt   settings_spect   config_sectionR,   (    (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyR      s°   	*	$






 R)   c           B   sĞ  e  Z d  Z d Z d Z d Z e e j j	 ƒ Z	 d e	 d <i dU d 6dV d 6dW d 6dX d 6Z
 d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d  „  Z e d! „ Z d" „  Z  d# „  Z! d$ „  Z" d% „  Z# d& „  Z$ d' „  Z% d( „  Z& d) „  Z' d* „  Z( d+ „  Z) d, „  Z* d- „  Z+ d. „  Z, d/ „  Z- d0 „  Z. d1 „  Z/ d2 „  Z0 d3 „  Z1 d4 „  Z2 i d5 d6 6d7 d8 6Z3 d9 „  Z4 d: „  Z5 d; „  Z6 d< „  Z7 d= „  Z8 d> „  Z9 d? „  Z: d@ „  Z; dA „  Z< dB „  Z= dC „  Z> dD „  Z? dE „  Z@ dF „  ZA dG „  ZB dH „  ZC dI „  ZD dJ „  ZE dK „  ZF dL „  ZG dM „  ZH dN „  ZI dO „  ZJ dP „  ZK dQ „  ZL dR „  ZM dS „  ZN dT „  ZO RS(Y   sH  
    The html4css1 writer has been optimized to produce visually compact
    lists (less vertical whitespace).  HTML's mixed content models
    allow list items to contain "<li><p>body elements</p></li>" or
    "<li>just text</li>" or even "<li>text<p>and body
    elements</p>combined</li>", each with different effects.  It would
    be best to stick with strict body elements in list items, but they
    affect vertical spacing in older browsers (although they really
    shouldn't).
    The html5_polyglot writer solves this using CSS2.

    Here is an outline of the optimization:

    - Check for and omit <p> tags in "simple" lists: list items
      contain either a single paragraph, a nested simple list, or a
      paragraph followed by a nested simple list.  This means that
      this list can be compact:

          - Item 1.
          - Item 2.

      But this list cannot be compact:

          - Item 1.

            This second paragraph forces space between list items.

          - Item 2.

    - In non-list contexts, omit <p> tags on a paragraph if that
      paragraph is the only child of its parent (footnotes & citations
      are allowed a label first).

    - Regardless of the above, in definitions, table cells, field bodies,
      option descriptions, and list items, mark the first child with
      'class="first"' and the last child with 'class="last"'.  The stylesheet
      sets the margins (top & bottom respectively) to 0 for these elements.

    The ``no_compact_lists`` setting (``--no-compact-lists`` command-line
    option) disables list whitespace optimization.
    sz   <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
sC   <meta http-equiv="Content-Type" content="text/html; charset=%s" />
sO   <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=%s" />
u   &nbsp;i    s   &mdash;R&   R    t   (t   )R!   R"   R#   c         C   s*   |  j  | d d ƒ |  j  | d d ƒ d  S(   Nt   firsti    t   lastiÿÿÿÿ(   t   set_class_on_child(   R+   t   node(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   set_first_lastÕ   s    c         C   s<   |  j  | d d t ƒ|  j j |  j | d d d ƒƒ d  S(   Nt   addresst   metat   pret   CLASS(   t   visit_docinfo_itemt   Falset   bodyt   appendt   starttag(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_addressÚ   s    c         C   sA   | d j  d d ƒ |  j j |  j | d ƒ ƒ |  j | ƒ d  S(   Nt   classesi    t
   admonitiont   div(   t   insertRN   RO   RP   RG   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_admonitionà   s    c         C   sH   t  | j t j ƒ r4 |  j rD |  j j d ƒ qD n |  j | d ƒ d  S(   Ns   
<br />t   author(   t
   isinstancet   parentR   t   authorst   author_in_authorsRN   RO   RL   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_authoræ   s    	c         C   s/   t  | j t j ƒ r! t |  _ n
 |  j ƒ  d  S(   N(   RX   RY   R   RZ   t   TrueR[   t   depart_docinfo_item(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_authorí   s    c         C   s   |  j  | d ƒ t |  _ d  S(   NRZ   (   RL   RM   R[   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_authorsó   s    c         C   s   |  j  ƒ  d  S(   N(   R^   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_authors÷   s    c         C   sT   d | d k pS |  j  j oS d | d k oS |  j pS |  j d g k pS |  j | ƒ S(   Nt   compactRR   t   opent   contents(   t   settingsR$   t   compact_simplet   topic_classest   check_simple_list(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   is_compactableı   s    	c      
   C   sO   |  j  j |  j | d d d d d d d ƒƒ |  j  j d ƒ |  j | ƒ d  S(	   Nt   tableRK   s   docutils citationt   framet   voidt   rulesR#   sK   <colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr>(   RN   RO   RP   t   footnote_backrefs(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_citation  s
    c         C   s   |  j  j d ƒ d  S(   Ns   </td></tr>
</tbody>
</table>
(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_citation  s    c         C   s9   |  j  j d ƒ |  j  j |  j | d d d d ƒƒ d  S(   Ns-    <span class="classifier-delimiter">:</span> t   spanR&   RK   t
   classifier(   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_classifier  s    c         C   s   d  S(   N(    (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_colspec  s    c         C   s‹   d } x |  j  D] } | | d 7} q WxS |  j  D]H } t | d d | d ƒ } |  j j |  j | d d d | ƒƒ q2 Wg  |  _  d  S(   Ni    t   colwidthg      Y@g      à?t   colt   widths   %i%%(   t   colspecst   intRN   RO   t   emptytag(   R+   Rw   RF   Ru   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   write_colspecs  s    c         C   s@   |  j  j d ƒ |  j  j |  j | d d ƒ ƒ |  j | ƒ d  S(   Ns   </dt>
t   ddR&   (   RN   RO   RP   RG   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_definition(  s    c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   Nt   dlRK   t   docutils(   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_definition_list.  s    c         C   s0   |  j  j |  j | d d ƒ ƒ |  j | ƒ d  S(   Nt   tdR&   (   RN   RO   RP   RG   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_description2  s    c         C   s   |  j  j d ƒ d  S(   Ns   </td>(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_description6  s    c      
   C   sd   |  j  j t |  j ƒ ƒ |  j j |  j | d d d d d d d ƒƒ |  j j d ƒ t |  _ d  S(	   NRj   RK   t   docinfoRk   Rl   Rm   R#   sR   <col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
(   t   contextRO   t   lenRN   RP   R]   t
   in_docinfo(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_docinfo:  s    c         C   sE   |  j  j d ƒ t |  _ |  j j ƒ  } |  j  | |  _ g  |  _  d  S(   Ns   </tbody>
</table>
(   RN   RO   RM   R‡   R…   t   popR„   (   R+   RF   t   start(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_docinfoD  s
    	c         C   sá   | r5 d | |  j  | j ƒ  ƒ f } |  j | ƒ n  |  j j |  j | d d ƒ ƒ |  j j d |  j j | ƒ t | ƒ rİ t	 | d t
 j ƒ r¬ | d d j d ƒ n  t	 | d t
 j ƒ rİ | d d j d	 ƒ qİ n  d  S(
   Ns    <meta name="%s" content="%s" />
t   trR&   s&   <th class="docinfo-name">%s:</th>
<td>i    RR   RC   iÿÿÿÿRD   (   t   attvalt   astextt   add_metaRN   RO   RP   t   languaget   labelsR†   RX   R   t   Element(   R+   RF   t   nameRI   t   meta_tag(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyRL   K  s    c         C   s   |  j  j d ƒ d  S(   Ns   </td></tr>
(   RN   RO   (   R+   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyR^   Y  s    c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   NRJ   RK   s   doctest-block(   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_doctest_block]  s    c         C   sL   t  j j j |  | ƒ t | ƒ d k r; |  j j d ƒ n  |  j | ƒ d  S(   Ni    s   &nbsp;(   R   R   R)   t   visit_entryR†   RN   RO   RG   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyR–   a  s    c         C   sÖ   i  } d | k r# | d | d <n  d | k r@ | d | d <n  |  j  } |  j j |  j  |  j f ƒ d |  _ |  j | ƒ |  _  |  j  r³ | r³ | j d d ƒ d j ƒ  | d <n  |  j j |  j	 | d |  ƒ d S(   s’   
        The 'start' attribute does not conform to HTML 4.01's strict.dtd, but
        cannot be emulated in CSS1 (HTML 5 reincludes it).
        RŠ   t   enumtypet   classR&   s    simplet   olN(
   Rf   R…   RO   t	   compact_pR:   Ri   t   gett   stripRN   RP   (   R+   RF   t   attst   old_compact_simple(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_enumerated_listh  s    		#c         C   s/   |  j  j ƒ  \ |  _ |  _ |  j j d ƒ d  S(   Ns   </ol>
(   R…   R‰   Rf   Rš   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_enumerated_list|  s    c         C   s)   |  j  j |  j | d d d d ƒƒ d  S(   NRŒ   R&   RK   t   field(   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_field  s    c         C   s   |  j  j d ƒ d  S(   Ns   </tr>
(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_field„  s    c         C   s   |  j  j |  j | d d d d ƒƒ |  j | d d ƒ | j } |  j s„ t | j t j ƒ s„ | j j	 | ƒ t
 | j ƒ d k rš |  j | d d	 ƒ n  d  S(
   NR   R&   RK   s
   field-bodyRC   i    i   RD   iÿÿÿÿ(   RN   RO   RP   RE   RY   t   compact_field_listRX   R   R„   t   indexR†   (   R+   RF   R¡   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_field_body‡  s    %		%c         C   s   |  j  j d ƒ d  S(   Ns   </td>
(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_field_body“  s    c      
   C   se  |  j  j |  j |  j f ƒ d  |  _ d | d k rA t |  _ n( |  j j ri d | d k ri t |  _ n  |  j r#x® | D]£ } | d } t | t	 j
 ƒ s¡ t ‚ g  | D] } t | t	 j ƒ s¨ | ^ q¨ } t | ƒ d k pt | ƒ d k ot | d t	 j t	 j f ƒ sy t |  _ Pqy qy Wn  |  j j |  j | d d d	 d
 d d d ƒƒ |  j j d ƒ d  S(   NRb   RR   Rc   iÿÿÿÿi    i   Rj   Rk   Rl   Rm   R#   RK   s   docutils field-listsK   <col class="field-name" />
<col class="field-body" />
<tbody valign="top">
(   R…   RO   R¤   Rš   R:   R]   Re   R%   RX   R   t
   field_bodyt   AssertionErrort	   InvisibleR†   t	   paragrapht
   line_blockRM   RN   RP   (   R+   RF   R¡   R¨   t   nt   children(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_field_list–  s.    		

	
c         C   s/   |  j  j d ƒ |  j j ƒ  \ |  _ |  _ d  S(   Ns   </tbody>
</table>
(   RN   RO   R…   R‰   R¤   Rš   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_field_list±  s    c         C   sÃ   i  } |  j  r d | d <n
 d | d <|  j j r t | j ƒ  ƒ |  j j k r d | d <|  j j d |  j | j d d d	 d
 ƒd ƒ n |  j j d ƒ |  j	 j |  j | d d |  ƒ d  S(   Ns   docinfo-nameR˜   s
   field-namei   t   colspans   </tr>
RŒ   R&   RK   R¡   s   <td>&nbsp;</td>t   th(
   R‡   Re   t   field_name_limitR†   R   R…   RO   RP   RY   RN   (   R+   RF   R   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_field_nameµ  s    	

	*c         C   s-   |  j  j d ƒ |  j  j |  j j ƒ  ƒ d  S(   Ns   :</th>(   RN   RO   R…   R‰   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_field_nameÆ  s    c      
   C   sO   |  j  j |  j | d d d d d d d ƒƒ |  j  j d ƒ |  j | ƒ d  S(	   NRj   RK   s   docutils footnoteRk   Rl   Rm   R#   sK   <colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr>(   RN   RO   RP   Rn   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_footnoteË  s
    c         C   sM  g  } | d } |  j  j rÜ | rÜ t | ƒ d k ro |  j j d ƒ |  j j d ƒ |  j j d | d ƒ qx5 t | ƒ D]' \ } } | j d | | d f ƒ q| W|  j j d d	 j | ƒ ƒ |  j d d g 7_ n% |  j j d ƒ |  j d d g 7_ t | ƒ d k rI| s1| d d
 j d ƒ n  | d d
 j d ƒ n  d  S(   Nt   backrefsi   R&   s   </a>s!   <a class="fn-backref" href="#%s">i    s'   <a class="fn-backref" href="#%s">%s</a>s   <em>(%s)</em> s   , RR   RC   iÿÿÿÿRD   (   Re   t   footnote_backlinksR†   R…   RO   t	   enumerateR6   (   R+   RF   t	   backlinksR·   t   it   backref(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyRn   Ô  s&    
	c         C   s   |  j  j d ƒ d  S(   Ns   </td></tr>
</tbody>
</table>
(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_footnoteï  s    c      	   C   s–   d | d } |  j  j } | d k r? d } |  j j d ƒ n( | d k sQ t ‚ d } |  j j d ƒ |  j j |  j | d	 | d
 d d | ƒƒ d  S(   Nt   #t   refidR   t   [t   ]R   s   <sup>s   </sup>t   aRK   s   footnote-referencet   href(   Re   t   footnote_referencesR…   RO   R©   RN   RP   (   R+   RF   RÃ   t   formatt   suffix(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_footnote_referenceô  s    c         C   s!   |  j  j |  j j ƒ  d ƒ d  S(   Ns   </a>(   RN   RO   R…   R‰   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_footnote_reference  s    c         C   s   d  S(   N(    (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_generated  s    s   image/svg+xmls   .svgs   application/x-shockwave-flashs   .swfc         C   s6   |  j  j |  j | d d |  j j ƒ  d d ƒƒ d  S(   NR   s   %s[RK   t   label(   RN   RO   RP   R…   R‰   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_label  s    (c         C   s0   |  j  j d |  j j ƒ  |  j j ƒ  f ƒ d  S(   Ns   ]%s</td><td>%s(   RN   RO   R…   R‰   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_label  s    c         C   sG   |  j  j |  j | d d ƒ ƒ t | ƒ rC | d d j d ƒ n  d  S(   Nt   liR&   i    RR   RC   (   RN   RO   RP   R†   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_list_item  s    c         C   sp  | j  d g  ƒ } d | k rj g  | D] } | d k r% | ^ q% | d <|  j j |  j | d d ƒ ƒ d  S|  j j |  j | d d d d ƒƒ | j ƒ  } xµ |  j j | ƒ D]¡ } | j ƒ  r|  j j	 | ƒ rò |  j j d |  j
 | ƒ ƒ qO|  j j |  j
 | ƒ ƒ q® | d k r-|  j j | ƒ q® |  j j d
 t | ƒ d d	 ƒ q® W|  j j d ƒ t j ‚ d  S(   NRR   t   codeR&   t   ttRK   s   docutils literals   <span class="pre">%s</span>s   
t    s   &nbsp;i   s   </tt>(   s   
RÑ   (   R›   RN   RO   RP   R   t   words_and_spacest   findallRœ   t   sollbruchstellet   searcht   encodeR†   R   t   SkipNode(   R+   RF   RR   t   clst   textt   token(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_literal   s&    )	&c         C   s&   |  j  j |  j | d d d ƒƒ d  S(   NRJ   RK   s   literal-block(   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_literal_block?  s    c         C   s   |  j  j d ƒ d  S(   Ns   
</pre>
(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_literal_blockC  s    c         C   s¦   i  } |  j  j rM t | j ƒ  ƒ |  j  j k rM d | d <|  j j d ƒ n |  j j d ƒ |  j j |  j | d d d | ƒ |  j j d ƒ |  j j d	 ƒ d  S(
   Ni   R±   s   </tr>
<tr><td>&nbsp;</td>R&   R   RK   s   option-groups   <kbd>i    (   Re   t   option_limitR†   R   R…   RO   RN   RP   (   R+   RF   R   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_option_groupG  s    
	c         C   s:   |  j  j ƒ  |  j j d ƒ |  j j |  j  j ƒ  ƒ d  S(   Ns   </kbd></td>
(   R…   R‰   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_option_groupT  s    c      
   C   sB   |  j  j |  j | d d d d d d d ƒƒ |  j  j d ƒ d  S(	   NRj   RK   s   docutils option-listRk   Rl   Rm   R#   sH   <col class="option" />
<col class="description" />
<tbody valign="top">
(   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_option_listY  s    	c         C   s   |  j  j d ƒ d  S(   Ns   </tbody>
</table>
(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_option_lista  s    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   NRŒ   R&   (   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_option_list_itemd  s    c         C   s   |  j  j d ƒ d  S(   Ns   </tr>
(   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_option_list_itemg  s    c         C   sX  t  | j t j ƒ s* t  | j t j ƒ r. t Sx^ | j ƒ  D]P \ } } | j | ƒ r; | d k oƒ | g  d g d g d d g f k r; t Sq; Wt  | j d t j ƒ } xA | j j	 | D]/ } t  | t j
 ƒ r× q¹ n  | | k rç Pn  t SWt g  | j D]' } t  | t j
 t j f ƒ sù | ^ qù ƒ } |  j sP|  j sP|  j rT| d k rTt St S(   sU   
        Determine if the <p> tags around paragraph ``node`` can be omitted.
        RR   RC   RD   i    i   (   RX   RY   R   t   documentt   compoundRM   t   attlistt   is_not_defaultRÊ   R®   Rª   R†   Rf   R¤   Rš   R]   (   R+   RF   t   keyt   valueRC   t   childR­   t   parent_length(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   should_be_compact_paragraphl  s,    "'		c         C   sU   |  j  | ƒ r" |  j j d ƒ n/ |  j j |  j | d d ƒ ƒ |  j j d ƒ d  S(   NR&   t   ps   </p>
(   Rí   R…   RO   RN   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_paragraphŠ  s    c         C   s   |  j  j |  j j ƒ  ƒ d  S(   N(   RN   RO   R…   R‰   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_paragraph‘  s    c         C   s<   |  j  j |  j | d d d ƒƒ |  j | ƒ t |  _ d  S(   NRT   RK   t   sidebar(   RN   RO   RP   RG   R]   t
   in_sidebar(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_sidebar•  s    	c         C   s`   t  | j t j ƒ r= |  j j |  j | d d d d ƒƒ n |  j j |  j | d d ƒ ƒ d  S(   NRq   R&   RK   t	   subscriptt   sub(   RX   RY   R   t   literal_blockRN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_subscriptœ  s    c         C   s<   t  | j t j ƒ r( |  j j d ƒ n |  j j d ƒ d  S(   Ns   </span>s   </sub>(   RX   RY   R   Rö   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_subscript£  s    c         C   s2  t  | j t j ƒ rM |  j j |  j | d d d d ƒƒ |  j j d ƒ ná t  | j t j ƒ r¬ |  j j |  j | d d d d ƒƒ |  j j d ƒ t	 |  j ƒ |  _
 n‚ t  | j t j ƒ r.d	 |  j |  j d
 } |  j j |  j | | d d d ƒ|  j i  d d d d ƒƒ |  j j d | ƒ n  d  S(   NRî   R&   RK   s   sidebar-subtitles   </p>
t   h2t   subtitles   </h2>
s   h%si   s   section-subtitleRq   s   </span></%s>
(   RX   RY   R   Rñ   RN   RO   RP   R…   Rå   R†   t   in_document_titlet   sectiont   section_levelt   initial_header_level(   R+   RF   t   tag(    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_subtitleª  s    
%	c         C   su   |  j  j |  j j ƒ  ƒ |  j rq |  j  |  j d !|  _ d |  _ |  j j |  j  ƒ |  j j |  j  ƒ |  j  2n  d  S(   Niÿÿÿÿi    (	   RN   RO   R…   R‰   Rû   Rú   t   body_pre_docinfot   extendt   html_subtitle(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_subtitleº  s    		c         C   s`   t  | j t j ƒ r= |  j j |  j | d d d d ƒƒ n |  j j |  j | d d ƒ ƒ d  S(   NRq   R&   RK   R   t   sup(   RX   RY   R   Rö   RN   RO   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_superscriptÄ  s    c         C   s<   t  | j t j ƒ r( |  j j d ƒ n |  j j d ƒ d  S(   Ns   </span>s   </sup>(   RX   RY   R   Rö   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_superscriptË  s    c         C   s+  |  j  j |  j | d d d ƒƒ |  j  j d ƒ d } t | d ƒ rÉ | d } t | ƒ d k ru d | d	 } qÉ d } g  } x/ | D]' } | j d
 | | f ƒ | d 7} qˆ Wd d j | ƒ } n  | j d ƒ ré d | d } n d } |  j  j d | d | d |  j | d ƒ | | f ƒ d  S(   NRT   RK   s   system-messages    <p class="system-message-title">R&   R·   i   s%   ; <em><a href="#%s">backlink</a></em>i    s   <a href="#%s">%s</a>s   ; <em>backlinks: %s</em>s   , t   lines	   , line %ss=   System Message: %s/%s (<tt class="docutils">%s</tt>%s)%s</p>
t   typet   levelt   source(   RN   RO   RP   R†   R6   t   hasattrRÖ   (   R+   RF   t   backref_textR·   R»   Rº   R¼   R  (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_system_messageÒ  s*    "
c         C   s‡   |  j  j |  j ƒ t |  _ d |  j j g } d | k rR | j d | d ƒ n  |  j j |  j | d d d j | ƒ d d ƒƒ d  S(	   NR   t   aligns   align-%sRj   RK   RÑ   t   borderR   (	   R…   RO   Rš   R]   Re   t   table_styleRN   RP   R6   (   R+   RF   RR   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_tableí  s    		c         C   s&   |  j  j ƒ  |  _ |  j j d ƒ d  S(   Ns	   </table>
(   R…   R‰   Rš   RN   RO   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   depart_tableö  s    c         C   sI   |  j  ƒ  |  j j |  j j ƒ  ƒ |  j j |  j | d d d ƒƒ d  S(   Nt   tbodyt   valignt   top(   R{   RN   RO   R…   R‰   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_tbodyû  s    
c         C   s9   |  j  j |  j | d ƒ ƒ |  j j d ƒ g  | _ d  S(   Nt   colgroups   </colgroup>
(   RN   RO   RP   R…   t   stubs(   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_tgroup  s    c         C   sY   |  j  ƒ  |  j j |  j j ƒ  ƒ |  j j d ƒ |  j j |  j | d d d ƒƒ d  S(   NR&   t   theadR  t   bottom(   R{   RN   RO   R…   R‰   RP   (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   visit_thead  s    
(   s   &mdash;R&   (   RA   RB   (   RA   RB   (   R&   R&   (P   R-   R.   t   __doc__t   doctypet   content_typet   content_type_mathmlt   dictR   R)   t   special_characterst   attribution_formatsRG   RQ   RV   R\   R_   R`   Ra   Ri   Ro   Rp   Rs   Rt   R{   R}   R€   R‚   Rƒ   Rˆ   R‹   R]   RL   R^   R•   R–   RŸ   R    R¢   R£   R¦   R§   R¯   R°   R´   Rµ   R¶   Rn   R½   RÇ   RÈ   RÉ   t   object_image_typesRË   RÌ   RÎ   RÛ   RÜ   Rİ   Rß   Rà   Rá   Râ   Rã   Rä   Rí   Rï   Rğ   Ró   R÷   Rø   R   R  R  R  R  R  R  R  R  R  (    (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyR)   “   s   )


								
											
																					

																				
								t   SimpleListCheckerc           B   s2   e  Z d  Z d „  Z d „  Z d „  Z d „  Z RS(   sİ   
    Raise `nodes.NodeFound` if non-simple list item is encountered.

    Here "simple" means a list item containing nothing other than a single
    paragraph, a simple list, or a paragraph followed by a simple list.
    c         C   s´   g  } x3 | j  D]( } t | t j ƒ s | j | ƒ q q W| r‘ t | d t j ƒ r‘ t | d t j ƒ s„ t | d t j ƒ r‘ | j ƒ  n  t	 | ƒ d k r§ d  St j
 ‚ d  S(   Ni    iÿÿÿÿi   (   R®   RX   R   Rª   RO   R«   t   bullet_listt   enumerated_listR‰   R†   t	   NodeFound(   R+   RF   R®   Rë   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyRÎ     s    c         C   s   t  j ‚ d  S(   N(   R   R)  (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyR€   0  s    c         C   s   t  j ‚ d  S(   N(   R   R)  (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyRˆ   3  s    c         C   s   t  j ‚ d  S(   N(   R   R)  (   R+   RF   (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyR€   6  s    (   R-   R.   R  RÎ   R€   Rˆ   (    (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyR&    s
   			(   R  t   __docformat__t   os.pathR1   R   R   R   R   R   t   docutils.transformsR   t   docutils.writersR   R   R)   R&  (    (    (    sE   /tmp/pip-build-awuatQ/docutils/docutils/writers/html4css1/__init__.pyt   <module>   s   "|ÿ ÿ                                                                                                                                                                                                                                                                                                                                                                                                                                            usr/local/lib/python2.7/dist-packages/docutils/writers/html4css1/html4css1.css                      0100644 0000000 0000062 00000016052 13077704374 025740  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        /*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      usr/local/lib/python2.7/dist-packages/docutils/writers/html4css1/template.txt                       0100644 0000000 0000062 00000000162 13077704374 025753  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        %(head_prefix)s
%(head)s
%(stylesheet)s
%(body_prefix)s
%(body_pre_docinfo)s
%(docinfo)s
%(body)s
%(body_suffix)s
                                                                                                                                                                                                                                                                                                                                                                                                              usr/local/lib/python2.7/dist-packages/docutils/writers/html5_polyglot/                              0042755 0000000 0000062 00000000000 13077704402 024535  5                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        usr/local/lib/python2.7/dist-packages/docutils/writers/html5_polyglot/__init__.py                   0100644 0000000 0000062 00000020447 13077704374 026660  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # .. coding: utf8
# :Author: GÃ¼nter Milde <milde@users.sf.net>
#          Based on the html4css1 writer by David Goodger.
# :Maintainer: docutils-develop@lists.sourceforge.net
# :Revision: $Revision: 7977 $
# :Date: $Date: 2005-06-28$
# :Copyright: Â© 2005, 2009, 2015 GÃ¼nter Milde,
#             portions from html4css1 Â© David Goodger.
# :License: Released under the terms of the `2-Clause BSD license`_, in short:
#
#    Copying and distribution of this file, with or without modification,
#    are permitted in any medium without royalty provided the copyright
#    notice and this notice are preserved.
#    This file is offered as-is, without any warranty.
#
# .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause

# Use "best practice" as recommended by the W3C:
# http://www.w3.org/2009/cheatsheet/

"""
Plain HyperText Markup Language document tree Writer.

The output conforms to the `HTML 5` specification.

The cascading style sheet "minimal.css" is required for proper viewing,
the style sheet "plain.css" improves reading experience.
"""
__docformat__ = 'reStructuredText'

import os.path
import docutils
from docutils import frontend, nodes, writers, io
from docutils.transforms import writer_aux
from docutils.writers import _html_base

class Writer(writers._html_base.Writer):

    supported = ('html', 'html5', 'html4', 'xhtml', 'xhtml10')
    """Formats this writer supports."""

    default_stylesheets = ['minimal.css','plain.css']
    default_stylesheet_dirs = ['.', os.path.abspath(os.path.dirname(__file__))]

    default_template = 'template.txt'
    default_template_path = os.path.join(
        os.path.dirname(os.path.abspath(__file__)), default_template)

    settings_spec = (
        'HTML-Specific Options',
        None,
        (('Specify the template file (UTF-8 encoded).  Default is "%s".'
          % default_template_path,
          ['--template'],
          {'default': default_template_path, 'metavar': '<file>'}),
         ('Comma separated list of stylesheet URLs. '
          'Overrides previous --stylesheet and --stylesheet-path settings.',
          ['--stylesheet'],
          {'metavar': '<URL[,URL,...]>', 'overrides': 'stylesheet_path',
           'validator': frontend.validate_comma_separated_list}),
         ('Comma separated list of stylesheet paths. '
          'Relative paths are expanded if a matching file is found in '
          'the --stylesheet-dirs. With --link-stylesheet, '
          'the path is rewritten relative to the output HTML file. '
          'Default: "%s"' % ','.join(default_stylesheets),
          ['--stylesheet-path'],
          {'metavar': '<file[,file,...]>', 'overrides': 'stylesheet',
           'validator': frontend.validate_comma_separated_list,
           'default': default_stylesheets}),
         ('Embed the stylesheet(s) in the output HTML file.  The stylesheet '
          'files must be accessible during processing. This is the default.',
          ['--embed-stylesheet'],
          {'default': 1, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Link to the stylesheet(s) in the output HTML file. '
          'Default: embed stylesheets.',
          ['--link-stylesheet'],
          {'dest': 'embed_stylesheet', 'action': 'store_false'}),
         ('Comma-separated list of directories where stylesheets are found. '
          'Used by --stylesheet-path when expanding relative path arguments. '
          'Default: "%s"' % default_stylesheet_dirs,
          ['--stylesheet-dirs'],
          {'metavar': '<dir[,dir,...]>',
           'validator': frontend.validate_comma_separated_list,
           'default': default_stylesheet_dirs}),
         ('Specify the initial header level.  Default is 1 for "<h1>".  '
          'Does not affect document title & subtitle (see --no-doc-title).',
          ['--initial-header-level'],
          {'choices': '1 2 3 4 5 6'.split(), 'default': '1',
           'metavar': '<level>'}),
         ('Format for footnote references: one of "superscript" or '
          '"brackets".  Default is "brackets".',
          ['--footnote-references'],
          {'choices': ['superscript', 'brackets'], 'default': 'brackets',
           'metavar': '<format>',
           'overrides': 'trim_footnote_reference_space'}),
         ('Format for block quote attributions: one of "dash" (em-dash '
          'prefix), "parentheses"/"parens", or "none".  Default is "dash".',
          ['--attribution'],
          {'choices': ['dash', 'parentheses', 'parens', 'none'],
           'default': 'dash', 'metavar': '<format>'}),
         ('Remove extra vertical whitespace between items of "simple" bullet '
          'lists and enumerated lists.  Default: enabled.',
          ['--compact-lists'],
          {'default': True, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Disable compact simple bullet and enumerated lists.',
          ['--no-compact-lists'],
          {'dest': 'compact_lists', 'action': 'store_false'}),
         ('Remove extra vertical whitespace between items of simple field '
          'lists.  Default: enabled.',
          ['--compact-field-lists'],
          {'default': True, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Disable compact simple field lists.',
          ['--no-compact-field-lists'],
          {'dest': 'compact_field_lists', 'action': 'store_false'}),
         ('Added to standard table classes. '
          'Defined styles: borderless, booktabs, '
          'align-left, align-center, align-right, colwidths-auto. '
          'Default: ""',
          ['--table-style'],
          {'default': ''}),
         ('Math output format (one of "MathML", "HTML", "MathJax", '
          'or "LaTeX") and option(s). '
          'Default: "HTML math.css"',
          ['--math-output'],
          {'default': 'HTML math.css'}),
         ('Prepend an XML declaration. (Thwarts HTML5 conformance.) '
          'Default: False',
          ['--xml-declaration'],
          {'default': False, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Omit the XML declaration.',
          ['--no-xml-declaration'],
          {'dest': 'xml_declaration', 'action': 'store_false'}),
         ('Obfuscate email addresses to confuse harvesters while still '
          'keeping email links usable with standards-compliant browsers.',
          ['--cloak-email-addresses'],
          {'action': 'store_true', 'validator': frontend.validate_boolean}),))

    config_section = 'html-plain writer'

    def __init__(self):
        self.parts = {}
        self.translator_class = HTMLTranslator


class HTMLTranslator(writers._html_base.HTMLTranslator):
    """
    This writer generates `polyglot markup`: HTML 5 that is also valid XML.
    """
    # def __init__(self, document):
    #     writers._html_base.HTMLTranslator.__init__(self, document)


    # <acronym> tag not supported in HTML5. Use the <abbr> tag instead.
    def visit_acronym(self, node):
        # @@@ implementation incomplete ("title" attribute)
        self.body.append(self.starttag(node, 'abbr', ''))

    def depart_acronym(self, node):
        self.body.append('</abbr>')

    # no meta tag in HTML 5
    def visit_authors(self, node):
        self.visit_docinfo_item(node, 'authors', meta=False)

    def visit_copyright(self, node):
        self.visit_docinfo_item(node, 'copyright', meta=False)

    # no meta tag in HTML 5
    def visit_date(self, node):
        self.visit_docinfo_item(node, 'date', meta=False)

    # TODO: use HTML 5 <footer> element?
    # def visit_footer(self, node):
    # def depart_footer(self, node):

    # TODO: use the new HTML5 element <aside>? (Also for footnote text)
    # def visit_footnote(self, node):

    # Meta tags: 'lang' attribute replaced by 'xml:lang' in XHTML 1.1
    # HTML5/polyglot recommends using both
    def visit_meta(self, node):
        if node.hasattr('lang'):
            node['xml:lang'] = node['lang']
            # del(node['lang'])
        meta = self.emptytag(node, 'meta', **node.non_default_attributes())
        self.add_meta(meta)

    # no meta tag in HTML 5
    def visit_organization(self, node):
        self.visit_docinfo_item(node, 'organization', meta=False)

    # TODO: use the new HTML 5 element <section>?
    # def visit_section(self, node):

    # TODO: use the new HTML5 element <aside>?
    # def visit_topic(self, node):
                                                                                                                                                                                                                         usr/local/lib/python2.7/dist-packages/docutils/writers/html5_polyglot/__init__.pyc                  0100644 0000000 0000062 00000016660 13077704402 027015  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        ó
üˆÿXc           @   s¢   d  Z  d Z d d l Z d d l Z d d l m Z m Z m Z m Z d d l	 m
 Z
 d d l m Z d e j j f d „  ƒ  YZ d	 e j j f d
 „  ƒ  YZ d S(   sí   
Plain HyperText Markup Language document tree Writer.

The output conforms to the `HTML 5` specification.

The cascading style sheet "minimal.css" is required for proper viewing,
the style sheet "plain.css" improves reading experience.
t   reStructuredTextiÿÿÿÿN(   t   frontendt   nodest   writerst   io(   t
   writer_aux(   t
   _html_baset   Writerc           B   s$  e  Z dR Z d d g Z d e j j e j j e ƒ ƒ g Z	 d Z
 e j j e j j e j j e ƒ ƒ e
 ƒ Z d	 dS d
 e d g i e d 6d d 6f d d g i d d 6d d 6e j d 6f d d j e ƒ d g i d d 6d d 6e j d 6e d 6f d d g i d d 6d d 6e j d 6f d d  g i d! d" 6d# d 6f d$ e	 d% g i d& d 6e j d 6e	 d 6f d' d( g i d) j ƒ  d* 6d+ d 6d, d 6f d- d. g i d/ d0 g d* 6d0 d 6d1 d 6d2 d 6f d3 d4 g i d5 d6 d7 d8 g d* 6d5 d 6d1 d 6f d9 d: g i e d 6d d 6e j d 6f d; d< g i d= d" 6d# d 6f d> d? g i e d 6d d 6e j d 6f d@ dA g i dB d" 6d# d 6f dC dD g i dE d 6f dF dG g i dH d 6f dI dJ g i e d 6d d 6e j d 6f dK dL g i dM d" 6d# d 6f dN dO g i d d 6e j d 6f f f Z dP Z dQ „  Z RS(T   t   htmlt   html5t   html4t   xhtmlt   xhtml10s   minimal.csss	   plain.csst   .s   template.txts   HTML-Specific Optionss<   Specify the template file (UTF-8 encoded).  Default is "%s".s
   --templatet   defaults   <file>t   metavarsh   Comma separated list of stylesheet URLs. Overrides previous --stylesheet and --stylesheet-path settings.s   --stylesheets   <URL[,URL,...]>t   stylesheet_patht	   overridest	   validatorsÙ   Comma separated list of stylesheet paths. Relative paths are expanded if a matching file is found in the --stylesheet-dirs. With --link-stylesheet, the path is rewritten relative to the output HTML file. Default: "%s"t   ,s   --stylesheet-paths   <file[,file,...]>t
   stylesheets   Embed the stylesheet(s) in the output HTML file.  The stylesheet files must be accessible during processing. This is the default.s   --embed-stylesheeti   t
   store_truet   actionsN   Link to the stylesheet(s) in the output HTML file. Default: embed stylesheets.s   --link-stylesheett   embed_stylesheett   destt   store_falses   Comma-separated list of directories where stylesheets are found. Used by --stylesheet-path when expanding relative path arguments. Default: "%s"s   --stylesheet-dirss   <dir[,dir,...]>s|   Specify the initial header level.  Default is 1 for "<h1>".  Does not affect document title & subtitle (see --no-doc-title).s   --initial-header-levels   1 2 3 4 5 6t   choicest   1s   <level>s[   Format for footnote references: one of "superscript" or "brackets".  Default is "brackets".s   --footnote-referencest   superscriptt   bracketss   <format>t   trim_footnote_reference_spaces{   Format for block quote attributions: one of "dash" (em-dash prefix), "parentheses"/"parens", or "none".  Default is "dash".s   --attributiont   dasht   parenthesest   parenst   nonesp   Remove extra vertical whitespace between items of "simple" bullet lists and enumerated lists.  Default: enabled.s   --compact-listss3   Disable compact simple bullet and enumerated lists.s   --no-compact-listst   compact_listssX   Remove extra vertical whitespace between items of simple field lists.  Default: enabled.s   --compact-field-listss#   Disable compact simple field lists.s   --no-compact-field-listst   compact_field_listss‰   Added to standard table classes. Defined styles: borderless, booktabs, align-left, align-center, align-right, colwidths-auto. Default: ""s   --table-stylet    sk   Math output format (one of "MathML", "HTML", "MathJax", or "LaTeX") and option(s). Default: "HTML math.css"s   --math-outputs   HTML math.csssG   Prepend an XML declaration. (Thwarts HTML5 conformance.) Default: Falses   --xml-declarations   Omit the XML declaration.s   --no-xml-declarationt   xml_declarationsy   Obfuscate email addresses to confuse harvesters while still keeping email links usable with standards-compliant browsers.s   --cloak-email-addressess   html-plain writerc         C   s   i  |  _  t |  _ d  S(   N(   t   partst   HTMLTranslatort   translator_class(   t   self(    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt   __init__   s    	(   s   htmlR	   R
   R   R   N(   t   __name__t
   __module__t	   supportedt   default_stylesheetst   ost   patht   abspatht   dirnamet   __file__t   default_stylesheet_dirst   default_templatet   joint   default_template_patht   NoneR   t   validate_comma_separated_listt   validate_booleant   splitt   Truet   Falset   settings_spect   config_sectionR+   (    (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyR   %   s    $	$






 R(   c           B   sM   e  Z d  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z d „  Z	 RS(   sQ   
    This writer generates `polyglot markup`: HTML 5 that is also valid XML.
    c         C   s#   |  j  j |  j | d d ƒ ƒ d  S(   Nt   abbrR%   (   t   bodyt   appendt   starttag(   R*   t   node(    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt   visit_acronym   s    c         C   s   |  j  j d ƒ d  S(   Ns   </abbr>(   RB   RC   (   R*   RE   (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt   depart_acronym¢   s    c         C   s   |  j  | d d t ƒd  S(   Nt   authorst   meta(   t   visit_docinfo_itemR>   (   R*   RE   (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt   visit_authors¦   s    c         C   s   |  j  | d d t ƒd  S(   Nt	   copyrightRI   (   RJ   R>   (   R*   RE   (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt   visit_copyright©   s    c         C   s   |  j  | d d t ƒd  S(   Nt   dateRI   (   RJ   R>   (   R*   RE   (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt
   visit_date­   s    c         C   sL   | j  d ƒ r  | d | d <n  |  j | d | j ƒ   } |  j | ƒ d  S(   Nt   langs   xml:langRI   (   t   hasattrt   emptytagt   non_default_attributest   add_meta(   R*   RE   RI   (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt
   visit_meta¹   s    c         C   s   |  j  | d d t ƒd  S(   Nt   organizationRI   (   RJ   R>   (   R*   RE   (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt   visit_organizationÁ   s    (
   R,   R-   t   __doc__RF   RG   RK   RM   RO   RU   RW   (    (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyR(   •   s   						(   RX   t   __docformat__t   os.pathR0   t   docutilsR   R   R   R   t   docutils.transformsR   t   docutils.writersR   R   R(   (    (    (    sJ   /tmp/pip-build-awuatQ/docutils/docutils/writers/html5_polyglot/__init__.pyt   <module>   s   "p                                                                                usr/local/lib/python2.7/dist-packages/docutils/writers/html5_polyglot/math.css                      0100644 0000000 0000062 00000011257 13077704374 026211  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        /*
*   math2html: convert LaTeX equations to HTML output.
*
*   Copyright (C) 2009,2010 Alex FernÃ¡ndez
*
*   Released under the terms of the `2-Clause BSD license'_, in short:
*   Copying and distribution of this file, with or without modification,
*   are permitted in any medium without royalty provided the copyright
*   notice and this notice are preserved.
*   This file is offered as-is, without any warranty.
*
* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
*
*   Based on eLyXer: convert LyX source files to HTML output.
*   http://elyxer.nongnu.org/
*/
/* --end--
* CSS file for LaTeX formulas.
*/

/* Formulas */
.formula {
	text-align: center;
	font-family: "Droid Serif", "DejaVu Serif", "STIX", serif;
	margin: 1.2em 0;
}
span.formula {
	white-space: nowrap;
}
div.formula {
	padding: 0.5ex;
	margin-left: auto;
	margin-right: auto;
}

/* Basic features */
a.eqnumber {
	display: inline-block;
	float: right;
	clear: right;
	font-weight: bold;
}
span.unknown {
	color: #800000;
}
span.ignored, span.arraydef {
	display: none;
}
.formula i {
	letter-spacing: 0.1ex;
}

/* Alignment */
.align-left, .align-l {
	text-align: left;
}
.align-right, .align-r {
	text-align: right;
}
.align-center, .align-c {
	text-align: center;
}

/* Structures */
span.overline, span.bar {
	text-decoration: overline;
}
.fraction, .fullfraction {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
}
.fraction .fraction {
	font-size: 80%;
	line-height: 100%;
}
span.numerator {
	display: block;
}
span.denominator {
	display: block;
	padding: 0ex;
	border-top: thin solid;
}
sup.numerator, sup.unit {
	font-size: 70%;
	vertical-align: 80%;
}
sub.denominator, sub.unit {
	font-size: 70%;
	vertical-align: -20%;
}
span.sqrt {
	display: inline-block;
	vertical-align: middle;
	padding: 0.1ex;
}
sup.root {
	font-size: 70%;
	position: relative;
	left: 1.4ex;
}
span.radical {
	display: inline-block;
	padding: 0ex;
	font-size: 150%;
	vertical-align: top;
}
span.root {
	display: inline-block;
	border-top: thin solid;
	padding: 0ex;
	vertical-align: middle;
}
span.symbol {
	line-height: 125%;
	font-size: 125%;
}
span.bigsymbol {
	line-height: 150%;
	font-size: 150%;
}
span.largesymbol {
	font-size: 175%;
}
span.hugesymbol {
	font-size: 200%;
}
span.scripts {
	display: inline-table;
	vertical-align: middle;
}
.script {
	display: table-row;
	text-align: left;
	line-height: 150%;
}
span.limits {
	display: inline-table;
	vertical-align: middle;
}
.limit {
	display: table-row;
	line-height: 99%;
}
sup.limit, sub.limit {
	line-height: 100%;
}
span.symbolover {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 100%;
	bottom: 0.5em;
	width: 0px;
}
span.withsymbol {
	display: inline-block;
}
span.symbolunder {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 80%;
	top: 0.3em;
	width: 0px;
}

/* Environments */
span.array, span.bracketcases, span.binomial, span.environment {
	display: inline-table;
	text-align: center;
	border-collapse: collapse;
	margin: 0em;
	vertical-align: middle;
}
span.arrayrow, span.binomrow {
	display: table-row;
	padding: 0ex;
	border: 0ex;
}
span.arraycell, span.bracket, span.case, span.binomcell, span.environmentcell {
	display: table-cell;
	padding: 0ex 0.2ex;
	line-height: 99%;
	border: 0ex;
}
/*
* CSS file for LaTeX formulas, extra stuff:
* binomials, vertical braces, stackrel, fonts and colors.
*/

/* Inline binomials */
span.binom {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
	font-size: 80%;
}
span.binomstack {
	display: block;
	padding: 0em;
}

/* Over- and underbraces */
span.overbrace {
	border-top: 2pt solid;
}
span.underbrace {
	border-bottom: 2pt solid;
}

/* Stackrel */
span.stackrel {
	display: inline-block;
	text-align: center;
}
span.upstackrel {
	display: block;
	padding: 0em;
	font-size: 80%;
	line-height: 64%;
	position: relative;
	top: 0.15em;

}
span.downstackrel {
	display: block;
	vertical-align: bottom;
	padding: 0em;
}

/* Fonts */
span.mathsf, span.textsf {
	font-style: normal;
	font-family: sans-serif;
}
span.mathrm, span.textrm {
	font-style: normal;
	font-family: serif;
}
span.text, span.textnormal {
	font-style: normal;
}
span.textipa {
	color: #008080;
}
span.fraktur {
	font-family: "Lucida Blackletter", eufm10, blackletter;
}
span.blackboard {
	font-family: Blackboard, msbm10, serif;
}
span.scriptfont {
	font-family: "Monotype Corsiva", "Apple Chancery", "URW Chancery L", cursive;
	font-style: italic;
}

/* Colors */
span.colorbox {
	display: inline-block;
	padding: 5px;
}
span.fbox {
	display: inline-block;
	border: thin solid black;
	padding: 2px;
}
span.boxed, span.framebox {
	display: inline-block;
	border: thin solid black;
	padding: 5px;
}

                                                                                                                                                                                                                                                                                                                                                 usr/local/lib/python2.7/dist-packages/docutils/writers/html5_polyglot/minimal.css                   0100644 0000000 0000062 00000015236 13077704374 026707  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        /* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: GÃ¼nter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 7952 2016-07-26 18:15:59Z milde $               */
/* :Copyright: Â© 2015 GÃ¼nter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS2.1_ stylesheet defines rules for Docutils elements without    */
/* HTML equivalent. It is required to make the document semantic visible. */
/*                                                                        */
/* .. _CSS2.1: http://www.w3.org/TR/CSS2                                  */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link       */

/* alignment of text and inline objects inside block objects*/
.align-left   { text-align: left; }
.align-right  { text-align: right; }
.align-center { clear: both; text-align: center; }
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* titles */
h1.title, p.subtitle {
  text-align: center;
}
p.admonition-title,
p.topic-title,
p.sidebar-title,
p.rubric,
p.system-message-title {
  font-weight: bold;
}
h1 + p.subtitle,
h1 + p.section-subtitle {
  font-size: 1.6em;
}
h2 + p.section-subtitle { font-size: 1.28em; }
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
p.sidebar-title,
p.rubric {
  font-size: larger;
}
p.rubric { color: maroon; }
a.toc-backref {
  color: black;
  text-decoration: none; }

/* Warnings, Errors */
div.caution p.admonition-title,
div.attention p.admonition-title,
div.danger p.admonition-title,
div.error p.admonition-title,
div.warning p.admonition-title,
div.system-messages h1,
div.error,
span.problematic,
p.system-message-title {
  color: red;
}

/* inline literals */
span.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wraph at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .compact li,
.simple  ul, .compact ul,
.simple  ol, .compact ol,
.simple > li p, .compact > li p,
dl.simple > dd, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}

/* Table of Contents */
div.topic.contents { margin: 0; }
ul.auto-toc {
  list-style-type: none;
  padding-left: 1.5em; }

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

dt span.classifier { font-style: italic }
dt span.classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}

/* Field Lists and drivatives */
/* bold field name, content starts on the same line */
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt,
dl.footnote > dt,
dl.citation > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples */
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}
/* field names followed by a colon */
dl.field-list > dt:after,
dl.docinfo > dt:after {
  content: ":";
}

/* Bibliographic Fields (docinfo) */
pre.address { font: inherit; }
dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list { margin-left: 40px; }
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */
dl.footnote.superscript > dd {margin-left: 1em; }
dl.footnote.brackets > dd {margin-left: 2em; }
dl > dt.label { font-weight: normal; }
a.footnote-reference.brackets:before,
dt.label > span.brackets:before { content: "["; }
a.footnote-reference.brackets:after,
dt.label > span.brackets:after { content: "]"; }
a.footnote-reference.superscript,
dl.footnote.superscript > dt.label {
  vertical-align: super;
  font-size: smaller;
}
dt.label > span.fn-backref { margin-left: 0.2em; }
dt.label > span.fn-backref > a { font-style: italic; }

/* Line Blocks */
div.line-block { display: block; }
div.line-block div.line-block {
  margin-top: 0;
  margin-bottom: 0;
  margin-left: 40px;
}

/* Figures, Images, and Tables */
.figure.align-left,
img.align-left,
object.align-left,
table.align-left {
  margin-right: auto;
}
.figure.align-center,
img.align-center,
object.align-center {
  margin-left: auto;
  margin-right: auto;
  display: block;
}
table.align-center {
  margin-left: auto;
  margin-right: auto;
}
.figure.align-right,
img.align-right,
object.align-right,
table.align-right {
  margin-left: auto;
}
/* reset inner alignment in figures and tables */
div.align-left, div.align-center, div.align-right,
table.align-left, table.align-center, table.align-right
{ text-align: inherit }

/* Admonitions and System Messages */
div.admonition,
div.system-message,
div.sidebar{
  margin: 40px;
  border: medium outset;
  padding-right: 1em;
  padding-left: 1em;
}

/* Sidebar */
div.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
}

/* Text Blocks */
div.topic,
pre.literal-block,
pre.doctest-block,
pre.math,
pre.code {
  margin-right: 40px;
  margin-left: 40px;
}
pre.code .ln { color: gray; } /* line numbers */

/* Tables */
table { border-collapse: collapse; }
td, th {
  border-style: solid;
  border-color: silver;
  padding: 0 1ex;
  border-width: thin;
}
td > p:first-child, th > p:first-child { margin-top: 0; }
td > p, th > p { margin-bottom: 0; }

table > caption {
  text-align: left;
  margin-bottom: 0.25em
}

table.borderless td, table.borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}
                                                                                                                                                                                                                                                                                                                                                                  usr/local/lib/python2.7/dist-packages/docutils/writers/html5_polyglot/plain.css                     0100644 0000000 0000062 00000015742 13077704374 026366  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        /* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.		   */
/*                                                                         */
/* :Author: GÃ¼nter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 7952 2016-07-26 18:15:59Z milde $               */
/* :Copyright: Â© 2015 GÃ¼nter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*    	     	      	     	 					   */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: http://www.w3.org/TR/CSS3		        		   */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  padding: 0 5%;
  margin: 8px 0;
}
div.document {
  line-height:1.3;
  counter-reset: table;
  /* counter-reset: figure; */
  /* avoid long lines --> better reading */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50em;
  margin: auto;
}

/* Sections */

/* Transitions */

hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs               */
/* ==========               */

/* vertical space (parskip) */
p, ol, ul, dl,
div.line-block,
table{
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
h1, h2, h3, h4, h5, h6,
dl > dd {
  margin-bottom: 0.5em;
}

/* Lists                    */
/* ==========               */

/* Definition Lists         */

dl > dd p:first-child { margin-top: 0; }
/* :last-child is not part of CSSÂ 2.1 (introduced in CSSÂ 3) */
/* dl > dd p:last-child  { margin-bottom: 0; } */

/* lists nested in definition lists */
/* :only-child is not part of CSSÂ 2.1 (introduced in CSSÂ 3) */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}

/* Field Lists */

/* example for custom field-name width */
dl.field-list.narrow > dd {
  margin-left: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use special definition list dl.docinfo */
/* but dedication and abstract are placed into "topic" divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* Citations */
dl.citation dt.label {
  font-weight: bold;
}
span.fn-backref {
  font-weight: normal;
}

/* Text Blocks           */
/* ============          */

/* Literal Blocks           */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  margin-left: 1.5em;
  margin-right: 1.5em
}

/* Block Quotes             */

blockquote,
div.topic {
  margin-left: 1.5em;
  margin-right: 1.5em
}
blockquote > table,
div.topic > table {
  margin-top: 0;
  margin-bottom: 0;
}
blockquote p.attribution,
div.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables                   */
/* ======                   */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks   */
/* ======================   */

/* Footnotes and Citations  */
/* -----------------------  */

/* line on the left */
dl.footnote {
  padding-left: 1ex;
  border-left: solid;
  border-left-width: thin;
}

/* Directives               */
/* ----------               */

/* Body Elements            */
/* ~~~~~~~~~~~~~            */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
.figure.align-left,
img.align-left,
object.align-left {
  display: block;
  clear: left;
  float: left;
  margin-right: 1em
}
.figure.align-right,
img.align-right,
object.align-right {
  display: block;
  clear: right;
  float: right;
  margin-left: 1em
}
/* Stop floating sidebars, images and figures at section level 1,2,3 */
h1, h2, h3 { clear: both; }

/* Sidebar */

/* Move into the margin. In a layout with fixed margins, */
/* it can be moved into the margin completely.		 */
div.sidebar {
  width: 30%;
  max-width: 26em;
  margin-left: 1em;
  margin-right: -5.5%;
  background-color: #ffffee ;
}

/* Code                     */

pre.code, code { background-color: #eeeeee }
pre.code .ln { color: gray; } /* line numbers */
/* basic highlighting: for a complete scheme, see */
/* http://docutils.sourceforge.net/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math                     */
/* styled separately (see math.css for math-output=HTML) */

/* Epigraph                 */
/* Highlights               */
/* Pull-Quote               */
/* Compound Paragraph       */
/* Container                */

/* can be styled in a custom stylesheet */

/* Document Header and Footer */

div.footer, div.header {
  clear: both;
  font-size: smaller;
}

/* Inline Markup            */
/* =============            */

/* Emphasis                 */
/*   em                     */
/* Strong Emphasis          */
/*   strong		    */
/* Interpreted Text         */
/*   span.interpreted  	    */
/* Title Reference 	    */
/*   cite		    */
/* Inline Literals          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal {Â white-space: pre-wrap; } */

/* Hyperlink References     */
a { text-decoration: none; }

/* External Targets         */
/*   span.target.external   */
/* Internal Targets  	    */
/*   span.target.internal   */
/* Footnote References      */
/*   a.footnote-reference   */
/* Citation References      */
/*   a.citation-reference   */
                              usr/local/lib/python2.7/dist-packages/docutils/writers/html5_polyglot/template.txt                  0100644 0000000 0000062 00000000162 13077704374 027113  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        %(head_prefix)s
%(head)s
%(stylesheet)s
%(body_prefix)s
%(body_pre_docinfo)s
%(docinfo)s
%(body)s
%(body_suffix)s
                                                                                                                                                                                                                                                                                                                                                                                                              usr/local/lib/python2.7/dist-packages/docutils/writers/latex2e/                                     0042755 0000000 0000062 00000000000 13077704402 023117  5                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        usr/local/lib/python2.7/dist-packages/docutils/writers/latex2e/__init__.py                          0100644 0000000 0000062 00000364015 13077704374 025244  0                                                                                                    ustar 00                                                                0000000 0000000                                                                                                                                                                        # .. coding: utf-8
# $Id: __init__.py 7971 2016-09-13 19:11:48Z milde $
# Author: Engelbert Gruber, GÃ¼nter Milde
# Maintainer: docutils-develop@lists.sourceforge.net
# Copyright: This module has been placed in the public domain.

"""LaTeX2e document tree Writer."""

__docformat__ = 'reStructuredText'

# code contributions from several people included, thanks to all.
# some named: David Abrahams, Julien Letessier, Lele Gaifax, and others.
#
# convention deactivate code by two # i.e. ##.

import sys
import os
import time
import re
import string
import urllib
try:
    import roman
except ImportError:
    import docutils.utils.roman as roman
from docutils import frontend, nodes, languages, writers, utils, io
from docutils.utils.error_reporting import SafeString
from docutils.transforms import writer_aux
from docutils.utils.math import pick_math_environment, unichar2tex

class Writer(writers.Writer):

    supported = ('latex','latex2e')
    """Formats this writer supports."""

    default_template = 'default.tex'
    default_template_path = os.path.dirname(os.path.abspath(__file__))
    default_preamble = '\n'.join([r'% PDF Standard Fonts',
                                  r'\usepackage{mathptmx} % Times',
                                  r'\usepackage[scaled=.90]{helvet}',
                                  r'\usepackage{courier}'])
    table_style_values = ('standard', 'booktabs','nolines', 'borderless',
                          'colwidths-auto', 'colwidths-given')

    settings_spec = (
        'LaTeX-Specific Options',
        None,
        (('Specify documentclass.  Default is "article".',
          ['--documentclass'],
          {'default': 'article', }),
         ('Specify document options.  Multiple options can be given, '
          'separated by commas.  Default is "a4paper".',
          ['--documentoptions'],
          {'default': 'a4paper', }),
         ('Footnotes with numbers/symbols by Docutils. (default)',
          ['--docutils-footnotes'],
          {'default': True, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Format for footnote references: one of "superscript" or '
          '"brackets".  Default is "superscript".',
          ['--footnote-references'],
          {'choices': ['superscript', 'brackets'], 'default': 'superscript',
           'metavar': '<format>',
           'overrides': 'trim_footnote_reference_space'}),
         ('Use \\cite command for citations. ',
          ['--use-latex-citations'],
          {'default': 0, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Use figure floats for citations '
          '(might get mixed with real figures). (default)',
          ['--figure-citations'],
          {'dest': 'use_latex_citations', 'action': 'store_false',
           'validator': frontend.validate_boolean}),
         ('Format for block quote attributions: one of "dash" (em-dash '
          'prefix), "parentheses"/"parens", or "none".  Default is "dash".',
          ['--attribution'],
          {'choices': ['dash', 'parentheses', 'parens', 'none'],
           'default': 'dash', 'metavar': '<format>'}),
         ('Specify LaTeX packages/stylesheets. '
         ' A style is referenced with \\usepackage if extension is '
         '".sty" or omitted and with \\input else. '
          ' Overrides previous --stylesheet and --stylesheet-path settings.',
          ['--stylesheet'],
          {'default': '', 'metavar': '<file[,file,...]>',
           'overrides': 'stylesheet_path',
           'validator': frontend.validate_comma_separated_list}),
         ('Comma separated list of LaTeX packages/stylesheets. '
          'Relative paths are expanded if a matching file is found in '
          'the --stylesheet-dirs. With --link-stylesheet, '
          'the path is rewritten relative to the output *.tex file. ',
          ['--stylesheet-path'],
          {'metavar': '<file[,file,...]>', 'overrides': 'stylesheet',
           'validator': frontend.validate_comma_separated_list}),
         ('Link to the stylesheet(s) in the output file. (default)',
          ['--link-stylesheet'],
          {'dest': 'embed_stylesheet', 'action': 'store_false'}),
         ('Embed the stylesheet(s) in the output file. '
          'Stylesheets must be accessible during processing. ',
          ['--embed-stylesheet'],
          {'default': 0, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Comma-separated list of directories where stylesheets are found. '
          'Used by --stylesheet-path when expanding relative path arguments. '
          'Default: "."',
          ['--stylesheet-dirs'],
          {'metavar': '<dir[,dir,...]>',
           'validator': frontend.validate_comma_separated_list,
           'default': ['.']}),
         ('Customization by LaTeX code in the preamble. '
          'Default: select PDF standard fonts (Times, Helvetica, Courier).',
          ['--latex-preamble'],
          {'default': default_preamble}),
         ('Specify the template file. Default: "%s".' % default_template,
          ['--template'],
          {'default': default_template, 'metavar': '<file>'}),
         ('Table of contents by LaTeX. (default) ',
          ['--use-latex-toc'],
          {'default': 1, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Table of contents by Docutils (without page numbers). ',
          ['--use-docutils-toc'],
          {'dest': 'use_latex_toc', 'action': 'store_false',
           'validator': frontend.validate_boolean}),
         ('Add parts on top of the section hierarchy.',
          ['--use-part-section'],
          {'default': 0, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Attach author and date to the document info table. (default) ',
          ['--use-docutils-docinfo'],
          {'dest': 'use_latex_docinfo', 'action': 'store_false',
           'validator': frontend.validate_boolean}),
         ('Attach author and date to the document title.',
          ['--use-latex-docinfo'],
          {'default': 0, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ("Typeset abstract as topic. (default)",
          ['--topic-abstract'],
          {'dest': 'use_latex_abstract', 'action': 'store_false',
           'validator': frontend.validate_boolean}),
         ("Use LaTeX abstract environment for the document's abstract. ",
          ['--use-latex-abstract'],
          {'default': 0, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Color of any hyperlinks embedded in text '
          '(default: "blue", "false" to disable).',
          ['--hyperlink-color'], {'default': 'blue'}),
         ('Additional options to the "hyperref" package '
          '(default: "").',
          ['--hyperref-options'], {'default': ''}),
         ('Enable compound enumerators for nested enumerated lists '
          '(e.g. "1.2.a.ii").  Default: disabled.',
          ['--compound-enumerators'],
          {'default': None, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Disable compound enumerators for nested enumerated lists. '
          'This is the default.',
          ['--no-compound-enumerators'],
          {'action': 'store_false', 'dest': 'compound_enumerators'}),
         ('Enable section ("." subsection ...) prefixes for compound '
          'enumerators.  This has no effect without --compound-enumerators.'
          'Default: disabled.',
          ['--section-prefix-for-enumerators'],
          {'default': None, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Disable section prefixes for compound enumerators.  '
          'This is the default.',
          ['--no-section-prefix-for-enumerators'],
          {'action': 'store_false', 'dest': 'section_prefix_for_enumerators'}),
         ('Set the separator between section number and enumerator '
          'for compound enumerated lists.  Default is "-".',
          ['--section-enumerator-separator'],
          {'default': '-', 'metavar': '<char>'}),
         ('When possibile, use the specified environment for literal-blocks. '
          'Default is quoting of whitespace and special chars.',
          ['--literal-block-env'],
          {'default': ''}),
         ('When possibile, use verbatim for literal-blocks. '
          'Compatibility alias for "--literal-block-env=verbatim".',
          ['--use-verbatim-when-possible'],
          {'default': 0, 'action': 'store_true',
           'validator': frontend.validate_boolean}),
         ('Table style. "standard" with horizontal and vertical lines, '
          '"booktabs" (LaTeX booktabs style) only horizontal lines '
          'above and below the table and below the header or "borderless".  '
          'Default: "standard"',
          ['--table-style'],
          {'default': ['standard'],
           'metavar': '<format>',
           'action': 'append',
           'validator': frontend.validate_comma_separated_list,
           'choices': table_style_values}),
         ('LaTeX graphicx package option. '
          'Possible values are "dvips", "pdftex". "auto" includes LaTeX code '
          'to use "pdftex" if processing with pdf(la)tex and dvips otherwise. '
          'Default is no option.',
          ['--graphicx-option'],
          {'default': ''}),
         ('LaTeX font encoding. '
          'Possible values are "", "T1" (default), "OT1", "LGR,T1" or '
          'any other combination of options to the `fontenc` package. ',
          ['--font-encoding'],
          {'default': 'T1'}),
         ('Per default the latex-writer puts the reference title into '
          'hyperreferences. Specify "ref*" or "pageref*" to get the section '
          'number or the page number.',
          ['--reference-label'],
          {'default': None, }),
         ('Specify style and database for bibtex, for example '
          '"--use-bibtex=mystyle,mydb1,mydb2".',
          ['--use-bibtex'],
          {'default': None, }),
          ),)

    settings_defaults = {'sectnum_depth': 0 # updated by SectNum transform
                        }
    config_section = 'latex2e writer'
    config_section_dependencies = ('writers',)

    head_parts = ('head_prefix', 'requirements', 'latex_preamble',
                  'stylesheet', 'fallbacks', 'pdfsetup',
                  'title', 'subtitle', 'titledata')
    visitor_attributes = head_parts + ('body_pre_docinfo', 'docinfo',
                                       'dedication', 'abstract', 'body')

    output = None
    """Final translated form of `document`."""

    def __init__(self):
        writers.Writer.__init__(self)
        self.translator_class = LaTeXTranslator

    # Override parent method to add latex-specific transforms
    def get_transforms(self):
       return writers.Writer.get_transforms(self) + [
       # Convert specific admonitions to generic one
       writer_aux.Admonitions,
       # TODO: footnote collection transform
       ]

    def translate(self):
        visitor = self.translator_class(self.document)
        self.document.walkabout(visitor)
        # copy parts
        for part in self.visitor_attributes:
            setattr(self, part, getattr(visitor, part))
        # get template string from file
        try:
            template_file = open(self.document.settings.template, 'rb')
        except IOError:
            template_file = open(os.path.join(self.default_template_path,
                                     self.document.settings.template), 'rb')
        template = string.Template(unicode(template_file.read(), 'utf-8'))
        template_file.close()
        # fill template
        self.assemble_parts() # create dictionary of parts
        self.output = template.substitute(self.parts)

    def assemble_parts(self):
        """Assemble the `self.parts` dictionary of output fragments."""
        writers.Writer.assemble_parts(self)
        for part in self.visitor_attributes:
            lines = getattr(self, part)
            if part in self.head_parts:
                if lines:
                    lines.append('') # to get a trailing newline
                self.parts[part] = '\n'.join(lines)
            else:
                # body contains inline elements, so join without newline
                self.parts[part] = ''.join(lines)


class Babel(object):
    """Language specifics for LaTeX."""

    # TeX (babel) language names:
    # ! not all of these are supported by Docutils!
    #
    # based on LyX' languages file with adaptions to `BCP 47`_
    # (http://www.rfc-editor.org/rfc/bcp/bcp47.txt) and
    # http://www.tug.org/TUGboat/Articles/tb29-3/tb93miklavec.pdf
    # * the key without subtags is the default
    # * case is ignored
    # cf. http://docutils.sourceforge.net/docs/howto/i18n.html
    #     http://www.w3.org/International/articles/language-tags/
    # and http://www.iana.org/assignments/language-subtag-registry
    language_codes = {
        # code          TeX/Babel-name       comment
        'af':           'afrikaans',
        'ar':           'arabic',
        # 'be':           'belarusian',
        'bg':           'bulgarian',
        'br':           'breton',
        'ca':           'catalan',
        # 'cop':          'coptic',
        'cs':           'czech',
        'cy':           'welsh',
        'da':           'danish',
        'de':           'ngerman', # new spelling (de_1996)
        'de-1901':      'german', # old spelling
        'de-AT':        'naustrian',
        'de-AT-1901':   'austrian',
        'dsb':          'lowersorbian',
        'el':           'greek', # monotonic (el-monoton)
        'el-polyton':   'polutonikogreek',
        'en':           'english',  # TeX' default language
        'en-AU':        'australian',
        'en-CA':        'canadian',
        'en-GB':        'british',
        'en-NZ':        'newzealand',
        'en-US':        'american',
        'eo':           'esperanto',
        'es':           'spanish',
        'et':           'estonian',
        'eu':           'basque',
        # 'fa':           'farsi',
        'fi':           'finnish',
        'fr':           'french',
        'fr-CA':        'canadien',
        'ga':           'irish',    # Irish Gaelic
        # 'grc':                    # Ancient Greek
        'grc-ibycus':   'ibycus',   # Ibycus encoding
        'gl':           'galician',
        'he':           'hebrew',
        'hr':           'croatian',
        'hsb':          'uppersorbian',
        'hu':           'magyar',
        'ia':           'interlingua',
        'id':           'bahasai',  # Bahasa (Indonesian)
        'is':           'icelandic',
        'it':           'italian',
        'ja':           'japanese',
        'kk':           'kazakh',
        'la':           'latin',
        'lt':           'lithuanian',
        'lv':           'latvian',
        'mn':           'mongolian', # Mongolian, Cyrillic script (mn-cyrl)
        'ms':           'bahasam',   # Bahasa (Malay)
        'nb':           'norsk',     # Norwegian Bokmal
        'nl':           'dutch',
        'nn':           'nynorsk',   # Norwegian Nynorsk
        'no':           'norsk',     # Norwegian (Bokmal)
        'pl':           'polish',
        'pt':           'portuges',
        'pt-BR':        'brazil',
        'ro':           'romanian',
        'ru':           'russian',
        'se':           'samin',     # North Sami
        'sh-Cyrl':      'serbianc',  # Serbo-Croatian, Cyrillic script
        'sh-Latn':      'serbian',   # Serbo-Croatian, Latin script see also 'hr'
        'sk':           'slovak',
        'sl':           'slovene',
        'sq':           'albanian',
        'sr':           'serbianc',  # Serbian, Cyrillic script (contributed)
        'sr-Latn':      'serbian',   # Serbian, Latin script
        'sv':           'swedish',
        # 'th':           'thai',
        'tr':           'turkish',
        'uk':           'ukrainian',
        'vi':           'vietnam',
        # zh-Latn:      Chinese Pinyin
        }
    # normalize (downcase) keys
    language_codes = dict([(k.lower(), v) for (k,v) in language_codes.items()])

    warn_msg = 'Language "%s" not supported by LaTeX (babel)'

    # "Active characters" are shortcuts that start a LaTeX macro and may need
    # escaping for literals use. Characters that prevent literal use (e.g.
    # starting accent macros like "a -> Ã¤) will be deactivated if one of the
    # defining languages is used in the document.
    # Special cases:
    #  ~ (tilde) -- used in estonian, basque, galician, and old versions of
    #    spanish -- cannot be deactivated as it denotes a no-break space macro,
    #  " (straight quote) -- used in albanian, austrian, basque
    #    brazil, bulgarian, catalan, czech, danish, dutch, estonian,
    #    finnish, galician, german, icelandic, italian, latin, naustrian,
    #    ngerman, norsk, nynorsk, polish, portuges, russian, serbian, slovak,
    #    slovene, spanish, swedish, ukrainian, and uppersorbian --
    #    is escaped as ``\textquotedbl``.
    active_chars = {# TeX/Babel-name:  active characters to deactivate
                    # 'breton':        ':;!?' # ensure whitespace
                    # 'esperanto':     '^',
                    # 'estonian':      '~"`',
                    # 'french':        ':;!?' # ensure whitespace
                    'galician':        '.<>', # also '~"'
                    # 'magyar':        '`', # for special hyphenation cases
                    'spanish':         '.<>', # old versions also '~'
                    # 'turkish':       ':!=' # ensure whitespace
                   }

    def __init__(self, language_code, reporter=None):
        self.reporter = reporter
        self.language = self.language_name(language_code)
        self.otherlanguages = {}

    def __call__(self):
        """Return the babel call with correct options and settings"""
        languages = sorted(self.otherlanguages.keys())
        languages.append(self.language or 'english')
        self.setup = [r'\usepackage[%s]{babel}' % ','.join(languages)]
        # Deactivate "active characters"
        shorthands = []
        for c in ''.join([self.active_chars.get(l, '') for l in languages]):
            if c not in shorthands:
                shorthands.append(c)
        if shorthands:
            self.setup.append(r'\AtBeginDocument{\shorthandoff{%s}}'
                              % ''.join(shorthands))
        # Including '~' in shorthandoff prevents its use as no-break space
        if 'galician' in languages:
            self.setup.append(r'\deactivatetilden % restore ~ in Galician')
        if 'estonian' in languages:
            self.setup.extend([r'\makeatletter',
                               r'  \addto\extrasestonian{\bbl@deactivate{~}}',
                               r'\makeatother'])
        if 'basque' in languages:
            self.setup.extend([r'\makeatletter',
                               r'  \addto\extrasbasque{\bbl@deactivate{~}}',
                               r'\makeatother'])
        if (languages[-1] == 'english' and
            'french' in self.otherlanguages.keys()):
            self.setup += ['% Prevent side-effects if French hyphenation '
                           'patterns are not loaded:',
                           r'\frenchbsetup{StandardLayout}',
                           r'\AtBeginDocument{\selectlanguage{%s}'
                           r'\noextrasfrench}' % self.language]
        return '\n'.join(self.setup)

    def language_name(self, language_code):
        """Return TeX language name for `language_code`"""
        for tag in utils.normalize_language_tag(language_code):
            try:
                return self.language_codes[tag]
            except KeyError:
                pass
        if self.reporter is not None:
            self.reporter.warning(self.warn_msg % language_code)
        return ''

    def get_language(self):
        # Obsolete, kept for backwards compatibility with Sphinx
        return self.language


# Building blocks for the latex preamble
# --------------------------------------

class SortableDict(dict):
    """Dictionary with additional sorting methods

    Tip: use key starting with with '_' for sorting before small letters
         and with '~' for sorting after small letters.
    """
    def sortedkeys(self):
        """Return sorted list of keys"""
        keys = self.keys()
        keys.sort()
        return keys

    def sortedvalues(self):
        """Return list of values sorted by keys"""
        return [self[key] for key in self.sortedkeys()]


# PreambleCmds
# `````````````
# A container for LaTeX code snippets that can be
# inserted into the preamble if required in the document.
#
# .. The package 'makecmds' would enable shorter definitions using the
#    \providelength and \provideenvironment commands.
#    However, it is pretty non-standard (texlive-latex-extra).

class PreambleCmds(object):
    """Building blocks for the latex preamble."""

PreambleCmds.abstract = r"""
% abstract title
\providecommand*{\DUtitleabstract}[1]{\centering\textbf{#1}}"""

PreambleCmds.admonition = r"""
% admonition (specially marked topic)
\providecommand{\DUadmonition}[2][class-arg]{%
  % try \DUadmonition#1{#2}:
  \ifcsname DUadmonition#1\endcsname%
    \csname DUadmonition#1\endcsname{#2}%
  \else
    \begin{center}
      \fbox{\parbox{0.9\linewidth}{#2}}
    \end{center}
  \fi
}"""

PreambleCmds.align_center = r"""
\makeatletter
\@namedef{DUrolealign-center}{\centering}
\makeatother
"""

## PreambleCmds.caption = r"""% configure caption layout
## \usepackage{caption}
## \captionsetup{singlelinecheck=false}% no exceptions for one-liners"""

PreambleCmds.color = r"""\usepackage{color}"""

PreambleCmds.docinfo = r"""
% docinfo (width of docinfo table)
\DUprovidelength{\DUdocinfowidth}{0.9\linewidth}"""
# PreambleCmds.docinfo._depends = 'providelength'

PreambleCmds.dedication = r"""
% dedication topic
\providecommand{\DUtopicdedication}[1]{\begin{center}#1\end{center}}"""

PreambleCmds.error = r"""
% error admonition title
\providecommand*{\DUtitleerror}[1]{\DUtitle{\color{red}#1}}"""
# PreambleCmds.errortitle._depends = 'color'

PreambleCmds.fieldlist = r"""
% fieldlist environment
\ifthenelse{\isundefined{\DUfieldlist}}{
  \newenvironment{DUfieldlist}%
    {\quote\description}
    {\enddescription\endquote}
}{}"""

PreambleCmds.float_settings = r"""\usepackage{float} % float configuration
\floatplacement{figure}{H} % place figures here definitely"""

PreambleCmds.footnotes = r"""% numeric or symbol footnotes with hyperlinks
\providecommand*{\DUfootnotemark}[3]{%
  \raisebox{1em}{\hypertarget{#1}{}}%
  \hyperlink{#2}{\textsuperscript{#3}}%
}
\providecommand{\DUfootnotetext}[4]{%
  \begingroup%
  \renewcommand{\thefootnote}{%
    \protect\raisebox{1em}{\protect\hypertarget{#1}{}}%
    \protect\hyperlink{#2}{#3}}%
  \footnotetext{#4}%
  \endgroup%
}"""

PreambleCmds.graphicx_auto = r"""% Check output format
\ifx\pdftexversion\undefined
  \usepackage{graphicx}
\else
  \usepackage[pdftex]{graphicx}
\fi"""

PreambleCmds.highlight_rules = r"""% basic code highlight:
\providecommand*\DUrolecomment[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\providecommand*\DUroledeleted[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\providecommand*\DUrolekeyword[1]{\textbf{#1}}
\providecommand*\DUrolestring[1]{\textit{#1}}"""

PreambleCmds.inline = r"""
% inline markup (custom roles)
% \DUrole{#1}{#2} tries \DUrole#1{#2}
\providecommand*{\DUrole}[2]{%
  \ifcsname DUrole#1\endcsname%
    \csname DUrole#1\endcsname{#2}%
  \else% backwards compatibility: try \docutilsrole#1{#2}
    \ifcsname docutilsrole#1\endcsname%
      \csname docutilsrole#1\endcsname{#2}%
    \else%
      #2%
    \fi%
  \fi%
}"""

PreambleCmds.legend = r"""
% legend environment
\ifthenelse{\isundefined{\DUlegend}}{
  \newenvironment{DUlegend}{\small}{}
}{}"""

PreambleCmds.lineblock = r"""
% lineblock environment
\DUprovidelength{\DUlineblockindent}{2.5em}
\ifthenelse{\isundefined{\DUlineblock}}{
  \newenvironment{DUlineblock}[1]{%
    \list{}{\setlength{\partopsep}{\parskip}
            \addtolength{\partopsep}{\baselineskip}
            \setlength{\topsep}{0pt}
            \setlength{\itemsep}{0.15\baselineskip}
            \setlength{\parsep}{0pt}
            \setlength{\leftmargin}{#1}}
    \raggedright
  }
  {\endlist}
}{}"""
# PreambleCmds.lineblock._depends = 'providelength'

PreambleCmds.linking = r"""
%% hyperlinks:
\ifthenelse{\isundefined{\hypersetup}}{
  \usepackage[%s]{hyperref}
  \usepackage{bookmark}
  \urlstyle{same} %% normal text font (alternatives: tt, rm, sf)
}{}"""

PreambleCmds.minitoc = r"""%% local table of contents
\usepackage{minitoc}"""

PreambleCmds.optionlist = r"""
% optionlist environment
\providecommand*{\DUoptionlistlabel}[1]{\bf #1 \hfill}
\DUprovidelength{\DUoptionlistindent}{3cm}
\ifthenelse{\isundefined{\DUoptionlist}}{
  \newenvironment{DUoptionlist}{%
    \list{}{\setlength{\labelwidth}{\DUoptionlistindent}
            \setlength{\rightmargin}{1cm}
            \setlength{\leftmargin}{\rightmargin}
            \addtolength{\leftmargin}{\labelwidth}
            \addtolength{\leftmargin}{\labelsep}
            \renewcommand{\makelabel}{\DUoptionlistlabel}}
  }
  {\endlist}
}{}"""
# PreambleCmds.optionlist._depends = 'providelength'

PreambleCmds.providelength = r"""
% providelength (provide a length variable and set default, if it is new)
\providecommand*{\DUprovidelength}[2]{
  \ifthenelse{\isundefined{#1}}{\newlength{#1}\setlength{#1}{#2}}{}
}"""

PreambleCmds.rubric = r"""
% rubric (informal heading)
\providecommand*{\DUrubric}[2][class-arg]{%
  \subsubsection*{\centering\textit{\textmd{#2}}}}"""

PreambleCmds.sidebar = r"""
% sidebar (text outside the main text flow)
\providecommand{\DUsidebar}[2][class-arg]{%
  \begin{center}
    \colorbox[gray]{0.80}{\parbox{0.9\linewidth}{#2}}
  \end{center}
}"""

PreambleCmds.subtitle = r"""
% subtitle (for topic/sidebar)
\providecommand*{\DUsubtitle}[2][class-arg]{\par\emph{#2}\smallskip}"""

PreambleCmds.documentsubtitle = r"""
% subtitle (in document title)
\providecommand*{\DUdocumentsubtitle}[1]{{\large #1}}"""

PreambleCmds.table = r"""\usepackage{longtable,ltcaption,array}
\setlength{\extrarowheight}{2pt}
\newlength{\DUtablewidth} % internal use in tables"""

# Options [force,almostfull] prevent spurious error messages, see
# de.comp.text.tex/2005-12/msg01855
PreambleCmds.textcomp = """\
\\usepackage{textcomp} % text symbol macros"""

PreambleCmds.titlereference = r"""
% titlereference role
\providecommand*{\DUroletitlereference}[1]{\textsl{#1}}"""

PreambleCmds.title = r"""
% title for topics, admonitions, unsupported section levels, and sidebar
\providecommand*{\DUtitle}[2][class-arg]{%
  % call \DUtitle#1{#2} if it exists:
  \ifcsname DUtitle#1\endcsname%
    \csname DUtitle#1\endcsname{#2}%
  \else
    \smallskip\noindent\textbf{#2}\smallskip%
  \fi
}"""

PreambleCmds.topic = r"""
% topic (quote with heading)
\providecommand{\DUtopic}[2][class-arg]{%
  \ifcsname DUtopic#1\endcsname%
    \csname DUtopic#1\endcsname{#2}%
  \else
    \begin{quote}#2\end{quote}
  \fi
}"""

PreambleCmds.transition = r"""
% transition (break, fancybreak, anonymous section)
\providecommand*{\DUtransition}[1][class-arg]{%
  \hspace*{\fill}\hrulefill\hspace*{\fill}
  \vskip 0.5\baselineskip
}"""


# LaTeX encoding maps
# -------------------
# ::

class CharMaps(object):
    """LaTeX representations for active and Unicode characters."""

    # characters that need escaping even in `alltt` environments:
    alltt = {
        ord('\\'): ur'\textbackslash{}',
        ord('{'): ur'\{',
        ord('}'): ur'\}',
    }
    # characters that normally need escaping:
    special = {
        ord('#'): ur'\#',
        ord('$'): ur'\$',
        ord('%'): ur'\%',
        ord('&'): ur'\&',
        ord('~'): ur'\textasciitilde{}',
        ord('_'): ur'\_',
        ord('^'): ur'\textasciicircum{}',
        # straight double quotes are 'active' in many languages
        ord('"'): ur'\textquotedbl{}',
        # Square brackets are ordinary chars and cannot be escaped with '\',
        # so we put them in a group '{[}'. (Alternative: ensure that all
        # macros with optional arguments are terminated with {} and text
        # inside any optional argument is put in a group ``[{text}]``).
        # Commands with optional args inside an optional arg must be put in a
        # group, e.g. ``\item[{\hyperref[label]{text}}]``.
        ord('['): ur'{[}',
        ord(']'): ur'{]}',
        # the soft hyphen is unknown in 8-bit text
        # and not properly handled by XeTeX
        0x00AD: ur'\-', # SOFT HYPHEN
    }
    # Unicode chars that are not recognized by LaTeX's utf8 encoding
    unsupported_unicode = {
        0x00A0: ur'~', # NO-BREAK SPACE
        # TODO: ensure white space also at the beginning of a line?
        # 0x00A0: ur'\leavevmode\nobreak\vadjust{}~'
        0x2008: ur'\,', # PUNCTUATION SPACEâ€ˆâ€ˆâ€ˆ
        0x2011: ur'\hbox{-}', # NON-BREAKING HYPHEN
        0x202F: ur'\,', # NARROW NO-BREAK SPACE
        0x21d4: ur'$\Leftrightarrow$',
        # Docutils footnote symbols:
        0x2660: ur'$\spadesuit$',
        0x2663: ur'$\clubsuit$',
    }
    # Unicode chars that are recognized by LaTeX's utf8 encoding
    utf8_supported_unicode = {
        0x00AB: ur'\guillemotleft{}', # LEFT-POINTING DOUBLE ANGLE QUOTATION MARK
        0x00bb: ur'\guillemotright{}', # RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK
        0x200C: ur'\textcompwordmark{}', # ZERO WIDTH NON-JOINER
        0x2013: ur'\textendash{}',
        0x2014: ur'\textemdash{}',
        0x2018: ur'\textquoteleft{}',
        0x2019: ur'\textquoteright{}',
        0x201A: ur'\quotesinglbase{}', # SINGLE LOW-9 QUOTATION MARK
        0x201C: ur'\textquotedblleft{}',
        0x201D: ur'\textquotedblright{}',
        0x201E: ur'\quotedblbase{}', # DOUBLE LOW-9 QUOTATION MARK
        0x2030: ur'\textperthousand{}',   # PER MILLE SIGN
        0x2031: ur'\textpertenthousand{}', # PER TEN THOUSAND SIGN
        0x2039: ur'\guilsinglleft{}',
        0x203A: ur'\guilsinglright{}',
        0x2423: ur'\textvisiblespace{}',  # OPEN BOX
        0x2020: ur'\dag{}',
        0x2021: ur'\ddag{}',
        0x2026: ur'\dots{}',
        0x2122: ur'\texttrademark{}',
    }
    # recognized with 'utf8', if textcomp is loaded
    textcomp = {
        # Latin-1 Supplement
        0x00a2: ur'\textcent{}',          # Â¢ CENT SIGN
        0x00a4: ur'\textcurrency{}',      # Â¤ CURRENCY SYMBOL
        0x00a5: ur'\textyen{}',           # Â¥ YEN SIGN
        0x00a6: ur'\textbrokenbar{}',     # Â¦ BROKEN BAR
        0x00a7: ur'\textsection{}',       # Â§ SECTION SIGN
        0x00a8: ur'\textasciidieresis{}', # Â¨ DIAERESIS
        0x00a9: ur'\textcopyright{}',     # Â© COPYRIGHT SIGN
        0x00aa: ur'\textordfeminine{}',   # Âª FEMININE ORDINAL INDICATOR
        0x00ac: ur'\textlnot{}',          # Â¬ NOT SIGN
        0x00ae: ur'\textregistered{}',    # Â® REGISTERED SIGN
        0x00af: ur'\textasciimacron{}',   # Â¯ MACRON
        0x00b0: ur'\textdegree{}',        # Â° DEGREE SIGN
        0x00b1: ur'\textpm{}',            # Â± PLUS-MINUS SIGN
        0x00b2: ur'\texttwosuperior{}',   # Â² SUPERSCRIPT TWO
        0x00b3: ur'\textthreesuperior{}', # Â³ SUPERSCRIPT THREE
        0x00b4: ur'\textasciiacute{}',    # Â´ ACUTE ACCENT
        0x00b5: ur'\textmu{}',            # Âµ MICRO SIGN
        0x00b6: ur'\textparagraph{}',     # Â¶ PILCROW SIGN # != \textpilcrow
        0x00b9: ur'\textonesuperior{}',   # Â¹ SUPERSCRIPT ONE
        0x00ba: ur'\textordmasculine{}',  # Âº MASCULINE ORDINAL INDICATOR
        0x00bc: ur'\textonequarter{}',    # 1/4 FRACTION
        0x00bd: ur'\textonehalf{}',       # 1/2 FRACTION
        0x00be: ur'\textthreequarters{}', # 3/4 FRACTION
        0x00d7: ur'\texttimes{}',         # Ã— MULTIPLICATION SIGN
        0x00f7: ur'\textdiv{}',           # Ã· DIVISION SIGN
        # others
        0x0192: ur'\textflorin{}',        # LATIN SMALL LETTER F WITH HOOK
        0x02b9: ur'\textasciiacute{}',    # MODIFIER LETTER PRIME
        0x02ba: ur'\textacutedbl{}',      # MODIFIER LETTER DOUBLE PRIME
        0x2016: ur'\textbardbl{}',        # DOUBLE VERTICAL LINE
        0x2022: ur'\textbullet{}',        # BULLET
        0x2032: ur'\textasciiacute{}',    # PRIME
        0x2033: ur'\textacutedbl{}',      # DOUBLE PRIME
        0x2035: ur'\textasciigrave{}',    # REVERSED PRIME
        0x2036: ur'\textgravedbl{}',      # REVERSED DOUBLE PRIME
        0x203b: ur'\textreferencemark{}', # REFERENCE MARK
        0x203d: ur'\textinterrobang{}',   # INTERROBANG
        0x2044: ur'\textfractionsolidus{}', # FRACTION SLASH
        0x2045: ur'\textlquill{}',        # LEFT SQUARE BRACKET WITH QUILL
        0x2046: ur'\textrquill{}',        # RIGHT SQUARE BRACKET WITH QUILL
        0x2052: ur'\textdiscount{}',      # COMMERCIAL MINUS SIGN
        0x20a1: ur'\textcolonmonetary{}', # COLON SIGN
        0x20a3: ur'\textfrenchfranc{}',   # FRENCH FRANC SIGN
        0x20a4: ur'\textlira{}',          # LIRA SIGN
        0x20a6: ur'\textnaira{}',         # NAIRA SIGN
        0x20a9: ur'\textwon{}',           # WON SIGN
        0x20ab: ur'\textdong{}',          # DONG SIGN
        0x20ac: ur'\texteuro{}',          # EURO SIGN
        0x20b1: ur'\textpeso{}',          # PESO SIGN
        0x20b2: ur'\textguarani{}',       # GUARANI SIGN
        0x2103: ur'\textcelsius{}',       # DEGREE CELSIUS
        0x2116: ur'\textnumero{}',        # NUMERO SIGN
        0x2117: ur'\textcircledP{}',      # SOUND RECORDING COYRIGHT
        0x211e: ur'\textrecipe{}',        # PRESCRIPTION TAKE
        0x2120: ur'\textservicemark{}',   # SERVICE MARK
        0x2122: ur'\texttrademark{}',     # TRADE MARK SIGN
        0x2126: ur'\textohm{}',           # OHM SIGN
        0x2127: ur'\textmho{}',           # INVERTED OHM SIGN
        0x212e: ur'\textestimated{}',     # ESTIMATED SYMBOL
        0x2190: ur'\textleftarrow{}',     # LEFTWARDS ARROW
        0x2191: ur'\textuparrow{}',       # UPWARDS ARROW
        0x2192: ur'\textrightarrow{}',    # RIGHTWARDS ARROW
        0x2193: ur'\textdownarrow{}',     # DOWNWARDS ARROW
        0x2212: ur'\textminus{}',         # MINUS SIGN
        0x2217: ur'\textasteriskcentered{}', # ASTERISK OPERATOR
        0x221a: ur'\textsurd{}',          # SQUARE ROOT
        0x2422: ur'\textblank{}',         # BLANK SYMBOL
        0x25e6: ur'\textopenbullet{}',    # WHITE BULLET
        0x25ef: ur'\textbigcircle{}',     # LARGE CIRCLE
        0x266a: ur'\textmusicalnote{}',   # EIGHTH NOTE
        0x26ad: ur'\textmarried{}',       # MARRIAGE SYMBOL
        0x26ae: ur'\textdivorced{}',      # DIVORCE SYMBOL
        0x27e8: ur'\textlangle{}',        # MATHEMATICAL LEFT ANGLE BRACKET
        0x27e9: ur'\textrangle{}',        # MATHEMATICAL RIGHT ANGLE BRACKET
    }
    # Unicode chars that require a feature/package to render
    pifont = {
        0x2665: ur'\ding{170}',     # black heartsuit
        0x2666: ur'\ding{169}',     # black diamondsuit
        0x2713: ur'\ding{51}',      # check mark
        0x2717: ur'\ding{55}',      # check mark
    }
    # TODO: greek alphabet ... ?
    # see also LaTeX codec
    # http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/252124
    # and unimap.py from TeXML


class DocumentClass(object):
    """Details of a LaTeX document class."""

    def __init__(self, document_class, with_part=False):
        self.document_class = document_class
        self._with_part = with_part
        self.sections = ['section', 'subsection', 'subsubsection',
                         'paragraph', 'subparagraph']
        if self.document_class in ('book', 'memoir', 'report',
                                   'scrbook', 'scrreprt'):
            self.sections.insert(0, 'chapter')
        if self._with_part:
            self.sections.insert(0, 'part')

    def section(self, level):
        """Return the LaTeX section name for section `level`.

        The name depends on the specific document class.
        Level is 1,2,3..., as level 0 is the title.
        """
        if level <= len(self.sections):
            return self.sections[level-1]
        else:  # unsupported levels
            return 'DUtitle[section%s]' % roman.toRoman(level)

class Table(object):
    """Manage a table while traversing.

    Maybe change to a mixin defining the visit/departs, but then
    class Table internal variables are in the Translator.

    Table style might be

    :standard:   horizontal and vertical lines
    :booktabs:   only horizontal lines (requires "booktabs" LaTeX package)
    :borderless: no borders around table cells
    :nolines:    alias for borderless

    :colwidths-auto:  column widths determined by LaTeX
    :colwidths-given: use colum widths from rST source
    """
    def __init__(self, translator, latex_type):
        self._translator = translator
        self._latex_type = latex_type
        self._open = False
        # miscellaneous attributes
        self._attrs = {}
        self._col_width = []
        self._rowspan = []
        self.stubs = []
        self.colwidths_auto = False
        self._in_thead = 0

    def open(self):
        self._open = True
        self._col_specs = []
        self.caption = []
        self._attrs = {}
        self._in_head = False # maybe context with search
    def close(self):
        self._open = False
        self._col_specs = None
        self.caption = []
        self._attrs = {}
        self.stubs = []
        self.colwidths_auto = False

    def is_open(self):
        return self._open

    def set_table_style(self, table_style, classes):
        borders = [cls.replace('nolines', 'borderless')
                   for cls in table_style+classes
                   if cls in ('standard','booktabs','borderless', 'nolines')]
        try:
            self.borders = borders[-1]
        except IndexError:
            self.borders = 'standard'
        self.colwidths_auto = (('colwidths-auto' in classes
                                and 'colwidths-given' not in table_style)
                               or ('colwidths-auto' in table_style
                                   and ('colwidths-given' not in classes)))

    def get_latex_type(self):
        if self._latex_type == 'longtable' and not self.caption:
            # do not advance the "table" counter (requires "ltcaption" package)
            return('longtable*')
        return self._latex_type

    def set(self,attr,value):
        self._attrs[attr] = value
    def get(self,attr):
        if attr in self._attrs:
            return self._attrs[attr]
        return None

    def get_vertical_bar(self):
        if self.borders == 'standard':
            return '|'
        return ''

    # horizontal lines are drawn below a row,
    def get_opening(self):
        align_map = {'left': 'l',
                     'center': 'c',
                     'right': 'r'}
        align = align_map.get(self.get('align') or 'center')
        opening = [r'\begin{%s}[%s]' % (self.get_latex_type(), align)]
        if not self.colwidths_auto:
            opening.insert(0, r'\setlength{\DUtablewidth}{\linewidth}')
        return '\n'.join(opening)

    def get_closing(self):
        closing = []
        if self.borders == 'booktabs':
            closing.append(r'\bottomrule')
        # elif self.borders == 'standard':
        #     closing.append(r'\hline')
        closing.append(r'\end{%s}' % self.get_latex_type())
        return '\n'.join(closing)

    def visit_colspec(self, node):
        self._col_specs.append(node)
        # "stubs" list is an attribute of the tgroup element:
        self.stubs.append(node.attributes.get('stub'))

    def get_colspecs(self, node):
        """Return column specification for longtable.

        Assumes reST line length being 80 characters.
        Table width is hairy.

        === ===
        ABC DEF
        === ===

        usually gets to narrow, therefore we add 1 (fiddlefactor).
        """
        bar = self.get_vertical_bar()
        self._rowspan= [0] * len(self._col_specs)
        self._col_width = []
        if self.colwidths_auto:
            latex_table_spec = (bar+'l')*len(self._col_specs)
            return latex_table_spec+bar
        width = 80
        total_width = 0.0
        # first see if we get too wide.
        for node in self._col_specs:
            colwidth = float(node['colwidth']+1) / width
            total_width += colwidth
        # donot make it full linewidth
        factor = 0.93
        if total_width > 1.0:
            factor /= total_width
        latex_table_spec = ''
        for node in self._col_specs:
            colwidth = factor * float(node['colwidth']+1) / width
            self._col_width.append(colwidth+0.005)
            latex_table_spec += '%sp{%.3f\\DUtablewidth}' % (bar, colwidth+0.005)
        return latex_table_spec+bar

    def get_column_width(self):
        """Return columnwidth for current cell (not multicell)."""
        try:
            return '%.2f\\DUtablewidth' % self._col_width[self._cell_in_row]
        except IndexError:
            return '*'

    def get_multicolumn_width(self, start, len_):
        """Return sum of columnwidths for multicell."""
        try:
            mc_width = sum([width
                            for width in ([self._col_width[start + co]
                                           for co in range (len_)])])
            return 'p{%.2f\\DUtablewidth}' % mc_width
        except IndexError:
            return 'l'

    def get_caption(self):
        if not self.caption:
            return ''
        caption = ''.join(self.caption)
        if 1 == self._translator.thead_depth():
            return r'\caption{%s}\\' '\n' % caption
        return r'\caption[]{%s (... continued)}\\' '\n' % caption

    def need_recurse(self):
        if self._latex_type == 'longtable':
            return 1 == self._translator.thead_depth()
        return 0

    def visit_thead(self):
        self._in_thead += 1
        if self.borders == 'standard':
            return ['\\hline\n']
        elif self.borders == 'booktabs':
            return ['\\toprule\n']
        return []

    def depart_thead(self):
        a = []
        #if self.borders == 'standard':
        #    a.append('\\hline\n')
        if self.borders == 'booktabs':
            a.append('\\midrule\n')
        if self._latex_type == 'longtable':
            if 1 == self._translator.thead_depth():
                a.append('\\endfirsthead\n')
            else:
                a.append('\\endhead\n')
                a.append(r'\multicolumn{%d}{c}' % len(self._col_specs) +
                         r'{\hfill ... continued on next page} \\')
                a.append('\n\\endfoot\n\\endlastfoot\n')
        # for longtable one could add firsthead, foot and lastfoot
        self._in_thead -= 1
        return a

    def visit_row(self):
        self._cell_in_row = 0

    def depart_row(self):
        res = [' \\\\\n']
        self._cell_in_row = None  # remove cell counter
        for i in range(len(self._rowspan)):
            if (self._rowspan[i]>0):
                self._rowspan[i] -= 1

        if self.borders == 'standard':
            rowspans = [i+1 for i in range(len(self._rowspan))
                        if (self._rowspan[i]<=0)]
            if len(rowspans)==len(self._rowspan):
                res.append('\\hline\n')
            else:
                cline = ''
                rowspans.reverse()
                # TODO merge clines
                while True:
                    try:
                        c_start = rowspans.pop()
                    except:
                        break
                    cline += '\\cline{%d-%d}\n' % (c_start,c_start)
                res.append(cline)
        return res

    def set_rowspan(self,cell,value):
        try:
            self._rowspan[cell] = value
        except:
            pass

    def get_rowspan(self,cell):
        try:
            return self._rowspan[cell]
        except:
            return 0

    def get_entry_number(self):
        return self._cell_in_row

    def visit_entry(self):
        self._cell_in_row += 1

    def is_stub_column(self):
        if len(self.stubs) >= self._cell_in_row:
            return self.stubs[self._cell_in_row]
        return False


class LaTeXTranslator(nodes.NodeVisitor):

    # When options are given to the documentclass, latex will pass them
    # to other packages, as done with babel.
    # Dummy settings might be taken from document settings

    # Write code for typesetting with 8-bit tex/pdftex (vs. xetex/luatex) engine
    # overwritten by the XeTeX writer
    is_xetex = False

    # Config setting defaults
    # -----------------------

    # TODO: use mixins for different implementations.
    # list environment for docinfo. else tabularx
    ## use_optionlist_for_docinfo = False # TODO: NOT YET IN USE

    # Use compound enumerations (1.A.1.)
    compound_enumerators = False

    # If using compound enumerations, include section information.
    section_prefix_for_enumerators = False

    # This is the character that separates the section ("." subsection ...)
    # prefix from the regular list enumerator.
    section_enumerator_separator = '-'

    # Auxiliary variables
    # -------------------

    has_latex_toc = False # is there a toc in the doc? (needed by minitoc)
    is_toc_list = False   # is the current bullet_list a ToC?
    section_level = 0

    # Flags to encode():
    # inside citation reference labels underscores dont need to be escaped
    inside_citation_reference_label = False
    verbatim = False                   # do not encode
    insert_non_breaking_blanks = False # replace blanks by "~"
    insert_newline = False             # add latex newline commands
    literal = False                    # literal text (block or inline)
    alltt = False                      # inside `alltt` environment

    def __init__(self, document, babel_class=Babel):
        nodes.NodeVisitor.__init__(self, document)
        # Reporter
        # ~~~~~~~~
        self.warn = self.document.reporter.warning
        self.error = self.document.reporter.error

        # Settings
        # ~~~~~~~~
        self.settings = settings = document.settings
        self.latex_encoding = self.to_latex_encoding(settings.output_encoding)
        self.use_latex_toc = settings.use_latex_toc
        self.use_latex_docinfo = settings.use_latex_docinfo
        self._use_latex_citations = settings.use_latex_citations
        self._reference_label = settings.reference_label
        self.hyperlink_color = settings.hyperlink_color
        self.compound_enumerators = settings.compound_enumerators
        self.font_encoding = getattr(settings, 'font_encoding', '')
        self.section_prefix_for_enumerators = (
            settings.section_prefix_for_enumerators)
        self.section_enumerator_separator = (
            settings.section_enumerator_separator.replace('_', r'\_'))
        # literal blocks:
        self.literal_block_env = 'alltt'
        self.literal_block_options = ''
        if settings.literal_block_env != '':
            (none,
             self.literal_block_env,
             self.literal_block_options,
             none ) = re.split('(\w+)(.*)', settings.literal_block_env)
        elif settings.use_verbatim_when_possible:
            self.literal_block_env = 'verbatim'
        #
        if self.settings.use_bibtex:
            self.bibtex = self.settings.use_bibtex.split(',',1)
            # TODO avoid errors on not declared citations.
        else:
            self.bibtex = None
        # language module for Docutils-generated text
        # (labels, bibliographic_fields, and author_separators)
        self.language_module = languages.get_language(settings.language_code,
                                              document.reporter)
        self.babel = babel_class(settings.language_code, document.reporter)
        self.author_separator = self.language_module.author_separators[0]
        d_options = [self.settings.documentoptions]
        if self.babel.language not in ('english', ''):
            d_options.append(self.babel.language)
        self.documentoptions = ','.join(filter(None, d_options))
        self.d_class = DocumentClass(settings.documentclass,
                                     settings.use_part_section)
        # graphic package options:
        if self.settings.graphicx_option == '':
            self.graphicx_package = r'\usepackage{graphicx}'
        elif self.settings.graphicx_option.lower() == 'auto':
            self.graphicx_package = PreambleCmds.graphicx_auto
        else:
            self.graphicx_package = (r'\usepackage[%s]{graphicx}' %
                                     self.settings.graphicx_option)
        # footnotes:
        self.docutils_footnotes = settings.docutils_footnotes
        # @@ table_style: list of values from fixed set: warn?
        # for s in self.settings.table_style:
        #     if s not in Writer.table_style_values:
        #         self.warn('Ignoring value "%s" in "table-style" setting.' %s)

        # Output collection stacks
        # ~~~~~~~~~~~~~~~~~~~~~~~~

        # Document parts
        self.head_prefix = [r'\documentclass[%s]{%s}' %
            (self.documentoptions, self.settings.documentclass)]
        self.requirements = SortableDict() # made a list in depart_document()
        self.requirements['__static'] = r'\usepackage{ifthen}'
        self.latex_preamble = [settings.latex_preamble]
        self.fallbacks = SortableDict() # made a list in depart_document()
        self.pdfsetup = [] # PDF properties (hyperref package)
        self.title = []
        self.subtitle = []
        self.titledata = [] # \title, \author, \date
        ## self.body_prefix = ['\\begin{document}\n']
        self.body_pre_docinfo = [] # \maketitle
        self.docinfo = []
        self.dedication = []
        self.abstract = []
        self.body = []
        ## self.body_suffix = ['\\end{document}\n']

        # A heterogenous stack used in conjunction with the tree traversal.
        # Make sure that the pops correspond to the pushes:
        self.context = []

        # Title metadata:
        self.title_labels = []
        self.subtitle_labels = []
        # (if use_latex_docinfo: collects lists of
        # author/organization/contact/address lines)
        self.author_stack = []
        self.date = []

        # PDF properties: pdftitle, pdfauthor
        # TODO?: pdfcreator, pdfproducer, pdfsubject, pdfkeywords
        self.pdfinfo = []
        self.pdfauthor = []

        # Stack of section counters so that we don't have to use_latex_toc.
        # This will grow and shrink as processing occurs.
        # Initialized for potential first-level sections.
        self._section_number = [0]

        # The current stack of enumerations so that we can expand
        # them into a compound enumeration.
        self._enumeration_counters = []
        # The maximum number of enumeration counters we've used.
        # If we go beyond this number, we need to create a new
        # counter; otherwise, just reuse an old one.
        self._max_enumeration_counters = 0

        self._bibitems = []

        # object for a table while proccessing.
        self.table_stack = []
        self.active_table = Table(self, 'longtable')

        # Where to collect the output of visitor methods (default: body)
        self.out = self.body
        self.out_stack = []  # stack of output collectors

        # Process settings
        # ~~~~~~~~~~~~~~~~
        # Encodings:
        # Docutils' output-encoding => TeX input encoding
        if self.latex_encoding != 'ascii':
            self.requirements['_inputenc'] = (r'\usepackage[%s]{inputenc}'
                                              % self.latex_encoding)
        # TeX font encoding
        if not self.is_xetex:
            if self.font_encoding:
                self.requirements['_fontenc'] = (r'\usepackage[%s]{fontenc}' %
                                                 self.font_encoding)
            # ensure \textquotedbl is defined:
            for enc in self.font_encoding.split(','):
                enc = enc.strip()
                if enc == 'OT1':
                    self.requirements['_textquotedblOT1'] = (
                        r'\DeclareTextSymbol{\textquotedbl}{OT1}{`\"}')
                elif enc not in ('T1', 'T2A', 'T2B', 'T2C', 'T4', 'T5'):
                    self.requirements['_textquotedbl'] = (
                        r'\DeclareTextSymbolDefault{\textquotedbl}{T1}')
        # page layout with typearea (if there are relevant document options)
        if (settings.documentclass.find('scr') == -1 and
            (self.documentoptions.find('DIV') != -1 or
             self.documentoptions.find('BCOR') != -1)):
            self.requirements['typearea'] = r'\usepackage{typearea}'

        # Stylesheets
        # (the name `self.stylesheet` is singular because only one
        # stylesheet was supported before Docutils 0.6).
        self.stylesheet = [self.stylesheet_call(path)
                           for path in utils.get_stylesheet_list(settings)]

        # PDF setup
        if self.hyperlink_color in ('0', 'false', 'False', ''):
            self.hyperref_options = ''
        else:
            self.hyperref_options = 'colorlinks=true,linkcolor=%s,urlcolor=%s' % (
                                      self.hyperlink_color, self.hyperlink_color)
        if settings.hyperref_options:
            self.hyperref_options += ',' + settings.hyperref_options

        # LaTeX Toc
        # include all supported sections in toc and PDF bookmarks
        # (or use documentclass-default (as currently))?
        ## if self.use_latex_toc:
        ##    self.requirements['tocdepth'] = (r'\setcounter{tocdepth}{%d}' %
        ##                                     len(self.d_class.sections))

        # Section numbering
        if settings.sectnum_xform: # section numbering by Docutils
            PreambleCmds.secnumdepth = r'\setcounter{secnumdepth}{0}'
        else: # section numbering by LaTeX:
            secnumdepth = settings.sectnum_depth
            # Possible values of settings.sectnum_depth:
            # None  "sectnum" directive without depth arg -> LaTeX default
            #  0    no "sectnum" directive -> no section numbers
            # >0    value of "depth" argument -> translate to LaTeX levels:
            #       -1  part    (0 with "article" document class)
            #        0  chapter (missing in "article" document class)
            #        1  section
            #        2  subsection
            #        3  subsubsection
            #        4  paragraph
            #        5  subparagraph
            if secnumdepth is not None:
                # limit to supported levels
                secnumdepth = min(secnumdepth, len(self.d_class.sections))
                # adjust to document class and use_part_section settings
                if 'chapter' in  self.d_class.sections:
                    secnumdepth -= 1
                if self.d_class.sections[0] == 'part':
                    secnumdepth -= 1
                PreambleCmds.secnumdepth = \
                    r'\setcounter{secnumdepth}{%d}' % secnumdepth

            # start with specified number:
            if (hasattr(settings, 'sectnum_start') and
                settings.sectnum_start != 1):
                self.requirements['sectnum_start'] = (
                    r'\setcounter{%s}{%d}' % (self.d_class.sections[0],
                                              settings.sectnum_start-1))
            # TODO: currently ignored (configure in a stylesheet):
            ## settings.sectnum_prefix
            ## settings.sectnum_suffix

    # Auxiliary Methods
    # -----------------

    def stylesheet_call(self, path):
        """Return code to reference or embed stylesheet file `path`"""
        # is it a package (no extension or *.sty) or "normal" tex code:
        (base, ext) = os.path.splitext(path)
        is_package = ext in ['.sty', '']
        # Embed content of style file:
        if self.settings.embed_stylesheet:
            if is_package:
                path = base + '.sty' # ensure extension
            try:
                content = io.FileInput(source_path=path,
                                       encoding='utf-8').read()
                self.settings.record_dependencies.add(path)
            except IOError, err:
                msg = u"Cannot embed stylesheet '%s':\n  %s." % (
                                path, SafeString(err.strerror))
                self.document.reporter.error(msg)
                return '% ' + msg.replace('\n', '\n% ')
            if is_package:
                content = '\n'.join([r'\makeatletter',
                                     content,
                                     r'\makeatother'])
            return '%% embedded stylesheet: %s\n%s' % (path, content)
        # Link to style file:
        if is_package:
            path = base # drop extension
            cmd = r'\usepackage{%s}'
        else:
            cmd = r'\input{%s}'
        if self.settings.stylesheet_path:
            # adapt path relative to output (cf. config.html#stylesheet-path)
            path = utils.relative_path(self.settings._destination, path)
        return cmd % path

    def to_latex_encoding(self,docutils_encoding):
        """Translate docutils encoding name into LaTeX's.

        Default method is remove "-" and "_" chars from docutils_encoding.
        """
        tr = {  'iso-8859-1': 'latin1',     # west european
                'iso-8859-2': 'latin2',     # east european
                'iso-8859-3': 'latin3',     # esperanto, maltese
                'iso-8859-4': 'latin4',     # north european, scandinavian, baltic
                'iso-8859-5': 'iso88595',   # cyrillic (ISO)
                'iso-8859-9': 'latin5',     # turkish
                'iso-8859-15': 'latin9',    # latin9, update to latin1.
                'mac_cyrillic': 'maccyr',   # cyrillic (on Mac)
                'windows-1251': 'cp1251',   # cyrillic (on Windows)
                'koi8-r': 'koi8-r',         # cyrillic (Russian)
                'koi8-u': 'koi8-u',         # cyrillic (Ukrainian)
                'windows-1250': 'cp1250',   #
                'windows-1252': 'cp1252',   #
                'us-ascii': 'ascii',        # ASCII (US)
                # unmatched encodings
                #'': 'applemac',
                #'': 'ansinew',  # windows 3.1 ansi
                #'': 'ascii',    # ASCII encoding for the range 32--127.
                #'': 'cp437',    # dos latin us
                #'': 'cp850',    # dos latin 1
                #'': 'cp852',    # dos latin 2
                #'': 'decmulti',
                #'': 'latin10',
                #'iso-8859-6': ''   # arabic
                #'iso-8859-7': ''   # greek
                #'iso-8859-8': ''   # hebrew
                #'iso-8859-10': ''   # latin6, more complete iso-8859-4
             }
        encoding = docutils_encoding.lower()
        if encoding in tr:
            return tr[encoding]
        # drop hyphen or low-line from "latin-1", "latin_1", "utf-8" and similar
        encoding = encoding.replace('_', '').replace('-', '')
        # strip the error handler
        return encoding.split(':')[0]

    def language_label(self, docutil_label):
        return self.language_module.labels[docutil_label]

    def encode(self, text):
        """Return text with 'problematic' characters escaped.

        * Escape the special printing characters ``# $ % & ~ _ ^ \ { }``,
          square brackets ``[ ]``, double quotes and (in OT1) ``< | >``.
        * Translate non-supported Unicode characters.
        * Separate ``-`` (and more in literal text) to prevent input ligatures.
        """
        if self.verbatim:
            return text
        # Set up the translation table:
        table = CharMaps.alltt.copy()
        if not self.alltt:
            table.update(CharMaps.special)
        # keep the underscore in citation references
        if self.inside_citation_reference_label:
            del(table[ord('_')])
        # Workarounds for OT1 font-encoding
        if self.font_encoding in ['OT1', ''] and not self.is_xetex:
            # * out-of-order characters in cmtt
            if self.literal:
                # replace underscore by underlined blank,
                # because this has correct width.
                table[ord('_')] = u'\\underline{~}'
                # the backslash doesn't work, so we use a mirrored slash.
                # \reflectbox is provided by graphicx:
                self.requirements['graphicx'] = self.graphicx_package
                table[ord('\\')] = ur'\reflectbox{/}'
            # * ``< | >`` come out as different chars (except for cmtt):
            else:
                table[ord('|')] = ur'\textbar{}'
                table[ord('<')] = ur'\textless{}'
                table[ord('>')] = ur'\textgreater{}'
        if self.insert_non_breaking_blanks:
            table[ord(' ')] = ur'~'
        # Unicode replacements for 8-bit tex engines (not required with XeTeX/LuaTeX):
        if not self.is_xetex:
            table.update(CharMaps.unsupported_unicode)
            if not self.latex_encoding.startswith('utf8'):
                table.update(CharMaps.utf8_supported_unicode)
                table.update(CharMaps.textcomp)
            table.update(CharMaps.pifont)
            # Characters that require a feature/package to render
            if [True for ch in text if ord(ch) in CharMaps.textcomp]:
                self.requirements['textcomp'] = PreambleCmds.textcomp
            if [True for ch in text if ord(ch) in CharMaps.pifont]:
                    self.requirements['pifont'] = '\\usepackage{pifont}'

        text = text.translate(table)

        # Break up input ligatures e.g. '--' to '-{}-'.
        if not self.is_xetex: # Not required with xetex/luatex
            separate_chars = '-'
            # In monospace-font, we also separate ',,', '``' and "''" and some
            # other characters which can't occur in non-literal text.
            if self.literal:
                separate_chars += ',`\'"<>'
            for char in separate_chars * 2:
                # Do it twice ("* 2") because otherwise we would replace
                # '---' by '-{}--'.
                text = text.replace(char + char, char + '{}' + char)

        # Literal line breaks (in address or literal blocks):
        if self.insert_newline:
            lines = text.split('\n')
            # Add a protected space to blank lines (except the last)
            # to avoid ``! LaTeX Error: There's no line here to end.``
            for i, line in enumerate(lines[:-1]):
                if not line.lstrip():
                    lines[i] += '~'
            text = (r'\\' + '\n').join(lines)
        if self.literal and not self.insert_non_breaking_blanks:
            # preserve runs of spaces but allow wrapping
            text = text.replace('  ', ' ~')
        return text

    def attval(self, text,
               whitespace=re.compile('[\n\r\t\v\f]')):
        """Cleanse, encode, and return attribute value text."""
        return self.encode(whitespace.sub(' ', text))

    # TODO: is this used anywhere? -> update (use template) or delete
    ## def astext(self):
    ##     """Assemble document parts and return as string."""
    ##     head = '\n'.join(self.head_prefix + self.stylesheet + self.head)
    ##     body = ''.join(self.body_prefix  + self.body + self.body_suffix)
    ##     return head + '\n' + body

    def is_inline(self, node):
        """Check whether a node represents an inline or block-level element"""
        return isinstance(node.parent, nodes.TextElement)

    def append_hypertargets(self, node):
        """Append hypertargets for all ids of `node`"""
        # hypertarget places the anchor at the target's baseline,
        # so we raise it explicitely
        self.out.append('%\n'.join(['\\raisebox{1em}{\\hypertarget{%s}{}}' %
                                    id for id in node['ids']]))

    def ids_to_labels(self, node, set_anchor=True):
        """Return list of label definitions for all ids of `node`

        If `set_anchor` is True, an anchor is set with \phantomsection.
        """
        labels = ['\\label{%s}' % id for id in node.get('ids', [])]
        if set_anchor and labels:
            labels.insert(0, '\\phantomsection')
        return labels

    def push_output_collector(self, new_out):
        self.out_stack.append(self.out)
        self.out = new_out

    def pop_output_collector(self):
        self.out = self.out_stack.pop()

    # Visitor methods
    # ---------------

    def visit_Text(self, node):
        self.out.append(self.encode(node.astext()))

    def depart_Text(self, node):
        pass

    def visit_abbreviation(self, node):
        node['classes'].insert(0, 'abbreviation')
        self.visit_inline(node)

    def depart_abbreviation(self, node):
        self.depart_inline(node)

    def visit_acronym(self, node):
        node['classes'].insert(0, 'acronym')
        self.visit_inline(node)

    def depart_acronym(self, node):
        self.depart_inline(node)

    def visit_address(self, node):
        self.visit_docinfo_item(node, 'address')

    def depart_address(self, node):
        self.depart_docinfo_item(node)

    def visit_admonition(self, node):
        self.fallbacks['admonition'] = PreambleCmds.admonition
        if 'error' in node['classes']:
            self.fallbacks['error'] = PreambleCmds.error
        # strip the generic 'admonition' from the list of classes
        node['classes'] = [cls for cls in node['classes']
                           if cls != 'admonition']
        self.out.append('\n\\DUadmonition[%s]{\n' % ','.join(node['classes']))

    def depart_admonition(self, node=None):
        self.out.append('}\n')

    def visit_author(self, node):
        self.visit_docinfo_item(node, 'author')

    def depart_author(self, node):
        self.depart_docinfo_item(node)

    def visit_authors(self, node):
        # not used: visit_author is called anyway for each author.
        pass

    def depart_authors(self, node):
        pass

    def visit_block_quote(self, node):
        self.out.append( '%\n\\begin{quote}\n')
        if node['classes']:
            self.visit_inline(node)

    def depart_block_quote(self, node):
        if node['classes']:
            self.depart_inline(node)
        self.out.append( '\n\\end{quote}\n')

    def visit_bullet_list(self, node):
        if self.is_toc_list:
            self.out.append( '%\n\\begin{list}{}{}\n' )
        else:
            self.out.append( '%\n\\begin{itemize}\n' )
        # if node['classes']:
        #     self.visit_inline(node)

    def depart_bullet_list(self, node):
        # if node['classes']:
        #     self.depart_inline(node)
        if self.is_toc_list:
            self.out.append( '\n\\end{list}\n' )
        else:
            self.out.append( '\n\\end{itemize}\n' )

    def visit_superscript(self, node):
        self.out.append(r'\textsuperscript{')
        if node['classes']:
            self.visit_inline(node)

    def depart_superscript(self, node):
        if node['classes']:
            self.depart_inline(node)
        self.out.append('}')

    def visit_subscript(self, node):
        self.out.append(r'\textsubscript{') # requires `fixltx2e`
        if node['classes']:
            self.visit_inline(node)

    def depart_subscript(self, node):
        if node['classes']:
            self.depart_inline(node)
        self.out.append('}')

    def visit_caption(self, node):
        self.out.append('\n\\caption{')

    def depart_caption(self, node):
        self.out.append('}\n')

    def visit_title_reference(self, node):
        self.fallbacks['titlereference'] = PreambleCmds.titlereference
        self.out.append(r'\DUroletitlereference{')
        if node['classes']:
            self.visit_inline(node)

    def depart_title_reference(self, node):
        if node['classes']:
            self.depart_inline(node)
        self.out.append( '}' )

    def visit_citation(self, node):
        # TODO maybe use cite bibitems
        if self._use_latex_citations:
            self.push_output_collector([])
        else:
            # TODO: do we need these?
            ## self.requirements['~fnt_floats'] = PreambleCmds.footnote_floats
            self.out.append(r'\begin{figure}[b]')
            self.append_hypertargets(node)

    def depart_citation(self, node):
        if self._use_latex_citations:
            label = self.out[0]
            text = ''.join(self.out[1:])
            self._bibitems.append([label, text])
            self.pop_output_collector()
        else:
            self.out.append('\\end{figure}\n')

    def visit_citation_reference(self, node):
        if self._use_latex_citations:
            if not self.inside_citation_reference_label:
                self.out.append(r'\cite{')
                self.inside_citation_reference_label = 1
            else:
                assert self.body[-1] in (' ', '\n'),\
                        'unexpected non-whitespace while in reference label'
                del self.body[-1]
        else:
            href = ''
            if 'refid' in node:
                href = node['refid']
            elif 'refname' in node:
                href = self.document.nameids[node['refname']]
            self.out.append('\\hyperlink{%s}{[' % href)

    def depart_citation_reference(self, node):
        if self._use_latex_citations:
            followup_citation = False
            # check for a following citation separated by a space or newline
            next_siblings = node.traverse(descend=False, siblings=True,
                                          include_self=False)
            if len(next_siblings) > 1:
                next = next_siblings[0]
                if (isinstance(next, nodes.Text) and
                    next.astext() in (' ', '\n')):
                    if next_siblings[1].__class__ == node.__class__:
                        followup_citation = True
            if followup_citation:
                self.out.append(',')
            else:
                self.out.append('}')
                self.inside_citation_reference_label = False
        else:
            self.out.append(']}')

    def visit_classifier(self, node):
        self.out.append( '(\\textbf{' )

    def depart_classifier(self, node):
        self.out.append( '})\n' )

    def visit_colspec(self, node):
        self.active_table.visit_colspec(node)

    def depart_colspec(self, node):
        pass

    def visit_comment(self, node):
        # Precede every line with a comment sign, wrap in newlines
        self.out.append('\n%% %s\n' % node.astext().replace('\n', '\n% '))
        raise nodes.SkipNode

    def depart_comment(self, node):
        pass

    def visit_compound(self, node):
        pass

    def depart_compound(self, node):
        pass

    def visit_contact(self, node):
        self.visit_docinfo_item(node, 'contact')

    def depart_contact(self, node):
        self.depart_docinfo_item(node)

    def visit_container(self, node):
        pass

    def depart_container(self, node):
        pass

    def visit_copyright(self, node):
        self.visit_docinfo_item(node, 'copyright')

    def depart_copyright(self, node):
        self.depart_docinfo_item(node)

    def visit_date(self, node):
        self.visit_docinfo_item(node, 'date')

    def depart_date(self, node):
        self.depart_docinfo_item(node)

    def visit_decoration(self, node):
        # header and footer
        pass

    def depart_decoration(self, node):
        pass

    def visit_definition(self, node):
        pass

    def depart_definition(self, node):
        self.out.append('\n')

    def visit_definition_list(self, node):
        self.out.append( '%\n\\begin{description}\n' )

    def depart_definition_list(self, node):
        self.out.append( '\\end{description}\n' )

    def visit_definition_list_item(self, node):
        pass

    def depart_definition_list_item(self, node):
        pass

    def visit_description(self, node):
        self.out.append(' ')

    def depart_description(self, node):
        pass

    def visit_docinfo(self, node):
        self.push_output_collector(self.docinfo)

    def depart_docinfo(self, node):
        self.pop_output_collector()
        # Some itmes (e.g. author) end up at other places
        if self.docinfo:
            # tabularx: automatic width of columns, no page breaks allowed.
            self.requirements['tabularx'] = r'\usepackage{tabularx}'
            self.fallbacks['_providelength'] = PreambleCmds.providelength
            self.fallbacks['docinfo'] = PreambleCmds.docinfo
            #
            self.docinfo.insert(0, '\n% Docinfo\n'
                                '\\begin{center}\n'
                                '\\begin{tabularx}{\\DUdocinfowidth}{lX}\n')
            self.docinfo.append('\\end{tabularx}\n'
                                '\\end{center}\n')

    def visit_docinfo_item(self, node, name):
        if name == 'author':
            self.pdfauthor.append(self.attval(node.astext()))
        if self.use_latex_docinfo:
            if name in ('author', 'organization', 'contact', 'address'):
                # We attach these to the last author.  If any of them precedes
                # the first author, put them in a separate "author" group
                # (in lack of better semantics).
                if name == 'author' or not self.author_stack:
                    self.author_stack.append([])
                if name == 'address':   # newlines are meaningful
                    self.insert_newline = True
                    text = self.encode(node.astext())
                    self.insert_newline = False
                else:
                    text = self.attval(node.astext())
                self.author_stack[-1].append(text)
                raise nodes.SkipNode
            elif name == 'date':
                self.date.append(self.attval(node.astext()))
                raise nodes.SkipNode
        self.out.append('\\textbf{%s}: &\n\t' % self.language_label(name))
        if name == 'address':
            self.insert_newline = True
            self.out.append('{\\raggedright\n')
            self.context.append(' } \\\\\n')
        else:
            self.context.append(' \\\\\n')

    def depart_docinfo_item(self, node):
        self.out.append(self.context.pop())
        # for address we did set insert_newline
        self.insert_newline = False

    def visit_doctest_block(self, node):
        self.visit_literal_block(node)

    def depart_doctest_block(self, node):
        self.depart_literal_block(node)

    def visit_document(self, node):
        # titled document?
        if (self.use_latex_docinfo or len(node) and
            isinstance(node[0], nodes.title)):
            self.title_labels += self.ids_to_labels(node, set_anchor=False)

    def depart_document(self, node):
        # Complete header with information gained from walkabout
        # * language setup
        if (self.babel.otherlanguages or
            self.babel.language not in ('', 'english')):
            self.requirements['babel'] = self.babel()
        # * conditional requirements (before style sheet)
        self.requirements = self.requirements.sortedvalues()
        # * coditional fallback definitions (after style sheet)
        self.fallbacks = self.fallbacks.sortedvalues()
        # * PDF properties
        self.pdfsetup.append(PreambleCmds.linking % self.hyperref_options)
        if self.pdfauthor:
            authors = self.author_separator.join(self.pdfauthor)
            self.pdfinfo.append('  pdfauthor={%s}' % authors)
        if self.pdfinfo:
            self.pdfsetup += [r'\hypersetup{'] + self.pdfinfo + ['}']
        # Complete body
        # * document title (with "use_latex_docinfo" also
        #   'author', 'organization', 'contact', 'address' and 'date')
        if self.title or (
           self.use_latex_docinfo and (self.author_stack or self.date)):
            # with the default template, titledata is written to the preamble
            self.titledata.append('%%% Title Data')
            # \title (empty \title prevents error with \maketitle)
            if self.title:
                self.title.insert(0, '\phantomsection%\n  ')
            title = [''.join(self.title)] + self.title_labels
            if self.subtitle:
                title += [r'\\ % subtitle',
                          r'\DUdocumentsubtitle{%s}' % ''.join(self.subtitle)
                         ] + self.subtitle_labels
            self.titledata.append(r'\title{%s}' % '%\n  '.join(title))
            # \author (empty \author prevents warning with \maketitle)
            authors = ['\\\\\n'.join(author_entry)
                        for author_entry in self.author_stack]
            self.titledata.append(r'\author{%s}' %
                                      ' \\and\n'.join(authors))
            # \date (empty \date prevents defaulting to \today)
            self.titledata.append(r'\date{%s}' % ', '.join(self.date))
            # \maketitle in the body formats title with LaTeX
            self.body_pre_docinfo.append('\\maketitle\n')

        # * bibliography
        #   TODO insertion point of bibliography should be configurable.
        if self._use_latex_citations and len(self._bibitems)>0:
            if not self.bibtex:
                widest_label = ''
                for bi in self._bibitems:
                    if len(widest_label)<len(bi[0]):
                        widest_label = bi[0]
                self.out.append('\n\\begin{thebibliography}{%s}\n' %
                                 widest_label)
                for bi in self._bibitems:
                    # cite_key: underscores must not be escaped
                    cite_key = bi[0].replace(r'\_','_')
                    self.out.append('\\bibitem[%s]{%s}{%s}\n' %
                                     (bi[0], cite_key, bi[1]))
                self.out.append('\\end{thebibliography}\n')
            else:
                self.out.append('\n\\bibliographystyle{%s}\n' %
                                self.bibtex[0])
                self.out.append('\\bibliography{%s}\n' % self.bibtex[1])
        # * make sure to generate a toc file if needed for local contents:
        if 'minitoc' in self.requirements and not self.has_latex_toc:
            self.out.append('\n\\faketableofcontents % for local ToCs\n')

    def visit_emphasis(self, node):
        self.out.append('\\emph{')
        if node['classes']:
            self.visit_inline(node)

    def depart_emphasis(self, node):
        if node['classes']:
            self.depart_inline(node)
        self.out.append('}')

    # Append column delimiters and advance column counter,
    # if the current cell is a multi-row continuation."""
    def insert_additional_table_colum_delimiters(self):
        while self.active_table.get_rowspan(
                                self.active_table.get_entry_number()):
            self.out.append(' & ')
            self.active_table.visit_entry() # increment cell count

    def visit_entry(self, node):
        # cell separation
        if self.active_table.get_entry_number() == 0:
            self.insert_additional_table_colum_delimiters()
        else:
            self.out.append(' & ')

        # multirow, multicolumn
        if 'morerows' in node and 'morecols' in node:
            raise NotImplementedError('Cells that '
            'span multiple rows *and* columns currently not supported, sorry.')
            # TODO: should be possible with LaTeX, see e.g.
            # http://texblog.org/2012/12/21/multi-column-and-multi-row-cells-in-latex-tables/
        # multirow in LaTeX simply will enlarge the cell over several rows
        # (the following n if n is positive, the former if negative).
        if 'morerows' in node:
            self.requirements['multirow'] = r'\usepackage{multirow}'
            mrows = node['morerows'] + 1
            self.active_table.set_rowspan(
                            self.active_table.get_entry_number(), mrows)
            self.out.append('\\multirow{%d}{%s}{' %
                            (mrows, self.active_table.get_column_width()))
            self.context.append('}')
        elif 'morecols' in node:
            # the vertical bar before column is missing if it is the first
            # column. the one after always.
            if self.active_table.get_entry_number() == 0:
                bar1 = self.active_table.get_vertical_bar()
            else:
                bar1 = ''
            mcols = node['morecols'] + 1
            self.out.append('\\multicolumn{%d}{%s%s%s}{' %
                    (mcols, bar1,
                     self.active_table.get_multicolumn_width(
                        self.active_table.get_entry_number(),
                        mcols),
                     self.active_table.get_vertical_bar()))
            self.context.append('}')
        else:
            self.context.append('')

        # bold header/stub-column
        if len(node) and (isinstance(node.parent.parent, nodes.thead)
                          or self.active_table.is_stub_column()):
            self.out.append('\\textbf{')
            self.context.append('}')
        else:
            self.context.append('')

        # if line ends with '{', mask line break to prevent spurious whitespace
        if not self.active_table.colwidths_auto and self.out[-1].endswith("{"):
                self.out.append("%")

        self.active_table.visit_entry() # increment cell count

    def depart_entry(self, node):
        self.out.append(self.context.pop()) # header / not header
        self.out.append(self.context.pop()) # multirow/column
        # insert extra "&"s, if following rows are spanned from above:
        self.insert_additional_table_colum_delimiters()

    def visit_row(self, node):
        self.active_table.visit_row()

    def depart_row(self, node):
        self.out.extend(self.active_table.depart_row())

    def visit_enumerated_list(self, node):
        # enumeration styles:
        types = {'': '',
                  'arabic':'arabic',
                  'loweralpha':'alph',
                  'upperalpha':'Alph',
                  'lowerroman':'roman',
                  'upperroman':'Roman'}
        # the 4 default LaTeX enumeration labels: prÃ¤fix, enumtype, suffix,
        labels = [('',  'arabic', '.'), #  1.
                  ('(', 'alph',   ')'), # (a)
                  ('',  'roman',  '.'), #  i.
                  ('',  'Alph',   '.')] #  A.

        prefix = ''
        if self.compound_enumerators:
            if (self.section_prefix_for_enumerators and self.section_level
                and not self._enumeration_counters):
                prefix = '.'.join([str(n) for n in
                                   self._section_number[:self.section_level]]
                                 ) + self.section_enumerator_separator
            if self._enumeration_counters:
                prefix += self._enumeration_counters[-1]
        # TODO: use LaTeX default for unspecified label-type?
              # (needs change of parser)
        prefix += node.get('prefix', '')
        enumtype = types[node.get('enumtype' '')]
        suffix = node.get('suffix', '')

        enumeration_level = len(self._enumeration_counters)+1
        counter_name = 'enum' + roman.toRoman(enumeration_level).lower()
        label = r'%s\%s{%s}%s' % (prefix, enumtype, counter_name, suffix)
        self._enumeration_counters.append(label)

        if enumeration_level <= 4:
            self.out.append('\\begin{enumerate}\n')
            if (prefix, enumtype, suffix
               ) != labels[enumeration_level-1]:
                self.out.append('\\renewcommand{\\label%s}{%s}\n' %
                                (counter_name, label))
        else:
            self.fallbacks[counter_name] = '\\newcounter{%s}' % counter_name
            self.out.append('\\begin{list}')
            self.out.append('{%s}' % label)
            self.out.append('{\\usecounter{%s}}\n' % counter_name)
        if 'start' in node:
            self.out.append('\\setcounter{%s}{%d}\n' %
                            (counter_name,node['start']-1))
        #     ## set rightmargin equal to leftmargin
        #     self.out.append('\\setlength{\\rightmargin}{\\leftmargin}\n')



    def depart_enumerated_list(self, node):
        if len(self._enumeration_counters) <= 4:
            self.out.append('\\end{enumerate}\n')
        else:
            self.out.append('\\end{list}\n')
        self._enumeration_counters.pop()

    def visit_field(self, node):
        # real output is done in siblings: _argument, _body, _name
        pass

    def depart_field(self, node):
        self.out.append('\n')
        ##self.out.append('%[depart_field]\n')

    def visit_field_argument(self, node):
        self.out.append('%[visit_field_argument]\n')

    def depart_field_argument(self, node):
        self.out.append('%[depart_field_argument]\n')

    def visit_field_body(self, node):
        pass

    def depart_field_body(self, node):
        if self.out is self.docinfo:
            self.out.append(r'\\')

    def visit_field_list(self, node):
        if self.out is not self.docinfo:
            self.fallbacks['fieldlist'] = PreambleCmds.fieldlist
            self.out.append('%\n\\begin{DUfieldlist}\n')

    def depart_field_list(self, node):
        if self.out is not self.docinfo:
            self.out.append('\\end{DUfieldlist}\n')

    def visit_field_name(self, node):
        if self.out is self.docinfo:
            self.out.append('\\textbf{')
        else:
            # Commands with optional args inside an optional arg must be put
            # in a group, e.g. ``\item[{\hyperref[label]{text}}]``.
            self.out.append('\\item[{')

    def depart_field_name(self, node):
        if self.out is self.docinfo:
            self.out.append('}: &')
        else:
            self.out.append(':}]')

    def visit_figure(self, node):
        self.requirements['float_settings'] = PreambleCmds.float_settings
        # The 'align' attribute sets the "outer alignment",
        # for "inner alignment" use LaTeX default alignment (similar to HTML)
        alignment = node.attributes.get('align', 'center')
        if alignment != 'center':
            # The LaTeX "figure" environment always uses the full linewidth,
            # so "outer alignment" is ignored. Just write a comment.
            # TODO: use the wrapfigure environment?
            self.out.append('\n\\begin{figure} %% align = "%s"\n' % alignment)
        else:
            self.out.append('\n\\begin{figure}\n')
        if node.get('ids'):
            self.out += self.ids_to_labels(node) + ['\n']

    def depart_figure(self, node):
        self.out.append('\\end{figure}\n')

    def visit_footer(self, node):
        self.push_output_collector([])
        self.out.append(r'\newcommand{\DUfooter}{')

    def depart_footer(self, node):
        self.out.append('}')
        self.requirements['~footer'] = ''.join(self.out)
        self.pop_output_collector()

    def visit_footnote(self, node):
        try:
            backref = node['backrefs'][0]
        except IndexError:
            backref = node['ids'][0] # no backref, use self-ref instead
        if self.docutils_footnotes:
            self.fallbacks['footnotes'] = PreambleCmds.footnotes
            num = node[0].astext()
            if self.settings.footnote_references == 'brackets':
                num = '[%s]' % num
            self.out.append('%%\n\\DUfootnotetext{%s}{%s}{%s}{' %
                            (node['ids'][0], backref, self.encode(num)))
            if node['ids'] == node['names']:
                self.out += self.ids_to_labels(node)
            # mask newline to prevent spurious whitespace if paragraph follows:
            if node[1:] and isinstance(node[1], nodes.paragraph):
                self.out.append('%')
        ## else:  # TODO: "real" LaTeX \footnote{}s

    def depart_footnote(self, node):
        self.out.append('}\n')

    def visit_footnote_reference(self, node):
        href = ''
        if 'refid' in node:
            href = node['refid']
        elif 'refname' in node:
            href = self.document.nameids[node['refname']]
        # if not self.docutils_footnotes:
            # TODO: insert footnote content at (or near) this place
            # print "footnote-ref to", node['refid']
            # footnotes = (self.document.footnotes +
            #              self.document.autofootnotes +
            #              self.document.symbol_footnotes)
            # for footnote in footnotes:
            #     # print footnote['ids']
            #     if node.get('refid', '') in footnote['ids']:
            #         print 'matches', footnote['ids']
        format = self.settings.footnote_references
        if format == 'brackets':
            self.append_hypertargets(node)
            self.out.append('\\hyperlink{%s}{[' % href)
            self.context.append(']}')
        else:
            self.fallbacks['footnotes'] = PreambleCmds.footnotes
            self.out.append(r'\DUfootnotemark{%s}{%s}{' %
                            (node['ids'][0], href))
            self.context.append('}')

    def depart_footnote_reference(self, node):
        self.out.append(self.context.pop())

    # footnote/citation label
    def label_delim(self, node, bracket, superscript):
        if isinstance(node.parent, nodes.footnote):
            raise nodes.SkipNode
        else:
            assert isinstance(node.parent, nodes.citation)
            if not self._use_latex_citations:
                self.out.append(bracket)

    def visit_label(self, node):
        """footnote or citation label: in brackets or as superscript"""
        self.label_delim(node, '[', '\\textsuperscript{')

    def depart_label(self, node):
        self.label_delim(node, ']', '}')

    # elements generated by the framework e.g. section numbers.
    def visit_generated(self, node):
        pass

    def depart_generated(self, node):
        pass

    def visit_header(self, node):
        self.push_output_collector([])
        self.out.append(r'\newcommand{\DUheader}{')

    def depart_header(self, node):
        self.out.append('}')
        self.requirements['~header'] = ''.join(self.out)
        self.pop_output_collector()

    def to_latex_length(self, length_str, pxunit=None):
        """Convert `length_str` with rst lenght to LaTeX length
        """
        if pxunit is not None:
            sys.stderr.write('deprecation warning: LaTeXTranslator.to_latex_length()'
                             ' option `pxunit` will be removed.')
        match = re.match('(\d*\.?\d*)\s*(\S*)', length_str)
        if not match:
            return length_str
        value, unit = match.groups()[:2]
        # no unit or "DTP" points (called 'bp' in TeX):
        if unit in ('', 'pt'):
            length_str = '%sbp' % value
        # percentage: relate to current line width
        elif unit == '%':
            length_str = '%.3f\\linewidth' % (float(value)/100.0)
        elif self.is_xetex and unit == 'px':
            # XeTeX does not know the length unit px.
            # Use \pdfpxdimen, the macro to set the value of 1 px in pdftex.
            # This way, configuring works the same for pdftex and xetex.
            self.fallbacks['_providelength'] = PreambleCmds.providelength
            self.fallbacks['px'] = '\n\\DUprovidelength{\\pdfpxdimen}{1bp}\n'
            length_str = r'%s\pdfpxdimen' % value
        return length_str

    def visit_image(self, node):
        self.requirements['graphicx'] = self.graphicx_package
        attrs = node.attributes
        # Convert image URI to a local file path
        imagepath = urllib.url2pathname(attrs['uri']).replace('\\', '/')
        # alignment defaults:
        if not 'align' in attrs:
            # Set default align of image in a figure to 'center'
            if isinstance(node.parent, nodes.figure):
                attrs['align'] = 'center'
            # query 'align-*' class argument
            for cls in node['classes']:
                if cls.startswith('align-'):
                    attrs['align'] = cls.split('-')[1]
        # pre- and postfix (prefix inserted in reverse order)
        pre = []
        post = []
        include_graphics_options = []
        align_codes = {
            # inline images: by default latex aligns the bottom.
            'bottom': ('', ''),
            'middle': (r'\raisebox{-0.5\height}{', '}'),
            'top':    (r'\raisebox{-\height}{', '}'),
            # block level images:
            'center': (r'\noindent\makebox[\linewidth][c]{', '}'),
            'left':   (r'\noindent{', r'\hfill}'),
            'right':  (r'\noindent{\hfill', '}'),}
        if 'align' in attrs:
            # TODO: warn or ignore non-applicable alignment settings?
            try:
                align_code = align_codes[attrs['align']]
                pre.append(align_code[0])
                post.append(align_code[1])
            except KeyError:
                pass                    # TODO: warn?
        if 'height' in attrs:
            include_graphics_options.append('height=%s' %
                            self.to_latex_length(attrs['height']))
        if 'scale' in attrs:
            include_graphics_options.append('scale=%f' %
                                            (attrs['scale'] / 100.0))
        if 'width' in attrs:
            include_graphics_options.append('width=%s' %
                            self.to_latex_length(attrs['width']))
        if not (self.is_inline(node) or
                isinstance(node.parent, nodes.figure)):
            pre.append('\n')
            post.append('\n')
        pre.reverse()
        self.out.extend(pre)
        options = ''
        if include_graphics_options:
            options = '[%s]' % (','.join(include_graphics_options))
        self.out.append('\\includegraphics%s{%s}' % (options, imagepath))
        self.out.extend(post)

    def depart_image(self, node):
        if node.get('ids'):
            self.out += self.ids_to_labels(node) + ['\n']

    def visit_inline(self, node): # <span>, i.e. custom roles
        self.context.append('}' * len(node['classes']))
        for cls in node['classes']:
            if cls == 'align-center':
                self.fallbacks['align-center'] = PreambleCmds.align_center
            if cls.startswith('language-'):
                language = self.babel.language_name(cls[9:])
                if language:
                    self.babel.otherlanguages[language] = True
                    self.out.append(r'\foreignlanguage{%s}{' % language)
            else:
                self.fallbacks['inline'] = PreambleCmds.inline
                self.out.append(r'\DUrole{%s}{' % cls)

    def depart_inline(self, node):
        self.out.append(self.context.pop())

    def visit_interpreted(self, node):
        # @@@ Incomplete, pending a proper implementation on the
        # Parser/Reader end.
        self.visit_literal(node)

    def depart_interpreted(self, node):
        self.depart_literal(node)

    def visit_legend(self, node):
        self.fallbacks['legend'] = PreambleCmds.legend
        self.out.append('\\begin{DUlegend}')

    def depart_legend(self, node):
        self.out.append('\\end{DUlegend}\n')

    def visit_line(self, node):
        self.out.append('\item[] ')

    def depart_line(self, node):
        self.out.append('\n')

    def visit_line_block(self, node):
        self.fallbacks['_providelength'] = PreambleCmds.providelength
        self.fallbacks['lineblock'] = PreambleCmds.lineblock
        if isinstance(node.parent, nodes.line_block):
            self.out.append('\\item[]\n'
                             '\\begin{DUlineblock}{\\DUlineblockindent}\n')
        else:
            self.out.append('\n\\begin{DUlineblock}{0em}\n')
        if node['classes']:
            self.visit_inline(node)
            self.out.append('\n')

    def depart_line_block(self, node):
        if node['classes']:
            self.depart_inline(node)
            self.out.append('\n')
        self.out.append('\\end{DUlineblock}\n')

    def visit_list_item(self, node):
        self.out.append('\n\\item ')

    def depart_list_item(self, node):
        pass

    def visit_literal(self, node):
        self.literal = True
        if 'code' in node['classes'] and (
                    self.settings.syntax_highlight != 'none'):
            self.requirements['color'] = PreambleCmds.color
            self.fallbacks['code'] = PreambleCmds.highlight_rules
        self.out.append('\\texttt{')
        if node['classes']:
            self.visit_inline(node)

    def depart_literal(self, node):
        self.literal = False
        if node['classes']:
            self.depart_inline(node)
        self.out.append('}')

    # Literal blocks are used for '::'-prefixed literal-indented
    # blocks of text, where the inline markup is not recognized,
    # but are also the product of the "parsed-literal" directive,
    # where the markup is respected.
    #
    # In both cases, we want to use a typewriter/monospaced typeface.
    # For "real" literal-blocks, we can use \verbatim, while for all
    # the others we must use \mbox or \alltt.
    #
    # We can distinguish between the two kinds by the number of
    # siblings that compose this node: if it is composed by a
    # single element, it's either
    # * a real one,
    # * a parsed-literal that does not contain any markup, or
    # * a parsed-literal containing just one markup construct.
    def is_plaintext(self, node):
        """Check whether a node can be typeset verbatim"""
        return (len(node) == 1) and isinstance(node[0], nodes.Text)

    def visit_literal_block(self, node):
        """Render a literal block."""
        # environments and packages to typeset literal blocks
        packages = {'alltt': r'\usepackage{alltt}',
                    'listing': r'\usepackage{moreverb}',
                    'lstlisting': r'\usepackage{listings}',
                    'Verbatim': r'\usepackage{fancyvrb}',
                    # 'verbatim': '',
                    'verbatimtab': r'\usepackage{moreverb}'}

        if node.get('ids'):
            self.out += ['\n'] + self.ids_to_labels(node)

        if not self.active_table.is_open():
            # no quote inside tables, to avoid vertical space between
            # table border and literal block.
            # TODO: fails if normal text precedes the literal block.
            # check parent node instead?
            self.out.append('%\n\\begin{quote}\n')
            self.context.append('\n\\end{quote}\n')
        else:
            self.out.append('\n')
            self.context.append('\n')

        if self.is_plaintext(node):
            environment = self.literal_block_env
            self.requirements['literal_block'] = packages.get(environment, '')
            if environment == 'alltt':
                self.alltt = True
            else:
                self.verbatim = True
            self.out.append('\\begin{%s}%s\n' %
                            (environment, self.literal_block_options))
            self.context.append('\n\\end{%s}' % environment)
        else:
            self.literal = True
            self.insert_newline = True
            self.insert_non_breaking_blanks = True
            if 'code' in node['classes'] and (
                    self.settings.syntax_highlight != 'none'):
                self.requirements['color'] = PreambleCmds.color
                self.fallbacks['code'] = PreambleCmds.highlight_rules
            self.out.append('{\\ttfamily \\raggedright \\noindent\n')
            self.context.append('\n}')

    def depart_literal_block(self, node):
        self.insert_non_breaking_blanks = False
        self.insert_newline = False
        self.literal = False
        self.verbatim = False
        self.alltt = False
        self.out.append(self.context.pop())
        self.out.append(self.context.pop())

    ## def visit_meta(self, node):
    ##     self.out.append('[visit_meta]\n')
        # TODO: set keywords for pdf?
        # But:
        #  The reStructuredText "meta" directive creates a "pending" node,
        #  which contains knowledge that the embedded "meta" node can only
        #  be handled by HTML-compatible writers. The "pending" node is
        #  resolved by the docutils.transforms.components.Filter transform,
        #  which checks that the calling writer supports HTML; if it doesn't,
        #  the "pending" node (and enclosed "meta" node) is removed from the
        #  document.
        #  --- docutils/docs/peps/pep-0258.html#transformer

    ## def depart_meta(self, node):
    ##     self.out.append('[depart_meta]\n')

    def visit_math(self, node, math_env='$'):
        """math role"""
        if node['classes']:
            self.visit_inline(node)
        self.requirements['amsmath'] = r'\usepackage{amsmath}'
        math_code = node.astext().translate(unichar2tex.uni2tex_table)
        if node.get('ids'):
            math_code = '\n'.join([math_code] + self.ids_to_labels(node))
        if math_env == '$':
            if self.alltt:
                wrapper = u'\(%s\)'
            else:
                wrapper = u'$%s$'
        else:
            wrapper = u'\n'.join(['%%',
                                 r'\begin{%s}' % math_env,
                                 '%s',
                                 r'\end{%s}' % math_env])
        # print repr(wrapper), repr(math_code)
        self.out.append(wrapper % math_code)
        if node['classes']:
            self.depart_inline(node)
        # Content already processed:
        raise nodes.SkipNode

    def depart_math(self, node):
        pass # never reached

    def visit_math_block(self, node):
        math_env = pick_math_environment(node.astext())
        self.visit_math(node, math_env=math_env)

    def depart_math_block(self, node):
        pass # never reached

    def visit_option(self, node):
        if self.context[-1]:
            # this is not the first option
            self.out.append(', ')

    def depart_option(self, node):
        # flag that the first option is done.
        self.context[-1] += 1

    def visit_option_argument(self, node):
        """Append the delimiter betweeen an option and its argument to body."""
        self.out.append(node.get('delimiter', ' '))

    def depart_option_argument(self, node):
        pass

    def visit_option_group(self, node):
        self.out.append('\n\\item[')
        # flag for first option
        self.context.append(0)

    def depart_option_group(self, node):
        self.context.pop() # the flag
        self.out.append('] ')

    def visit_option_list(self, node):
        self.fallbacks['_providelength'] = PreambleCmds.providelength
        self.fallbacks['optionlist'] = PreambleCmds.optionlist
        self.out.append('%\n\\begin{DUoptionlist}\n')

    def depart_option_list(self, node):
        self.out.append('\n\\end{DUoptionlist}\n')

    def visit_option_list_item(self, node):
        pass

    def depart_option_list_item(self, node):
        pass

    def visit_option_string(self, node):
        ##self.out.append(self.starttag(node, 'span', '', CLASS='option'))
        pass

    def depart_option_string(self, node):
        ##self.out.append('</span>')
        pass

    def visit_organization(self, node):
        self.visit_docinfo_item(node, 'organization')

    def depart_organization(self, node):
        self.depart_docinfo_item(node)

    def visit_paragraph(self, node):
        # insert blank line, unless
        # * the paragraph is first in a list item,
        # * follows a non-paragraph node in a compound,
        # * is in a table with auto-width columns
        index = node.parent.index(node)
        if (index == 0 and (isinstance(node.parent, nodes.list_item) or
                            isinstance(node.parent, nodes.description))):
            pass
        elif (index > 0 and isinstance(node.parent, nodes.compound) and
              not isinstance(node.parent[index - 1], nodes.paragraph) and
              not isinstance(node.parent[index - 1], nodes.compound)):
            pass
        elif self.active_table.colwidths_auto:
            if index == 1: # second paragraph
                self.warn('LaTeX merges paragraphs in tables '
                          'with auto-sized columns!', base_node=node)
            if index > 0:
                self.out.append('\n')
        else:
            self.out.append('\n')
        if node.get('ids'):
            self.out += self.ids_to_labels(node) + ['\n']
        if node['classes']:
            self.visit_inline(node)

    def depart_paragraph(self, node):
        if node['classes']:
            self.depart_inline(node)
        if not self.active_table.colwidths_auto:
            self.out.append('\n')

    def visit_problematic(self, node):
        self.requirements['color'] = PreambleCmds.color
        self.out.append('%\n')
        self.append_hypertargets(node)
        self.out.append(r'\hyperlink{%s}{\textbf{\color{red}' % node['refid'])

    def depart_problematic(self, node):
        self.out.append('}}')

    def visit_raw(self, node):
        if not 'latex' in node.get('format', '').split():
            raise nodes.SkipNode
        if not self.is_inline(node):
            self.out.append('\n')
        if node['classes']:
            self.visit_inline(node)
        # append "as-is" skipping any LaTeX-encoding
        self.verbatim = True

    def depart_raw(self, node):
        self.verbatim = False
        if node['classes']:
            self.depart_inline(node)
        if not self.is_inline(node):
            self.out.append('\n')

    def has_unbalanced_braces(self, string):
        """Test whether there are unmatched '{' or '}' characters."""
        level = 0
        for ch in string:
            if ch == '{':
                level += 1
            if ch == '}':
                level -= 1
            if level < 0:
                return True
        return level != 0

    def visit_reference(self, node):
        # We need to escape #, \, and % if we use the URL in a command.
        special_chars = {ord('#'): ur'\#',
                         ord('%'): ur'\%',
                         ord('\\'): ur'\\',
                        }
        # external reference (URL)
        if 'refuri' in node:
            href = unicode(node['refuri']).translate(special_chars)
            # problematic chars double caret and unbalanced braces:
            if href.find('^^') != -1 or self.has_unbalanced_braces(href):
                self.error(
                    'External link "%s" not supported by LaTeX.\n'
                    ' (Must not contain "^^" or unbalanced braces.)' % href)
            if node['refuri'] == node.astext():
                self.out.append(r'\url{%s}' % href)
                raise nodes.SkipNode
            self.out.append(r'\href{%s}{' % href)
            return
        # internal reference
        if 'refid' in node:
            href = node['refid']
        elif 'refname' in node:
            href = self.document.nameids[node['refname']]
        else:
            raise AssertionError('Unknown reference.')
        if not self.is_inline(node):
            self.out.append('\n')
        self.out.append('\\hyperref[%s]{' % href)
        if self._reference_label:
            self.out.append('\\%s{%s}}' %
                            (self._reference_label, href.replace('#', '')))
            raise nodes.SkipNode

    def depart_reference(self, node):
        self.out.append('}')
        if not self.is_inline(node):
            self.out.append('\n')

    def visit_revision(self, node):
        self.visit_docinfo_item(node, 'revision')

    def depart_revision(self, node):
        self.depart_docinfo_item(node)

    def visit_section(self, node):
        self.section_level += 1
        # Initialize counter for potential subsections:
        self._section_number.append(0)
        # Counter for this section's level (initialized by parent section):
        self._section_number[self.section_level - 1] += 1

    def depart_section(self, node):
        # Remove counter for potential subsections:
        self._section_number.pop()
        self.section_level -= 1

    def visit_sidebar(self, node):
        self.requirements['color'] = PreambleCmds.color
        self.fallbacks['sidebar'] = PreambleCmds.sidebar
        self.out.append('\n\\DUsidebar{\n')

    def depart_sidebar(self, node):
        self.out.append('}\n')

    attribution_formats = {'dash': (u'â€”', ''), # EM DASH
                           'parentheses': ('(', ')'),
                           'parens': ('(', ')'),
                           'none': ('', '')}

    def visit_attribution(self, node):
        prefix, suffix = self.attribution_formats[self.settings.attribution]
        self.out.append('\\nopagebreak\n\n\\raggedleft ')
        self.out.append(prefix)
        self.context.append(suffix)

    def depart_attribution(self, node):
        self.out.append(self.context.pop() + '\n')

    def visit_status(self, node):
        self.visit_docinfo_item(node, 'status')

    def depart_status(self, node):
        self.depart_docinfo_item(node)

    def visit_strong(self, node):
        self.out.append('\\textbf{')
        if node['classes']:
            self.visit_inline(node)

    def depart_strong(self, node):
        if node['classes']:
            self.depart_inline(node)
        self.out.append('}')

    def visit_substitution_definition(self, node):
        raise nodes.SkipNode

    def visit_substitution_reference(self, node):
        self.unimplemented_visit(node)

    def visit_subtitle(self, node):
        if isinstance(node.parent, nodes.document):
            self.push_output_collector(self.subtitle)
            self.fallbacks['documentsubtitle'] = PreambleCmds.documentsubtitle
            self.subtitle_labels += self.ids_to_labels(node, set_anchor=False)
        # section subtitle: "starred" (no number, not in ToC)
        elif isinstance(node.parent, nodes.section):
            self.out.append(r'\%s*{' %
                             self.d_class.section(self.section_level + 1))
        else:
            self.fallbacks['subtitle'] = PreambleCmds.subtitle
            self.out.append('\n\\DUsubtitle[%s]{' % node.parent.tagname)

    def depart_subtitle(self, node):
        if isinstance(node.parent, nodes.document):
            self.pop_output_collector()
        else:
            self.out.append('}\n')

    def visit_system_message(self, node):
        self.requirements['color'] = PreambleCmds.color
        self.fallbacks['title'] = PreambleCmds.title
        node['classes'] = ['system-message']
        self.visit_admonition(node)
        self.out.append('\\DUtitle[system-message]{system-message}\n')
        self.append_hypertargets(node)
        try:
            line = ', line~%s' % node['line']
        except KeyError:
            line = ''
        self.out.append('\n\n{\color{red}%s/%s} in \\texttt{%s}%s\n' %
                         (node['type'], node['level'],
                          self.encode(node['source']), line))
        if len(node['backrefs']) == 1:
            self.out.append('\n\\hyperlink{%s}{' % node['backrefs'][0])
            self.context.append('}')
        else:
            backrefs = ['\\hyperlink{%s}{%d}' % (href, i+1)
                        for (i, href) in enumerate(node['backrefs'])]
            self.context.append('backrefs: ' + ' '.join(backrefs))

    def depart_system_message(self, node):
        self.out.append(self.context.pop())
        self.depart_admonition()

    def visit_table(self, node):
        self.requirements['table'] = PreambleCmds.table
        if self.active_table.is_open():
            self.table_stack.append(self.active_table)
            # nesting longtable does not work (e.g. 2007-04-18)
            self.active_table = Table(self,'tabular')
        # A longtable moves before \paragraph and \subparagraph
        # section titles if it immediately follows them:
        if (self.active_table._latex_type == 'longtable' and
            isinstance(node.parent, nodes.section) and
            node.parent.index(node) == 1 and
            self.d_class.section(self.section_level).find('paragraph') != -1):
            self.out.append('\\leavevmode')
        self.active_table.open()
        self.active_table.set_table_style(self.settings.table_style,
                                          node['classes'])
        if 'align' in node:
            self.active_table.set('align', node['align'])
        if self.active_table.borders == 'booktabs':
            self.requirements['booktabs'] = r'\usepackage{booktabs}'
        self.push_output_collector([])

    def depart_table(self, node):
        # wrap content in the right environment:
        content = self.out
        self.pop_output_collector()
        self.out.append('\n' + self.active_table.get_opening())
        self.out += content
        self.out.append(self.active_table.get_closing() + '\n')
        self.active_table.close()
        if len(self.table_stack)>0:
            self.active_table = self.table_stack.pop()
        # Insert hyperlabel after (long)table, as
        # other places (beginning, caption) result in LaTeX errors.
        if node.get('ids'):
            self.out += self.ids_to_labels(node, set_anchor=False) + ['\n']

    def visit_target(self, node):
        # Skip indirect targets:
        if ('refuri' in node       # external hyperlink
            or 'refid' in node     # resolved internal link
            or 'refname' in node): # unresolved internal link
            ## self.out.append('%% %s\n' % node)   # for debugging
            return
        self.out.append('%\n')
        # do we need an anchor (\phantomsection)?
        set_anchor = not(isinstance(node.parent, nodes.caption) or
                         isinstance(node.parent, nodes.title))
        # TODO: where else can/must we omit the \phantomsection?
        self.out += self.ids_to_labels(node, set_anchor)

    def depart_target(self, node):
        pass

    def visit_tbody(self, node):
        # BUG write preamble if not yet done (colspecs not [])
        # for tables without heads.
        if not self.active_table.get('preamble written'):
            self.visit_thead(node)
            self.depart_thead(None)

    def depart_tbody(self, node):
        pass

    def visit_term(self, node):
        """definition list term"""
        # Commands with optional args inside an optional arg must be put
        # in a group, e.g. ``\item[{\hyperref[label]{text}}]``.
        self.out.append('\\item[{')

    def depart_term(self, node):
        # \leavevmode results in a line break if the
        # term is followed by an item list.
        self.out.append('}] \leavevmode ')

    def visit_tgroup(self, node):
        #self.out.append(self.starttag(node, 'colgroup'))
        #self.context.append('</colgroup>\n')
        pass

    def depart_tgroup(self, node):
        pass

    _thead_depth = 0
    def thead_depth (self):
        return self._thead_depth

    def visit_thead(self, node):
        self._thead_depth += 1
        if 1 == self.thead_depth():
            self.out.append('{%s}\n' % self.active_table.get_colspecs(node))
            self.active_table.set('preamble written',1)
        self.out.append(self.active_table.get_caption())
        self.out.extend